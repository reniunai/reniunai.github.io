<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.14" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.51" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://reniunai.github.io/note/java/juc.html"><meta property="og:site_name" content="热牛奶"><meta property="og:title" content="Java并发包"><meta property="og:description" content="Java 并发包"><meta property="og:type" content="article"><meta property="og:image" content="https://reniunai.github.io/assets/images/cover1.jpg"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2024-07-15T17:57:29.000Z"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image:src" content="https://reniunai.github.io/assets/images/cover1.jpg"><meta name="twitter:image:alt" content="Java并发包"><meta property="article:author" content="HotMilk"><meta property="article:tag" content="jvm"><meta property="article:published_time" content="2024-07-15T00:00:00.000Z"><meta property="article:modified_time" content="2024-07-15T17:57:29.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Java并发包","image":["https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407152329333.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407152329791.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407152329444.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407152329589.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407152329327.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407152329339.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407152329318.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407152329419.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407152329587.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407152329795.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407152329812.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407152331977.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407152329919.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407152329433.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407152329798.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407152329817.png"],"datePublished":"2024-07-15T00:00:00.000Z","dateModified":"2024-07-15T17:57:29.000Z","author":[{"@type":"Person","name":"HotMilk"}]}</script><title>Java并发包 | 热牛奶</title><meta name="description" content="Java 并发包">
    <link rel="preload" href="/assets/style-DqX65dVc.css" as="style"><link rel="stylesheet" href="/assets/style-DqX65dVc.css">
    <link rel="modulepreload" href="/assets/app-CKQIJpv-.js"><link rel="modulepreload" href="/assets/juc.html-CL3B8A36.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper-DlAUqK2U.js">
    <link rel="prefetch" href="/assets/index.html-DhYtpP-S.js" as="script"><link rel="prefetch" href="/assets/intro.html-Dc4e8w4p.js" as="script"><link rel="prefetch" href="/assets/index.html-BNxHpTJZ.js" as="script"><link rel="prefetch" href="/assets/disable.html-DM1t4aLT.js" as="script"><link rel="prefetch" href="/assets/encrypt.html-3B9TJ5kY.js" as="script"><link rel="prefetch" href="/assets/layout.html-yGM6a8AG.js" as="script"><link rel="prefetch" href="/assets/markdown.html-DfZ6aFU_.js" as="script"><link rel="prefetch" href="/assets/page.html-CV4bOjJH.js" as="script"><link rel="prefetch" href="/assets/index.html-BjGyCfdm.js" as="script"><link rel="prefetch" href="/assets/cherry.html-D6OiZ43F.js" as="script"><link rel="prefetch" href="/assets/dragonfruit.html-D7dVSdEJ.js" as="script"><link rel="prefetch" href="/assets/strawberry.html-CTSPU1cc.js" as="script"><link rel="prefetch" href="/assets/tomato.html-CQ_0enRe.js" as="script"><link rel="prefetch" href="/assets/index.html-D9Hl9OIJ.js" as="script"><link rel="prefetch" href="/assets/disable.html-B_SJrLfj.js" as="script"><link rel="prefetch" href="/assets/jvm.html-DBEJvpns.js" as="script"><link rel="prefetch" href="/assets/index.html-D5Jcs94D.js" as="script"><link rel="prefetch" href="/assets/Redis缓存穿透-布隆过滤器.html-BCYSHZaD.js" as="script"><link rel="prefetch" href="/assets/page.html-D-eLTm6q.js" as="script"><link rel="prefetch" href="/assets/1.html-74odiZSz.js" as="script"><link rel="prefetch" href="/assets/2.html-zZSx2L3c.js" as="script"><link rel="prefetch" href="/assets/3.html-BDsBhxq3.js" as="script"><link rel="prefetch" href="/assets/4.html-CPfbcb9M.js" as="script"><link rel="prefetch" href="/assets/1.html-CfpkmsA6.js" as="script"><link rel="prefetch" href="/assets/2.html-DcHThEDm.js" as="script"><link rel="prefetch" href="/assets/3.html-CRSXhmjd.js" as="script"><link rel="prefetch" href="/assets/4.html-CWm5xlFh.js" as="script"><link rel="prefetch" href="/assets/404.html-v94XwAiI.js" as="script"><link rel="prefetch" href="/assets/index.html-BcHsRj--.js" as="script"><link rel="prefetch" href="/assets/index.html-C35R9sRy.js" as="script"><link rel="prefetch" href="/assets/index.html-CqTW4kA0.js" as="script"><link rel="prefetch" href="/assets/index.html-403xvqB7.js" as="script"><link rel="prefetch" href="/assets/index.html-BSNvA-tY.js" as="script"><link rel="prefetch" href="/assets/index.html-D0h0uTek.js" as="script"><link rel="prefetch" href="/assets/index.html-BNDgWQe2.js" as="script"><link rel="prefetch" href="/assets/index.html-DtAK8gar.js" as="script"><link rel="prefetch" href="/assets/index.html-D9aQqP9k.js" as="script"><link rel="prefetch" href="/assets/index.html-BBaMbJfT.js" as="script"><link rel="prefetch" href="/assets/index.html-C7Twnrkg.js" as="script"><link rel="prefetch" href="/assets/index.html-DYriTMWx.js" as="script"><link rel="prefetch" href="/assets/index.html-CfipAdsF.js" as="script"><link rel="prefetch" href="/assets/index.html-Cn2qzZQI.js" as="script"><link rel="prefetch" href="/assets/index.html-BjAQ-ncl.js" as="script"><link rel="prefetch" href="/assets/index.html-C--3pY-h.js" as="script"><link rel="prefetch" href="/assets/index.html-C0tHtTSB.js" as="script"><link rel="prefetch" href="/assets/index.html-CtL-SmEI.js" as="script"><link rel="prefetch" href="/assets/index.html-NBXHbGmY.js" as="script"><link rel="prefetch" href="/assets/index.html-BNOALFwt.js" as="script"><link rel="prefetch" href="/assets/index.html-BoGxxJy3.js" as="script"><link rel="prefetch" href="/assets/index.html-DxHpzZ4U.js" as="script"><link rel="prefetch" href="/assets/index.html-DGCoXL09.js" as="script"><link rel="prefetch" href="/assets/index.html-C1gdotkH.js" as="script"><link rel="prefetch" href="/assets/index.html-BDtZhG-R.js" as="script"><link rel="prefetch" href="/assets/index.html-CZ8eC7Le.js" as="script"><link rel="prefetch" href="/assets/index.html-BNIFwZY1.js" as="script"><link rel="prefetch" href="/assets/index.html-DgGgSBHp.js" as="script"><link rel="prefetch" href="/assets/index.html-BSN2jgdK.js" as="script"><link rel="prefetch" href="/assets/index.html-cuD4ShmG.js" as="script"><link rel="prefetch" href="/assets/index.html-CmNEOcbw.js" as="script"><link rel="prefetch" href="/assets/index.html-CGkSYJND.js" as="script"><link rel="prefetch" href="/assets/index.html-Ew7kbYlH.js" as="script"><link rel="prefetch" href="/assets/index.html-DwvBrTB1.js" as="script"><link rel="prefetch" href="/assets/index.html-CUY4xPkd.js" as="script"><link rel="prefetch" href="/assets/index.html-BCiP3bZ8.js" as="script"><link rel="prefetch" href="/assets/index.html-CVmXONul.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-GXRgw7eJ.js" as="script"><link rel="prefetch" href="/assets/SearchResult-BzPc5bsH.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">跳至主要內容</a><!--]--><div class="theme-container external-link-icon has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><!--[--><a class="route-link vp-brand" href="/"><img class="vp-nav-logo" src="https://theme-hope-assets.vuejs.press/logo.svg" alt><!----><span class="vp-site-name hide-in-pad">热牛奶</span></a><!--]--><!----></div><div class="vp-navbar-center"><!----><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/" aria-label="博客主页"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span><!--]-->博客主页<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="笔记"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>笔记<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link route-link-active auto-link" href="/note/java/" aria-label="java"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->java<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/note/redis/" aria-label="redis"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->redis<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/note/Linux/" aria-label="redis"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->redis<!----></a></li></ul></button></div></div></nav><!--]--><!----></div><div class="vp-navbar-end"><!----><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/reniunai" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-outlook-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon" name="outlook"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="vp-outlook-dropdown"><!----></div></button></div><!--[--><button type="button" class="search-pro-button" aria-label="搜索"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon" name="search"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="search-pro-placeholder">搜索</div><div class="search-pro-key-hints"><kbd class="search-pro-key">Ctrl</kbd><kbd class="search-pro-key">K</kbd></div></button><!--]--><!--]--><!----><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!----><ul class="vp-sidebar-links"><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/note/java/juc.html" aria-label="Java并发包"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-file" style=""></span><!--]-->Java并发包<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/note/java/jvm.html" aria-label="Java虚拟机"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-file" style=""></span><!--]-->Java虚拟机<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/note/java/disable.html" aria-label="布局与功能禁用"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-gears" style=""></span><!--]-->布局与功能禁用<!----></a></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><div class="page-cover"><img src="/assets/images/cover1.jpg" alt no-view></div><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><span class="font-icon icon fa-fw fa-sm fas fa-file" style=""></span>Java并发包</h1><div class="page-info"><span class="page-author-info" aria-label="作者🖊" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><span class="page-author-item">HotMilk</span></span><span property="author" content="HotMilk"></span></span><!----><span class="page-date-info" aria-label="写作日期📅" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2024-07-15T00:00:00.000Z"></span><span class="page-category-info" aria-label="分类🌈" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon" name="category"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item color7 clickable" role="navigation">JVM</span><!--]--><meta property="articleSection" content="JVM"></span><span class="page-tag-info" aria-label="标签🏷" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon" name="tag"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item color5 clickable" role="navigation">jvm</span><!--]--><meta property="keywords" content="jvm"></span><span class="page-reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 29 分钟</span><meta property="timeRequired" content="PT29M"></span><span class="page-word-info" aria-label="字数🔠" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon word-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="word icon" name="word"><path d="M518.217 432.64V73.143A73.143 73.143 0 01603.43 1.097a512 512 0 01419.474 419.474 73.143 73.143 0 01-72.046 85.212H591.36a73.143 73.143 0 01-73.143-73.143z"></path><path d="M493.714 566.857h340.297a73.143 73.143 0 0173.143 85.577A457.143 457.143 0 11371.566 117.76a73.143 73.143 0 0185.577 73.143v339.383a36.571 36.571 0 0036.571 36.571z"></path></svg><span>约 8768 字</span><meta property="wordCount" content="8768"></span></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!----><div class="vp-toc-header">此页内容<button type="button" class="print-button" title="打印"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#wait-notify原理">Wait notify原理</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#join原理">join原理</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#park-unpark原理">Park unpark原理</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#先park-后unpark">先Park 后unpark</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#先unpark后park">先unpark后Park</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#与-object-的-wait-notify相比">与 Object 的 wait &amp; notify相比</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#含义">含义</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#作用">作用</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#使用场景及原理">使用场景及原理</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#synchronized">Synchronized</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#monitor-被翻译为监视器或管程">Monitor 被翻译为监视器或管程</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#关联流程">关联流程</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#对象头">对象头</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#偏向锁">偏向锁</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#轻量级锁">轻量级锁</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#锁膨胀">锁膨胀</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#锁消除">锁消除</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#synchronized-的四种锁状态">Synchronized 的四种锁状态</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#reentrantlock">ReentrantLock</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#synchronized和reentrantlock对比">Synchronized和ReentrantLock对比</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#reentrantreadwritelock">ReentrantReadWriteLock</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#cas-aba问题-自旋问题-单个变量操作">CAS：ABA问题，自旋问题，单个变量操作</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#aqs">AQS</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#semaphore">Semaphore</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#semaphore-原理">Semaphore 原理</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#semaphore的主要特点包括">Semaphore的主要特点包括</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#使用semaphore的一个简单例子">使用Semaphore的一个简单例子：</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#countdownlatch">CountDownLatch</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#cyclicbarrier-类">CyclicBarrier 类</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#exchanger">Exchanger</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#completablefuture">CompletableFuture</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#locksupport">LockSupport</a></li><!----><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!----></aside></div><!----><div class="theme-hope-content"><p>Java 并发包</p><!-- more --><p>JUC是指package java.util.concurrent;这个并发包。</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407152329333.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>这个包是为了解决并发问题的。有atomic子包，locks子包，Semaphore，Threadlocal，ThreadPoolExecutor，Excutor，CyclicBarrier，Future，</p><h1 id="线程间通信机制" tabindex="-1"><a class="header-anchor" href="#线程间通信机制"><span>线程间通信机制</span></a></h1><p>讲到并发，那要先提一下线程间是如何通信的，简单来说线程有两种通信方式，一种是基于共享内存的，一种是基于消息传递的。Java里面是基于内存共享来进行线程间的通信，golang里面的协程（类似于操作系统的线程，线程是CPU调度的最小单位，协程是在线程的基础上再细分出来的一个调度的最小单位）可以通过管道进行消息传递来实现协程间的通信。</p><h1 id="线程同步机制" tabindex="-1"><a class="header-anchor" href="#线程同步机制"><span>线程同步机制</span></a></h1><p>线程同步是一种机制，用于控制多个线程访问共享资源（如内存、文件、数据库等）的方式，以避免数据不一致或竞态条件的问题。在 Java 中，线程同步通常通过以下几种方式实现：</p><ol><li><strong>互斥锁</strong>**（Mutexes）**：通过 <code>synchronized</code> 关键字或 <code>java.util.concurrent.locks.Lock</code> 接口的实现（如 <code>ReentrantLock</code>）来保证同一时间只有一个线程可以访问特定的代码块或资源。</li><li><strong>原子操作</strong>：使用 <code>java.util.concurrent.atomic</code> 包中的原子类（如 <code>AtomicInteger</code>、<code>AtomicReference</code> 等）来执行不可中断的操作。</li><li><strong>volatile 关键字</strong>：确保对变量的读写操作直接在主内存中进行，而不是在各个线程的缓存中，以此保证变量的一致性。</li><li><strong>final 关键字</strong>：确保对象的引用在构造之后不会改变，保证对象初始化的安全性。</li></ol><p>线程同步的目的是确保当一个线程正在使用某个资源时，其他线程不会同时修改这个资源，从而防止数据竞争和不一致。</p><h1 id="线程通信" tabindex="-1"><a class="header-anchor" href="#线程通信"><span>线程通信</span></a></h1><p>线程通信是指线程之间相互发送信号和交换数据的过程。线程通信通常用于以下场景：</p><ol><li><strong>协调任务执行</strong>：线程可能需要等待其他线程完成某些操作后才能继续执行。</li><li><strong>数据共享</strong>：线程可能需要向其他线程提供数据或者从其他线程接收数据。</li></ol><p>在 Java 中，线程通信通常通过以下几种方式实现：</p><ol><li><strong>等待/通知机制</strong>：通过 <code>Object</code> 类的 <code>wait()</code>、<code>notify()</code> 和 <code>notifyAll()</code> 方法实现。一个线程可以调用 <code>wait()</code> 方法暂停执行并等待其他线程通过 <code>notify()</code> 或 <code>notifyAll()</code> 方法唤醒它。</li><li><strong>条件变量</strong>：通过 <code>java.util.concurrent.locks.Condition</code> 接口实现，与 <code>ReentrantLock</code> 结合使用，提供了更灵活的线程通信方式。</li><li>**CountDownLatch、CyclicBarrier、**<strong>Semaphore</strong> 等同步器：提供更高级的线程通信和同步机制。</li></ol><h2 id="wait-notify原理" tabindex="-1"><a class="header-anchor" href="#wait-notify原理"><span>Wait notify原理</span></a></h2><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407152329791.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><ul><li>Owner 线程发现条件不满足，调用 wait 方法，即可进入 WaitSet 变为 WAITING 状态</li><li>BLOCKED 和 WAITING 的线程都处于阻塞状态，不占用 CPU 时间片</li><li>BLOCKED 线程会在 Owner 线程释放锁时唤醒</li><li>WAITING 线程会在 Owner 线程调用 notify 或 notifyAll 时唤醒，但唤醒后并不意味者立刻获得锁，仍需进入</li><li>EntryList 重新竞争</li></ul><h2 id="join原理" tabindex="-1"><a class="header-anchor" href="#join原理"><span>join原理</span></a></h2><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">//是调用者轮询检查线程 alive 状态</span></span>
<span class="line"><span style="color:#D8DEE9;">t1</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">join</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">等价于下面的代码</span></span>
<span class="line"><span style="color:#81A1C1;">synchronized</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9FF;">t1</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;"> // 调用者线程进入 t1 的 waitSet 等待, 直到 t1 运行结束</span></span>
<span class="line"><span style="color:#81A1C1;"> while</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">t1</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isAlive</span><span style="color:#ECEFF4;">())</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;"> t1</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">wait</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">0</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;"> }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>注意</strong> <strong>join 体现的是【保护性暂停】模式，请参考之</strong></p></blockquote><h2 id="park-unpark原理" tabindex="-1"><a class="header-anchor" href="#park-unpark原理"><span>Park unpark原理</span></a></h2><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// 暂停当前线程</span></span>
<span class="line"><span style="color:#D8DEE9;">LockSupport</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">park</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">// 恢复某个线程的运行</span></span>
<span class="line"><span style="color:#D8DEE9;">LockSupport</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">unpark</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">暂停线程对象</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>每个线程都有自己的一个 Parker 对象，由三部分组成 _counter ， _cond 和 _mutex 打个比喻</p><p>_counter 理解成订单，_cond 理解成停车场，_mutex是互斥锁。</p><p>把Park 理解成泊车，把unpark理解成出车。跟现实的司机很像，这里代入一下。</p><p>可以先Park 后unpark，也可以先unpark后Park 。</p><h3 id="先park-后unpark" tabindex="-1"><a class="header-anchor" href="#先park-后unpark"><span>先Park 后unpark</span></a></h3><p>执行Park ，司机在停车场停车休息，阻塞等待订单。</p><p>执行unpark，下了个订单，司机那边收到就开始工作。</p><h3 id="先unpark后park" tabindex="-1"><a class="header-anchor" href="#先unpark后park"><span>先unpark后Park</span></a></h3><p>执行unpark，先下个单，等司机来接。</p><p>执行Park ，开车不能玩手机，司机停车的时候发现有个订单，立马处理，不用阻塞等待。这里跟现实不一样，这里必须是司机停车的时候才能接单。</p><h2 id="与-object-的-wait-notify相比" tabindex="-1"><a class="header-anchor" href="#与-object-的-wait-notify相比"><span>与 Object 的 wait &amp; notify相比</span></a></h2><ul><li>wait, notify 和 notifyAll 必须配合 Object Monitor 一起使用,而 park, unpark不必</li><li>park &amp; unpark是以线程为单位来【阻塞】和【唤醒】线程，而 notify 只能随机唤醒一个等待线程， notifyAll 是唤醒所有等待线程，就不那么【精确】</li><li>park &amp; unpark可以先 unpark, 而 wait &amp; notify 不能先 notify</li></ul><h1 id="线程同步和线程通信的关系" tabindex="-1"><a class="header-anchor" href="#线程同步和线程通信的关系"><span>线程同步和线程通信的关系</span></a></h1><p>线程同步和线程通信虽然密切相关，但它们的关注点不同。线程同步关注的是如何避免并发导致的问题，而线程通信关注的是线程之间如何协作完成任务。在并发编程中，这两者通常是相辅相成的。</p><h1 id="java内存模型-jmm" tabindex="-1"><a class="header-anchor" href="#java内存模型-jmm"><span>Java内存模型（JMM）</span></a></h1><p>是一种抽象的模型，被定义出来屏蔽各种硬件和操作系统的内存访问差异。</p><p>JMM定义了线程和主内存之间的抽象关系：线程之间的共享变量存储在主内存（Main Memory）中，每个线程都有一个私有的 本地内存 （Local Memory），本地内存中存储了该线程以读/写共享变量的副本。</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407152329444.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><h1 id="并发编程的本质就是解决三大问题-原子性、可见性、有序性。" tabindex="-1"><a class="header-anchor" href="#并发编程的本质就是解决三大问题-原子性、可见性、有序性。"><span>并发编程<strong>的本质就是解决三大问题:原子性、可见性、有序性</strong>。</span></a></h1><p>原子性、有序性、可见性是并发编程中非常重要的基础概念，用于描述多线程环境下的内存访问行为，它们是 Java 内存模型（Java Memory Model, JMM）的基础。</p><ol><li><p><strong>原子性（Atomicity）</strong>：</p><ol><li>原子性是指一个操作或者一系列操作要么全部执行并且在执行过程中不会被任何其他操作中断，要么就全部都不执行。</li><li>在多线程环境中，原子性确保了当多个线程尝试同时修改同一变量时，这些修改不会相互干扰。</li><li>Java 提供了一些原子类（如 <code>AtomicInteger</code>、<code>AtomicLong</code> 等），它们利用底层硬件的原子指令来保证操作的原子性。</li></ol></li><li><p><strong>可见性（Visibility）</strong>：</p><ol><li>可见性是指当一个线程修改了共享变量的值，其他线程能够立即看到这个修改。</li><li>在没有同步机制的情况下，一个线程对共享变量的修改可能对其他线程不可见，因为变量的值可能被缓存在寄存器或者线程私有内存中。</li><li>Java 通过 <code>volatile</code> 关键字、<code>synchronized</code> 块以及 <code>Lock</code> 机制来保证可见性。</li></ol></li><li><p><strong>有序性（Ordering）</strong>：</p><ol><li>有序性是指程序执行的顺序按照代码的先后顺序进行。</li><li>在多线程环境中，由于编译器优化、处理器乱序执行等原因，指令可能会以不同于编写代码时的顺序执行。</li><li>JMM 规定了 happens-before 关系，确保在并发环境中程序的执行结果与按序执行时的结果一致。</li><li>使用 <code>synchronized</code> 和 <code>volatile</code> 可以禁止某些重排序，保证操作的有序性。</li></ol></li></ol><p>JMM 定义了这些概念来规范多线程程序的内存一致性行为，确保在不同的线程、处理器和编译器优化下，程序的行为符合预期。理解并正确使用这些概念对于编写正确、高效的并发程序至关重要。</p><h1 id="volatile" tabindex="-1"><a class="header-anchor" href="#volatile"><span>volatile</span></a></h1><p>volatile关键字有两个作用，保证可见性和有序性，但是不保证原子性。</p><h2 id="含义" tabindex="-1"><a class="header-anchor" href="#含义"><span>含义</span></a></h2><p><code>volatile</code>关键字用来修饰变量，告诉JVM编译器和处理器，这个变量可能会被不同的线程同时访问和修改。这意味着，任何线程对<code>volatile</code>变量的修改，都将立即反映到主内存中，而且其他线程可以从主内存中读取最新的值。</p><h2 id="作用" tabindex="-1"><a class="header-anchor" href="#作用"><span>作用</span></a></h2><ol><li>保证可见性：<code>volatile</code>变量的写操作会强制将数据写入主内存，读操作会从主内存中读取数据。这样，一旦某个线程修改了<code>volatile</code>变量，其他线程可以立即看到这个变化。</li><li>禁止指令重排序：变量的写操作在执行时不能被编译器或处理器重排序到之前的任何时刻。这确保了在 <code>volatile</code> 变量写操作之前的所有操作都将在写操作之前完成，读操作也是如此。</li><li>尽管 <code>volatile</code> 保证了可见性和禁止指令重排序，但它并不保证复合操作的原子性。例如，递增操作 <code>i++</code>（即 <code>i = i + 1</code>）不是一个原子操作，即使 <code>i</code> 被声明为 <code>volatile</code>，也不能保证线程安全。</li></ol><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;">1public </span><span style="color:#81A1C1;">class</span><span style="color:#8FBCBB;"> VolatileCounter</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#B48EAD;">2</span><span style="color:#81A1C1;">    private</span><span style="color:#81A1C1;"> volatile</span><span style="color:#81A1C1;"> int</span><span style="color:#D8DEE9;"> count</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">34    public </span><span style="color:#81A1C1;">void</span><span style="color:#88C0D0;"> increment</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#B48EAD;">5</span><span style="color:#D8DEE9FF;">        count</span><span style="color:#81A1C1;">++;</span><span style="color:#616E88;"> // 这个操作在多线程环境下不是原子的</span></span>
<span class="line"><span style="color:#B48EAD;">6</span><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#B48EAD;">7</span><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="使用场景及原理" tabindex="-1"><a class="header-anchor" href="#使用场景及原理"><span>使用场景及原理</span></a></h2><ol><li><p><strong>使用场景</strong>：</p><ol><li><code>volatile</code> 适用于状态标记，例如，一个线程需要知道另一个线程是否已经初始化了某些资源或者是否正在执行特定的任务。</li></ol></li><li><p><strong>示例</strong>：</p><ol><li><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Example</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    private</span><span style="color:#81A1C1;"> volatile</span><span style="color:#81A1C1;"> boolean</span><span style="color:#D8DEE9;"> running</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> true;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> start</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">        while</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9FF;">running</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">            // 执行任务</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> stop</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        running </span><span style="color:#81A1C1;">=</span><span style="color:#81A1C1;"> false;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>在这个例子中，<code>running</code> 变量被声明为 <code>volatile</code>，以确保当调用 <code>stop()</code> 方法修改 <code>running</code> 为 <code>false</code> 时，<code>start()</code> 方法中的线程能够立即看到这个变化。</p></li></ol></li><li><p><strong>内存****屏障</strong>：</p><ol><li>在读取 <code>volatile</code> 变量时，JVM 会插入一个内存屏障来防止指令重排序，确保在该屏障之前的所有读/写操作在该屏障之后的所有读/写操作之前执行。</li></ol></li></ol><p><code>volatile</code> 是一种比 <code>synchronized</code> 更轻量级的同步机制，但它的使用场景有限，主要用于保证变量的可见性。在需要更复杂的同步操作时，通常需要使用其他同步机制，如 <code>synchronized</code> 或 <code>java.util.concurrent</code> 包中的并发工具。</p><h1 id="atomic包" tabindex="-1"><a class="header-anchor" href="#atomic包"><span>Atomic包</span></a></h1><p>原子操作。</p><h1 id="锁" tabindex="-1"><a class="header-anchor" href="#锁"><span>锁</span></a></h1><h2 id="synchronized" tabindex="-1"><a class="header-anchor" href="#synchronized"><span>Synchronized</span></a></h2><h3 id="monitor-被翻译为监视器或管程" tabindex="-1"><a class="header-anchor" href="#monitor-被翻译为监视器或管程"><span>Monitor 被翻译为监视器或管程</span></a></h3><p>每个 Java 对象都可以关联一个 Monitor 对象，如果使用 synchronized 给对象上锁（重量级）之后，该对象头的Mark Word 中就被设置指向 Monitor 对象的指针。</p><h3 id="关联流程" tabindex="-1"><a class="header-anchor" href="#关联流程"><span>关联流程</span></a></h3><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407152329589.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><ul><li>刚开始 Monitor 中 Owner 为 null</li><li>当 Thread-2 执行 synchronized(obj) 就会将 Monitor 的所有者 Owner 置为 Thread-2，Monitor中只能有一个 Owner</li><li>在 Thread-2 上锁的过程中，如果 Thread-3，Thread-4，Thread-5 也来执行 synchronized(obj)，就会进入EntryList BLOCKED</li><li>Thread-2 执行完同步代码块的内容，然后唤醒 EntryList 中等待的线程来竞争锁，竞争的时是非公平的</li><li>图中 WaitSet 中的 Thread-0，Thread-1 是之前获得过锁，但条件不满足进入 WAITING 状态的线程</li></ul><p>注意：</p><p>synchronized 必须是进入同一个对象的 monitor 才有上述的效果</p><p>不加 synchronized 的对象不会关联监视器，不遵从以上规则</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">static</span><span style="color:#81A1C1;"> final</span><span style="color:#8FBCBB;"> Object</span><span style="color:#D8DEE9;"> lock</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Object</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">static</span><span style="color:#81A1C1;"> int</span><span style="color:#D8DEE9;"> counter</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9FF;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;"> synchronized</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9FF;">lock</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9FF;"> counter</span><span style="color:#81A1C1;">++;</span></span>
<span class="line"><span style="color:#ECEFF4;">     }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    Code</span><span style="color:#81A1C1;">:</span></span>
<span class="line"><span style="color:#D8DEE9FF;">     stack</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">2</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> locals</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">3</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> args_size</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">1</span></span>
<span class="line"><span style="color:#B48EAD;">     0</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> getstatic #</span><span style="color:#B48EAD;">2</span><span style="color:#616E88;"> // &lt;- lock引用 （synchronized开始）</span></span>
<span class="line"><span style="color:#B48EAD;">     3</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> dup</span></span>
<span class="line"><span style="color:#B48EAD;">     4</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> astore_1 </span><span style="color:#616E88;">// lock引用 -&gt; slot 1</span></span>
<span class="line"><span style="color:#B48EAD;">     5</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> monitorenter </span><span style="color:#616E88;">// 将 lock对象 MarkWord 置为 Monitor 指针</span></span>
<span class="line"><span style="color:#B48EAD;">     6</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> getstatic #</span><span style="color:#B48EAD;">3</span><span style="color:#616E88;"> // &lt;- i</span></span>
<span class="line"><span style="color:#B48EAD;">     9</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> iconst_1 </span><span style="color:#616E88;">// 准备常数 1</span></span>
<span class="line"><span style="color:#B48EAD;">     10</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> iadd </span><span style="color:#616E88;">// +1</span></span>
<span class="line"><span style="color:#B48EAD;">     11</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> putstatic #</span><span style="color:#B48EAD;">3</span><span style="color:#616E88;"> // -&gt; i</span></span>
<span class="line"><span style="color:#B48EAD;">     14</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> aload_1 </span><span style="color:#616E88;">// &lt;- lock引用</span></span>
<span class="line"><span style="color:#B48EAD;">     15</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> monitorexit </span><span style="color:#616E88;">// 将 lock对象 MarkWord 重置, 唤醒 EntryList</span></span>
<span class="line"><span style="color:#B48EAD;">     16</span><span style="color:#81A1C1;">:</span><span style="color:#81A1C1;"> goto</span><span style="color:#B48EAD;"> 24</span></span>
<span class="line"><span style="color:#B48EAD;">     19</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> astore_2 </span><span style="color:#616E88;">// e -&gt; slot 2</span></span>
<span class="line"><span style="color:#B48EAD;">     20</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> aload_1 </span><span style="color:#616E88;">// &lt;- lock引用</span></span>
<span class="line"><span style="color:#B48EAD;">     21</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> monitorexit </span><span style="color:#616E88;">// 将 lock对象 MarkWord 重置, 唤醒 EntryList</span></span>
<span class="line"><span style="color:#B48EAD;">     22</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> aload_2 </span><span style="color:#616E88;">// &lt;- slot 2 (e)</span></span>
<span class="line"><span style="color:#B48EAD;">     23</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> athrow </span><span style="color:#616E88;">// throw e</span></span>
<span class="line"><span style="color:#B48EAD;">     24</span><span style="color:#81A1C1;">:</span><span style="color:#81A1C1;"> return</span></span>
<span class="line"><span style="color:#8FBCBB;">     Exception</span><span style="color:#D8DEE9;"> table</span><span style="color:#81A1C1;">:</span></span>
<span class="line"><span style="color:#D8DEE9FF;">     from to target type</span></span>
<span class="line"><span style="color:#B48EAD;">     6</span><span style="color:#B48EAD;"> 16</span><span style="color:#B48EAD;"> 19</span><span style="color:#D8DEE9FF;"> any</span></span>
<span class="line"><span style="color:#B48EAD;">     19</span><span style="color:#B48EAD;"> 22</span><span style="color:#B48EAD;"> 19</span><span style="color:#D8DEE9FF;"> any</span></span>
<span class="line"><span style="color:#D8DEE9FF;">     LineNumberTable</span><span style="color:#81A1C1;">:</span></span>
<span class="line"><span style="color:#D8DEE9FF;">     line </span><span style="color:#B48EAD;">8</span><span style="color:#81A1C1;">:</span><span style="color:#B48EAD;"> 0</span></span>
<span class="line"><span style="color:#D8DEE9FF;">     line </span><span style="color:#B48EAD;">9</span><span style="color:#81A1C1;">:</span><span style="color:#B48EAD;"> 6</span></span>
<span class="line"><span style="color:#D8DEE9FF;">     line </span><span style="color:#B48EAD;">10</span><span style="color:#81A1C1;">:</span><span style="color:#B48EAD;"> 14</span></span>
<span class="line"><span style="color:#D8DEE9FF;">     line </span><span style="color:#B48EAD;">11</span><span style="color:#81A1C1;">:</span><span style="color:#B48EAD;"> 24</span></span>
<span class="line"><span style="color:#D8DEE9FF;">     LocalVariableTable</span><span style="color:#81A1C1;">:</span></span>
<span class="line"><span style="color:#8FBCBB;">     Start</span><span style="color:#8FBCBB;"> Length</span><span style="color:#8FBCBB;"> Slot</span><span style="color:#8FBCBB;"> Name</span><span style="color:#8FBCBB;"> Signature</span></span>
<span class="line"><span style="color:#B48EAD;">     0</span><span style="color:#B48EAD;"> 25</span><span style="color:#B48EAD;"> 0</span><span style="color:#D8DEE9FF;"> args </span><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">Ljava</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">lang</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">String</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">     StackMapTable</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> number_of_entries </span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;"> 2</span></span>
<span class="line"><span style="color:#D8DEE9FF;">     frame_type </span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;"> 255</span><span style="color:#616E88;"> /* full_frame*/</span></span>
<span class="line"><span style="color:#D8DEE9FF;">     offset_delta </span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;"> 19</span></span>
<span class="line"><span style="color:#D8DEE9FF;">     locals </span><span style="color:#81A1C1;">=</span><span style="color:#ECEFF4;"> [</span><span style="color:#D8DEE9FF;"> class </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">[Ljava/lang/String;</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> java</span><span style="color:#D8DEE9FF;">/lang/Object ]</span></span>
<span class="line"><span style="color:#D8DEE9FF;">     stack = [ </span><span style="color:#81A1C1;">class</span><span style="color:#8FBCBB;"> java</span><span style="color:#D8DEE9FF;">/lang/Throwable ]</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    * frame_type = 250 </span><span style="color:#616E88;">/* chop */</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    offset_delta = 4</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>锁住的是对象实例或类对象</p><h3 id="对象头" tabindex="-1"><a class="header-anchor" href="#对象头"><span>对象头</span></a></h3><p>对象头由以下三部分组成：</p><blockquote><p>1，Mark Word</p><p>2，指向类的指针</p><p>3，数组长度（只有数组对象才有）</p></blockquote><h4 id="对象标记" tabindex="-1"><a class="header-anchor" href="#对象标记"><span><strong>对象标记</strong></span></a></h4><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407152329327.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407152329339.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><h4 id="指向类的指针" tabindex="-1"><a class="header-anchor" href="#指向类的指针"><span><strong>指向类的指针</strong></span></a></h4><p>该指针在32位JVM中的长度是32bit，在64位JVM中长度是64bit。</p><p>Java对象的类数据保存在方法区。</p><h4 id="数组长度" tabindex="-1"><a class="header-anchor" href="#数组长度"><span><strong>数组长度</strong></span></a></h4><p>只有数组对象保存了这部分数据。</p><p>该数据在32位和64位JVM中长度都是32bit。</p><h3 id="偏向锁" tabindex="-1"><a class="header-anchor" href="#偏向锁"><span>偏向锁</span></a></h3><p>轻量级锁在没有竞争时（就自己这个线程），每次重入仍然需要执行 CAS 操作。</p><p>Java 6 中引入了偏向锁来做进一步优化：只有第一次使用 CAS 将线程 ID 设置到对象的 Mark Word 头，之后检查</p><p>这个线程 ID 是自己的就表示没有竞争，不用重新 CAS。以后只要不发生竞争，这个对象就归该线程所有。</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">static</span><span style="color:#81A1C1;"> final</span><span style="color:#8FBCBB;"> Object</span><span style="color:#D8DEE9;"> obj</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Object</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> m1</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;"> synchronized</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;"> obj </span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;"> // 同步块 A</span></span>
<span class="line"><span style="color:#88C0D0;"> m2</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;"> }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> m2</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;"> synchronized</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;"> obj </span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;"> // 同步块 B</span></span>
<span class="line"><span style="color:#88C0D0;"> m3</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;"> }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> m3</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;"> synchronized</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;"> obj </span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;"> // 同步块 C</span></span>
<span class="line"><span style="color:#ECEFF4;"> }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="偏向状态" tabindex="-1"><a class="header-anchor" href="#偏向状态"><span>偏向状态</span></a></h4><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">|--------------------------------------------------------------------|--------------------|</span></span>
<span class="line"><span style="color:#81A1C1;">|</span><span style="color:#8FBCBB;">                         Mark</span><span style="color:#88C0D0;"> Word</span><span style="color:#ECEFF4;"> (</span><span style="color:#B48EAD;">64</span><span style="color:#D8DEE9FF;"> bits</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">                        |</span><span style="color:#D8DEE9FF;"> State              </span><span style="color:#81A1C1;">|</span></span>
<span class="line"><span style="color:#81A1C1;">|--------------------------------------------------------------------|--------------------|</span></span>
<span class="line"><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> unused</span><span style="color:#81A1C1;">:</span><span style="color:#B48EAD;">25</span><span style="color:#81A1C1;"> |</span><span style="color:#D8DEE9FF;"> hashcode</span><span style="color:#81A1C1;">:</span><span style="color:#B48EAD;">31</span><span style="color:#81A1C1;"> |</span><span style="color:#D8DEE9FF;"> unused</span><span style="color:#81A1C1;">:</span><span style="color:#B48EAD;">1</span><span style="color:#81A1C1;"> |</span><span style="color:#D8DEE9FF;"> age</span><span style="color:#81A1C1;">:</span><span style="color:#B48EAD;">4</span><span style="color:#81A1C1;"> |</span><span style="color:#D8DEE9FF;"> biased_lock</span><span style="color:#81A1C1;">:</span><span style="color:#B48EAD;">0</span><span style="color:#81A1C1;"> |</span><span style="color:#B48EAD;"> 01</span><span style="color:#81A1C1;">    |</span><span style="color:#D8DEE9FF;"> Normal             </span><span style="color:#81A1C1;">|</span></span>
<span class="line"><span style="color:#81A1C1;">|--------------------------------------------------------------------|--------------------|</span></span>
<span class="line"><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> thread</span><span style="color:#81A1C1;">:</span><span style="color:#B48EAD;">54</span><span style="color:#81A1C1;"> |</span><span style="color:#D8DEE9FF;"> epoch</span><span style="color:#81A1C1;">:</span><span style="color:#B48EAD;">2</span><span style="color:#81A1C1;">     |</span><span style="color:#D8DEE9FF;"> unused</span><span style="color:#81A1C1;">:</span><span style="color:#B48EAD;">1</span><span style="color:#81A1C1;"> |</span><span style="color:#D8DEE9FF;"> age</span><span style="color:#81A1C1;">:</span><span style="color:#B48EAD;">4</span><span style="color:#81A1C1;"> |</span><span style="color:#D8DEE9FF;"> biased_lock</span><span style="color:#81A1C1;">:</span><span style="color:#B48EAD;">1</span><span style="color:#81A1C1;"> |</span><span style="color:#B48EAD;"> 01</span><span style="color:#81A1C1;">    |</span><span style="color:#D8DEE9FF;"> Biased             </span><span style="color:#81A1C1;">|</span></span>
<span class="line"><span style="color:#81A1C1;">|--------------------------------------------------------------------|--------------------|</span></span>
<span class="line"><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> ptr_to_lock_record</span><span style="color:#81A1C1;">:</span><span style="color:#B48EAD;">62</span><span style="color:#81A1C1;">                                      |</span><span style="color:#B48EAD;"> 00</span><span style="color:#81A1C1;">    |</span><span style="color:#8FBCBB;"> Lightweight</span><span style="color:#D8DEE9FF;"> Locked </span><span style="color:#81A1C1;">|</span></span>
<span class="line"><span style="color:#81A1C1;">|--------------------------------------------------------------------|--------------------|</span></span>
<span class="line"><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> ptr_to_heavyweight_monitor</span><span style="color:#81A1C1;">:</span><span style="color:#B48EAD;">62</span><span style="color:#81A1C1;">                              |</span><span style="color:#B48EAD;"> 10</span><span style="color:#81A1C1;">    |</span><span style="color:#8FBCBB;"> Heavyweight</span><span style="color:#D8DEE9FF;"> Locked </span><span style="color:#81A1C1;">|</span></span>
<span class="line"><span style="color:#81A1C1;">|--------------------------------------------------------------------|--------------------|</span></span>
<span class="line"><span style="color:#81A1C1;">|</span><span style="color:#81A1C1;">                                                            |</span><span style="color:#B48EAD;"> 11</span><span style="color:#81A1C1;">    |</span><span style="color:#8FBCBB;"> Marked</span><span style="color:#81A1C1;"> for</span><span style="color:#D8DEE9FF;"> GC      </span><span style="color:#81A1C1;">|</span></span>
<span class="line"><span style="color:#81A1C1;">|--------------------------------------------------------------------|--------------------|</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="撤销-调用对象-hashcode" tabindex="-1"><a class="header-anchor" href="#撤销-调用对象-hashcode"><span>撤销 - 调用对象 hashCode</span></a></h4><p>调用了对象的 hashCode，但偏向锁的对象 MarkWord 中存储的是线程 id，如果调用 hashCode 会导致偏向锁被撤销</p><ul><li>轻量级锁会在锁记录中记录 hashCode</li><li>重量级锁会在 Monitor 中记录 hashCode</li></ul><p>在调用 hashCode 后使用偏向锁，记得去掉 -XX:-UseBiasedLocking</p><h4 id="撤销-其它线程使用对象" tabindex="-1"><a class="header-anchor" href="#撤销-其它线程使用对象"><span>撤销 - 其它线程使用对象</span></a></h4><p>当有其它线程使用偏向锁对象时，会将偏向锁升级为轻量级锁</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">private</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> test2</span><span style="color:#ECEFF4;">()</span><span style="color:#D8DEE9FF;"> throws InterruptedException </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#8FBCBB;"> Dog</span><span style="color:#D8DEE9;"> d</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Dog</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#8FBCBB;"> Thread</span><span style="color:#D8DEE9;"> t1</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Thread</span><span style="color:#ECEFF4;">(()</span><span style="color:#8FBCBB;"> -&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;"> synchronized</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9FF;">d</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;"> log</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">debug</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">ClassLayout</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">parseInstance</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">d</span><span style="color:#ECEFF4;">).</span><span style="color:#88C0D0;">toPrintableSimple</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">true</span><span style="color:#ECEFF4;">))</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;"> }</span></span>
<span class="line"><span style="color:#81A1C1;"> synchronized</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">TestBiased</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">class</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;"> TestBiased</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">class</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">notify</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;"> }</span></span>
<span class="line"><span style="color:#616E88;"> // 如果不用 wait/notify 使用 join 必须打开下面的注释</span></span>
<span class="line"><span style="color:#616E88;"> // 因为：t1 线程不能结束，否则底层线程可能被 jvm 重用作为 t2 线程，底层线程 id 是一样的</span></span>
<span class="line"><span style="color:#616E88;"> /*try {</span></span>
<span class="line"><span style="color:#616E88;"> System.in.read();</span></span>
<span class="line"><span style="color:#616E88;"> } catch (IOException e) {</span></span>
<span class="line"><span style="color:#616E88;"> e.printStackTrace();</span></span>
<span class="line"><span style="color:#616E88;"> }*/</span></span>
<span class="line"><span style="color:#ECEFF4;"> },</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">t1</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;"> t1</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">start</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#8FBCBB;"> Thread</span><span style="color:#D8DEE9;"> t2</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Thread</span><span style="color:#ECEFF4;">(()</span><span style="color:#8FBCBB;"> -&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;"> synchronized</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">TestBiased</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">class</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;"> try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;"> TestBiased</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">class</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">wait</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;"> }</span><span style="color:#81A1C1;"> catch</span><span style="color:#ECEFF4;"> (</span><span style="color:#8FBCBB;">InterruptedException</span><span style="color:#D8DEE9;"> e</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;"> e</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">printStackTrace</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;"> }</span></span>
<span class="line"><span style="color:#ECEFF4;"> }</span></span>
<span class="line"><span style="color:#D8DEE9;"> log</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">debug</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">ClassLayout</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">parseInstance</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">d</span><span style="color:#ECEFF4;">).</span><span style="color:#88C0D0;">toPrintableSimple</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">true</span><span style="color:#ECEFF4;">))</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;"> synchronized</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9FF;">d</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;"> log</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">debug</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">ClassLayout</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">parseInstance</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">d</span><span style="color:#ECEFF4;">).</span><span style="color:#88C0D0;">toPrintableSimple</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">true</span><span style="color:#ECEFF4;">))</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;"> }</span></span>
<span class="line"><span style="color:#D8DEE9;"> log</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">debug</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">ClassLayout</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">parseInstance</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">d</span><span style="color:#ECEFF4;">).</span><span style="color:#88C0D0;">toPrintableSimple</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">true</span><span style="color:#ECEFF4;">))</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;"> },</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">t2</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;"> t2</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">start</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>输出</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t1</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 01000001</span><span style="color:#B48EAD;"> 00010000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 01000001</span><span style="color:#B48EAD;"> 00010000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 10110101</span><span style="color:#B48EAD;"> 11110000</span><span style="color:#B48EAD;"> 01000000</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000001</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="撤销-调用-wait-notify" tabindex="-1"><a class="header-anchor" href="#撤销-调用-wait-notify"><span>撤销 - 调用 wait/notify</span></a></h4><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9FF;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> throws InterruptedException </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#8FBCBB;"> Dog</span><span style="color:#D8DEE9;"> d</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Dog</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#8FBCBB;"> Thread</span><span style="color:#D8DEE9;"> t1</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Thread</span><span style="color:#ECEFF4;">(()</span><span style="color:#8FBCBB;"> -&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;"> log</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">debug</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">ClassLayout</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">parseInstance</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">d</span><span style="color:#ECEFF4;">).</span><span style="color:#88C0D0;">toPrintableSimple</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">true</span><span style="color:#ECEFF4;">))</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;"> synchronized</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9FF;">d</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;"> log</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">debug</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">ClassLayout</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">parseInstance</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">d</span><span style="color:#ECEFF4;">).</span><span style="color:#88C0D0;">toPrintableSimple</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">true</span><span style="color:#ECEFF4;">))</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;"> try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;"> d</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">wait</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;"> }</span><span style="color:#81A1C1;"> catch</span><span style="color:#ECEFF4;"> (</span><span style="color:#8FBCBB;">InterruptedException</span><span style="color:#D8DEE9;"> e</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;"> e</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">printStackTrace</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;"> }</span></span>
<span class="line"><span style="color:#D8DEE9;"> log</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">debug</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">ClassLayout</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">parseInstance</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">d</span><span style="color:#ECEFF4;">).</span><span style="color:#88C0D0;">toPrintableSimple</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">true</span><span style="color:#ECEFF4;">))</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;"> }</span></span>
<span class="line"><span style="color:#ECEFF4;"> },</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">t1</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;"> t1</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">start</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Thread</span><span style="color:#ECEFF4;">(()</span><span style="color:#8FBCBB;"> -&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;"> try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;"> Thread</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">sleep</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">6000</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;"> }</span><span style="color:#81A1C1;"> catch</span><span style="color:#ECEFF4;"> (</span><span style="color:#8FBCBB;">InterruptedException</span><span style="color:#D8DEE9;"> e</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;"> e</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">printStackTrace</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;"> }</span></span>
<span class="line"><span style="color:#81A1C1;"> synchronized</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9FF;">d</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;"> log</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">debug</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">notify</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;"> d</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">notify</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;"> }</span></span>
<span class="line"><span style="color:#ECEFF4;"> },</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">t2</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">).</span><span style="color:#88C0D0;">start</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>输出</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t1</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t1</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 10110011</span><span style="color:#B48EAD;"> 11111000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#D8DEE9FF;"> notify </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t1</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011100</span><span style="color:#B48EAD;"> 11010100</span><span style="color:#B48EAD;"> 00001101</span><span style="color:#B48EAD;"> 11001010</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="批量重偏向" tabindex="-1"><a class="header-anchor" href="#批量重偏向"><span>批量重偏向</span></a></h4><p>如果对象虽然被多个线程访问，但没有竞争，这时偏向了线程 T1 的对象仍有机会重新偏向 T2，重偏向会重置对象</p><p>的 Thread ID</p><p>当撤销偏向锁阈值超过 20 次后，jvm 会这样觉得，我是不是偏向错了呢，于是会在给这些对象加锁时重新偏向至</p><p>加锁线程</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">private</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> test3</span><span style="color:#ECEFF4;">()</span><span style="color:#D8DEE9FF;"> throws InterruptedException </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#8FBCBB;"> Vector</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">Dog</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9;"> list</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#8FBCBB;"> Vector</span><span style="color:#ECEFF4;">&lt;&gt;()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#8FBCBB;"> Thread</span><span style="color:#D8DEE9;"> t1</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Thread</span><span style="color:#ECEFF4;">(()</span><span style="color:#8FBCBB;"> -&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;"> for</span><span style="color:#ECEFF4;"> (</span><span style="color:#81A1C1;">int</span><span style="color:#D8DEE9;"> i</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> i </span><span style="color:#81A1C1;">&lt;</span><span style="color:#B48EAD;"> 30</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> i</span><span style="color:#81A1C1;">++</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;"> Dog</span><span style="color:#D8DEE9;"> d</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Dog</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;"> list</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">add</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">d</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;"> synchronized</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9FF;">d</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;"> log</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">debug</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">i </span><span style="color:#81A1C1;">+</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#EBCB8B;">\t</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;"> +</span><span style="color:#D8DEE9;"> ClassLayout</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">parseInstance</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">d</span><span style="color:#ECEFF4;">).</span><span style="color:#88C0D0;">toPrintableSimple</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">true</span><span style="color:#ECEFF4;">))</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;"> }</span></span>
<span class="line"><span style="color:#ECEFF4;"> }</span></span>
<span class="line"><span style="color:#81A1C1;"> synchronized</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9FF;">list</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;"> list</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">notify</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;"> },</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">t1</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;"> t1</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">start</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#8FBCBB;"> Thread</span><span style="color:#D8DEE9;"> t2</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Thread</span><span style="color:#ECEFF4;">(()</span><span style="color:#8FBCBB;"> -&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;"> synchronized</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9FF;">list</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;"> try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;"> list</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">wait</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;"> }</span><span style="color:#81A1C1;"> catch</span><span style="color:#ECEFF4;"> (</span><span style="color:#8FBCBB;">InterruptedException</span><span style="color:#D8DEE9;"> e</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;"> e</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">printStackTrace</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;"> }</span></span>
<span class="line"><span style="color:#ECEFF4;"> }</span></span>
<span class="line"><span style="color:#D8DEE9;"> log</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">debug</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">===============&gt; </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;"> for</span><span style="color:#ECEFF4;"> (</span><span style="color:#81A1C1;">int</span><span style="color:#D8DEE9;"> i</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> i </span><span style="color:#81A1C1;">&lt;</span><span style="color:#B48EAD;"> 30</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> i</span><span style="color:#81A1C1;">++</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;"> Dog</span><span style="color:#D8DEE9;"> d</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> list</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">get</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">i</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;"> log</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">debug</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">i </span><span style="color:#81A1C1;">+</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#EBCB8B;">\t</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;"> +</span><span style="color:#D8DEE9;"> ClassLayout</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">parseInstance</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">d</span><span style="color:#ECEFF4;">).</span><span style="color:#88C0D0;">toPrintableSimple</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">true</span><span style="color:#ECEFF4;">))</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;"> synchronized</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9FF;">d</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;"> log</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">debug</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">i </span><span style="color:#81A1C1;">+</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#EBCB8B;">\t</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;"> +</span><span style="color:#D8DEE9;"> ClassLayout</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">parseInstance</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">d</span><span style="color:#ECEFF4;">).</span><span style="color:#88C0D0;">toPrintableSimple</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">true</span><span style="color:#ECEFF4;">))</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;"> }</span></span>
<span class="line"><span style="color:#D8DEE9;"> log</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">debug</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">i </span><span style="color:#81A1C1;">+</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#EBCB8B;">\t</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;"> +</span><span style="color:#D8DEE9;"> ClassLayout</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">parseInstance</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">d</span><span style="color:#ECEFF4;">).</span><span style="color:#88C0D0;">toPrintableSimple</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">true</span><span style="color:#ECEFF4;">))</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;"> }</span></span>
<span class="line"><span style="color:#ECEFF4;"> },</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">t2</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;"> t2</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">start</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>输出</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t1</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 0</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t1</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 1</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t1</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 2</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t1</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 3</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t1</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 4</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t1</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 5</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t1</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 6</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t1</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 7</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t1</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 8</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t1</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 9</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t1</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 10</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t1</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 11</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t1</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 12</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t1</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 13</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t1</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 14</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t1</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 15</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t1</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 16</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t1</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 17</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t1</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 18</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t1</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 19</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t1</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 20</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t1</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 21</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t1</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 22</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t1</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 23</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t1</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 24</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t1</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 25</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t1</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 26</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t1</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 27</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t1</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 28</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t1</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 29</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#81A1C1;"> ===============&gt;</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 0</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 0</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00100000</span><span style="color:#B48EAD;"> 01011000</span><span style="color:#B48EAD;"> 11110111</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 0</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000001</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 1</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 1</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00100000</span><span style="color:#B48EAD;"> 01011000</span><span style="color:#B48EAD;"> 11110111</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 1</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000001</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 2</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 2</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00100000</span><span style="color:#B48EAD;"> 01011000</span><span style="color:#B48EAD;"> 11110111</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 2</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000001</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 3</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 3</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00100000</span><span style="color:#B48EAD;"> 01011000</span><span style="color:#B48EAD;"> 11110111</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 3</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000001</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 4</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 4</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00100000</span><span style="color:#B48EAD;"> 01011000</span><span style="color:#B48EAD;"> 11110111</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 4</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000001</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 5</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 5</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00100000</span><span style="color:#B48EAD;"> 01011000</span><span style="color:#B48EAD;"> 11110111</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 5</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000001</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 6</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 6</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00100000</span><span style="color:#B48EAD;"> 01011000</span><span style="color:#B48EAD;"> 11110111</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 6</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000001</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 7</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 7</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00100000</span><span style="color:#B48EAD;"> 01011000</span><span style="color:#B48EAD;"> 11110111</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 7</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000001</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 8</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 8</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00100000</span><span style="color:#B48EAD;"> 01011000</span><span style="color:#B48EAD;"> 11110111</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 8</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000001</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 9</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 9</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00100000</span><span style="color:#B48EAD;"> 01011000</span><span style="color:#B48EAD;"> 11110111</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 9</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000001</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 10</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 10</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00100000</span><span style="color:#B48EAD;"> 01011000</span><span style="color:#B48EAD;"> 11110111</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 10</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000001</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 11</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 11</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00100000</span><span style="color:#B48EAD;"> 01011000</span><span style="color:#B48EAD;"> 11110111</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 11</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000001</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 12</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 12</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00100000</span><span style="color:#B48EAD;"> 01011000</span><span style="color:#B48EAD;"> 11110111</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 12</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000001</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 13</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 13</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00100000</span><span style="color:#B48EAD;"> 01011000</span><span style="color:#B48EAD;"> 11110111</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 13</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000001</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 14</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 14</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00100000</span><span style="color:#B48EAD;"> 01011000</span><span style="color:#B48EAD;"> 11110111</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 14</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000001</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 15</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 15</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00100000</span><span style="color:#B48EAD;"> 01011000</span><span style="color:#B48EAD;"> 11110111</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 15</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000001</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 16</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 16</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00100000</span><span style="color:#B48EAD;"> 01011000</span><span style="color:#B48EAD;"> 11110111</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 16</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000001</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 17</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 17</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00100000</span><span style="color:#B48EAD;"> 01011000</span><span style="color:#B48EAD;"> 11110111</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 17</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000001</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 18</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 18</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00100000</span><span style="color:#B48EAD;"> 01011000</span><span style="color:#B48EAD;"> 11110111</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 18</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000001</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 19</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 19</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11110001</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 19</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11110001</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 20</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 20</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11110001</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 20</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11110001</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 21</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 21</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11110001</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 21</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11110001</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 22</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 22</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11110001</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 22</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11110001</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 23</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 23</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11110001</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 23</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11110001</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 24</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 24</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11110001</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 24</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11110001</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 25</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 25</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11110001</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 25</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11110001</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 26</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 26</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11110001</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 26</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11110001</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 27</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 27</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11110001</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 27</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11110001</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 28</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 28</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11110001</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 28</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11110001</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 29</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11100000</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 29</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11110001</span><span style="color:#B48EAD;"> 00000101</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;"> 29</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00000000</span><span style="color:#B48EAD;"> 00011111</span><span style="color:#B48EAD;"> 11110011</span><span style="color:#B48EAD;"> 11110001</span><span style="color:#B48EAD;"> 00000101</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="批量撤销" tabindex="-1"><a class="header-anchor" href="#批量撤销"><span>批量撤销</span></a></h4><p>当撤销偏向锁阈值超过 40 次后，jvm 会这样觉得，自己确实偏向错了，根本就不该偏向。于是整个类的所有对象</p><p>都会变为不可偏向的，新建的对象也是不可偏向的</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">static</span><span style="color:#8FBCBB;"> Thread</span><span style="color:#D8DEE9;"> t1</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;">t2</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;">t3</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">private</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> test4</span><span style="color:#ECEFF4;">()</span><span style="color:#D8DEE9FF;"> throws InterruptedException </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#8FBCBB;"> Vector</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">Dog</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9;"> list</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#8FBCBB;"> Vector</span><span style="color:#ECEFF4;">&lt;&gt;()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;"> int</span><span style="color:#D8DEE9;"> loopNumber</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 39</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;"> t1 </span><span style="color:#81A1C1;">=</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Thread</span><span style="color:#ECEFF4;">(()</span><span style="color:#8FBCBB;"> -&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;"> for</span><span style="color:#ECEFF4;"> (</span><span style="color:#81A1C1;">int</span><span style="color:#D8DEE9;"> i</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> i </span><span style="color:#81A1C1;">&lt;</span><span style="color:#D8DEE9FF;"> loopNumber</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> i</span><span style="color:#81A1C1;">++</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;"> Dog</span><span style="color:#D8DEE9;"> d</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Dog</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;"> list</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">add</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">d</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;"> synchronized</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9FF;">d</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;"> log</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">debug</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">i </span><span style="color:#81A1C1;">+</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#EBCB8B;">\t</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;"> +</span><span style="color:#D8DEE9;"> ClassLayout</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">parseInstance</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">d</span><span style="color:#ECEFF4;">).</span><span style="color:#88C0D0;">toPrintableSimple</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">true</span><span style="color:#ECEFF4;">))</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;"> }</span></span>
<span class="line"><span style="color:#ECEFF4;"> }</span></span>
<span class="line"><span style="color:#D8DEE9;"> LockSupport</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">unpark</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">t2</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;"> },</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">t1</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;"> t1</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">start</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;"> t2 </span><span style="color:#81A1C1;">=</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Thread</span><span style="color:#ECEFF4;">(()</span><span style="color:#8FBCBB;"> -&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;"> LockSupport</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">park</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;"> log</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">debug</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">===============&gt; </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;"> for</span><span style="color:#ECEFF4;"> (</span><span style="color:#81A1C1;">int</span><span style="color:#D8DEE9;"> i</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> i </span><span style="color:#81A1C1;">&lt;</span><span style="color:#D8DEE9FF;"> loopNumber</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> i</span><span style="color:#81A1C1;">++</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;"> Dog</span><span style="color:#D8DEE9;"> d</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> list</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">get</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">i</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;"> log</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">debug</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">i </span><span style="color:#81A1C1;">+</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#EBCB8B;">\t</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;"> +</span><span style="color:#D8DEE9;"> ClassLayout</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">parseInstance</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">d</span><span style="color:#ECEFF4;">).</span><span style="color:#88C0D0;">toPrintableSimple</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">true</span><span style="color:#ECEFF4;">))</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;"> synchronized</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9FF;">d</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;"> log</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">debug</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">i </span><span style="color:#81A1C1;">+</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#EBCB8B;">\t</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;"> +</span><span style="color:#D8DEE9;"> ClassLayout</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">parseInstance</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">d</span><span style="color:#ECEFF4;">).</span><span style="color:#88C0D0;">toPrintableSimple</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">true</span><span style="color:#ECEFF4;">))</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;"> }</span></span>
<span class="line"><span style="color:#D8DEE9;"> log</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">debug</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">i </span><span style="color:#81A1C1;">+</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#EBCB8B;">\t</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;"> +</span><span style="color:#D8DEE9;"> ClassLayout</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">parseInstance</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">d</span><span style="color:#ECEFF4;">).</span><span style="color:#88C0D0;">toPrintableSimple</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">true</span><span style="color:#ECEFF4;">))</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;"> }</span></span>
<span class="line"><span style="color:#D8DEE9;"> LockSupport</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">unpark</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">t3</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;"> },</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">t2</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;"> t2</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">start</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;"> t3 </span><span style="color:#81A1C1;">=</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Thread</span><span style="color:#ECEFF4;">(()</span><span style="color:#8FBCBB;"> -&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;"> LockSupport</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">park</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;"> log</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">debug</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">===============&gt; </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;"> for</span><span style="color:#ECEFF4;"> (</span><span style="color:#81A1C1;">int</span><span style="color:#D8DEE9;"> i</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> i </span><span style="color:#81A1C1;">&lt;</span><span style="color:#D8DEE9FF;"> loopNumber</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> i</span><span style="color:#81A1C1;">++</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;"> Dog</span><span style="color:#D8DEE9;"> d</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> list</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">get</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">i</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;"> log</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">debug</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">i </span><span style="color:#81A1C1;">+</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#EBCB8B;">\t</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;"> +</span><span style="color:#D8DEE9;"> ClassLayout</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">parseInstance</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">d</span><span style="color:#ECEFF4;">).</span><span style="color:#88C0D0;">toPrintableSimple</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">true</span><span style="color:#ECEFF4;">))</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;"> synchronized</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9FF;">d</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;"> log</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">debug</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">i </span><span style="color:#81A1C1;">+</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#EBCB8B;">\t</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;"> +</span><span style="color:#D8DEE9;"> ClassLayout</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">parseInstance</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">d</span><span style="color:#ECEFF4;">).</span><span style="color:#88C0D0;">toPrintableSimple</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">true</span><span style="color:#ECEFF4;">))</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;"> }</span></span>
<span class="line"><span style="color:#D8DEE9;"> log</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">debug</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">i </span><span style="color:#81A1C1;">+</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#EBCB8B;">\t</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;"> +</span><span style="color:#D8DEE9;"> ClassLayout</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">parseInstance</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">d</span><span style="color:#ECEFF4;">).</span><span style="color:#88C0D0;">toPrintableSimple</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">true</span><span style="color:#ECEFF4;">))</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;"> }</span></span>
<span class="line"><span style="color:#ECEFF4;"> },</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">t3</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;"> t3</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">start</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;"> t3</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">join</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;"> log</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">debug</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">ClassLayout</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">parseInstance</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">new</span><span style="color:#88C0D0;"> Dog</span><span style="color:#ECEFF4;">()).</span><span style="color:#88C0D0;">toPrintableSimple</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">true</span><span style="color:#ECEFF4;">))</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="轻量级锁" tabindex="-1"><a class="header-anchor" href="#轻量级锁"><span>轻量级锁</span></a></h3><p>轻量级锁的使用场景：如果一个对象虽然有多线程要加锁，但加锁的时间是错开的（也就是没有竞争），那么可以使用轻量级锁来优化。</p><p>轻量级锁对使用者是透明的，即语法仍然是 synchronized。</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407152329318.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><ul><li>创建锁记录（Lock Record）对象，每个线程都的栈帧都会包含一个锁记录的结构，内部可以存储锁定对象的Mark Word</li><li>让锁记录中 Object reference 指向锁对象，并尝试用 cas 替换 Object 的 Mark Word，将 Mark Word 的值存入锁记录</li><li>如果 cas 替换成功，对象头中存储了 锁记录地址和状态 00 ，表示由该线程给对象加锁</li><li>如果 cas 失败，有两种情况 <ul><li>如果是其它线程已经持有了该 Object 的轻量级锁，这时表明有竞争，进入锁膨胀过程</li><li>如果是自己执行了 synchronized 锁重入，那么再添加一条 Lock Record 作为重入的计数</li></ul></li></ul><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407152329419.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><ul><li>当退出 synchronized 代码块（解锁时）如果有取值为 null 的锁记录，表示有重入，这时重置锁记录，表示重入计数减一</li></ul><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407152329587.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><ul><li>当退出 synchronized 代码块（解锁时）锁记录的值不为 null，这时使用 cas 将 Mark Word 的值恢复给对象头 <ul><li>成功，则解锁成功</li><li>失败，说明轻量级锁进行了锁膨胀或已经升级为重量级锁，进入重量级锁解锁流程</li></ul></li></ul><h3 id="锁膨胀" tabindex="-1"><a class="header-anchor" href="#锁膨胀"><span>锁膨胀</span></a></h3><p>如果在尝试加轻量级锁的过程中，CAS 操作无法成功，这时一种情况就是有其它线程为此对象加上了轻量级锁（有竞争），这时需要进行锁膨胀，将轻量级锁变为重量级锁。</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">static</span><span style="color:#8FBCBB;"> Object</span><span style="color:#D8DEE9;"> obj</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Object</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> method1</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;"> synchronized</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;"> obj </span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;"> // 同步块</span></span>
<span class="line"><span style="color:#ECEFF4;">     }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>当 Thread-1 进行轻量级加锁时，Thread-0 已经对该对象加了轻量级锁</li></ul><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407152329795.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><ul><li>这时 Thread-1 加轻量级锁CAS失败，进入锁膨胀流程 <ul><li>即为 Object 对象申请 Monitor 锁，让 Object 指向重量级锁地址</li><li>然后自己进入 Monitor 的 EntryList BLOCKED</li><li><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407152329812.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></li></ul></li><li>当 Thread-0 退出同步块解锁时，使用 cas 将 Mark Word 的值恢复给对象头，失败。这时会进入重量级解锁流程，即按照 Monitor 地址找到 Monitor 对象，设置 Owner 为 null，唤醒 EntryList 中 BLOCKED 线程</li></ul><h3 id="锁消除" tabindex="-1"><a class="header-anchor" href="#锁消除"><span>锁消除</span></a></h3><p>锁消除是指JVM在编译过程中通过静态分析技术检测到一些不可能存在竞争条件的锁，从而将其消除的优化过程。当JVM确定某个锁对象不会发生竞争时，就可以安全地消除对该锁的获取和释放操作，从而减少了锁操作的开销。</p><p>来分析如下代码：</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#8FBCBB;">StringBuffer</span><span style="color:#D8DEE9;"> sBuffer</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> StringBuffer</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">sBuffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">append</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">a</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">sBuffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">append</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">b</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">sBuffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">append</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">c</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">sBuffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">append</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">d</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>此时由于<code>StringBuffer</code>对象是线程安全的，但是在单线程运行环境下，这些加锁解锁操作完全没有必要，因此编译器就会帮我们省去这些锁</p><p>注意：synchronized消除锁的策略是比较保守的，明显不会发生线程安全问题的代码才会消除锁，例如：</p><ul><li>变量只涉及局部变量，没有全局变量</li><li>多个线程只对变量做读取操作，不涉及修改操作</li></ul><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">@</span><span style="color:#D08770;">Fork</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">1</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"><span style="color:#ECEFF4;">@</span><span style="color:#D08770;">BenchmarkMode</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">Mode</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">AverageTime</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"><span style="color:#ECEFF4;">@</span><span style="color:#D08770;">Warmup</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">iterations</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">3</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"><span style="color:#ECEFF4;">@</span><span style="color:#D08770;">Measurement</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">iterations</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">5</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"><span style="color:#ECEFF4;">@</span><span style="color:#D08770;">OutputTimeUnit</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">TimeUnit</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">NANOSECONDS</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> MyBenchmark</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> int</span><span style="color:#D8DEE9;"> x</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;"> @</span><span style="color:#D08770;">Benchmark</span></span>
<span class="line"><span style="color:#81A1C1;"> public</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> a</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> throws</span><span style="color:#8FBCBB;"> Exception</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9FF;"> x</span><span style="color:#81A1C1;">++;</span></span>
<span class="line"><span style="color:#ECEFF4;"> }</span></span>
<span class="line"><span style="color:#ECEFF4;"> @</span><span style="color:#D08770;">Benchmark</span></span>
<span class="line"><span style="color:#81A1C1;"> public</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> b</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> throws</span><span style="color:#8FBCBB;"> Exception</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;"> Object</span><span style="color:#D8DEE9;"> o</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Object</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;"> synchronized</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9FF;">o</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9FF;"> x</span><span style="color:#81A1C1;">++;</span></span>
<span class="line"><span style="color:#ECEFF4;">         }</span></span>
<span class="line"><span style="color:#ECEFF4;">     }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>java -jar benchmarks.jar</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#8FBCBB;">Benchmark</span><span style="color:#8FBCBB;"> Mode</span><span style="color:#8FBCBB;"> Samples</span><span style="color:#8FBCBB;"> Score</span><span style="color:#8FBCBB;"> Score</span><span style="color:#D8DEE9FF;"> error </span><span style="color:#8FBCBB;">Units</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#D8DEE9;">c</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">i</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">MyBenchmark</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">a</span><span style="color:#D8DEE9FF;"> avgt </span><span style="color:#B48EAD;">5</span><span style="color:#B48EAD;"> 1.542</span><span style="color:#B48EAD;"> 0.056</span><span style="color:#D8DEE9FF;"> ns</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">op </span></span>
<span class="line"><span style="color:#D8DEE9;">c</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">i</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">MyBenchmark</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">b</span><span style="color:#D8DEE9FF;"> avgt </span><span style="color:#B48EAD;">5</span><span style="color:#B48EAD;"> 1.518</span><span style="color:#B48EAD;"> 0.091</span><span style="color:#D8DEE9FF;"> ns</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">op</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>java -XX:-EliminateLocks -jar benchmarks.jar</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#8FBCBB;">Benchmark</span><span style="color:#8FBCBB;"> Mode</span><span style="color:#8FBCBB;"> Samples</span><span style="color:#8FBCBB;"> Score</span><span style="color:#8FBCBB;"> Score</span><span style="color:#D8DEE9FF;"> error </span><span style="color:#8FBCBB;">Units</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#D8DEE9;">c</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">i</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">MyBenchmark</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">a</span><span style="color:#D8DEE9FF;"> avgt </span><span style="color:#B48EAD;">5</span><span style="color:#B48EAD;"> 1.507</span><span style="color:#B48EAD;"> 0.108</span><span style="color:#D8DEE9FF;"> ns</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">op </span></span>
<span class="line"><span style="color:#D8DEE9;">c</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">i</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">MyBenchmark</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">b</span><span style="color:#D8DEE9FF;"> avgt </span><span style="color:#B48EAD;">5</span><span style="color:#B48EAD;"> 16.976</span><span style="color:#B48EAD;"> 1.572</span><span style="color:#D8DEE9FF;"> ns</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">op</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="锁粗化" tabindex="-1"><a class="header-anchor" href="#锁粗化"><span>锁粗化</span></a></h4><p>对相同对象多次加锁，导致线程发生多次重入，可以使用锁粗化方式来优化，这不同于之前讲的细分锁的粒度。</p><p>如果在同一段代码逻辑中，多次频繁的加锁解锁操作，编译器和JVM会帮助我们将其合并为一次加锁解锁操作。</p><h3 id="synchronized-的四种锁状态" tabindex="-1"><a class="header-anchor" href="#synchronized-的四种锁状态"><span>Synchronized 的四种锁状态</span></a></h3><p>无锁：</p><p>偏向锁：偏向某个线程使用，如果有其他线程尝试获取偏向锁，则会撤销偏向模式，升级为轻量级锁。</p><p>轻量级锁：多个线程交替使用，轻量级锁使用CAS（Compare And Swap）操作来尝试获取锁。如果CAS操作成功，线程就获得了锁；如果失败，证明有多个线程同时使用，即发生竞争，达到次数升级重量级锁</p><p>重量级锁：重量级锁是 <code>synchronized</code> 的最终状态，当锁处于这个状态时，所有等待获取锁的线程都会被挂起，直到锁被释放。</p><h2 id="reentrantlock" tabindex="-1"><a class="header-anchor" href="#reentrantlock"><span>ReentrantLock</span></a></h2><p>是类，基于AQS实现，具有原子性，有序性，可见性，可重入性。</p><p>公平锁</p><p>非公平锁</p><h2 id="synchronized和reentrantlock对比" tabindex="-1"><a class="header-anchor" href="#synchronized和reentrantlock对比"><span>Synchronized和ReentrantLock对比</span></a></h2><h2 id="reentrantreadwritelock" tabindex="-1"><a class="header-anchor" href="#reentrantreadwritelock"><span>ReentrantReadWriteLock</span></a></h2><h2 id="cas-aba问题-自旋问题-单个变量操作" tabindex="-1"><a class="header-anchor" href="#cas-aba问题-自旋问题-单个变量操作"><span>CAS：ABA问题，自旋问题，单个变量操作</span></a></h2><p>CAS（Compare And Swap）是一种原子操作，用于实现多线程环境下的同步操作。CAS 操作包含三个操作数：内存位置（V）、旧的预期值（A）和新值（B）。当且仅当预期值 A 和内存位置 V 的值相同时，CAS 会将内存位置 V 的值更新为新值B。</p><h2 id="aqs" tabindex="-1"><a class="header-anchor" href="#aqs"><span>AQS</span></a></h2><p>AbstractQueuedSynchronizer（AQS）是Java中用于实现锁和同步器的基础框架。它提供了一种队列同步器的实现方式，可以用于构建各种同步器，如ReentrantLock、Semaphore、CountDownLatch等。AQS的核心思想是使用一个FIFO的等待队列来管理线程的获取和释放锁的顺序，同时使用一个volatile变量来表示锁的状态。AQS的实现方式是通过继承来扩展，子类需要实现tryAcquire和tryRelease等方法来控制锁的获取和释放。AQS是Java并发编程中的重要概念，也是Java并发包中的核心组件之一。</p><h1 id="并发集合-容器" tabindex="-1"><a class="header-anchor" href="#并发集合-容器"><span>并发集合(容器)</span></a></h1><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407152331977.png" alt="image-20240715233123923" tabindex="0" loading="lazy"><figcaption>image-20240715233123923</figcaption></figure><h1 id="线程池-七大参数、拒绝策略" tabindex="-1"><a class="header-anchor" href="#线程池-七大参数、拒绝策略"><span>线程池：七大参数、拒绝策略</span></a></h1><ul><li>Executor：执行线程的顶级接口。</li><li>Executors：工厂类，用于创建不同类型的线程池。</li><li>ExecutorService：管理任务提交和线程池的接口。</li><li>ThreadPoolExecutor：可扩展的线程池类。</li><li>ScheduledExecutorService：用于定时任务的线程池接口。</li></ul><h1 id="同步工具" tabindex="-1"><a class="header-anchor" href="#同步工具"><span>同步工具</span></a></h1><h2 id="semaphore" tabindex="-1"><a class="header-anchor" href="#semaphore"><span>Semaphore</span></a></h2><p>在Java中，<code>Semaphore</code>是一个同步辅助类，它提供了一种更为复杂的方式来控制同时访问某些资源的线程数量。<code>Semaphore</code>本质上是一个计数信号量，用来限制对某些资源的并发访问。</p><h3 id="semaphore-原理" tabindex="-1"><a class="header-anchor" href="#semaphore-原理"><span>Semaphore 原理</span></a></h3><p>Semaphore 有点像一个停车场，permits 就好像停车位数量，当线程获得了 permits 就像是获得了停车位，然后</p><p>停车场显示空余车位减一</p><p>刚开始，permits（state）为 3，这时 5 个线程来获取资源</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407152329919.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>假设其中 Thread-1，Thread-2，Thread-4 cas 竞争成功，而 Thread-0 和 Thread-3 竞争失败，进入 AQS 队列</p><p>park 阻塞</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407152329433.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>这时 Thread-4 释放了 permits，状态如下</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407152329798.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>接下来 Thread-0 竞争成功，permits 再次设置为 0，设置自己为 head 节点，断开原来的 head 节点，unpark 接</p><p>下来的 Thread-3 节点，但由于 permits 是 0，因此 Thread-3 在尝试不成功后再次进入 park 状态</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407152329817.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><h3 id="semaphore的主要特点包括" tabindex="-1"><a class="header-anchor" href="#semaphore的主要特点包括"><span><code>Semaphore</code>的主要特点包括</span></a></h3><ol><li><strong>计数器</strong>：<code>Semaphore</code>内部有一个计数器，表示同时允许访问资源的线程数量。</li><li><strong>获取（Acquire）</strong>：线程调用<code>Semaphore</code>的<code>acquire()</code>方法来获取一个许可。如果计数器大于0，计数器减1，线程成功获取许可；如果计数器为0，则线程会被阻塞，直到其他线程释放许可。</li><li><strong>释放（Release）</strong>：线程完成资源使用后，调用<code>release()</code>方法来释放一个许可，此时计数器加1，可能会唤醒等待的线程。</li><li><strong>公平性（Fairness）</strong>：可以创建一个公平的<code>Semaphore</code>，它按照线程请求资源的顺序来分配许可，而非公平的<code>Semaphore</code>则可能允许线程饥饿。</li><li><strong>尝试获取（Try Acquire）</strong>：<code>Semaphore</code>提供了<code>tryAcquire()</code>方法，允许线程尝试获取许可而不被阻塞。如果获取成功，返回<code>true</code>；如果失败（即没有可用的许可），则返回<code>false</code>。 1.</li></ol><h3 id="使用semaphore的一个简单例子" tabindex="-1"><a class="header-anchor" href="#使用semaphore的一个简单例子"><span>使用<code>Semaphore</code>的一个简单例子：</span></a></h3><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// 创建一个计数为1的Semaphore，表示一次只允许一个线程访问资源</span></span>
<span class="line"><span style="color:#8FBCBB;">Semaphore</span><span style="color:#D8DEE9;"> semaphore</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Semaphore</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">1</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// 线程尝试获取许可</span></span>
<span class="line"><span style="color:#D8DEE9;">semaphore</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">acquire</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// 线程使用资源</span></span>
<span class="line"><span style="color:#616E88;">// ...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// 线程使用完资源后释放许可</span></span>
<span class="line"><span style="color:#D8DEE9;">semaphore</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">release</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>Semaphore</code>可以用于多种同步场景，比如限制数据库连接池的大小、控制线程池中的线程数量等。它比<code>synchronized</code>关键字和<code>ReentrantLock</code>提供了更多的灵活性。</p><h2 id="countdownlatch" tabindex="-1"><a class="header-anchor" href="#countdownlatch"><span>CountDownLatch</span></a></h2><p>允许一个或多个线程等待一组操作在其他线程中完成。用来进行线程同步协作，等待所有线程完成倒计时。</p><p>其中构造参数用来初始化等待计数值，await() 用来等待计数归零，countDown() 用来让计数减一。</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9FF;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> throws InterruptedException </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#8FBCBB;"> CountDownLatch</span><span style="color:#D8DEE9;"> latch</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> CountDownLatch</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">3</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Thread</span><span style="color:#ECEFF4;">(()</span><span style="color:#8FBCBB;"> -&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;"> log</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">debug</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">begin...</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#88C0D0;"> sleep</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">1</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;"> latch</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">countDown</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;"> log</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">debug</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">end...{}</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> latch</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getCount</span><span style="color:#ECEFF4;">())</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;"> }).</span><span style="color:#88C0D0;">start</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Thread</span><span style="color:#ECEFF4;">(()</span><span style="color:#8FBCBB;"> -&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;"> log</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">debug</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">begin...</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#88C0D0;"> sleep</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">2</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;"> latch</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">countDown</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;"> log</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">debug</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">end...{}</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> latch</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getCount</span><span style="color:#ECEFF4;">())</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;"> }).</span><span style="color:#88C0D0;">start</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Thread</span><span style="color:#ECEFF4;">(()</span><span style="color:#8FBCBB;"> -&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;"> log</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">debug</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">begin...</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#88C0D0;"> sleep</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">1.5</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;"> latch</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">countDown</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;"> log</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">debug</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">end...{}</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> latch</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getCount</span><span style="color:#ECEFF4;">())</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;"> }).</span><span style="color:#88C0D0;">start</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;"> log</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">debug</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">waiting...</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;"> latch</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">await</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;"> log</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">debug</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">wait end...</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="cyclicbarrier-类" tabindex="-1"><a class="header-anchor" href="#cyclicbarrier-类"><span>CyclicBarrier 类</span></a></h2><p>使一组线程到达某个点后继续执行。循环栅栏，用来进行线程协作，等待线程满足某个计数。构造时设置『计数个数』，每个线程执行到某个需要“同步”的时刻调用 await() 方法进行等待，当等待的线程数满足『计数个数』时，继续执行。</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#8FBCBB;">CyclicBarrier</span><span style="color:#D8DEE9;"> cb</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> CyclicBarrier</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">2</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // 个数为2时才会继续执行</span></span>
<span class="line"><span style="color:#81A1C1;">new</span><span style="color:#88C0D0;"> Thread</span><span style="color:#ECEFF4;">(()</span><span style="color:#8FBCBB;">-&gt;</span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;"> System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">线程1开始..</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">+new</span><span style="color:#88C0D0;"> Date</span><span style="color:#ECEFF4;">())</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;"> try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;"> cb</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">await</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // 当个数不足时，等待</span></span>
<span class="line"><span style="color:#ECEFF4;"> }</span><span style="color:#81A1C1;"> catch</span><span style="color:#ECEFF4;"> (</span><span style="color:#8FBCBB;">InterruptedException</span><span style="color:#ECEFF4;"> |</span><span style="color:#8FBCBB;"> BrokenBarrierException</span><span style="color:#D8DEE9;"> e</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;"> e</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">printStackTrace</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;"> }</span></span>
<span class="line"><span style="color:#D8DEE9;"> System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">线程1继续向下运行...</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">+new</span><span style="color:#88C0D0;"> Date</span><span style="color:#ECEFF4;">())</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}).</span><span style="color:#88C0D0;">start</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">new</span><span style="color:#88C0D0;"> Thread</span><span style="color:#ECEFF4;">(()</span><span style="color:#8FBCBB;">-&gt;</span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;"> System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">线程2开始..</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">+new</span><span style="color:#88C0D0;"> Date</span><span style="color:#ECEFF4;">())</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;"> try</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9;"> Thread</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">sleep</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">2000</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span><span style="color:#ECEFF4;"> }</span><span style="color:#81A1C1;"> catch</span><span style="color:#ECEFF4;"> (</span><span style="color:#8FBCBB;">InterruptedException</span><span style="color:#D8DEE9;"> e</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span><span style="color:#ECEFF4;"> }</span></span>
<span class="line"><span style="color:#81A1C1;"> try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;"> cb</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">await</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // 2 秒后，线程个数够2，继续运行</span></span>
<span class="line"><span style="color:#ECEFF4;"> }</span><span style="color:#81A1C1;"> catch</span><span style="color:#ECEFF4;"> (</span><span style="color:#8FBCBB;">InterruptedException</span><span style="color:#ECEFF4;"> |</span><span style="color:#8FBCBB;"> BrokenBarrierException</span><span style="color:#D8DEE9;"> e</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;"> e</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">printStackTrace</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;"> }</span></span>
<span class="line"><span style="color:#D8DEE9;"> System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">线程2继续向下运行...</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">+new</span><span style="color:#88C0D0;"> Date</span><span style="color:#ECEFF4;">())</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}).</span><span style="color:#88C0D0;">start</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>注意 CyclicBarrier 与 CountDownLatch 的主要区别在于 CyclicBarrier 是可以重用的 CyclicBarrier 可以被比</p><p>喻为『人满发车』</p></blockquote><h2 id="exchanger" tabindex="-1"><a class="header-anchor" href="#exchanger"><span>Exchanger</span></a></h2><p>允许在并发线程之间交换数据。</p><h2 id="completablefuture" tabindex="-1"><a class="header-anchor" href="#completablefuture"><span>CompletableFuture</span></a></h2><p>CompletableFuture是Java 8引入的一个异步编程工具类，用于处理异步任务的结果和执行流程。它提供了一种简洁而强大的方式来处理异步操作，包括任务的串行执行、并行执行、组合以及异常处理等。</p><h2 id="locksupport" tabindex="-1"><a class="header-anchor" href="#locksupport"><span>LockSupport</span></a></h2><p>提供线程阻塞和唤醒操作的工具类。</p><p>在Java中，<code>park</code>方法属<code>java.util.concurrent.locks.LockSupport</code>工具类。<code>LockSupport</code>提供了一些静态方法，用于线程之间的线程阻塞和唤醒操作，<code>park</code>方法就是其中之一。</p><p><code>park</code>方法的作用是阻塞当前线程，直到它被其他线程通过调用<code>LockSupport.unpark(Thread thread)</code>方法唤醒。这通常用于实现锁和其他同步器的框架，以及那些需要更细粒度控制线程阻塞和唤醒的高级并发应用程序。</p><p><code>park</code>方法的用法非常简单，它没有参数，调用后当前线程就会挂起。以下是<code>park</code>方法的一个基本示例：</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9;">LockSupport</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">park</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>这行代码会使当前线程进入等待状态，直到另一个线程调用<code>LockSupport.unpark(Thread thread)</code>，其中<code>thread</code>是当前线程的引用，来唤醒它。</p><p><code>LockSupport</code>还提供了一些变体的<code>park</code>方法，允许你指定一个阻塞时间：</p><ul><li><code>LockSupport.parkNanos(long nanos)</code>：阻塞当前线程，直到另一个线程唤醒它或者超过指定的纳秒时间。</li><li><code>LockSupport.parkUntil(long deadline)</code>：阻塞当前线程，直到另一个线程唤醒它或者当前时间超过了指定的截止时间。</li></ul><p>使用<code>park</code>和<code>unpark</code>的方法可以在没有使用锁的情况下实现线程间的协作，这在某些情况下可以提高性能，因为它们避免了使用重量级的锁机制。然而，它们也要求开发者更仔细地管理线程的生命周期和状态，以避免常见的并发问题，如死锁。</p><p>下面是一个使用<code>park</code>和<code>unpark</code>的简单示例：</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> ParkUnparkExample</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">        Thread</span><span style="color:#D8DEE9;"> thread</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Thread</span><span style="color:#ECEFF4;">(()</span><span style="color:#8FBCBB;"> -&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">            System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Thread is running and will park now.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">            LockSupport</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">park</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">            System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Thread was unparked and is now running again.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        })</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">        thread</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">start</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">        // 稍等一下，确保线程已经进入park状态</span></span>
<span class="line"><span style="color:#81A1C1;">        try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">            Thread</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">sleep</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">1000</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span><span style="color:#81A1C1;"> catch</span><span style="color:#ECEFF4;"> (</span><span style="color:#8FBCBB;">InterruptedException</span><span style="color:#D8DEE9;"> e</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">            e</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">printStackTrace</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">        // 唤醒线程</span></span>
<span class="line"><span style="color:#D8DEE9;">        LockSupport</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">unpark</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">thread</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在这个例子中，新线程启动后会打印一条消息，然后调用<code>park</code>方法进入等待状态。主线程稍等一秒钟后调用<code>unpark</code>方法唤醒等待的线程，线程被唤醒后继续执行并打印另一条消息。</p></div><!----><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">上次编辑于: </span><!----></div><div class="contributors"><span class="vp-meta-label">贡献者: </span><!--[--><!--[--><span class="vp-meta-info" title="email: 2843768@qq.com">reniunai</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><!----><a class="route-link auto-link next" href="/note/java/jvm.html" aria-label="Java虚拟机"><div class="hint">下一页<span class="arrow end"></span></div><div class="link">Java虚拟机<span class="font-icon icon fa-fw fa-sm fas fa-file" style=""></span></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper"><!----><!----></footer></div><!--]--><!--[--><!----><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-CKQIJpv-.js" defer></script>
  </body>
</html>
