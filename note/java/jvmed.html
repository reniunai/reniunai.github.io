<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.14" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.51" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://reniunai.github.io/note/java/jvmed.html"><meta property="og:site_name" content="çƒ­ç‰›å¥¶"><meta property="og:title" content="Javaè™šæ‹Ÿæœº"><meta property="og:description" content="Java è™šæ‹Ÿæœº"><meta property="og:type" content="article"><meta property="og:image" content="https://reniunai.github.io/assets/images/cover1.jpg"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2024-08-05T08:48:07.000Z"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image:src" content="https://reniunai.github.io/assets/images/cover1.jpg"><meta name="twitter:image:alt" content="Javaè™šæ‹Ÿæœº"><meta property="article:author" content="HotMilk"><meta property="article:tag" content="jvm"><meta property="article:published_time" content="2024-07-15T00:00:00.000Z"><meta property="article:modified_time" content="2024-08-05T08:48:07.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Javaè™šæ‹Ÿæœº","image":["https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806488.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806323.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806481.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806492.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806444.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806556.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806505.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806336.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806606.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806528.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806611.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806759.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806509.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806290.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806559.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806527.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806840.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806056.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806314.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806561.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806479.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806087.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806182.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806969.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806904.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806959.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806010.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806615.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806783.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806878.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806958.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806023.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806120.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806464.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806544.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806723.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806901.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806946.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806753.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806075.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806106.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806741.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806880.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806753.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806868.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806873.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806924.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806440.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806424.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806496.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806602.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806701.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806770.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806182.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806241.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806174.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806552.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806608.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806670.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806036.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806984.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806093.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806432.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806537.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806754.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806177.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806829.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806104.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806300.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806281.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806529.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806658.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806004.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806053.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806072.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806127.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806165.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806461.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806768.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806950.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806098.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806079.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806159.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806271.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806382.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806675.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806863.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806948.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806050.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806161.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806177.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806295.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806520.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407152008060.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407152130988.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407152221819.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407152223824.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407152224719.png"],"datePublished":"2024-07-15T00:00:00.000Z","dateModified":"2024-08-05T08:48:07.000Z","author":[{"@type":"Person","name":"HotMilk"}]}</script><title>Javaè™šæ‹Ÿæœº | çƒ­ç‰›å¥¶</title><meta name="description" content="Java è™šæ‹Ÿæœº">
    <link rel="preload" href="/assets/style-DqX65dVc.css" as="style"><link rel="stylesheet" href="/assets/style-DqX65dVc.css">
    <link rel="modulepreload" href="/assets/app-zamys2Ga.js"><link rel="modulepreload" href="/assets/jvmed.html-BXGoOHuf.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper-DlAUqK2U.js">
    <link rel="prefetch" href="/assets/index.html-gws2Ru1v.js" as="script"><link rel="prefetch" href="/assets/intro.html-CSvwD531.js" as="script"><link rel="prefetch" href="/assets/index.html-C3c63ahV.js" as="script"><link rel="prefetch" href="/assets/disable.html-368Taf75.js" as="script"><link rel="prefetch" href="/assets/encrypt.html-BXzce1Fb.js" as="script"><link rel="prefetch" href="/assets/layout.html-DT_TSkSK.js" as="script"><link rel="prefetch" href="/assets/markdown.html-Bm2tw4gV.js" as="script"><link rel="prefetch" href="/assets/page.html-BsvOJrSt.js" as="script"><link rel="prefetch" href="/assets/index.html-DiAOPui8.js" as="script"><link rel="prefetch" href="/assets/cherry.html-CcMS49ll.js" as="script"><link rel="prefetch" href="/assets/dragonfruit.html-CC-wF7at.js" as="script"><link rel="prefetch" href="/assets/strawberry.html-d2PwhQe8.js" as="script"><link rel="prefetch" href="/assets/tomato.html-Dd_6TA0L.js" as="script"><link rel="prefetch" href="/assets/è®¡ç®—æœºç½‘ç»œ.html-CMs6tlHx.js" as="script"><link rel="prefetch" href="/assets/1.Elasticsearchå­¦ä¹ ï¼Œè¯·å…ˆçœ‹è¿™ä¸€ç¯‡ï¼.html-ChblA27A.js" as="script"><link rel="prefetch" href="/assets/2.Elasticsearchèšåˆæ·±å…¥è¯¦è§£â€”â€”å¯¹æ¯”Mysqlå®ç° - å‰¯æœ¬ (3).html-ruP3ISvB.js" as="script"><link rel="prefetch" href="/assets/2.Elasticsearchèšåˆæ·±å…¥è¯¦è§£â€”â€”å¯¹æ¯”Mysqlå®ç°.html-Di30Kgka.js" as="script"><link rel="prefetch" href="/assets/3.ELK.html-Bk4odkTz.js" as="script"><link rel="prefetch" href="/assets/5.æ•°æ®åŒæ­¥åˆ°Elasticsearched.html-C5yoQvuj.js" as="script"><link rel="prefetch" href="/assets/esåŸºç¡€è¯­æ³•.html-BC4UAocJ.js" as="script"><link rel="prefetch" href="/assets/ginä½¿ç”¨elasticsearchå®ç°å¸–å­å…¨æ–‡æ£€ç´¢.html-CuqGjsqm.js" as="script"><link rel="prefetch" href="/assets/ginä½¿ç”¨rabbitMQå®ç°å¼‚æ­¥åŒå†™.html-pm6VCOzo.js" as="script"><link rel="prefetch" href="/assets/ginä½¿ç”¨rediså®ç°å…±åŒå…³æ³¨.html-D8ZtvZE9.js" as="script"><link rel="prefetch" href="/assets/ginä½¿ç”¨rediså®ç°ç®€å•å…³æ³¨æ¨é€.html-B3JONsnL.js" as="script"><link rel="prefetch" href="/assets/go-ginä½¿ç”¨redis.html-DfXM_s_P.js" as="script"><link rel="prefetch" href="/assets/go-ç®€å•ä½¿ç”¨elasticsearch.html-CksMaWUT.js" as="script"><link rel="prefetch" href="/assets/go-è¯­æ³•åŸºç¡€.html-DCpG46i6.js" as="script"><link rel="prefetch" href="/assets/index.html-Infn2Ztu.js" as="script"><link rel="prefetch" href="/assets/SpringSecurity.html-v-FGgyXQ.js" as="script"><link rel="prefetch" href="/assets/disable.html-CSgE-n9A.js" as="script"><link rel="prefetch" href="/assets/juced.html-B5wvl7Rg.js" as="script"><link rel="prefetch" href="/assets/kafkaæ¦‚å¿µ.html-DBdiLvKy.js" as="script"><link rel="prefetch" href="/assets/B_æ ‘ï¼Œç´¢å¼•ï¼Œå›è¡¨.html-DjVZp0YF.js" as="script"><link rel="prefetch" href="/assets/SQLæ³¨å…¥.html-D6MyVxHs.js" as="script"><link rel="prefetch" href="/assets/ä¸»ä»åŒæ­¥åŸç†.html-Cn1zw72F.js" as="script"><link rel="prefetch" href="/assets/äº‹åŠ¡ã€éš”ç¦»çº§åˆ«ã€MVCC.html-CEMyxIjI.js" as="script"><link rel="prefetch" href="/assets/åˆ†åº“åˆ†è¡¨.html-zJSuiv33.js" as="script"><link rel="prefetch" href="/assets/æ…¢æŸ¥è¯¢ï¼ŒSQLä¼˜åŒ–.html-C084wO-7.js" as="script"><link rel="prefetch" href="/assets/1.redisç®€ä»‹.html-SEaFDC5p.js" as="script"><link rel="prefetch" href="/assets/10.åº”ç”¨åœºæ™¯ - å‰¯æœ¬.html-B7-u-Ql2.js" as="script"><link rel="prefetch" href="/assets/10.åº”ç”¨åœºæ™¯.html-5AhD76oH.js" as="script"><link rel="prefetch" href="/assets/11. Canalè§£å†³Mysqlå’ŒRedisæ•°æ®åŒæ­¥(TCP).html-tdSwlTgI.js" as="script"><link rel="prefetch" href="/assets/12. Canalè§£å†³Mysqlå’ŒRedisæ•°æ®åŒæ­¥(MQ).html-BlgsvjC6.js" as="script"><link rel="prefetch" href="/assets/13. Canalè§£å†³Mysqlå’ŒESæ•°æ®åŒæ­¥.html-BZqM2wW1.js" as="script"><link rel="prefetch" href="/assets/2.Redisç¼“å­˜ï¼ˆç¼“å­˜ç©¿é€ã€ã€ç¼“å­˜å‡»ç©¿ã€ç¼“å­˜é›ªå´©ï¼‰.html-BaCODm8N.js" as="script"><link rel="prefetch" href="/assets/3.Redisç¼“å­˜ç©¿é€-å¸ƒéš†è¿‡æ»¤å™¨ed.html-DWTcTgyZ.js" as="script"><link rel="prefetch" href="/assets/4.Redisç¼“å­˜æ•°æ®å’Œæ•°æ®åº“æ•°æ®ä¸€è‡´æ€§.html-DNcMxm9Y.js" as="script"><link rel="prefetch" href="/assets/5.RedisæŒä¹…åŒ–ï¼ˆè½ç›˜ï¼‰.html-C2TUH_e3.js" as="script"><link rel="prefetch" href="/assets/6.Redisé«˜å¯ç”¨-ä¸‰ç§æ–¹æ¡ˆ.html-BSDpg_H0.js" as="script"><link rel="prefetch" href="/assets/7.Redisä¸»ä»å¤åˆ¶.html-DIx4Ea2T.js" as="script"><link rel="prefetch" href="/assets/8.åˆ†å¸ƒå¼é”ã€ç§’æ€ã€RedLock.html-CA4tpGf5.js" as="script"><link rel="prefetch" href="/assets/9.æ•°æ®è¿‡æœŸåˆ é™¤ç­–ç•¥ã€å†…å­˜æ·˜æ±°ç­–ç•¥.html-BNqm2TNR.js" as="script"><link rel="prefetch" href="/assets/index.html-DWcBnkQv.js" as="script"><link rel="prefetch" href="/assets/page.html-CFUbX1xi.js" as="script"><link rel="prefetch" href="/assets/Spark.html-CsbvGVTN.js" as="script"><link rel="prefetch" href="/assets/å¹¿å‘Šæ•°ä»“.html-D6sbOKzm.js" as="script"><link rel="prefetch" href="/assets/1.html-DOCUNWJv.js" as="script"><link rel="prefetch" href="/assets/2.html-Ddjuyp90.js" as="script"><link rel="prefetch" href="/assets/3.html-R9-CK8Sl.js" as="script"><link rel="prefetch" href="/assets/4.html-BSn9pvly.js" as="script"><link rel="prefetch" href="/assets/1.html-DHPV92gN.js" as="script"><link rel="prefetch" href="/assets/2.html-BW52rY_0.js" as="script"><link rel="prefetch" href="/assets/3.html-Di2IMebg.js" as="script"><link rel="prefetch" href="/assets/4.html-3FXVRjWg.js" as="script"><link rel="prefetch" href="/assets/dockerç®€å•è§£å†³æ— æ³•ä¸‹è½½é•œåƒ.html-DnmH8Br-.js" as="script"><link rel="prefetch" href="/assets/å®‰è£…Goï¼Œé…ç½®VScode.html-LapETGr9.js" as="script"><link rel="prefetch" href="/assets/404.html-BxSdGKVA.js" as="script"><link rel="prefetch" href="/assets/index.html-DJC_wVSE.js" as="script"><link rel="prefetch" href="/assets/index.html-DAGkkYzc.js" as="script"><link rel="prefetch" href="/assets/index.html-Ctbs8zHK.js" as="script"><link rel="prefetch" href="/assets/index.html-BKz6SZsy.js" as="script"><link rel="prefetch" href="/assets/index.html-DKVZ3F79.js" as="script"><link rel="prefetch" href="/assets/index.html-BOdVfRaN.js" as="script"><link rel="prefetch" href="/assets/index.html-C2-7YeHw.js" as="script"><link rel="prefetch" href="/assets/index.html-BUgmiYui.js" as="script"><link rel="prefetch" href="/assets/index.html-BwMKDCjo.js" as="script"><link rel="prefetch" href="/assets/index.html-BqOiarBE.js" as="script"><link rel="prefetch" href="/assets/index.html-BuZ0nP2W.js" as="script"><link rel="prefetch" href="/assets/index.html-Bdu_qG-t.js" as="script"><link rel="prefetch" href="/assets/index.html-Br7YzRQg.js" as="script"><link rel="prefetch" href="/assets/index.html-Dt00bYtw.js" as="script"><link rel="prefetch" href="/assets/index.html-CTRMBcST.js" as="script"><link rel="prefetch" href="/assets/index.html-Cm78I-Px.js" as="script"><link rel="prefetch" href="/assets/index.html-OUZwnErK.js" as="script"><link rel="prefetch" href="/assets/index.html-xbWDK_8s.js" as="script"><link rel="prefetch" href="/assets/index.html-BKIBvgHn.js" as="script"><link rel="prefetch" href="/assets/index.html-FjlFkk_7.js" as="script"><link rel="prefetch" href="/assets/index.html-MsefKOWi.js" as="script"><link rel="prefetch" href="/assets/index.html-CSBR5rin.js" as="script"><link rel="prefetch" href="/assets/index.html-D_isb1qs.js" as="script"><link rel="prefetch" href="/assets/index.html-BhEXfrM0.js" as="script"><link rel="prefetch" href="/assets/index.html-BSs8JEUO.js" as="script"><link rel="prefetch" href="/assets/index.html-D6Tt0ImX.js" as="script"><link rel="prefetch" href="/assets/index.html-Cif0endg.js" as="script"><link rel="prefetch" href="/assets/index.html-Dlpxo5Gg.js" as="script"><link rel="prefetch" href="/assets/index.html-CSNSse50.js" as="script"><link rel="prefetch" href="/assets/index.html-DaqMKXD1.js" as="script"><link rel="prefetch" href="/assets/index.html-BkVJjHoB.js" as="script"><link rel="prefetch" href="/assets/index.html-Bkr5Fjh5.js" as="script"><link rel="prefetch" href="/assets/index.html-DRnPyIR3.js" as="script"><link rel="prefetch" href="/assets/index.html-DqEGMThJ.js" as="script"><link rel="prefetch" href="/assets/index.html-NVLs2PCi.js" as="script"><link rel="prefetch" href="/assets/index.html-DykuEDyy.js" as="script"><link rel="prefetch" href="/assets/index.html-DLqEIQGW.js" as="script"><link rel="prefetch" href="/assets/index.html-DJvXRuWI.js" as="script"><link rel="prefetch" href="/assets/index.html-D3aLkbQT.js" as="script"><link rel="prefetch" href="/assets/index.html-ZudLyak-.js" as="script"><link rel="prefetch" href="/assets/index.html-D1xhISc_.js" as="script"><link rel="prefetch" href="/assets/index.html-BSlzDUjV.js" as="script"><link rel="prefetch" href="/assets/index.html-C2goA7p0.js" as="script"><link rel="prefetch" href="/assets/index.html-CVr8E0dn.js" as="script"><link rel="prefetch" href="/assets/index.html-CQHLd7Md.js" as="script"><link rel="prefetch" href="/assets/index.html-ChRFQzA3.js" as="script"><link rel="prefetch" href="/assets/index.html-Zg-l9bqW.js" as="script"><link rel="prefetch" href="/assets/index.html-LVFhrue-.js" as="script"><link rel="prefetch" href="/assets/index.html-CqzpwpQ0.js" as="script"><link rel="prefetch" href="/assets/index.html-mTuw0PMg.js" as="script"><link rel="prefetch" href="/assets/index.html-C1n6ERD7.js" as="script"><link rel="prefetch" href="/assets/index.html-Czqf6kyb.js" as="script"><link rel="prefetch" href="/assets/index.html-DEm_yfr_.js" as="script"><link rel="prefetch" href="/assets/index.html-DYvO9ECR.js" as="script"><link rel="prefetch" href="/assets/index.html-CcZOg0CT.js" as="script"><link rel="prefetch" href="/assets/index.html-Dqaz0npn.js" as="script"><link rel="prefetch" href="/assets/index.html-kGFrNf51.js" as="script"><link rel="prefetch" href="/assets/index.html-mTuw0PMg.js" as="script"><link rel="prefetch" href="/assets/index.html-ptvVhPu-.js" as="script"><link rel="prefetch" href="/assets/index.html-CydJOpNs.js" as="script"><link rel="prefetch" href="/assets/index.html-Bvb-GyVe.js" as="script"><link rel="prefetch" href="/assets/index.html-6aXDAUnA.js" as="script"><link rel="prefetch" href="/assets/index.html-C4iZOMF3.js" as="script"><link rel="prefetch" href="/assets/index.html-cgttEa_g.js" as="script"><link rel="prefetch" href="/assets/index.html-CFw31ukz.js" as="script"><link rel="prefetch" href="/assets/index.html-BpdElFoO.js" as="script"><link rel="prefetch" href="/assets/index.html-DbQPSJSI.js" as="script"><link rel="prefetch" href="/assets/index.html-RY8xjIai.js" as="script"><link rel="prefetch" href="/assets/index.html-BlrfPQu1.js" as="script"><link rel="prefetch" href="/assets/index.html-ButD8Ms4.js" as="script"><link rel="prefetch" href="/assets/index.html-B0mo8RCf.js" as="script"><link rel="prefetch" href="/assets/index.html-CRnmDiOn.js" as="script"><link rel="prefetch" href="/assets/index.html-Dz7P16wf.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-GXRgw7eJ.js" as="script"><link rel="prefetch" href="/assets/SearchResult-2oSpbF8E.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><div class="theme-container external-link-icon has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><!--[--><a class="route-link vp-brand" href="/"><img class="vp-nav-logo" src="https://theme-hope-assets.vuejs.press/logo.svg" alt><!----><span class="vp-site-name hide-in-pad">çƒ­ç‰›å¥¶</span></a><!--]--><!----></div><div class="vp-navbar-center"><!----><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/" aria-label="åšå®¢ä¸»é¡µ"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span><!--]-->åšå®¢ä¸»é¡µ<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="ç¬”è®°"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>ç¬”è®°<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link route-link-active auto-link" href="/note/java/" aria-label="java"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->java<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/note/redis/" aria-label="redis"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->redis<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/note/Linux/" aria-label="redis"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->redis<!----></a></li></ul></button></div></div></nav><!--]--><!----></div><div class="vp-navbar-end"><!----><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/reniunai" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-outlook-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon" name="outlook"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="vp-outlook-dropdown"><!----></div></button></div><!--[--><button type="button" class="search-pro-button" aria-label="æœç´¢"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon" name="search"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="search-pro-placeholder">æœç´¢</div><div class="search-pro-key-hints"><kbd class="search-pro-key">Ctrl</kbd><kbd class="search-pro-key">K</kbd></div></button><!--]--><!--]--><!----><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!----><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/note/java/juced.html" aria-label="Javaå¹¶å‘åŒ…"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-file" style=""></span><!--]-->Javaå¹¶å‘åŒ…<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/note/java/jvmed.html" aria-label="Javaè™šæ‹Ÿæœº"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-file" style=""></span><!--]-->Javaè™šæ‹Ÿæœº<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/note/java/SpringSecurity.html" aria-label="SpringSecurity"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-file" style=""></span><!--]-->SpringSecurity<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/note/java/disable.html" aria-label="å¸ƒå±€ä¸åŠŸèƒ½ç¦ç”¨"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-gears" style=""></span><!--]-->å¸ƒå±€ä¸åŠŸèƒ½ç¦ç”¨<!----></a></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><div class="page-cover"><img src="/assets/images/cover1.jpg" alt no-view></div><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><span class="font-icon icon fa-fw fa-sm fas fa-file" style=""></span>Javaè™šæ‹Ÿæœº</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><span class="page-author-item">HotMilk</span></span><span property="author" content="HotMilk"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2024-07-15T00:00:00.000Z"></span><span class="page-category-info" aria-label="åˆ†ç±»ğŸŒˆ" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon" name="category"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item color7 clickable" role="navigation">JVM</span><!--]--><meta property="articleSection" content="JVM"></span><span class="page-tag-info" aria-label="æ ‡ç­¾ğŸ·" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon" name="tag"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item color5 clickable" role="navigation">jvm</span><!--]--><meta property="keywords" content="jvm"></span><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 104 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT104M"></span><span class="page-word-info" aria-label="å­—æ•°ğŸ” " data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon word-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="word icon" name="word"><path d="M518.217 432.64V73.143A73.143 73.143 0 01603.43 1.097a512 512 0 01419.474 419.474 73.143 73.143 0 01-72.046 85.212H591.36a73.143 73.143 0 01-73.143-73.143z"></path><path d="M493.714 566.857h340.297a73.143 73.143 0 0173.143 85.577A457.143 457.143 0 11371.566 117.76a73.143 73.143 0 0185.577 73.143v339.383a36.571 36.571 0 0036.571 36.571z"></path></svg><span>çº¦ 31344 å­—</span><meta property="wordCount" content="31344"></span></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!----><div class="vp-toc-header">æ­¤é¡µå†…å®¹<button type="button" class="print-button" title="æ‰“å°"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_1-ç¨‹åºè®¡æ•°å™¨">1.ç¨‹åºè®¡æ•°å™¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_2-è™šæ‹Ÿæœºæ ˆ">2.è™šæ‹Ÿæœºæ ˆ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_3-æœ¬åœ°æ–¹æ³•æ ˆ">3.æœ¬åœ°æ–¹æ³•æ ˆ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_4-å †">4.å †</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_5-æ–¹æ³•åŒº">5.æ–¹æ³•åŒº</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_6-ç›´æ¥å†…å­˜">6.ç›´æ¥å†…å­˜</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_1-å¦‚ä½•åˆ¤æ–­å¯¹è±¡å¯ä»¥å›æ”¶">1.å¦‚ä½•åˆ¤æ–­å¯¹è±¡å¯ä»¥å›æ”¶</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_2-åƒåœ¾å›æ”¶ç®—æ³•">2. åƒåœ¾å›æ”¶ç®—æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_3-åˆ†ä»£åƒåœ¾å›æ”¶">3. åˆ†ä»£åƒåœ¾å›æ”¶</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_4-åƒåœ¾å›æ”¶å™¨">4. åƒåœ¾å›æ”¶å™¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_5-åƒåœ¾å›æ”¶è°ƒä¼˜">5. åƒåœ¾å›æ”¶è°ƒä¼˜</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_1-ç±»æ–‡ä»¶ç»“æ„">1. ç±»æ–‡ä»¶ç»“æ„</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-1-é­”æ•°">1.1 é­”æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-2-ç‰ˆæœ¬">1.2 ç‰ˆæœ¬</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-3-å¸¸é‡æ± ">1.3 å¸¸é‡æ± </a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-4-è®¿é—®æ ‡è¯†ä¸ç»§æ‰¿ä¿¡æ¯">1.4 è®¿é—®æ ‡è¯†ä¸ç»§æ‰¿ä¿¡æ¯</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_2-å­—èŠ‚ç æŒ‡ä»¤">2. å­—èŠ‚ç æŒ‡ä»¤</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-1-javapå·¥å…·">2.1 javapå·¥å…·</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-2-å›¾è§£æ–¹æ³•æ‰§è¡Œæµç¨‹">2.2 å›¾è§£æ–¹æ³•æ‰§è¡Œæµç¨‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-3-ç»ƒä¹ -åˆ†æ-i">2.3 ç»ƒä¹  - åˆ†æ i++</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-4-æ¡ä»¶åˆ¤æ–­æŒ‡ä»¤">2.4 æ¡ä»¶åˆ¤æ–­æŒ‡ä»¤</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-5-å¾ªç¯æ§åˆ¶æŒ‡ä»¤">2.5 å¾ªç¯æ§åˆ¶æŒ‡ä»¤</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-6-ç»ƒä¹ -åˆ¤æ–­ç»“æœ">2.6 ç»ƒä¹ -åˆ¤æ–­ç»“æœ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-7-æ„é€ æ–¹æ³•">2.7 æ„é€ æ–¹æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-8-æ–¹æ³•è°ƒç”¨">2.8 æ–¹æ³•è°ƒç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-9-å¤šæ€çš„åŸç†">2.9 å¤šæ€çš„åŸç†</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-10-å¼‚å¸¸å¤„ç†">2.10 å¼‚å¸¸å¤„ç†</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-11-synchronized">2.11 synchronized</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_3-ç¼–è¯‘å™¨å¤„ç†">3. ç¼–è¯‘å™¨å¤„ç†</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-1-é»˜è®¤æ„é€ å™¨">3.1 é»˜è®¤æ„é€ å™¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-2-è‡ªåŠ¨æ‹†è£…ç®±">3.2 è‡ªåŠ¨æ‹†è£…ç®±</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-3-æ³›å‹é›†åˆå–å€¼">3.3 æ³›å‹é›†åˆå–å€¼</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-4åå°„è·å–æ³›å‹ä¿¡æ¯">3.4åå°„è·å–æ³›å‹ä¿¡æ¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-5-å¯å˜å‚æ•°">3.5 å¯å˜å‚æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-6-foreach-å¾ªç¯">3.6 foreach å¾ªç¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-7-switch-å­—ç¬¦ä¸²">3.7 switch å­—ç¬¦ä¸²</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-8-switch-æšä¸¾">3.8 switch æšä¸¾</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-9-æšä¸¾ç±»">3.9 æšä¸¾ç±»</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-10-try-with-resources">3.10 try-with-resources</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-11-æ–¹æ³•é‡å†™æ—¶çš„æ¡¥æ¥æ–¹æ³•">3.11 æ–¹æ³•é‡å†™æ—¶çš„æ¡¥æ¥æ–¹æ³•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-12-åŒ¿åå†…éƒ¨ç±»">3.12 åŒ¿åå†…éƒ¨ç±»</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_4-ç±»åŠ è½½é˜¶æ®µ">4. ç±»åŠ è½½é˜¶æ®µ</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_4-1-åŠ è½½">4.1 åŠ è½½</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_4-2-é“¾æ¥">4.2 é“¾æ¥</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_4-3-åˆå§‹åŒ–">4-3 åˆå§‹åŒ–</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_4-ç»ƒä¹ ">4ï¼‰ç»ƒä¹ </a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_5-ç±»åŠ è½½å™¨">5.ç±»åŠ è½½å™¨</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_5-1-å¯åŠ¨ç±»çš„åŠ è½½å™¨">5.1 å¯åŠ¨ç±»çš„åŠ è½½å™¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_5-2-æ‰©å±•ç±»çš„åŠ è½½å™¨">5.2 æ‰©å±•ç±»çš„åŠ è½½å™¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_5-3-åŒäº²å§”æ´¾æ¨¡å¼">5.3 åŒäº²å§”æ´¾æ¨¡å¼</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_5-4-è‡ªå®šä¹‰ç±»åŠ è½½å™¨">5.4 è‡ªå®šä¹‰ç±»åŠ è½½å™¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_5-5-çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨">5.5 çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_6ã€è¿è¡ŒæœŸä¼˜åŒ–">6ã€è¿è¡ŒæœŸä¼˜åŒ–</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_6-1-å³æ—¶ç¼–è¯‘">6.1 å³æ—¶ç¼–è¯‘</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_6-2-åå°„ä¼˜åŒ–">6.2 åå°„ä¼˜åŒ–</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_1-åŸå­æ€§">1. åŸå­æ€§</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-1-é—®é¢˜è§£æ">1-1 é—®é¢˜è§£æ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-2-è§£å†³æ–¹æ³•-åŠ é”">1-2 è§£å†³æ–¹æ³• -åŠ é”</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_2-å¯è§æ€§">2.å¯è§æ€§</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-3-å¯è§æ€§">2-3 å¯è§æ€§</a></li><!----><!--]--></ul></li><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!----></aside></div><!----><div class="theme-hope-content"><p>Java è™šæ‹Ÿæœº</p><!-- more --><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806488.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>Java Class</p><p>ClassLoader</p><h1 id="ä¸€ã€javaå†…å­˜ç»“æ„" tabindex="-1"><a class="header-anchor" href="#ä¸€ã€javaå†…å­˜ç»“æ„"><span>ä¸€ã€Javaå†…å­˜ç»“æ„</span></a></h1><h2 id="_1-ç¨‹åºè®¡æ•°å™¨" tabindex="-1"><a class="header-anchor" href="#_1-ç¨‹åºè®¡æ•°å™¨"><span>1.ç¨‹åºè®¡æ•°å™¨</span></a></h2><h4 id="_1-1å®šä¹‰" tabindex="-1"><a class="header-anchor" href="#_1-1å®šä¹‰"><span>1.1å®šä¹‰</span></a></h4><p>Program Counter Register ç¨‹åºè®¡æ•°å™¨ï¼ˆå¯„å­˜å™¨ï¼‰ ä½œç”¨ï¼šæ˜¯è®°å½•ä¸‹ä¸€æ¡ jvm æŒ‡ä»¤çš„æ‰§è¡Œåœ°å€è¡Œå·ã€‚ ç‰¹ç‚¹ï¼š</p><ul><li>æ˜¯çº¿ç¨‹ç§æœ‰çš„</li><li>ä¸ä¼šå­˜åœ¨å†…å­˜æº¢å‡º</li></ul><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#B48EAD;">0</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> getstatic #</span><span style="color:#B48EAD;">20</span><span style="color:#616E88;"> // PrintStream out = System.out;</span></span>
<span class="line"><span style="color:#B48EAD;">3</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> astore_1 </span><span style="color:#616E88;">// --</span></span>
<span class="line"><span style="color:#B48EAD;">4</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> aload_1 </span><span style="color:#616E88;">// out.println(1);</span></span>
<span class="line"><span style="color:#B48EAD;">5</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> iconst_1 </span><span style="color:#616E88;">// --</span></span>
<span class="line"><span style="color:#B48EAD;">6</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> invokevirtual #</span><span style="color:#B48EAD;">26</span><span style="color:#616E88;"> // --</span></span>
<span class="line"><span style="color:#B48EAD;">9</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> aload_1 </span><span style="color:#616E88;">// out.println(2);</span></span>
<span class="line"><span style="color:#B48EAD;">10</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> iconst_2 </span><span style="color:#616E88;">// --</span></span>
<span class="line"><span style="color:#B48EAD;">11</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> invokevirtual #</span><span style="color:#B48EAD;">26</span><span style="color:#616E88;"> // --</span></span>
<span class="line"><span style="color:#B48EAD;">14</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> aload_1 </span><span style="color:#616E88;">// out.println(3);</span></span>
<span class="line"><span style="color:#B48EAD;">15</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> iconst_3 </span><span style="color:#616E88;">// --</span></span>
<span class="line"><span style="color:#B48EAD;">16</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> invokevirtual #</span><span style="color:#B48EAD;">26</span><span style="color:#616E88;"> // --</span></span>
<span class="line"><span style="color:#B48EAD;">19</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> aload_1 </span><span style="color:#616E88;">// out.println(4);</span></span>
<span class="line"><span style="color:#B48EAD;">20</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> iconst_4 </span><span style="color:#616E88;">// --</span></span>
<span class="line"><span style="color:#B48EAD;">21</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> invokevirtual #</span><span style="color:#B48EAD;">26</span><span style="color:#616E88;"> // --</span></span>
<span class="line"><span style="color:#B48EAD;">24</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> aload_1 </span><span style="color:#616E88;">// out.println(5);</span></span>
<span class="line"><span style="color:#B48EAD;">25</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> iconst_5 </span><span style="color:#616E88;">// --</span></span>
<span class="line"><span style="color:#B48EAD;">26</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> invokevirtual #</span><span style="color:#B48EAD;">26</span><span style="color:#616E88;"> // --</span></span>
<span class="line"><span style="color:#B48EAD;">29</span><span style="color:#81A1C1;">:</span><span style="color:#81A1C1;"> return</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>è§£é‡Šå™¨ä¼šè§£é‡ŠæŒ‡ä»¤ä¸ºæœºå™¨ç äº¤ç»™ cpu æ‰§è¡Œï¼Œç¨‹åºè®¡æ•°å™¨ä¼šè®°å½•ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€è¡Œå·ï¼Œè¿™æ ·ä¸‹ä¸€æ¬¡è§£é‡Šå™¨ä¼šä»ç¨‹åºè®¡æ•°å™¨æ‹¿åˆ°æŒ‡ä»¤ç„¶åè¿›è¡Œè§£é‡Šæ‰§è¡Œã€‚</li><li>å¤šçº¿ç¨‹çš„ç¯å¢ƒä¸‹ï¼Œå¦‚æœä¸¤ä¸ªçº¿ç¨‹å‘ç”Ÿäº†ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œé‚£ä¹ˆç¨‹åºè®¡æ•°å™¨ä¼šè®°å½•çº¿ç¨‹ä¸‹ä¸€è¡ŒæŒ‡ä»¤çš„åœ°å€è¡Œå·ï¼Œä»¥ä¾¿äºæ¥ç€å¾€ä¸‹æ‰§è¡Œã€‚</li></ul><h2 id="_2-è™šæ‹Ÿæœºæ ˆ" tabindex="-1"><a class="header-anchor" href="#_2-è™šæ‹Ÿæœºæ ˆ"><span>2.è™šæ‹Ÿæœºæ ˆ</span></a></h2><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806323.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><h4 id="_2-1-å®šä¹‰" tabindex="-1"><a class="header-anchor" href="#_2-1-å®šä¹‰"><span>2.1 å®šä¹‰</span></a></h4><ul><li>æ¯ä¸ªçº¿ç¨‹è¿è¡Œéœ€è¦çš„å†…å­˜ç©ºé—´ï¼Œç§°ä¸ºè™šæ‹Ÿæœºæ ˆ</li><li>æ¯ä¸ªæ ˆç”±å¤šä¸ªæ ˆå¸§ï¼ˆFrameï¼‰ç»„æˆï¼Œå¯¹åº”ç€æ¯æ¬¡è°ƒç”¨æ–¹æ³•æ—¶æ‰€å ç”¨çš„å†…å­˜</li><li>æ¯ä¸ªçº¿ç¨‹åªèƒ½æœ‰ä¸€ä¸ªæ´»åŠ¨æ ˆå¸§ï¼Œå¯¹åº”ç€å½“å‰æ­£åœ¨æ‰§è¡Œçš„æ–¹æ³•</li></ul><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> main1</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#88C0D0;">        method1</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> method1</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#88C0D0;">        method2</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">1</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 2</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> int</span><span style="color:#88C0D0;"> method2</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">int</span><span style="color:#D8DEE9;"> a</span><span style="color:#ECEFF4;">,</span><span style="color:#81A1C1;"> int</span><span style="color:#D8DEE9;"> b</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">        int</span><span style="color:#D8DEE9;"> c</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9FF;"> a </span><span style="color:#81A1C1;">+</span><span style="color:#D8DEE9FF;"> b</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">        return</span><span style="color:#D8DEE9FF;"> c</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806481.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>é—®é¢˜è¾¨æï¼š</p><ol><li>åƒåœ¾å›æ”¶æ˜¯å¦æ¶‰åŠæ ˆå†…å­˜ï¼Ÿ ä¸ä¼šã€‚æ ˆå†…å­˜æ˜¯æ–¹æ³•è°ƒç”¨äº§ç”Ÿçš„ï¼Œæ–¹æ³•è°ƒç”¨ç»“æŸåä¼šå¼¹å‡ºæ ˆã€‚</li><li>æ ˆå†…å­˜åˆ†é…è¶Šå¤§è¶Šå¥½å—ï¼Ÿ ä¸æ˜¯ã€‚å› ä¸ºç‰©ç†å†…å­˜æ˜¯ä¸€å®šçš„ï¼Œæ ˆå†…å­˜è¶Šå¤§ï¼Œå¯ä»¥æ”¯æŒæ›´å¤šçš„é€’å½’è°ƒç”¨ï¼Œä½†æ˜¯å¯æ‰§è¡Œçš„çº¿ç¨‹æ•°å°±ä¼šè¶Šå°‘ã€‚</li><li>æ–¹æ³•å‘¢çš„å±€éƒ¨å˜é‡æ˜¯å¦çº¿ç¨‹å®‰å…¨ <ol><li>å¦‚æœæ–¹æ³•å†…éƒ¨çš„å˜é‡æ²¡æœ‰é€ƒç¦»æ–¹æ³•çš„ä½œç”¨èŒƒå›´ï¼Œå®ƒæ˜¯çº¿ç¨‹å®‰å…¨çš„</li><li>å¦‚æœæ˜¯å±€éƒ¨å˜é‡å¼•ç”¨äº†å¯¹è±¡ï¼Œå¹¶é€ƒç¦»äº†æ–¹æ³•çš„èŒƒå›´ï¼Œé‚£å°±è¦è€ƒè™‘çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚</li></ol></li></ol><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> main1</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#616E88;">    //ä¸‹é¢å„ä¸ªæ–¹æ³•ä¼šä¸ä¼šé€ æˆçº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Ÿ</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    //ä¸ä¼š</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> m1</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">        StringBuilder</span><span style="color:#D8DEE9;"> sb</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> StringBuilder</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        sb</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">append</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">1</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        sb</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">append</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">2</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        sb</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">append</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">3</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">sb</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">toString</span><span style="color:#ECEFF4;">())</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    //ä¼šï¼Œå¯èƒ½ä¼šæœ‰å…¶ä»–çº¿ç¨‹ä½¿ç”¨è¿™ä¸ªå¯¹è±¡</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> m2</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">StringBuilder</span><span style="color:#D8DEE9;"> sb</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">        sb</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">append</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">1</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        sb</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">append</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">2</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        sb</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">append</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">3</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">sb</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">toString</span><span style="color:#ECEFF4;">())</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    //ä¼šï¼Œå…¶ä»–çº¿ç¨‹å¯èƒ½ä¼šæ‹¿åˆ°è¿™ä¸ªçº¿ç¨‹çš„å¼•ç”¨</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#8FBCBB;"> StringBuilder</span><span style="color:#88C0D0;"> m3</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">        StringBuilder</span><span style="color:#D8DEE9;"> sb</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> StringBuilder</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        sb</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">append</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">1</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        sb</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">append</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">2</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        sb</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">append</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">3</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">        return</span><span style="color:#D8DEE9FF;"> sb</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-2-æ ˆå†…å­˜æº¢å‡º" tabindex="-1"><a class="header-anchor" href="#_2-2-æ ˆå†…å­˜æº¢å‡º"><span>2.2 æ ˆå†…å­˜æº¢å‡º</span></a></h4><p><strong><code>Java.lang.stackOverflowError</code></strong> æ ˆå†…å­˜æº¢å‡º</p><p><strong>å¯¼è‡´æ ˆ<strong><strong>å†…å­˜</strong></strong>æº¢å‡ºçš„æƒ…å†µ</strong>ï¼š</p><ul><li><strong>æ ˆå¸§****è¿‡å¤š</strong>å¯¼è‡´æ ˆå†…å­˜æº¢å‡º</li><li><strong>æ ˆå¸§****è¿‡å¤§</strong>å¯¼è‡´æ ˆå†…å­˜æº¢å‡º</li></ul><p>æ ˆå¸§è¿‡å¤§ã€è¿‡å¤šã€æˆ–è€…ç¬¬ä¸‰æ–¹ç±»åº“æ“ä½œï¼Œéƒ½æœ‰å¯èƒ½é€ æˆæ ˆå†…å­˜æº¢å‡º java.lang.stackOverflowError ï¼Œä½¿ç”¨ -Xss256k æŒ‡å®šæ ˆå†…å­˜å¤§å°ï¼</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806492.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p><strong>è®¾ç½®<strong><strong>è™šæ‹Ÿæœº</strong></strong>æ ˆ<strong><strong>å†…å­˜</strong></strong>å¤§å°</strong>ï¼š</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806444.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><h4 id="_2-3-çº¿ç¨‹è¿è¡Œè¯Šæ–­" tabindex="-1"><a class="header-anchor" href="#_2-3-çº¿ç¨‹è¿è¡Œè¯Šæ–­"><span>2.3 çº¿ç¨‹è¿è¡Œè¯Šæ–­</span></a></h4><p>æ¡ˆä¾‹ï¼šCPUå ç”¨è¿‡é«˜</p><p>Linuxç¯å¢ƒä¸‹è¿è¡ŒæŸäº›ç¨‹åºçš„æ—¶å€™ï¼Œå¯èƒ½å¯¼è‡´CPUçš„å ç”¨è¿‡é«˜ï¼Œè¿™æ—¶éœ€è¦å®šä½å ç”¨CPUè¿‡é«˜çš„çº¿ç¨‹</p><ul><li>ç”¨<code>top</code>å®šä½å“ªä¸ªè¿›ç¨‹å¯¹cpuçš„å ç”¨è¿‡é«˜</li><li><code>ps H -eo pid,tid,%cpu | grep è¿›ç¨‹id</code> ï¼Œåˆšæ‰é€šè¿‡topæŸ¥åˆ°çš„è¿›ç¨‹å·ï¼Œç”¨pså‘½ä»¤è¿›ä¸€æ­¥å®šä½æ˜¯å“ªä¸ªçº¿ç¨‹å¼•èµ·çš„cpuå ç”¨è¿‡é«˜</li><li><code>jstack è¿›ç¨‹id</code>ï¼Œé€šè¿‡æŸ¥çœ‹è¿›ç¨‹ä¸­çš„çº¿ç¨‹çš„nidï¼Œåˆšæ‰é€šè¿‡pså‘½ä»¤çœ‹åˆ°çš„tidæ¥<strong>å¯¹æ¯”å®šä½</strong>ï¼Œæ³¨æ„jstackæŸ¥æ‰¾å‡ºçš„çº¿ç¨‹idæ˜¯<strong>16è¿›åˆ¶çš„</strong>ï¼Œ<strong>éœ€è¦è½¬æ¢</strong></li></ul><h2 id="_3-æœ¬åœ°æ–¹æ³•æ ˆ" tabindex="-1"><a class="header-anchor" href="#_3-æœ¬åœ°æ–¹æ³•æ ˆ"><span>3.æœ¬åœ°æ–¹æ³•æ ˆ</span></a></h2><p>ä¸€äº›å¸¦æœ‰<strong>nativeå…³é”®å­—</strong>çš„æ–¹æ³•å°±æ˜¯éœ€è¦JAVAå»è°ƒç”¨æœ¬åœ°çš„Cæˆ–è€…C++æ–¹æ³•ï¼Œå› ä¸ºJAVAæœ‰æ—¶å€™æ²¡æ³•ç›´æ¥å’Œæ“ä½œç³»ç»Ÿåº•å±‚äº¤äº’ï¼Œæ‰€ä»¥éœ€è¦ç”¨åˆ°æœ¬åœ°æ–¹æ³•ã€‚</p><h2 id="_4-å †" tabindex="-1"><a class="header-anchor" href="#_4-å †"><span>4.å †</span></a></h2><h4 id="_4-1-å®šä¹‰" tabindex="-1"><a class="header-anchor" href="#_4-1-å®šä¹‰"><span>4.1 å®šä¹‰</span></a></h4><p>é€šè¿‡<strong>newå…³é”®å­—åˆ›å»ºçš„å¯¹è±¡</strong>éƒ½ä¼šä½¿ç”¨å †å†…å­˜</p><h4 id="_4-2ç‰¹ç‚¹" tabindex="-1"><a class="header-anchor" href="#_4-2ç‰¹ç‚¹"><span>4.2ç‰¹ç‚¹</span></a></h4><ul><li>å®ƒæ˜¯<strong>çº¿ç¨‹å…±äº«</strong>çš„ï¼Œå †ä¸­å¯¹è±¡éƒ½éœ€è¦è€ƒè™‘çº¿ç¨‹å®‰å…¨çš„é—®é¢˜</li><li>æœ‰åƒåœ¾å›æ”¶æœºåˆ¶</li></ul><h4 id="_4-3å †å†…å­˜æº¢å‡º" tabindex="-1"><a class="header-anchor" href="#_4-3å †å†…å­˜æº¢å‡º"><span>4.3å †å†…å­˜æº¢å‡º</span></a></h4><p><code>java.lang.OutofMemoryError ï¼šjava heap space</code> å †å†…å­˜æº¢å‡º</p><p>æ¡ˆä¾‹ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">/**</span></span>
<span class="line"><span style="color:#616E88;"> * æ¼”ç¤ºå †å†…å­˜æº¢å‡º java.lang.OutOfMemoryError: Java heap space</span></span>
<span class="line"><span style="color:#616E88;"> * -Xmx8m ï¼Œæœ€å¤§å †ç©ºé—´çš„jvmè™šæ‹Ÿæœºå‚æ•°ï¼Œé»˜è®¤æ˜¯4g</span></span>
<span class="line"><span style="color:#616E88;"> */</span></span>
<span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> main1</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">        int</span><span style="color:#D8DEE9;"> i</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">        try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">            ArrayList</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9;"> list</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#8FBCBB;"> ArrayList</span><span style="color:#ECEFF4;">&lt;&gt;()</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;">// new ä¸€ä¸ªlist å­˜å…¥å †ä¸­</span></span>
<span class="line"><span style="color:#8FBCBB;">            String</span><span style="color:#D8DEE9;"> a</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">hello</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">            while</span><span style="color:#ECEFF4;"> (</span><span style="color:#81A1C1;">true</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">                list</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">add</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">a</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;">// ä¸æ–­åœ°å‘list ä¸­æ·»åŠ  a</span></span>
<span class="line"><span style="color:#D8DEE9FF;">                a </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> a </span><span style="color:#81A1C1;">+</span><span style="color:#D8DEE9FF;"> a</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">                i</span><span style="color:#81A1C1;">++;</span></span>
<span class="line"><span style="color:#ECEFF4;">            }</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span><span style="color:#81A1C1;"> catch</span><span style="color:#ECEFF4;"> (</span><span style="color:#8FBCBB;">Throwable</span><span style="color:#D8DEE9;"> e</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span><span style="color:#616E88;">// list ä½¿ç”¨ç»“æŸï¼Œè¢«jc åƒåœ¾å›æ”¶</span></span>
<span class="line"><span style="color:#D8DEE9;">            e</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">printStackTrace</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">            System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">i</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç»“æœï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9;">java</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">lang</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">OutOfMemoryError</span><span style="color:#81A1C1;">:</span><span style="color:#8FBCBB;"> Java</span><span style="color:#D8DEE9FF;"> heap space</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        at </span><span style="color:#D8DEE9;">java</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">util</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">Arrays</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">copyOf</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">Arrays</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">java</span><span style="color:#81A1C1;">:</span><span style="color:#B48EAD;">3332</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        at </span><span style="color:#D8DEE9;">java</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">lang</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">AbstractStringBuilder</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">ensureCapacityInternal</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">AbstractStringBuilder</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">java</span><span style="color:#81A1C1;">:</span><span style="color:#B48EAD;">124</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        at </span><span style="color:#D8DEE9;">java</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">lang</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">AbstractStringBuilder</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">append</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">AbstractStringBuilder</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">java</span><span style="color:#81A1C1;">:</span><span style="color:#B48EAD;">448</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        at </span><span style="color:#D8DEE9;">java</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">lang</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">StringBuilder</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">append</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">StringBuilder</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">java</span><span style="color:#81A1C1;">:</span><span style="color:#B48EAD;">136</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        at </span><span style="color:#D8DEE9;">com</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">itcast</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">itheima</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">xpp</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">main1</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">main</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">main1</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">java</span><span style="color:#81A1C1;">:</span><span style="color:#B48EAD;">14</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"><span style="color:#B48EAD;">22</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4-4å †å†…å­˜è¯Šæ–­" tabindex="-1"><a class="header-anchor" href="#_4-4å †å†…å­˜è¯Šæ–­"><span>4.4å †å†…å­˜è¯Šæ–­</span></a></h4><ol><li><strong>jps</strong> <strong>å·¥å…·</strong></li></ol><p>æŸ¥çœ‹å½“å‰ç³»ç»Ÿä¸­æœ‰å“ªäº› java è¿›ç¨‹</p><ol><li><strong>jmap å·¥å…·</strong></li></ol><p>æŸ¥çœ‹å †å†…å­˜å ç”¨æƒ…å†µ <code>jmap - heap è¿›ç¨‹id</code></p><ol><li><strong>jconsole å·¥å…·</strong></li></ol><p>å›¾å½¢ç•Œé¢çš„ï¼Œå¤šåŠŸèƒ½çš„ç›‘æµ‹å·¥å…·ï¼Œå¯ä»¥è¿ç»­ç›‘æµ‹</p><ol><li>jvisualvm å·¥å…·</li></ol><h2 id="_5-æ–¹æ³•åŒº" tabindex="-1"><a class="header-anchor" href="#_5-æ–¹æ³•åŒº"><span>5.æ–¹æ³•åŒº</span></a></h2><h4 id="_5-1-å®šä¹‰" tabindex="-1"><a class="header-anchor" href="#_5-1-å®šä¹‰"><span>5.1 å®šä¹‰</span></a></h4><p>Java è™šæ‹Ÿæœºæœ‰ä¸€ä¸ªåœ¨æ‰€æœ‰ Java è™šæ‹Ÿæœºçº¿ç¨‹ä¹‹é—´å…±äº«çš„æ–¹æ³•åŒºåŸŸã€‚æ–¹æ³•åŒºåŸŸç±»ä¼¼äºç”¨äºä¼ ç»Ÿè¯­è¨€çš„ç¼–è¯‘ä»£ç çš„å­˜å‚¨åŒºåŸŸï¼Œæˆ–è€…ç±»ä¼¼äºæ“ä½œç³»ç»Ÿè¿›ç¨‹ä¸­çš„â€œæ–‡æœ¬â€æ®µã€‚å®ƒå­˜å‚¨æ¯ä¸ªç±»çš„ç»“æ„ï¼Œä¾‹å¦‚è¿è¡Œæ—¶å¸¸é‡æ± ã€å­—æ®µå’Œæ–¹æ³•æ•°æ®ï¼Œä»¥åŠæ–¹æ³•å’Œæ„é€ å‡½æ•°çš„ä»£ç ï¼ŒåŒ…æ‹¬ç‰¹æ®Šæ–¹æ³•ï¼Œç”¨äºç±»å’Œå®ä¾‹åˆå§‹åŒ–ä»¥åŠæ¥å£åˆå§‹åŒ–æ–¹æ³•åŒºåŸŸæ˜¯åœ¨è™šæ‹Ÿæœºå¯åŠ¨æ—¶åˆ›å»ºçš„ã€‚å°½ç®¡æ–¹æ³•åŒºåŸŸåœ¨é€»è¾‘ä¸Šæ˜¯å †çš„ä¸€éƒ¨åˆ†ï¼Œä½†ç®€å•çš„å®ç°å¯èƒ½ä¸ä¼šé€‰æ‹©åƒåœ¾æ”¶é›†æˆ–å‹ç¼©å®ƒã€‚æ­¤è§„èŒƒä¸å¼ºåˆ¶æŒ‡å®šæ–¹æ³•åŒºçš„ä½ç½®æˆ–ç”¨äºç®¡ç†å·²ç¼–è¯‘ä»£ç çš„ç­–ç•¥ã€‚æ–¹æ³•åŒºåŸŸå¯ä»¥å…·æœ‰å›ºå®šçš„å¤§å°ï¼Œæˆ–è€…å¯ä»¥æ ¹æ®è®¡ç®—çš„éœ€è¦è¿›è¡Œæ‰©å±•ï¼Œå¹¶ä¸”å¦‚æœä¸éœ€è¦æ›´å¤§çš„æ–¹æ³•åŒºåŸŸï¼Œåˆ™å¯ä»¥æ”¶ç¼©ã€‚æ–¹æ³•åŒºåŸŸçš„å†…å­˜ä¸éœ€è¦æ˜¯è¿ç»­çš„ï¼</p><h4 id="_5-2-ç»„æˆ" tabindex="-1"><a class="header-anchor" href="#_5-2-ç»„æˆ"><span>5.2 ç»„æˆ</span></a></h4><ul><li><strong>æ°¸ä¹…ä»£</strong>ç”¨çš„<strong>å †å†…å­˜</strong></li><li><strong>å…ƒç©ºé—´</strong>ç”¨çš„<strong>æœ¬åœ°****å†…å­˜</strong></li></ul><p>Hotspot è™šæ‹Ÿæœº jdk1.6 1.7 1.8 å†…å­˜ç»“æ„å›¾</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806556.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><h4 id="_5-3-æ–¹æ³•åŒºå†…å­˜æº¢å‡º" tabindex="-1"><a class="header-anchor" href="#_5-3-æ–¹æ³•åŒºå†…å­˜æº¢å‡º"><span>5.3 æ–¹æ³•åŒºå†…å­˜æº¢å‡º</span></a></h4><ul><li>1.8ä»¥å‰ä¼šå¯¼è‡´<strong>æ°¸ä¹…ä»£</strong>å†…å­˜æº¢å‡º<code>java.lang.OutOfMemoryError: PermGen space</code></li><li>1.8ä»¥åä¼šå¯¼è‡´<strong>å…ƒç©ºé—´</strong>å†…å­˜æº¢å‡º<code>java.lang.OutOfMemoryError: Metaspace</code></li><li>1.8 ä¹‹å‰ä¼šå¯¼è‡´æ°¸ä¹…ä»£å†…å­˜æº¢å‡º <ul><li>ä½¿ç”¨ -XX:MaxPermSize=8m æŒ‡å®šæ°¸ä¹…ä»£å†…å­˜å¤§å°</li></ul></li><li>1.8 ä¹‹åä¼šå¯¼è‡´å…ƒç©ºé—´å†…å­˜æº¢å‡º <ul><li>ä½¿ç”¨ -XX:MaxMetaspaceSize=8m æŒ‡å®šå…ƒç©ºé—´å¤§å°</li></ul></li></ul><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">/**</span></span>
<span class="line"><span style="color:#616E88;"> * æ¼”ç¤ºå…ƒç©ºé—´å†…å­˜æº¢å‡º:java.lang.OutOfMemoryError: Metaspace</span></span>
<span class="line"><span style="color:#616E88;"> * -XX:MaxMetaspaceSize=8m</span></span>
<span class="line"><span style="color:#616E88;"> */</span></span>
<span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> main1</span><span style="color:#81A1C1;"> extends</span><span style="color:#8FBCBB;font-weight:bold;"> ClassLoader</span><span style="color:#ECEFF4;"> {</span><span style="color:#616E88;">//å¯ä»¥ç”¨æ¥åŠ è½½ç±»çš„äºŒè¿›åˆ¶å­—èŠ‚ç </span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">        int</span><span style="color:#D8DEE9;"> j</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">        try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9FF;">            main1 test </span><span style="color:#81A1C1;">=</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> main1</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">            for</span><span style="color:#ECEFF4;"> (</span><span style="color:#81A1C1;">int</span><span style="color:#D8DEE9;"> i</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> i </span><span style="color:#81A1C1;">&lt;</span><span style="color:#B48EAD;"> 10000</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> i</span><span style="color:#81A1C1;">++</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;">j</span><span style="color:#81A1C1;">++</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">                //ClassWriter ä½œç”¨æ˜¯ç”Ÿäº§ç±»çš„äºŒè¿›åˆ¶å­—èŠ‚ç </span></span>
<span class="line"><span style="color:#8FBCBB;">                ClassWriter</span><span style="color:#D8DEE9;"> cw</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> ClassWriter</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">0</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">                //ç‰ˆæœ¬å·ï¼Œpublicï¼Œç±»å</span></span>
<span class="line"><span style="color:#D8DEE9;">                cw</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">visit</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">Opcodes</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">V1_8</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> Opcodes</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">ACC_PUBLIC</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">Class</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;"> +</span><span style="color:#D8DEE9FF;"> i</span><span style="color:#ECEFF4;">,</span><span style="color:#81A1C1;"> null</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">java/lang/Object</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#81A1C1;"> null</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">                //è¿”å› byte[]</span></span>
<span class="line"><span style="color:#81A1C1;">                byte</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> code</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> cw</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">toByteArray</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">                //æ‰§è¡Œç±»çš„åŠ è½½</span></span>
<span class="line"><span style="color:#D8DEE9;">                test</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">defineClass</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Class</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;"> +</span><span style="color:#D8DEE9FF;"> i</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> code</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> code</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">length</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">            }</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span><span style="color:#81A1C1;"> finally</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">            System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">j</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#8FBCBB;">Exception</span><span style="color:#D8DEE9FF;"> in thread </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">main</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9;"> java</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">lang</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">OutOfMemoryError</span><span style="color:#81A1C1;">:</span><span style="color:#8FBCBB;"> Metaspace</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        at </span><span style="color:#D8DEE9;">java</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">lang</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">ClassLoader</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">defineClass1</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">Native</span><span style="color:#D8DEE9FF;"> Method</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        at </span><span style="color:#D8DEE9;">java</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">lang</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">ClassLoader</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">defineClass</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">ClassLoader</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">java</span><span style="color:#81A1C1;">:</span><span style="color:#B48EAD;">763</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        at </span><span style="color:#D8DEE9;">java</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">lang</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">ClassLoader</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">defineClass</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">ClassLoader</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">java</span><span style="color:#81A1C1;">:</span><span style="color:#B48EAD;">642</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        at </span><span style="color:#D8DEE9;">com</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">itcast</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">itheima</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">xpp</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">main1</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">main</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">main1</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">java</span><span style="color:#81A1C1;">:</span><span style="color:#B48EAD;">26</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"><span style="color:#B48EAD;">4865</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8FBCBB;">Process</span><span style="color:#D8DEE9FF;"> finished with exit code </span><span style="color:#B48EAD;">1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_5-4-é€šè¿‡åç¼–è¯‘æ¥æŸ¥çœ‹ç±»çš„ä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#_5-4-é€šè¿‡åç¼–è¯‘æ¥æŸ¥çœ‹ç±»çš„ä¿¡æ¯"><span>5.4 é€šè¿‡åç¼–è¯‘æ¥æŸ¥çœ‹ç±»çš„ä¿¡æ¯</span></a></h4><ul><li>è·å¾—å¯¹åº”ç±»çš„.classæ–‡ä»¶ï¼Œ<code>javac xxx.java</code><ul><li><p>åœ¨JDKå¯¹åº”çš„binç›®å½•ä¸‹è¿è¡Œcmdï¼Œ<strong>ä¹Ÿå¯ä»¥åœ¨IDEAæ§åˆ¶å°è¾“å…¥</strong></p></li><li><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806505.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure></li><li><p>è¾“å…¥ <strong>javac</strong> <strong>å¯¹åº”ç±»çš„ç»å¯¹è·¯å¾„</strong></p></li><li><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;">F</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;">\JAVA\</span><span style="color:#D8DEE9;">JDK8</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">0</span><span style="color:#D8DEE9FF;">\bin</span><span style="color:#81A1C1;">&gt;</span><span style="color:#D8DEE9FF;">javac F</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;">\Thread_study\src\com\nyima\JVM\day01\</span><span style="color:#D8DEE9;">Main</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">java</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>è¾“å…¥å®Œæˆåï¼Œå¯¹åº”çš„ç›®å½•ä¸‹å°±ä¼šå‡ºç°ç±»çš„.classæ–‡ä»¶</p></li></ul></li><li>åœ¨æ§åˆ¶å°è¾“å…¥ <code>javap -v ç±»çš„ç»å¯¹è·¯å¾„</code></li></ul><div class="language-plain line-numbers-mode" data-highlighter="shiki" data-ext="plain" data-title="plain" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span>javap -v F:\Thread_study\src\com\nyima\JVM\day01\Main.class</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>ç„¶åèƒ½åœ¨æ§åˆ¶å°çœ‹åˆ°åç¼–è¯‘ä»¥åç±»çš„ä¿¡æ¯äº† <ul><li><p>ç±»çš„åŸºæœ¬ä¿¡æ¯</p></li><li><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806336.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure></li><li><p>å¸¸é‡æ± </p></li><li><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806606.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure></li><li><p>è™šæ‹Ÿæœºä¸­æ‰§è¡Œç¼–è¯‘çš„æ–¹æ³•ï¼ˆæ¡†å†…çš„æ˜¯çœŸæ­£ç¼–è¯‘æ‰§è¡Œçš„å†…å®¹ï¼Œ<strong>#å·çš„å†…å®¹éœ€è¦åœ¨<strong><strong>å¸¸é‡æ± </strong></strong>ä¸­æŸ¥æ‰¾</strong>ï¼‰</p></li><li><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806528.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure></li></ul></li></ul><h4 id="_5-5-è¿è¡Œæ—¶å¸¸é‡æ± " tabindex="-1"><a class="header-anchor" href="#_5-5-è¿è¡Œæ—¶å¸¸é‡æ± "><span>5.5 è¿è¡Œæ—¶å¸¸é‡æ± </span></a></h4><ul><li><strong>å¸¸é‡æ± </strong>ï¼šå°±æ˜¯ä¸€å¼ è¡¨ï¼Œè™šæ‹ŸæœºæŒ‡ä»¤æ ¹æ®è¿™å¼ å¸¸é‡è¡¨æ‰¾åˆ°è¦æ‰§è¡Œçš„ç±»åã€æ–¹æ³•åã€å‚æ•°ç±»å‹ã€å­—é¢é‡ç­‰ä¿¡æ¯</li><li><strong>è¿è¡Œæ—¶å¸¸é‡æ± </strong>ï¼šå¸¸é‡æ± æ˜¯ *.class æ–‡ä»¶ä¸­çš„ï¼Œå½“è¯¥ç±»è¢«åŠ è½½ï¼Œå®ƒçš„å¸¸é‡æ± ä¿¡æ¯å°±ä¼šæ”¾å…¥è¿è¡Œæ—¶å¸¸é‡æ± ï¼Œå¹¶æŠŠé‡Œé¢çš„ç¬¦å·åœ°å€å˜ä¸ºçœŸå®åœ°å€</li></ul><h4 id="_5-6-å¸¸é‡æ± ä¸ä¸²æ± stringtableçš„å…³ç³»" tabindex="-1"><a class="header-anchor" href="#_5-6-å¸¸é‡æ± ä¸ä¸²æ± stringtableçš„å…³ç³»"><span>5.6 å¸¸é‡æ± ä¸ä¸²æ± StringTableçš„å…³ç³»</span></a></h4><p><strong>StringTable ç‰¹æ€§</strong></p><ul><li>å¸¸é‡æ± ä¸­çš„å­—ç¬¦ä¸²ä»…æ˜¯ç¬¦å·ï¼Œåªæœ‰<strong>åœ¨è¢«ç”¨åˆ°æ—¶æ‰ä¼šè½¬åŒ–ä¸ºå¯¹è±¡</strong></li><li>åˆ©ç”¨ä¸²æ± çš„æœºåˆ¶ï¼Œæ¥é¿å…é‡å¤åˆ›å»ºå­—ç¬¦ä¸²å¯¹è±¡</li><li>å­—ç¬¦ä¸²<strong>å˜é‡</strong>æ‹¼æ¥çš„åŸç†æ˜¯<strong>StringBuilder</strong></li><li>å­—ç¬¦ä¸²<strong>å¸¸é‡</strong>æ‹¼æ¥çš„åŸç†æ˜¯<strong>ç¼–è¯‘å™¨ä¼˜åŒ–</strong></li><li>å¯ä»¥ä½¿ç”¨<strong>internæ–¹æ³•</strong>ï¼Œä¸»åŠ¨å°†ä¸²æ± ä¸­è¿˜æ²¡æœ‰çš„å­—ç¬¦ä¸²å¯¹è±¡æ”¾å…¥ä¸²æ± ä¸­ <ul><li>1.8 å°†è¿™ä¸ªå­—ç¬¦ä¸²å¯¹è±¡å°è¯•æ”¾å…¥ä¸²æ± ï¼Œå¦‚æœæœ‰åˆ™å¹¶ä¸ä¼šæ”¾å…¥ï¼Œå¦‚æœæ²¡æœ‰åˆ™æ”¾å…¥ä¸²æ± ï¼Œä¼šæŠŠä¸²æ± ä¸­çš„å¯¹è±¡è¿”å›</li><li>1.6 å°†è¿™ä¸ªå­—ç¬¦ä¸²å¯¹è±¡å°è¯•æ”¾å…¥ä¸²æ± ï¼Œå¦‚æœæœ‰åˆ™å¹¶ä¸ä¼šæ”¾å…¥ï¼Œå¦‚æœæ²¡æœ‰ä¼šæŠŠæ­¤å¯¹è±¡å¤åˆ¶ä¸€ä»½ï¼Œæ”¾å…¥ä¸²æ± ï¼Œä¼šæŠŠä¸²æ± ä¸­çš„å¯¹è±¡è¿”å›</li></ul></li></ul><p><strong>æ —å­1</strong>ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> StringTableStudy</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">        public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">                String</span><span style="color:#D8DEE9;"> a</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">a</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#8FBCBB;">                String</span><span style="color:#D8DEE9;"> b</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">b</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#8FBCBB;">                String</span><span style="color:#D8DEE9;"> ab</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">ab</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¸¸é‡æ± ä¸­çš„ä¿¡æ¯ï¼Œéƒ½ä¼šè¢«åŠ è½½åˆ°è¿è¡Œæ—¶å¸¸é‡æ± ä¸­ï¼Œä½†è¿™æ˜¯a b ab ä»…æ˜¯å¸¸é‡æ± ä¸­çš„ç¬¦å·ï¼Œ<strong>è¿˜æ²¡æœ‰æˆä¸ºjavaå­—ç¬¦ä¸²</strong></p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#B48EAD;">0</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> ldc           #</span><span style="color:#B48EAD;">2</span><span style="color:#616E88;">                  // String a</span></span>
<span class="line"><span style="color:#B48EAD;">2</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> astore_1</span></span>
<span class="line"><span style="color:#B48EAD;">3</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> ldc           #</span><span style="color:#B48EAD;">3</span><span style="color:#616E88;">                  // String b</span></span>
<span class="line"><span style="color:#B48EAD;">5</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> astore_2</span></span>
<span class="line"><span style="color:#B48EAD;">6</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> ldc           #</span><span style="color:#B48EAD;">4</span><span style="color:#616E88;">                  // String ab</span></span>
<span class="line"><span style="color:#B48EAD;">8</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> astore_3</span></span>
<span class="line"><span style="color:#B48EAD;">9</span><span style="color:#81A1C1;">:</span><span style="color:#81A1C1;"> return</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å½“æ‰§è¡Œåˆ° ldc #2 æ—¶ï¼Œä¼šæŠŠç¬¦å· a å˜ä¸º â€œaâ€ å­—ç¬¦ä¸²å¯¹è±¡ï¼Œ<strong>å¹¶æ”¾å…¥ä¸²æ± ä¸­</strong>ï¼ˆhashtableç»“æ„ ä¸å¯æ‰©å®¹ï¼‰</p><p>å½“æ‰§è¡Œåˆ° ldc #3 æ—¶ï¼Œä¼šæŠŠç¬¦å· b å˜ä¸º â€œbâ€ å­—ç¬¦ä¸²å¯¹è±¡ï¼Œå¹¶æ”¾å…¥ä¸²æ± ä¸­</p><p>å½“æ‰§è¡Œåˆ° ldc #4 æ—¶ï¼Œä¼šæŠŠç¬¦å· ab å˜ä¸º â€œabâ€ å­—ç¬¦ä¸²å¯¹è±¡ï¼Œå¹¶æ”¾å…¥ä¸²æ± ä¸­</p><p>æœ€ç»ˆ<strong>StringTable [â€œaâ€, â€œbâ€, â€œ<strong><strong>ab</strong></strong>â€]</strong></p><p><strong>æ³¨æ„</strong>ï¼šå­—ç¬¦ä¸²å¯¹è±¡çš„åˆ›å»ºéƒ½æ˜¯<strong>æ‡’æƒ°çš„</strong>ï¼Œåªæœ‰å½“è¿è¡Œåˆ°é‚£ä¸€è¡Œå­—ç¬¦ä¸²ä¸”åœ¨ä¸²æ± ä¸­ä¸å­˜åœ¨çš„æ—¶å€™ï¼ˆå¦‚ ldc #2ï¼‰æ—¶ï¼Œè¯¥å­—ç¬¦ä¸²æ‰ä¼šè¢«åˆ›å»ºå¹¶æ”¾å…¥ä¸²æ± ä¸­ã€‚</p><p><strong>æ —å­2</strong>ï¼šä½¿ç”¨æ‹¼æ¥<strong>å­—ç¬¦ä¸²****å˜é‡å¯¹è±¡</strong>åˆ›å»ºå­—ç¬¦ä¸²çš„è¿‡ç¨‹</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> HelloWorld</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">        String</span><span style="color:#D8DEE9;"> s1</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">a</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#8FBCBB;">        String</span><span style="color:#D8DEE9;"> s2</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">b</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#8FBCBB;">        String</span><span style="color:#D8DEE9;"> s3</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">ab</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#8FBCBB;">        String</span><span style="color:#D8DEE9;"> s4</span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;">s1</span><span style="color:#81A1C1;">+</span><span style="color:#D8DEE9FF;">s2</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;">//new StringBuilder().append(&quot;a&quot;).append(&quot;2&quot;).toString()  new String(&quot;ab&quot;)</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">s3</span><span style="color:#81A1C1;">==</span><span style="color:#D8DEE9FF;">s4</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;">//false</span></span>
<span class="line"><span style="color:#616E88;">//ç»“æœä¸ºfalse,å› ä¸ºs3æ˜¯å­˜åœ¨äºä¸²æ± ä¹‹ä¸­ï¼Œs4æ˜¯ç”±StringBufferçš„toStringæ–¹æ³•æ‰€è¿”å›çš„ä¸€ä¸ªå¯¹è±¡ï¼Œå­˜åœ¨äºå †å†…å­˜ä¹‹ä¸­</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åç¼–è¯‘åçš„ç»“æœ</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;">         Code</span><span style="color:#81A1C1;">:</span></span>
<span class="line"><span style="color:#D8DEE9FF;">      stack</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">2</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> locals</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">5</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> args_size</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">1</span></span>
<span class="line"><span style="color:#B48EAD;">         0</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> ldc           #</span><span style="color:#B48EAD;">2</span><span style="color:#616E88;">                  // String a</span></span>
<span class="line"><span style="color:#B48EAD;">         2</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> astore_1</span></span>
<span class="line"><span style="color:#B48EAD;">         3</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> ldc           #</span><span style="color:#B48EAD;">3</span><span style="color:#616E88;">                  // String b</span></span>
<span class="line"><span style="color:#B48EAD;">         5</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> astore_2</span></span>
<span class="line"><span style="color:#B48EAD;">         6</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> ldc           #</span><span style="color:#B48EAD;">4</span><span style="color:#616E88;">                  // String ab</span></span>
<span class="line"><span style="color:#B48EAD;">         8</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> astore_3</span></span>
<span class="line"><span style="color:#B48EAD;">         9</span><span style="color:#81A1C1;">:</span><span style="color:#81A1C1;"> new</span><span style="color:#D8DEE9FF;">           #5                  </span><span style="color:#616E88;">// class java/lang/StringBuilder</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        12</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> dup</span></span>
<span class="line"><span style="color:#B48EAD;">        13</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> invokespecial #</span><span style="color:#B48EAD;">6</span><span style="color:#616E88;">                  // Method java/lang/StringBuilder.&quot;&lt;init&gt;&quot;:()V</span></span>
<span class="line"><span style="color:#B48EAD;">        16</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> aload_1</span></span>
<span class="line"><span style="color:#B48EAD;">        17</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> invokevirtual #</span><span style="color:#B48EAD;">7</span><span style="color:#616E88;">                  // Method java/lang/StringBuilder.append:(Ljava/lang/String</span></span>
<span class="line"><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;">)Ljava</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">lang</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">StringBuilder</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#B48EAD;">        20</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> aload_2</span></span>
<span class="line"><span style="color:#B48EAD;">        21</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> invokevirtual #</span><span style="color:#B48EAD;">7</span><span style="color:#616E88;">                  // Method java/lang/StringBuilder.append:(Ljava/lang/String</span></span>
<span class="line"><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;">)Ljava</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">lang</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">StringBuilder</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#B48EAD;">        24</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> invokevirtual #</span><span style="color:#B48EAD;">8</span><span style="color:#616E88;">                  // Method java/lang/StringBuilder.toString:()Ljava/lang/Str</span></span>
<span class="line"><span style="color:#D8DEE9FF;">ing</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#B48EAD;">        27</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> astore        </span><span style="color:#B48EAD;">4</span></span>
<span class="line"><span style="color:#B48EAD;">        29</span><span style="color:#81A1C1;">:</span><span style="color:#81A1C1;"> return</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>é€šè¿‡æ‹¼æ¥çš„æ–¹å¼æ¥åˆ›å»ºå­—ç¬¦ä¸²çš„<strong>è¿‡ç¨‹</strong>æ˜¯ï¼š<code>StringBuilder().append(â€œaâ€).append(â€œbâ€).toString()</code></li><li>æœ€åçš„toStringæ–¹æ³•çš„è¿”å›å€¼æ˜¯ä¸€ä¸ª<strong>æ–°çš„å­—ç¬¦ä¸²</strong>ï¼Œä½†å­—ç¬¦ä¸²çš„<strong>å€¼</strong>å’Œæ‹¼æ¥çš„å­—ç¬¦ä¸²ä¸€è‡´ï¼Œä½†æ˜¯ä¸¤ä¸ªä¸åŒçš„å­—ç¬¦ä¸²ï¼Œ<strong>ä¸€ä¸ªå­˜åœ¨äºä¸²æ± ä¹‹ä¸­ï¼Œä¸€ä¸ªå­˜åœ¨äº<strong><strong>å †å†…å­˜</strong></strong>ä¹‹ä¸­</strong></li></ul><p><strong>æ —å­3</strong>ï¼šä½¿ç”¨<strong>æ‹¼æ¥å­—ç¬¦ä¸²å¸¸é‡å¯¹è±¡</strong>çš„æ–¹æ³•åˆ›å»ºå­—ç¬¦ä¸²</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> HelloWorld</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">        String</span><span style="color:#D8DEE9;"> s1</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">a</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#8FBCBB;">        String</span><span style="color:#D8DEE9;"> s2</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">b</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#8FBCBB;">        String</span><span style="color:#D8DEE9;"> s3</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">ab</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#8FBCBB;">        String</span><span style="color:#D8DEE9;"> s4</span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;">s1</span><span style="color:#81A1C1;">+</span><span style="color:#D8DEE9FF;">s2</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;">//new StringBuilder().a|ppend(&quot;a&quot;).append(&quot;2&quot;).toString()  new String(&quot;ab&quot;)</span></span>
<span class="line"><span style="color:#8FBCBB;">        String</span><span style="color:#D8DEE9;"> s5</span><span style="color:#81A1C1;">=</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">a</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">+</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">b</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">s5</span><span style="color:#81A1C1;">==</span><span style="color:#D8DEE9FF;">s3</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;">//true</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åç¼–è¯‘åçš„ç»“æœ</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;">           Code</span><span style="color:#81A1C1;">:</span></span>
<span class="line"><span style="color:#D8DEE9FF;">      stack</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">2</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> locals</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">6</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> args_size</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">1</span></span>
<span class="line"><span style="color:#B48EAD;">         0</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> ldc           #</span><span style="color:#B48EAD;">2</span><span style="color:#616E88;">                  // String a</span></span>
<span class="line"><span style="color:#B48EAD;">         2</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> astore_1</span></span>
<span class="line"><span style="color:#B48EAD;">         3</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> ldc           #</span><span style="color:#B48EAD;">3</span><span style="color:#616E88;">                  // String b</span></span>
<span class="line"><span style="color:#B48EAD;">         5</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> astore_2</span></span>
<span class="line"><span style="color:#B48EAD;">         6</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> ldc           #</span><span style="color:#B48EAD;">4</span><span style="color:#616E88;">                  // String ab</span></span>
<span class="line"><span style="color:#B48EAD;">         8</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> astore_3</span></span>
<span class="line"><span style="color:#B48EAD;">         9</span><span style="color:#81A1C1;">:</span><span style="color:#81A1C1;"> new</span><span style="color:#D8DEE9FF;">           #5                  </span><span style="color:#616E88;">// class java/lang/StringBuilder</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        12</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> dup</span></span>
<span class="line"><span style="color:#B48EAD;">        13</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> invokespecial #</span><span style="color:#B48EAD;">6</span><span style="color:#616E88;">                  // Method java/lang/StringBuilder.&quot;&lt;init&gt;&quot;:()V</span></span>
<span class="line"><span style="color:#B48EAD;">        16</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> aload_1</span></span>
<span class="line"><span style="color:#B48EAD;">        17</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> invokevirtual #</span><span style="color:#B48EAD;">7</span><span style="color:#616E88;">                  // Method java/lang/StringBuilder.append:(Ljava/lang/String</span></span>
<span class="line"><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;">)Ljava</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">lang</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">StringBuilder</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#B48EAD;">        20</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> aload_2</span></span>
<span class="line"><span style="color:#B48EAD;">        21</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> invokevirtual #</span><span style="color:#B48EAD;">7</span><span style="color:#616E88;">                  // Method java/lang/StringBuilder.append:(Ljava/lang/String</span></span>
<span class="line"><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;">)Ljava</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">lang</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">StringBuilder</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#B48EAD;">        24</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> invokevirtual #</span><span style="color:#B48EAD;">8</span><span style="color:#616E88;">                  // Method java/lang/StringBuilder.toString:()Ljava/lang/Str</span></span>
<span class="line"><span style="color:#D8DEE9FF;">ing</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#B48EAD;">        27</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> astore        </span><span style="color:#B48EAD;">4</span></span>
<span class="line"><span style="color:#616E88;">        //ab3åˆå§‹åŒ–æ—¶ç›´æ¥ä»ä¸²æ± ä¸­è·å–å­—ç¬¦ä¸²</span></span>
<span class="line"><span style="color:#B48EAD;">        29</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> ldc           #</span><span style="color:#B48EAD;">4</span><span style="color:#616E88;">                  // String ab</span></span>
<span class="line"><span style="color:#B48EAD;">        31</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> astore        </span><span style="color:#B48EAD;">5</span></span>
<span class="line"><span style="color:#B48EAD;">        33</span><span style="color:#81A1C1;">:</span><span style="color:#81A1C1;"> return</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>ä½¿ç”¨<strong>æ‹¼æ¥å­—ç¬¦ä¸²å¸¸é‡</strong>çš„æ–¹æ³•æ¥åˆ›å»ºæ–°çš„å­—ç¬¦ä¸²æ—¶ï¼Œå› ä¸º<strong>å†…å®¹æ˜¯å¸¸é‡ï¼Œ<strong><strong>javac</strong></strong>åœ¨ç¼–è¯‘æœŸä¼šè¿›è¡Œä¼˜åŒ–ï¼Œç»“æœå·²åœ¨ç¼–è¯‘æœŸç¡®å®šä¸ºab</strong>ï¼Œè€Œåˆ›å»ºabçš„æ—¶å€™å·²ç»åœ¨ä¸²æ± ä¸­æ”¾å…¥äº†â€œabâ€ï¼Œæ‰€ä»¥s5ç›´æ¥ä»ä¸²æ± ä¸­è·å–å€¼ï¼Œæ‰€ä»¥è¿›è¡Œçš„æ“ä½œå’Œ s3= â€œabâ€ ä¸€è‡´ã€‚</li><li>ä½¿ç”¨<strong>æ‹¼æ¥å­—ç¬¦ä¸²å˜é‡</strong>çš„æ–¹æ³•æ¥åˆ›å»ºæ–°çš„å­—ç¬¦ä¸²æ—¶ï¼Œå› ä¸ºå†…å®¹æ˜¯å˜é‡ï¼Œåªèƒ½<strong>åœ¨è¿è¡ŒæœŸç¡®å®šå®ƒçš„å€¼ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨<strong><strong>StringBuilder</strong></strong>æ¥åˆ›å»º</strong></li></ul><p><strong>internæ–¹æ³• 1.8</strong>ï¼š</p><p>è°ƒç”¨å­—ç¬¦ä¸²å¯¹è±¡çš„internæ–¹æ³•ï¼Œä¼šå°†è¯¥å­—ç¬¦ä¸²å¯¹è±¡å°è¯•æ”¾å…¥åˆ°ä¸²æ± ä¸­</p><ul><li>å¦‚æœä¸²æ± ä¸­æ²¡æœ‰è¯¥å­—ç¬¦ä¸²å¯¹è±¡ï¼Œåˆ™æ”¾å…¥æˆåŠŸ</li><li>å¦‚æœæœ‰è¯¥å­—ç¬¦ä¸²å¯¹è±¡ï¼Œåˆ™æ”¾å…¥å¤±è´¥</li></ul><p>æ— è®ºæ”¾å…¥æ˜¯å¦æˆåŠŸï¼Œéƒ½ä¼šè¿”å›<strong>ä¸²æ± ä¸­</strong>çš„å­—ç¬¦ä¸²å¯¹è±¡</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> HelloWorld</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">        String</span><span style="color:#D8DEE9;"> x</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">ab</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#8FBCBB;">        String</span><span style="color:#D8DEE9;"> s</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> String</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">a</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> +</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> String</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">b</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8FBCBB;">        String</span><span style="color:#D8DEE9;"> s2</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> s</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">intern</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;">//å°†è¿™ä¸ªå­—ç¬¦ä¸²å¯¹è±¡å°è¯•æ”¾å…¥ä¸²æ± ï¼Œå¦‚æœæœ‰åˆ™å¹¶ä¸ä¼šæ”¾å…¥ï¼Œå¦‚æœæ²¡æœ‰åˆ™æ”¾å…¥ä¸²æ± ï¼Œè¿™ä¸¤ç§æƒ…å†µéƒ½ä¼šæŠŠä¸²æ± ä¸­çš„å¯¹è±¡è¿”å›</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">s2 </span><span style="color:#81A1C1;">==</span><span style="color:#D8DEE9FF;"> x</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;">//true</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">s </span><span style="color:#81A1C1;">==</span><span style="color:#D8DEE9FF;"> x</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;">//false</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="é¢è¯•é¢˜-string-str1-new-string-abc-å’Œstring-str2-abc-å’Œ-åŒºåˆ«" tabindex="-1"><a class="header-anchor" href="#é¢è¯•é¢˜-string-str1-new-string-abc-å’Œstring-str2-abc-å’Œ-åŒºåˆ«"><span><strong>é¢è¯•é¢˜ï¼šString str1 = new String(&quot;abc&quot;)å’ŒString str2 = &quot;abc&quot; å’Œ åŒºåˆ«ï¼Ÿ</strong></span></a></h5><p>ç­”ï¼šç¼–è¯‘å™¨åœ¨ç¼–è¯‘æœŸé—´ä¼šæŠŠabcä½œä¸ºå¸¸é‡æ”¾åœ¨å¸¸é‡æ± ä¸­ï¼Œè¿™ä¸¤ä¸ªè¯­å¥éƒ½ä¼šå»å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­æ£€æŸ¥æ˜¯å¦å·²ç»å­˜åœ¨ â€œabcâ€ï¼ŒåŒºåˆ«åœ¨äºnewä¼šåœ¨å †ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼ŒString str2 = &quot;abc&quot; è¿”å›å­—ç¬¦ä¸²å¸¸é‡æ± çš„å¼•ç”¨ã€‚</p><h5 id="é¢è¯•é¢˜-string-s-new-string-a-new-string-b" tabindex="-1"><a class="header-anchor" href="#é¢è¯•é¢˜-string-s-new-string-a-new-string-b"><span><strong>é¢è¯•é¢˜ï¼šString s = new String(&quot;a&quot;) + new String(&quot;b&quot;);</strong></span></a></h5><p><strong>String s3 = &quot;ab&quot;;</strong> <strong>String s4=s1+s2; //new</strong> <strong>StringBuilder</strong>**().a|ppend(&quot;a&quot;).append(&quot;2&quot;).toString() new String(&quot;ab&quot;)** <strong>String s5=&quot;a&quot;+&quot;b&quot;;</strong></p><p>è¿™ç±»é¢˜è®°ä½ç¼–è¯‘å™¨åœ¨ç¼–è¯‘æœŸé—´ä¼šæŠŠå­—ç¬¦å­—é¢é‡ä½œä¸ºå¸¸é‡æ”¾åœ¨å¸¸é‡æ± ä¸­ï¼Œå¦‚æœæ“ä½œçš„æ˜¯å¯¹è±¡å’Œå˜é‡æ˜¯ä¸ä¼šæ”¾å…¥å¸¸é‡æ± ä¸­çš„ã€‚</p><p><strong>internæ–¹æ³• 1.6</strong>ï¼š</p><p>è°ƒç”¨å­—ç¬¦ä¸²å¯¹è±¡çš„internæ–¹æ³•ï¼Œä¼šå°†è¯¥å­—ç¬¦ä¸²å¯¹è±¡å°è¯•æ”¾å…¥åˆ°ä¸²æ± ä¸­</p><ul><li>å¦‚æœä¸²æ± ä¸­æ²¡æœ‰è¯¥å­—ç¬¦ä¸²å¯¹è±¡ï¼Œä¼šå°†è¯¥å­—ç¬¦ä¸²å¯¹è±¡å¤åˆ¶ä¸€ä»½ï¼Œå†æ”¾å…¥åˆ°ä¸²æ± ä¸­</li><li>å¦‚æœæœ‰è¯¥å­—ç¬¦ä¸²å¯¹è±¡ï¼Œåˆ™æ”¾å…¥å¤±è´¥</li></ul><p>æ— è®ºæ”¾å…¥æ˜¯å¦æˆåŠŸï¼Œéƒ½ä¼šè¿”å›<strong>ä¸²æ± ä¸­</strong>çš„å­—ç¬¦ä¸²å¯¹è±¡</p><p><strong>é¢è¯•é¢˜ï¼ˆ1.8ï¼‰</strong>ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">package</span><span style="color:#8FBCBB;"> com</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">itcast</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">itheima</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">xpp</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> main</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8FBCBB;">        String</span><span style="color:#D8DEE9;"> s1</span><span style="color:#81A1C1;">=</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">a</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#8FBCBB;">        String</span><span style="color:#D8DEE9;"> s2</span><span style="color:#81A1C1;">=</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">b</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#8FBCBB;">        String</span><span style="color:#D8DEE9;"> s3</span><span style="color:#81A1C1;">=</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">a</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">+</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">b</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#8FBCBB;">        String</span><span style="color:#D8DEE9;"> s4</span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;">s1</span><span style="color:#81A1C1;">+</span><span style="color:#D8DEE9FF;">s2</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#8FBCBB;">        String</span><span style="color:#D8DEE9;"> s5</span><span style="color:#81A1C1;">=</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ab</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#8FBCBB;">        String</span><span style="color:#D8DEE9;"> s6</span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9;">s4</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">intern</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">s3</span><span style="color:#81A1C1;">==</span><span style="color:#D8DEE9FF;">s4</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;">//false</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">s3</span><span style="color:#81A1C1;">==</span><span style="color:#D8DEE9FF;">s5</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;">//true</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">s3</span><span style="color:#81A1C1;">==</span><span style="color:#D8DEE9FF;">s6</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;">//true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8FBCBB;">        String</span><span style="color:#D8DEE9;"> x2</span><span style="color:#81A1C1;">=new</span><span style="color:#88C0D0;"> String</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">c</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">+new</span><span style="color:#88C0D0;"> String</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">d</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#8FBCBB;">        String</span><span style="color:#D8DEE9;"> x1</span><span style="color:#81A1C1;">=</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">cd</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        x2</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">intern</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">x1</span><span style="color:#81A1C1;">==</span><span style="color:#D8DEE9FF;">x2</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;">//false</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#8FBCBB;">        String</span><span style="color:#D8DEE9;"> x4</span><span style="color:#81A1C1;">=new</span><span style="color:#88C0D0;"> String</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">e</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">+new</span><span style="color:#88C0D0;"> String</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">f</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        x4</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">intern</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#8FBCBB;">        String</span><span style="color:#D8DEE9;"> x3</span><span style="color:#81A1C1;">=</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ef</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">x3</span><span style="color:#81A1C1;">==</span><span style="color:#D8DEE9FF;">x4</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;">//true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_5-7-stringtable-ä½ç½®" tabindex="-1"><a class="header-anchor" href="#_5-7-stringtable-ä½ç½®"><span>5.7 StringTable ä½ç½®</span></a></h4><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806611.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><ul><li>JDK1.6 æ—¶ï¼ŒStringTableæ˜¯å±äº<strong>å¸¸é‡æ± </strong>çš„ä¸€éƒ¨åˆ†ã€‚</li><li>JDK1.8 ä»¥åï¼ŒStringTableæ˜¯æ”¾åœ¨<strong>å †</strong>ä¸­çš„ã€‚</li></ul><h4 id="_5-8-stringtable-åƒåœ¾å›æ”¶" tabindex="-1"><a class="header-anchor" href="#_5-8-stringtable-åƒåœ¾å›æ”¶"><span>5.8 StringTable åƒåœ¾å›æ”¶</span></a></h4><p>StringTableåœ¨å†…å­˜ç´§å¼ æ—¶ï¼Œä¼šå‘ç”Ÿåƒåœ¾å›æ”¶</p><p>-Xmx10m æŒ‡å®šå †å†…å­˜å¤§å° -XX:+PrintStringTableStatistics æ‰“å°å­—ç¬¦ä¸²å¸¸é‡æ± ä¿¡æ¯ -XX:+PrintGCDetails -verbose:gc æ‰“å° gc çš„æ¬¡æ•°ï¼Œè€—è´¹æ—¶é—´ç­‰ä¿¡æ¯</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">/**</span></span>
<span class="line"><span style="color:#616E88;"> * æ¼”ç¤º StringTable åƒåœ¾å›æ”¶</span></span>
<span class="line"><span style="color:#616E88;"> * -Xmx10m -XX:+PrintStringTableStatistics -XX:+PrintGCDetails -verbose:gc</span></span>
<span class="line"><span style="color:#616E88;"> */</span></span>
<span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Code_05_StringTableTest</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">        int</span><span style="color:#D8DEE9;"> i</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">        try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">            for</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">int</span><span style="color:#D8DEE9;"> j</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> j </span><span style="color:#81A1C1;">&lt;</span><span style="color:#B48EAD;"> 10000</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> j</span><span style="color:#81A1C1;">++</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span><span style="color:#616E88;"> // j = 100, j = 10000</span></span>
<span class="line"><span style="color:#D8DEE9;">                String</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">valueOf</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">j</span><span style="color:#ECEFF4;">).</span><span style="color:#88C0D0;">intern</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">                i</span><span style="color:#81A1C1;">++;</span></span>
<span class="line"><span style="color:#ECEFF4;">            }</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span><span style="color:#81A1C1;">catch</span><span style="color:#ECEFF4;"> (</span><span style="color:#8FBCBB;">Exception</span><span style="color:#D8DEE9;"> e</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">            e</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">printStackTrace</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span><span style="color:#81A1C1;">finally</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">            System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">i</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_5-9-stringtable-æ€§èƒ½è°ƒä¼˜" tabindex="-1"><a class="header-anchor" href="#_5-9-stringtable-æ€§èƒ½è°ƒä¼˜"><span>5.9 StringTable æ€§èƒ½è°ƒä¼˜</span></a></h4><ul><li>å› ä¸ºStringTableæ˜¯ç”±HashTableå®ç°çš„ï¼Œæ‰€ä»¥å¯ä»¥é€‚å½“å¢åŠ HashTableæ¡¶çš„ä¸ªæ•°ï¼Œæ¥å‡å°‘å­—ç¬¦ä¸²æ”¾å…¥ä¸²æ± æ‰€éœ€è¦çš„æ—¶é—´</li></ul><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">-</span><span style="color:#D8DEE9FF;">XX</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;">StringTableSize</span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;">æ¡¶ä¸ªæ•°ï¼ˆæœ€å°‘è®¾ç½®ä¸º </span><span style="color:#B48EAD;">1009</span><span style="color:#D8DEE9FF;"> ä»¥ä¸Šï¼‰</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>è€ƒè™‘æ˜¯å¦éœ€è¦å°†å­—ç¬¦ä¸²å¯¹è±¡å…¥æ±  å¯ä»¥é€šè¿‡ intern æ–¹æ³•å‡å°‘é‡å¤å…¥æ± </li></ul><h2 id="_6-ç›´æ¥å†…å­˜" tabindex="-1"><a class="header-anchor" href="#_6-ç›´æ¥å†…å­˜"><span>6.ç›´æ¥å†…å­˜</span></a></h2><h4 id="_6-1-å®šä¹‰" tabindex="-1"><a class="header-anchor" href="#_6-1-å®šä¹‰"><span>6.1 å®šä¹‰</span></a></h4><ul><li>å±äºæ“ä½œç³»ç»Ÿï¼Œå¸¸è§äºNIOæ“ä½œæ—¶ï¼Œç”¨äºæ•°æ®ç¼“å†²åŒº</li><li>åˆ†é…å›æ”¶æˆæœ¬è¾ƒé«˜ï¼Œä½†è¯»å†™æ€§èƒ½é«˜</li><li>ä¸å—JVMå†…å­˜å›æ”¶ç®¡ç†</li></ul><h4 id="_6-2-ä½¿ç”¨ç›´æ¥å†…å­˜çš„å¥½å¤„" tabindex="-1"><a class="header-anchor" href="#_6-2-ä½¿ç”¨ç›´æ¥å†…å­˜çš„å¥½å¤„"><span>6.2 ä½¿ç”¨ç›´æ¥å†…å­˜çš„å¥½å¤„</span></a></h4><p>æ–‡ä»¶è¯»å†™æµç¨‹ï¼š</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806759.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>å› ä¸º java ä¸èƒ½ç›´æ¥æ“ä½œæ–‡ä»¶ç®¡ç†ï¼Œéœ€è¦åˆ‡æ¢åˆ°å†…æ ¸æ€ï¼Œä½¿ç”¨æœ¬åœ°æ–¹æ³•è¿›è¡Œæ“ä½œï¼Œç„¶åè¯»å–ç£ç›˜æ–‡ä»¶ï¼Œä¼šåœ¨ç³»ç»Ÿå†…å­˜ä¸­åˆ›å»ºä¸€ä¸ªç¼“å†²åŒºï¼Œå°†æ•°æ®è¯»åˆ°ç³»ç»Ÿç¼“å†²åŒºï¼Œ ç„¶ååœ¨å°†ç³»ç»Ÿç¼“å†²åŒºæ•°æ®ï¼Œå¤åˆ¶åˆ° java å †å†…å­˜ä¸­ã€‚ç¼ºç‚¹æ˜¯æ•°æ®å­˜å‚¨äº†ä¸¤ä»½ï¼Œåœ¨ç³»ç»Ÿå†…å­˜ä¸­æœ‰ä¸€ä»½ï¼Œjava å †ä¸­æœ‰ä¸€ä»½ï¼Œé€ æˆäº†ä¸å¿…è¦çš„å¤åˆ¶ã€‚</p><p><strong>ä½¿ç”¨äº† DirectBuffer æ–‡ä»¶è¯»å–æµç¨‹</strong></p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806509.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>ç›´æ¥å†…å­˜æ˜¯æ“ä½œç³»ç»Ÿå’Œ Java ä»£ç éƒ½å¯ä»¥è®¿é—®çš„ä¸€å—åŒºåŸŸï¼Œæ— éœ€å°†ä»£ç ä»ç³»ç»Ÿå†…å­˜å¤åˆ¶åˆ° Java å †å†…å­˜ï¼Œä»è€Œæé«˜äº†æ•ˆç‡ã€‚</p><h4 id="ç›´æ¥å†…å­˜ä¹Ÿä¼šå¯¼è‡´å†…å­˜æº¢å‡º" tabindex="-1"><a class="header-anchor" href="#ç›´æ¥å†…å­˜ä¹Ÿä¼šå¯¼è‡´å†…å­˜æº¢å‡º"><span><strong>ç›´æ¥<strong><strong>å†…å­˜</strong></strong>ä¹Ÿä¼šå¯¼è‡´å†…å­˜æº¢å‡º</strong></span></a></h4><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Main</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    static</span><span style="color:#81A1C1;"> int</span><span style="color:#D8DEE9;"> _100MB</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 1024</span><span style="color:#81A1C1;"> *</span><span style="color:#B48EAD;"> 1024</span><span style="color:#81A1C1;"> *</span><span style="color:#B48EAD;"> 100</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> throws</span><span style="color:#8FBCBB;"> IOException</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">        List</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">ByteBuffer</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9;"> list</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#8FBCBB;"> ArrayList</span><span style="color:#ECEFF4;">&lt;&gt;()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">        int</span><span style="color:#D8DEE9;"> i</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">        try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">            while</span><span style="color:#ECEFF4;"> (</span><span style="color:#81A1C1;">true</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">                ByteBuffer</span><span style="color:#D8DEE9;"> byteBuffer</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> ByteBuffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">allocateDirect</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">_100MB</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">                list</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">add</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">byteBuffer</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">                i</span><span style="color:#81A1C1;">++;</span></span>
<span class="line"><span style="color:#ECEFF4;">            }</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span><span style="color:#81A1C1;"> finally</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">            System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">i</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#616E88;">//è¾“å‡ºï¼š</span></span>
<span class="line"><span style="color:#B48EAD;">2</span></span>
<span class="line"><span style="color:#8FBCBB;">Exception</span><span style="color:#D8DEE9FF;"> in thread </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">main</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9;"> java</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">lang</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">OutOfMemoryError</span><span style="color:#81A1C1;">:</span><span style="color:#8FBCBB;"> Direct</span><span style="color:#D8DEE9FF;"> buffer memory</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        at </span><span style="color:#D8DEE9;">java</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">nio</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">Bits</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">reserveMemory</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">Bits</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">java</span><span style="color:#81A1C1;">:</span><span style="color:#B48EAD;">694</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        at </span><span style="color:#D8DEE9;">java</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">nio</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">DirectByteBuffer</span><span style="color:#ECEFF4;">.</span><span style="color:#81A1C1;">&lt;</span><span style="color:#D8DEE9FF;">init</span><span style="color:#81A1C1;">&gt;</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">DirectByteBuffer</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">java</span><span style="color:#81A1C1;">:</span><span style="color:#B48EAD;">123</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        at </span><span style="color:#D8DEE9;">java</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">nio</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">ByteBuffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">allocateDirect</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">ByteBuffer</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">java</span><span style="color:#81A1C1;">:</span><span style="color:#B48EAD;">311</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        at </span><span style="color:#D8DEE9;">main</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">Main</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">main</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">Main</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">java</span><span style="color:#81A1C1;">:</span><span style="color:#B48EAD;">19</span><span style="color:#ECEFF4;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ç›´æ¥<strong><strong>å†…å­˜</strong></strong>é‡Šæ”¾åŸç†</strong>ï¼š</p><p>ç›´æ¥å†…å­˜çš„å›æ”¶ä¸æ˜¯é€šè¿‡JVMçš„åƒåœ¾å›æ”¶æ¥é‡Šæ”¾çš„ï¼Œè€Œæ˜¯é€šè¿‡<code>unsafe.freeMemory</code>æ¥æ‰‹åŠ¨é‡Šæ”¾</p><p>é€šè¿‡ç”³è¯·ç›´æ¥å†…å­˜ï¼Œä½†JVMå¹¶ä¸èƒ½å›æ”¶ç›´æ¥å†…å­˜ä¸­çš„å†…å®¹ï¼Œå®ƒæ˜¯å¦‚ä½•å®ç°å›æ”¶çš„å‘¢ï¼Ÿ</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">//é€šè¿‡ByteBufferç”³è¯·1Mçš„ç›´æ¥å†…å­˜ByteBuffer byteBuffer = ByteBuffer.allocateDirect(_1M);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>allocateDirectçš„å®ç°</strong>ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> static</span><span style="color:#8FBCBB;"> ByteBuffer</span><span style="color:#88C0D0;"> allocateDirect</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">int</span><span style="color:#D8DEE9FF;"> capacity</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span><span style="color:#81A1C1;">return</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> DirectByteBuffer</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">capacity</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>DirectByteBufferç±»</strong>ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">DirectByteBuffer</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">int</span><span style="color:#D8DEE9FF;"> cap</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span><span style="color:#616E88;">   // package-private</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">    super</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">-</span><span style="color:#B48EAD;">1</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> cap</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> cap</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    boolean</span><span style="color:#D8DEE9;"> pa</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> VM</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isDirectMemoryPageAligned</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    int</span><span style="color:#D8DEE9;"> ps</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Bits</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">pageSize</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    long</span><span style="color:#D8DEE9;"> size</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Math</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">max</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">1L</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#81A1C1;">long</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;">cap </span><span style="color:#81A1C1;">+</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9FF;">pa </span><span style="color:#81A1C1;">?</span><span style="color:#D8DEE9FF;"> ps </span><span style="color:#81A1C1;">:</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;">))</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    Bits</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">reserveMemory</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">size</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> cap</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">    long</span><span style="color:#D8DEE9;"> base</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        base </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9;"> unsafe</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">allocateMemory</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">size</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> //ç”³è¯·å†…å­˜</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#81A1C1;"> catch</span><span style="color:#ECEFF4;"> (</span><span style="color:#8FBCBB;">OutOfMemoryError</span><span style="color:#D8DEE9;"> x</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">        Bits</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">unreserveMemory</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">size</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> cap</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">        throw</span><span style="color:#D8DEE9FF;"> x</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#D8DEE9;">    unsafe</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">setMemory</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">base</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> size</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#81A1C1;">byte</span><span style="color:#ECEFF4;">)</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9FF;">pa </span><span style="color:#81A1C1;">&amp;&amp;</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9FF;">base </span><span style="color:#81A1C1;">%</span><span style="color:#D8DEE9FF;"> ps </span><span style="color:#81A1C1;">!=</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;">))</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">        // Round up to page boundary</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        address </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> base </span><span style="color:#81A1C1;">+</span><span style="color:#D8DEE9FF;"> ps </span><span style="color:#81A1C1;">-</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9FF;">base </span><span style="color:#81A1C1;">&amp;</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9FF;">ps </span><span style="color:#81A1C1;">-</span><span style="color:#B48EAD;"> 1</span><span style="color:#ECEFF4;">))</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        address </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> base</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    cleaner </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9;"> Cleaner</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">create</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">this</span><span style="color:#ECEFF4;">,</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Deallocator</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">base</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> size</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> cap</span><span style="color:#ECEFF4;">))</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> //é€šè¿‡è™šå¼•ç”¨ï¼Œæ¥å®ç°ç›´æ¥å†…å­˜çš„é‡Šæ”¾ï¼Œthisä¸ºè™šå¼•ç”¨çš„å®é™…å¯¹è±¡</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    att </span><span style="color:#81A1C1;">=</span><span style="color:#81A1C1;"> null;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œè°ƒç”¨äº†ä¸€ä¸ªCleanerçš„createæ–¹æ³•ï¼Œä¸”åå°çº¿ç¨‹è¿˜ä¼šå¯¹è™šå¼•ç”¨çš„å¯¹è±¡ç›‘æµ‹ï¼Œå¦‚æœè™šå¼•ç”¨çš„å®é™…å¯¹è±¡ï¼ˆè¿™é‡Œæ˜¯DirectByteBufferï¼‰è¢«å›æ”¶ä»¥åï¼Œå°±ä¼šè°ƒç”¨Cleanerçš„cleanæ–¹æ³•ï¼Œæ¥æ¸…é™¤ç›´æ¥å†…å­˜ä¸­å ç”¨çš„å†…å­˜</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> clean</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#ECEFF4;"> (</span><span style="color:#88C0D0;">remove</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">this</span><span style="color:#ECEFF4;">))</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">        try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">            this</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">thunk</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">run</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> //è°ƒç”¨runæ–¹æ³•</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span><span style="color:#81A1C1;"> catch</span><span style="color:#ECEFF4;"> (</span><span style="color:#81A1C1;">final</span><span style="color:#8FBCBB;"> Throwable</span><span style="color:#D8DEE9;"> var2</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">            AccessController</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">doPrivileged</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">new</span><span style="color:#8FBCBB;"> PrivilegedAction</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">Void</span><span style="color:#ECEFF4;">&gt;()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">                public</span><span style="color:#8FBCBB;"> Void</span><span style="color:#88C0D0;"> run</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">                    if</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">err</span><span style="color:#81A1C1;"> !=</span><span style="color:#81A1C1;"> null</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">                        (</span><span style="color:#81A1C1;">new</span><span style="color:#88C0D0;"> Error</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Cleaner terminated abnormally</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#88C0D0;"> var2</span><span style="color:#ECEFF4;">)).</span><span style="color:#88C0D0;">printStackTrace</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">                    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">                    System</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">exit</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">1</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">                    return</span><span style="color:#81A1C1;"> null;</span></span>
<span class="line"><span style="color:#ECEFF4;">                }</span></span>
<span class="line"><span style="color:#ECEFF4;">            })</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>runæ–¹æ³•</strong>ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> run</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9FF;">address </span><span style="color:#81A1C1;">==</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">        // Paranoia</span></span>
<span class="line"><span style="color:#81A1C1;">        return;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#D8DEE9;">    unsafe</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">freeMemory</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">address</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> //é‡Šæ”¾ç›´æ¥å†…å­˜ä¸­å ç”¨çš„å†…å­˜</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    address </span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    Bits</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">unreserveMemory</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">size</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> capacity</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ç›´æ¥<strong><strong>å†…å­˜</strong></strong>çš„å›æ”¶æœºåˆ¶æ€»ç»“</strong>ï¼š</p><ul><li>ä½¿ç”¨äº† <code>Unsafe</code> å¯¹è±¡å®Œæˆç›´æ¥å†…å­˜çš„åˆ†é…å›æ”¶ï¼Œå¹¶ä¸”å›æ”¶éœ€è¦ä¸»åŠ¨è°ƒç”¨ <code>freeMemory</code> æ–¹æ³•</li><li><code>ByteBuffer</code> çš„å®ç°ç±»å†…éƒ¨ï¼Œä½¿ç”¨äº† <code>Cleaner</code> ï¼ˆè™šå¼•ç”¨ï¼‰æ¥ç›‘æµ‹ ByteBuffer å¯¹è±¡ï¼Œä¸€æ—¦ ByteBuffer å¯¹è±¡è¢«åƒåœ¾å›æ”¶ï¼Œé‚£ä¹ˆå°±ä¼šç”± <code>ReferenceHandler</code> çº¿ç¨‹é€šè¿‡ Cleaner çš„ clean æ–¹æ³•è°ƒ ç”¨ freeMemory æ¥é‡Šæ”¾ç›´æ¥å†…å­˜</li></ul><h4 id="_6-3-ç›´æ¥å†…å­˜å›æ”¶åŸç†" tabindex="-1"><a class="header-anchor" href="#_6-3-ç›´æ¥å†…å­˜å›æ”¶åŸç†"><span>6.3 ç›´æ¥å†…å­˜å›æ”¶åŸç†</span></a></h4><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Code_06_DirectMemoryTest</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> int</span><span style="color:#D8DEE9;"> _1GB</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 1024</span><span style="color:#81A1C1;"> *</span><span style="color:#B48EAD;"> 1024</span><span style="color:#81A1C1;"> *</span><span style="color:#B48EAD;"> 1024</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> throws</span><span style="color:#8FBCBB;"> IOException</span><span style="color:#ECEFF4;">,</span><span style="color:#8FBCBB;"> NoSuchFieldException</span><span style="color:#ECEFF4;">,</span><span style="color:#8FBCBB;"> IllegalAccessException</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">//        method();</span></span>
<span class="line"><span style="color:#88C0D0;">        method1</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // æ¼”ç¤º ç›´æ¥å†…å­˜ æ˜¯è¢« unsafe åˆ›å»ºä¸å›æ”¶</span></span>
<span class="line"><span style="color:#81A1C1;">    private</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> method1</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> throws</span><span style="color:#8FBCBB;"> IOException</span><span style="color:#ECEFF4;">,</span><span style="color:#8FBCBB;"> NoSuchFieldException</span><span style="color:#ECEFF4;">,</span><span style="color:#8FBCBB;"> IllegalAccessException</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8FBCBB;">        Field</span><span style="color:#D8DEE9;"> field</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Unsafe</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">class</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getDeclaredField</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">theUnsafe</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        field</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">setAccessible</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">true</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#8FBCBB;">        Unsafe</span><span style="color:#D8DEE9;"> unsafe</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9FF;">Unsafe</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9;">field</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">get</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">Unsafe</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">class</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">        long</span><span style="color:#D8DEE9;"> base</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> unsafe</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">allocateMemory</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">_1GB</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        unsafe</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">setMemory</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">base</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;">_1GB</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> (</span><span style="color:#81A1C1;">byte</span><span style="color:#ECEFF4;">)</span><span style="color:#B48EAD;">0</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">in</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">read</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">        unsafe</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">freeMemory</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">base</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">in</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">read</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // æ¼”ç¤º ç›´æ¥å†…å­˜è¢« é‡Šæ”¾</span></span>
<span class="line"><span style="color:#81A1C1;">    private</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> method</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> throws</span><span style="color:#8FBCBB;"> IOException</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">        ByteBuffer</span><span style="color:#D8DEE9;"> byteBuffer</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> ByteBuffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">allocateDirect</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">_1GB</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">åˆ†é…å®Œæ¯•</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">in</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">read</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å¼€å§‹é‡Šæ”¾</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        byteBuffer </span><span style="color:#81A1C1;">=</span><span style="color:#81A1C1;"> null;</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">gc</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // æ‰‹åŠ¨ gc</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">in</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">read</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#616E88;">/**</span></span>
<span class="line"><span style="color:#616E88;">     * -XX:+DisableExplicitGC æ˜¾ç¤ºçš„</span></span>
<span class="line"><span style="color:#616E88;">     */</span></span>
<span class="line"><span style="color:#81A1C1;">    private</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> method</span><span style="color:#ECEFF4;">()</span><span style="color:#D8DEE9FF;"> throws IOException </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#8FBCBB;">        ByteBuffer</span><span style="color:#D8DEE9;"> byteBuffer</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> ByteBuffer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">allocateDirect</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">_1GB</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">åˆ†é…å®Œæ¯•</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">in</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">read</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å¼€å§‹é‡Šæ”¾</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        byteBuffer </span><span style="color:#81A1C1;">=</span><span style="color:#81A1C1;"> null;</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">gc</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // æ‰‹åŠ¨ gc å¤±æ•ˆ</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">in</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">read</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸€èˆ¬ç”¨ jvm è°ƒä¼˜æ—¶ï¼Œä¼šåŠ ä¸Šä¸‹é¢çš„å‚æ•°ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">-</span><span style="color:#D8DEE9FF;">XX</span><span style="color:#81A1C1;">:+</span><span style="color:#D8DEE9FF;">DisableExplicitGC  </span><span style="color:#616E88;">// é™æ­¢æ˜¾ç¤ºçš„ GC</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>æ„æ€å°±æ˜¯ç¦æ­¢æˆ‘ä»¬æ‰‹åŠ¨çš„ GCï¼Œæ¯”å¦‚æ‰‹åŠ¨ System.gc() æ— æ•ˆï¼Œå®ƒæ˜¯ä¸€ç§ full gcï¼Œä¼šå›æ”¶æ–°ç”Ÿä»£ã€è€å¹´ä»£ï¼Œä¼šé€ æˆç¨‹åºæ‰§è¡Œçš„æ—¶é—´æ¯”è¾ƒé•¿ã€‚æ‰€ä»¥æˆ‘ä»¬å°±é€šè¿‡ unsafe å¯¹è±¡è°ƒç”¨ freeMemory çš„æ–¹å¼é‡Šæ”¾å†…å­˜ã€‚</p><h1 id="äºŒã€åƒåœ¾å›æ”¶" tabindex="-1"><a class="header-anchor" href="#äºŒã€åƒåœ¾å›æ”¶"><span>äºŒã€åƒåœ¾å›æ”¶</span></a></h1><h2 id="_1-å¦‚ä½•åˆ¤æ–­å¯¹è±¡å¯ä»¥å›æ”¶" tabindex="-1"><a class="header-anchor" href="#_1-å¦‚ä½•åˆ¤æ–­å¯¹è±¡å¯ä»¥å›æ”¶"><span>1.å¦‚ä½•åˆ¤æ–­å¯¹è±¡å¯ä»¥å›æ”¶</span></a></h2><h4 id="_1-1-å¼•ç”¨è®¡æ•°æ³•" tabindex="-1"><a class="header-anchor" href="#_1-1-å¼•ç”¨è®¡æ•°æ³•"><span>1.1 å¼•ç”¨è®¡æ•°æ³•</span></a></h4><ul><li>å½“ä¸€ä¸ªå¯¹è±¡è¢«å…¶ä»–å˜é‡å¼•ç”¨ï¼Œè¯¥å¯¹è±¡è®¡æ•°åŠ ä¸€ï¼Œå½“æŸä¸ªå˜é‡ä¸åœ¨å¼•ç”¨è¯¥å¯¹è±¡ï¼Œå…¶è®¡æ•°å‡ä¸€</li><li>å½“ä¸€ä¸ªå¯¹è±¡å¼•ç”¨æ²¡æœ‰è¢«å…¶ä»–å˜é‡å¼•ç”¨æ—¶ï¼Œå³è®¡æ•°å˜ä¸º0æ—¶ï¼Œè¯¥å¯¹è±¡å°±å¯ä»¥è¢«å›æ”¶</li></ul><h5 id="ç¼ºç‚¹-å¾ªç¯å¼•ç”¨æ—¶-ä¸¤ä¸ªå¯¹è±¡çš„è®¡æ•°éƒ½ä¸º1-å¯¼è‡´ä¸¤ä¸ªå¯¹è±¡éƒ½æ— æ³•è¢«é‡Šæ”¾" tabindex="-1"><a class="header-anchor" href="#ç¼ºç‚¹-å¾ªç¯å¼•ç”¨æ—¶-ä¸¤ä¸ªå¯¹è±¡çš„è®¡æ•°éƒ½ä¸º1-å¯¼è‡´ä¸¤ä¸ªå¯¹è±¡éƒ½æ— æ³•è¢«é‡Šæ”¾"><span><strong>ç¼ºç‚¹</strong>ï¼šå¾ªç¯å¼•ç”¨æ—¶ï¼Œä¸¤ä¸ªå¯¹è±¡çš„è®¡æ•°éƒ½ä¸º1ï¼Œå¯¼è‡´ä¸¤ä¸ªå¯¹è±¡éƒ½æ— æ³•è¢«é‡Šæ”¾</span></a></h5><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806290.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><h4 id="_1-2-å¯è¾¾æ€§åˆ†æç®—æ³•" tabindex="-1"><a class="header-anchor" href="#_1-2-å¯è¾¾æ€§åˆ†æç®—æ³•"><span>1.2 å¯è¾¾æ€§åˆ†æç®—æ³•</span></a></h4><ul><li>JVMä¸­çš„åƒåœ¾å›æ”¶å™¨é€šè¿‡<strong>å¯è¾¾æ€§åˆ†æ</strong>æ¥æ¢ç´¢æ‰€æœ‰å­˜æ´»çš„å¯¹è±¡</li><li>æ‰«æå †ä¸­çš„å¯¹è±¡ï¼Œçœ‹èƒ½å¦æ²¿ç€<strong>GC</strong> <strong>Root</strong>å¯¹è±¡ä¸ºèµ·ç‚¹çš„å¼•ç”¨é“¾æ‰¾åˆ°è¯¥å¯¹è±¡ï¼Œå¦‚æœ<strong>æ‰¾ä¸åˆ°</strong>ï¼Œåˆ™è¡¨ç¤º<strong>å¯ä»¥å›æ”¶</strong></li></ul><h5 id="å¯ä»¥ä½œä¸ºgc-rootçš„å¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#å¯ä»¥ä½œä¸ºgc-rootçš„å¯¹è±¡"><span>å¯ä»¥ä½œä¸º<strong>GC</strong> <strong>Root</strong>çš„å¯¹è±¡</span></a></h5><ul><li>è™šæ‹Ÿæœºæ ˆï¼ˆæ ˆå¸§ä¸­çš„æœ¬åœ°å˜é‡è¡¨ï¼‰ä¸­å¼•ç”¨çš„å¯¹è±¡ã€‚</li><li>æ–¹æ³•åŒºä¸­ç±»é™æ€å±æ€§å¼•ç”¨çš„å¯¹è±¡</li><li>æ–¹æ³•åŒºä¸­å¸¸é‡å¼•ç”¨çš„å¯¹è±¡</li><li>æœ¬åœ°æ–¹æ³•æ ˆä¸­JNIï¼ˆå³ä¸€èˆ¬è¯´çš„Nativeæ–¹æ³•ï¼‰å¼•ç”¨çš„å¯¹è±¡</li><li>æ‰€æœ‰è¢«åŒæ­¥é”ï¼ˆsynchronizedå…³é”®å­—ï¼‰æŒæœ‰çš„å¯¹è±¡ã€‚</li></ul><h5 id="ä½¿ç”¨memory-analyzer-mat-åˆ†æã€‚" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨memory-analyzer-mat-åˆ†æã€‚"><span>ä½¿ç”¨Memory Analyzer (MAT)åˆ†æã€‚</span></a></h5><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9FF;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> throws IOException </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8FBCBB;">        ArrayList</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">Object</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9;"> list</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#8FBCBB;"> ArrayList</span><span style="color:#ECEFF4;">&lt;&gt;()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        list</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">add</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">a</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        list</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">add</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">b</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        list</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">add</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">1</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">1</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">in</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">read</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9FF;">        list </span><span style="color:#81A1C1;">=</span><span style="color:#81A1C1;"> null;</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">2</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">in</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">read</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">end</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯¹äºä»¥ä¸Šä»£ç ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å°†å †å†…å­˜ä¿¡æ¯è½¬å‚¨æˆä¸€ä¸ªæ–‡ä»¶ï¼Œç„¶åä½¿ç”¨ Eclipse Memory Analyzer å·¥å…·è¿›è¡Œåˆ†æã€‚ ç¬¬ä¸€æ­¥ï¼š ä½¿ç”¨ jps å‘½ä»¤ï¼ŒæŸ¥çœ‹ç¨‹åºçš„è¿›ç¨‹</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806559.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>ç¬¬äºŒæ­¥ï¼š</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806527.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>ä½¿ç”¨ jmap -dump:format=b,live,file=1.bin 16104 å‘½ä»¤è½¬å‚¨æ–‡ä»¶ dumpï¼šè½¬å‚¨æ–‡ä»¶ format=bï¼šäºŒè¿›åˆ¶æ–‡ä»¶ fileï¼šæ–‡ä»¶å 16104ï¼šè¿›ç¨‹çš„id ç¬¬ä¸‰æ­¥ï¼šæ‰“å¼€ Eclipse Memory Analyzer å¯¹ 1.bin æ–‡ä»¶è¿›è¡Œåˆ†æã€‚</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806840.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>åˆ†æçš„ gc rootï¼Œæ‰¾åˆ°äº† ArrayList å¯¹è±¡ï¼Œç„¶åå°† list ç½®ä¸ºnullï¼Œå†æ¬¡è½¬å‚¨ï¼Œé‚£ä¹ˆ list å¯¹è±¡å°±ä¼šè¢«å›æ”¶ã€‚</p><h4 id="_1-3-äº”ç§å¼•ç”¨" tabindex="-1"><a class="header-anchor" href="#_1-3-äº”ç§å¼•ç”¨"><span>1.3 äº”ç§å¼•ç”¨</span></a></h4><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806056.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><ol><li><h5 id="å¼ºå¼•ç”¨" tabindex="-1"><a class="header-anchor" href="#å¼ºå¼•ç”¨"><span><strong>å¼ºå¼•ç”¨</strong></span></a></h5><ul><li>åªæœ‰æ‰€æœ‰ GC Roots å¯¹è±¡éƒ½ä¸é€šè¿‡ã€å¼ºå¼•ç”¨ã€‘å¼•ç”¨è¯¥å¯¹è±¡ï¼Œè¯¥å¯¹è±¡æ‰èƒ½è¢«åƒåœ¾å›æ”¶</li></ul></li><li><h5 id="è½¯å¼•ç”¨" tabindex="-1"><a class="header-anchor" href="#è½¯å¼•ç”¨"><span><strong>è½¯å¼•ç”¨</strong></span></a></h5><ul><li>ä»…æœ‰ã€è½¯å¼•ç”¨ã€‘å¼•ç”¨è¯¥å¯¹è±¡æ—¶ï¼Œåœ¨åƒåœ¾å›æ”¶åï¼Œ<strong>å†…å­˜****ä»ä¸è¶³</strong>æ—¶ä¼šå†æ¬¡å‡ºå‘åƒåœ¾å›æ”¶ï¼Œå›æ”¶è½¯å¼•ç”¨å¯¹è±¡</li><li>å¯ä»¥é…åˆã€å¼•ç”¨é˜Ÿåˆ—ã€‘æ¥é‡Šæ”¾è½¯å¼•ç”¨è‡ªèº«</li></ul></li><li><h5 id="å¼±å¼•ç”¨" tabindex="-1"><a class="header-anchor" href="#å¼±å¼•ç”¨"><span><strong>å¼±å¼•ç”¨</strong></span></a></h5><ul><li>ä»…æœ‰ã€å¼±å¼•ç”¨ã€‘å¼•ç”¨è¯¥å¯¹è±¡æ—¶ï¼Œåœ¨åƒåœ¾å›æ”¶æ—¶ï¼Œ<strong>æ— è®º<strong><strong>å†…å­˜</strong></strong>æ˜¯å¦å……è¶³</strong>ï¼Œéƒ½ä¼šå›æ”¶å¼±å¼•ç”¨å¯¹è±¡</li><li>å¯ä»¥é…åˆã€å¼•ç”¨é˜Ÿåˆ—ã€‘æ¥é‡Šæ”¾å¼±å¼•ç”¨è‡ªèº«</li></ul></li><li><h5 id="è™šå¼•ç”¨" tabindex="-1"><a class="header-anchor" href="#è™šå¼•ç”¨"><span><strong>è™šå¼•ç”¨</strong></span></a></h5><ul><li>å¿…é¡»é…åˆã€å¼•ç”¨é˜Ÿåˆ—ã€‘ä½¿ç”¨ï¼Œä¸»è¦é…åˆ <code>ByteBuffer</code> ä½¿ç”¨ï¼Œè¢«å¼•ç”¨å¯¹è±¡å›æ”¶æ—¶ï¼Œä¼šå°†ã€è™šå¼•ç”¨ã€‘å…¥é˜Ÿï¼Œ ç”± <code>Reference Handler</code> çº¿ç¨‹è°ƒç”¨è™šå¼•ç”¨ç›¸å…³æ–¹æ³•é‡Šæ”¾ã€ç›´æ¥å†…å­˜ã€‘</li><li>å¦‚ä¸Šå›¾ï¼ŒBå¯¹è±¡ä¸å†å¼•ç”¨<code>ByteBuffer</code>å¯¹è±¡ï¼Œ<code>ByteBuffer</code>å°±ä¼šè¢«å›æ”¶ã€‚ä½†æ˜¯ç›´æ¥å†…å­˜ä¸­çš„å†…å­˜è¿˜æœªè¢«å›æ”¶ã€‚è¿™æ—¶éœ€è¦å°†è™šå¼•ç”¨å¯¹è±¡<code>Cleaner</code>æ”¾å…¥å¼•ç”¨é˜Ÿåˆ—ä¸­ï¼Œç„¶åè°ƒç”¨å®ƒçš„<code>clean</code>æ–¹æ³•æ¥é‡Šæ”¾ç›´æ¥å†…å­˜</li></ul></li><li><h5 id="ç»ˆç»“å™¨å¼•ç”¨" tabindex="-1"><a class="header-anchor" href="#ç»ˆç»“å™¨å¼•ç”¨"><span><strong>ç»ˆç»“å™¨å¼•ç”¨</strong></span></a></h5><ul><li>æ— éœ€æ‰‹åŠ¨ç¼–ç ï¼Œä½†å…¶å†…éƒ¨é…åˆã€å¼•ç”¨é˜Ÿåˆ—ã€‘ä½¿ç”¨ï¼Œåœ¨åƒåœ¾å›æ”¶æ—¶ï¼Œã€ç»ˆç»“å™¨å¼•ç”¨ã€‘å…¥é˜Ÿï¼ˆè¢«å¼•ç”¨å¯¹è±¡æš‚æ—¶æ²¡æœ‰è¢«å›æ”¶ï¼‰ï¼Œå†ç”± <code>Finalizer</code> çº¿ç¨‹é€šè¿‡ã€ç»ˆç»“å™¨å¼•ç”¨ã€‘æ‰¾åˆ°è¢«å¼•ç”¨å¯¹è±¡å¹¶è°ƒç”¨å®ƒçš„ <code>finalize</code> æ–¹æ³•ï¼Œç¬¬äºŒæ¬¡ GC æ—¶æ‰èƒ½å›æ”¶è¢«å¼•ç”¨å¯¹è±¡</li><li>å¦‚ä¸Šå›¾ï¼ŒBå¯¹è±¡ä¸å†å¼•ç”¨A4å¯¹è±¡ã€‚è¿™æ—¶ç»ˆç»“å™¨å¯¹è±¡å°±ä¼šè¢«æ”¾å…¥å¼•ç”¨é˜Ÿåˆ—ä¸­ï¼Œå¼•ç”¨é˜Ÿåˆ—ä¼šæ ¹æ®å®ƒï¼Œæ‰¾åˆ°å®ƒæ‰€å¼•ç”¨çš„å¯¹è±¡ã€‚ç„¶åè°ƒç”¨è¢«å¼•ç”¨å¯¹è±¡çš„<code>finalize</code>æ–¹æ³•ã€‚è°ƒç”¨ä»¥åï¼Œè¯¥å¯¹è±¡å°±å¯ä»¥è¢«åƒåœ¾å›æ”¶äº†</li></ul></li></ol><h5 id="è½¯å¼•ç”¨ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#è½¯å¼•ç”¨ä½¿ç”¨"><span><strong>è½¯å¼•ç”¨ä½¿ç”¨</strong></span></a></h5><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Demo1</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">        public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">                final</span><span style="color:#81A1C1;"> int</span><span style="color:#D8DEE9;"> _4M</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 4</span><span style="color:#81A1C1;">*</span><span style="color:#B48EAD;">1024</span><span style="color:#81A1C1;">*</span><span style="color:#B48EAD;">1024</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">                //ä½¿ç”¨è½¯å¼•ç”¨å¯¹è±¡ listå’ŒSoftReferenceæ˜¯å¼ºå¼•ç”¨ï¼Œè€ŒSoftReferenceå’Œbyteæ•°ç»„åˆ™æ˜¯è½¯å¼•ç”¨</span></span>
<span class="line"><span style="color:#8FBCBB;">                List</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">SoftReference</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#81A1C1;">byte</span><span style="color:#ECEFF4;">[]&gt;&gt;</span><span style="color:#D8DEE9;"> list</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#8FBCBB;"> ArrayList</span><span style="color:#ECEFF4;">&lt;&gt;()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#8FBCBB;">                SoftReference</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#81A1C1;">byte</span><span style="color:#ECEFF4;">[]&gt;</span><span style="color:#D8DEE9;"> ref</span><span style="color:#81A1C1;">=</span><span style="color:#81A1C1;"> new</span><span style="color:#8FBCBB;"> SoftReference</span><span style="color:#ECEFF4;">&lt;&gt;(</span><span style="color:#81A1C1;">new</span><span style="color:#81A1C1;"> byte</span><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">_4M</span><span style="color:#ECEFF4;">])</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#616E88;">/**</span></span>
<span class="line"><span style="color:#616E88;"> * æ¼”ç¤º è½¯å¼•ç”¨</span></span>
<span class="line"><span style="color:#616E88;"> * -Xmx20m -XX:+PrintGCDetails -verbose:gc</span></span>
<span class="line"><span style="color:#616E88;"> */</span></span>
<span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Code_08_SoftReferenceTest</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> int</span><span style="color:#D8DEE9;"> _4MB</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 4</span><span style="color:#81A1C1;"> *</span><span style="color:#B48EAD;"> 1024</span><span style="color:#81A1C1;"> *</span><span style="color:#B48EAD;"> 1024</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> throws</span><span style="color:#8FBCBB;"> IOException</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#88C0D0;">        method2</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // è®¾ç½® -Xmx20m , æ¼”ç¤ºå †å†…å­˜ä¸è¶³,</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> method1</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> throws</span><span style="color:#8FBCBB;"> IOException</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">        ArrayList</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#81A1C1;">byte</span><span style="color:#ECEFF4;">[]&gt;</span><span style="color:#D8DEE9;"> list</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#8FBCBB;"> ArrayList</span><span style="color:#ECEFF4;">&lt;&gt;()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">        for</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">int</span><span style="color:#D8DEE9;"> i</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> i </span><span style="color:#81A1C1;">&lt;</span><span style="color:#B48EAD;"> 5</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> i</span><span style="color:#81A1C1;">++</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">            list</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">add</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">new</span><span style="color:#81A1C1;"> byte</span><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">_4MB</span><span style="color:#ECEFF4;">])</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">in</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">read</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // æ¼”ç¤º è½¯å¼•ç”¨</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> method2</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> throws</span><span style="color:#8FBCBB;"> IOException</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">        ArrayList</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">SoftReference</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#81A1C1;">byte</span><span style="color:#ECEFF4;">[]&gt;&gt;</span><span style="color:#D8DEE9;"> list</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#8FBCBB;"> ArrayList</span><span style="color:#ECEFF4;">&lt;&gt;()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">        for</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">int</span><span style="color:#D8DEE9;"> i</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> i </span><span style="color:#81A1C1;">&lt;</span><span style="color:#B48EAD;"> 5</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> i</span><span style="color:#81A1C1;">++</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">            SoftReference</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#81A1C1;">byte</span><span style="color:#ECEFF4;">[]&gt;</span><span style="color:#D8DEE9;"> ref</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#8FBCBB;"> SoftReference</span><span style="color:#ECEFF4;">&lt;&gt;(</span><span style="color:#81A1C1;">new</span><span style="color:#81A1C1;"> byte</span><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">_4MB</span><span style="color:#ECEFF4;">])</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">            System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">ref</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">get</span><span style="color:#ECEFF4;">())</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">            list</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">add</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">ref</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">            System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">list</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">size</span><span style="color:#ECEFF4;">())</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å¾ªç¯ç»“æŸï¼š</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;"> +</span><span style="color:#D8DEE9;"> list</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">size</span><span style="color:#ECEFF4;">())</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">        for</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">SoftReference</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#81A1C1;">byte</span><span style="color:#ECEFF4;">[]&gt;</span><span style="color:#D8DEE9;"> ref</span><span style="color:#81A1C1;"> :</span><span style="color:#D8DEE9FF;"> list</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">            System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">ref</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">get</span><span style="color:#ECEFF4;">())</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>method1 æ–¹æ³•è§£æï¼š é¦–å…ˆä¼šè®¾ç½®ä¸€ä¸ªå †å†…å­˜çš„å¤§å°ä¸º 20mï¼Œç„¶åè¿è¡Œ mehtod1 æ–¹æ³•ï¼Œä¼šæŠ›å¼‚å¸¸ï¼Œå †å†…å­˜ä¸è¶³ï¼Œå› ä¸º mehtod1 ä¸­çš„ list éƒ½æ˜¯å¼ºå¼•ç”¨ã€‚</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806314.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>method2 æ–¹æ³•è§£æï¼š åœ¨ list é›†åˆä¸­å­˜æ”¾äº† è½¯å¼•ç”¨å¯¹è±¡ï¼Œå½“å†…å­˜ä¸è¶³æ—¶ï¼Œä¼šè§¦å‘ full gcï¼Œå°†è½¯å¼•ç”¨çš„å¯¹è±¡å›æ”¶ã€‚ç»†èŠ‚å¦‚å›¾ï¼š</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806561.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>ä¸Šé¢çš„ä»£ç ä¸­ï¼Œå½“è½¯å¼•ç”¨å¼•ç”¨çš„å¯¹è±¡è¢«å›æ”¶äº†ï¼Œä½†æ˜¯è½¯å¼•ç”¨è¿˜å­˜åœ¨ï¼Œæ‰€ä»¥ï¼Œä¸€èˆ¬è½¯å¼•ç”¨éœ€è¦æ­é…ä¸€ä¸ªå¼•ç”¨é˜Ÿåˆ—ä¸€èµ·ä½¿ç”¨ã€‚</p><p>ä¿®æ”¹ method2 å¦‚ä¸‹ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// æ¼”ç¤º è½¯å¼•ç”¨ æ­é…å¼•ç”¨é˜Ÿåˆ—</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> method3</span><span style="color:#ECEFF4;">()</span><span style="color:#D8DEE9FF;"> throws IOException </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">        //ä½¿ç”¨è½¯å¼•ç”¨å¯¹è±¡ listå’ŒSoftReferenceæ˜¯å¼ºå¼•ç”¨ï¼Œè€ŒSoftReferenceå’Œbyteæ•°ç»„åˆ™æ˜¯è½¯å¼•ç”¨</span></span>
<span class="line"><span style="color:#8FBCBB;">        ArrayList</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">SoftReference</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#81A1C1;">byte</span><span style="color:#ECEFF4;">[]&gt;&gt;</span><span style="color:#D8DEE9;"> list</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#8FBCBB;"> ArrayList</span><span style="color:#ECEFF4;">&lt;&gt;()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">        ///ä½¿ç”¨å¼•ç”¨é˜Ÿåˆ—ï¼Œç”¨äºç§»é™¤å¼•ç”¨ä¸ºç©ºçš„è½¯å¼•ç”¨å¯¹è±¡</span></span>
<span class="line"><span style="color:#8FBCBB;">        ReferenceQueue</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#81A1C1;">byte</span><span style="color:#ECEFF4;">[]&gt;</span><span style="color:#D8DEE9;"> queue</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#8FBCBB;"> ReferenceQueue</span><span style="color:#ECEFF4;">&lt;&gt;()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">        for</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">int</span><span style="color:#D8DEE9;"> i</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> i </span><span style="color:#81A1C1;">&lt;</span><span style="color:#B48EAD;"> 5</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> i</span><span style="color:#81A1C1;">++</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">            // å…³è”äº†å¼•ç”¨é˜Ÿåˆ—ï¼Œå½“è½¯å¼•ç”¨æ‰€å…³è”çš„ byte[] è¢«å›æ”¶æ—¶ï¼Œè½¯å¼•ç”¨è‡ªå·±ä¼šåŠ å…¥åˆ° queue ä¸­å»</span></span>
<span class="line"><span style="color:#8FBCBB;">            SoftReference</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#81A1C1;">byte</span><span style="color:#ECEFF4;">[]&gt;</span><span style="color:#D8DEE9;"> ref</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#8FBCBB;"> SoftReference</span><span style="color:#ECEFF4;">&lt;&gt;(</span><span style="color:#81A1C1;">new</span><span style="color:#81A1C1;"> byte</span><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">_4MB</span><span style="color:#ECEFF4;">],</span><span style="color:#D8DEE9FF;"> queue</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">            System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">ref</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">get</span><span style="color:#ECEFF4;">())</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">            list</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">add</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">ref</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">            System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">list</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">size</span><span style="color:#ECEFF4;">())</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">        // ä»é˜Ÿåˆ—ä¸­è·å–æ— ç”¨çš„ è½¯å¼•ç”¨å¯¹è±¡ï¼Œå¹¶ç§»é™¤</span></span>
<span class="line"><span style="color:#8FBCBB;">        Reference</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">?</span><span style="color:#81A1C1;"> extends</span><span style="color:#81A1C1;"> byte</span><span style="color:#ECEFF4;">[]&gt;</span><span style="color:#D8DEE9;"> poll</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> queue</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">poll</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">        //éå†å¼•ç”¨é˜Ÿåˆ—ï¼Œå¦‚æœæœ‰å…ƒç´ ï¼Œåˆ™ç§»é™¤</span></span>
<span class="line"><span style="color:#81A1C1;">        while</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">poll </span><span style="color:#81A1C1;">!=</span><span style="color:#81A1C1;"> null</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">            list</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">remove</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">poll</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">            poll </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9;"> queue</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">poll</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">=====================</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">        for</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">SoftReference</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#81A1C1;">byte</span><span style="color:#ECEFF4;">[]&gt;</span><span style="color:#D8DEE9;"> ref</span><span style="color:#81A1C1;"> :</span><span style="color:#D8DEE9FF;"> list</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">            System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">ref</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">get</span><span style="color:#ECEFF4;">())</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806479.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><h5 id="å¼±å¼•ç”¨-ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#å¼±å¼•ç”¨-ä½¿ç”¨"><span><strong>å¼±å¼•ç”¨****ä½¿ç”¨</strong></span></a></h5><p>å¼±å¼•ç”¨çš„ä½¿ç”¨å’Œè½¯å¼•ç”¨ç±»ä¼¼ï¼Œåªæ˜¯å°† <code>SoftReference</code> æ¢ä¸ºäº† <code>WeakReference</code></p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Code_09_WeakReferenceTest</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">//        method1();</span></span>
<span class="line"><span style="color:#88C0D0;">        method2</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> int</span><span style="color:#D8DEE9;"> _4MB</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 4</span><span style="color:#81A1C1;"> *</span><span style="color:#B48EAD;"> 1024</span><span style="color:#81A1C1;"> *</span><span style="color:#B48EAD;">1024</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // æ¼”ç¤º å¼±å¼•ç”¨</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> method1</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">        List</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">WeakReference</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#81A1C1;">byte</span><span style="color:#ECEFF4;">[]&gt;&gt;</span><span style="color:#D8DEE9;"> list</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#8FBCBB;"> ArrayList</span><span style="color:#ECEFF4;">&lt;&gt;()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">        for</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">int</span><span style="color:#D8DEE9;"> i</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> i </span><span style="color:#81A1C1;">&lt;</span><span style="color:#B48EAD;"> 10</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> i</span><span style="color:#81A1C1;">++</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">            WeakReference</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#81A1C1;">byte</span><span style="color:#ECEFF4;">[]&gt;</span><span style="color:#D8DEE9;"> weakReference</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#8FBCBB;"> WeakReference</span><span style="color:#ECEFF4;">&lt;&gt;(</span><span style="color:#81A1C1;">new</span><span style="color:#81A1C1;"> byte</span><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">_4MB</span><span style="color:#ECEFF4;">])</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">            list</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">add</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">weakReference</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">            for</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">WeakReference</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#81A1C1;">byte</span><span style="color:#ECEFF4;">[]&gt;</span><span style="color:#D8DEE9;"> wake</span><span style="color:#81A1C1;"> :</span><span style="color:#D8DEE9FF;"> list</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">                System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">print</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">wake</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">get</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> +</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">,</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">            }</span></span>
<span class="line"><span style="color:#D8DEE9;">            System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // æ¼”ç¤º å¼±å¼•ç”¨æ­é… å¼•ç”¨é˜Ÿåˆ—</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> method2</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">        List</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">WeakReference</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#81A1C1;">byte</span><span style="color:#ECEFF4;">[]&gt;&gt;</span><span style="color:#D8DEE9;"> list</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#8FBCBB;"> ArrayList</span><span style="color:#ECEFF4;">&lt;&gt;()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#8FBCBB;">        ReferenceQueue</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#81A1C1;">byte</span><span style="color:#ECEFF4;">[]&gt;</span><span style="color:#D8DEE9;"> queue</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#8FBCBB;"> ReferenceQueue</span><span style="color:#ECEFF4;">&lt;&gt;()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">        for</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">int</span><span style="color:#D8DEE9;"> i</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> i </span><span style="color:#81A1C1;">&lt;</span><span style="color:#B48EAD;"> 9</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> i</span><span style="color:#81A1C1;">++</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">            WeakReference</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#81A1C1;">byte</span><span style="color:#ECEFF4;">[]&gt;</span><span style="color:#D8DEE9;"> weakReference</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#8FBCBB;"> WeakReference</span><span style="color:#ECEFF4;">&lt;&gt;(</span><span style="color:#81A1C1;">new</span><span style="color:#81A1C1;"> byte</span><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">_4MB</span><span style="color:#ECEFF4;">],</span><span style="color:#D8DEE9FF;"> queue</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">            list</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">add</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">weakReference</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">            for</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">WeakReference</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#81A1C1;">byte</span><span style="color:#ECEFF4;">[]&gt;</span><span style="color:#D8DEE9;"> wake</span><span style="color:#81A1C1;"> :</span><span style="color:#D8DEE9FF;"> list</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">                System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">print</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">wake</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">get</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> +</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">,</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">            }</span></span>
<span class="line"><span style="color:#D8DEE9;">            System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">===========================================</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#8FBCBB;">        Reference</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">?</span><span style="color:#81A1C1;"> extends</span><span style="color:#81A1C1;"> byte</span><span style="color:#ECEFF4;">[]&gt;</span><span style="color:#D8DEE9;"> poll</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> queue</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">poll</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">        while</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9FF;">poll </span><span style="color:#81A1C1;">!=</span><span style="color:#81A1C1;"> null</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">            list</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">remove</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">poll</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">            poll </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9;"> queue</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">poll</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#81A1C1;">        for</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">WeakReference</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#81A1C1;">byte</span><span style="color:#ECEFF4;">[]&gt;</span><span style="color:#D8DEE9;"> wake</span><span style="color:#81A1C1;"> :</span><span style="color:#D8DEE9FF;"> list</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">            System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">print</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">wake</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">get</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> +</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">,</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-åƒåœ¾å›æ”¶ç®—æ³•" tabindex="-1"><a class="header-anchor" href="#_2-åƒåœ¾å›æ”¶ç®—æ³•"><span>2. åƒåœ¾å›æ”¶ç®—æ³•</span></a></h2><h4 id="_2-1-æ ‡è®°æ¸…é™¤" tabindex="-1"><a class="header-anchor" href="#_2-1-æ ‡è®°æ¸…é™¤"><span>2.1 æ ‡è®°æ¸…é™¤</span></a></h4><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806087.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p><strong>å®šä¹‰</strong>ï¼šåœ¨è™šæ‹Ÿæœºæ‰§è¡Œåƒåœ¾å›æ”¶çš„è¿‡ç¨‹ä¸­ï¼Œå…ˆé‡‡ç”¨æ ‡è®°ç®—æ³•ç¡®å®šå¯å›æ”¶å¯¹è±¡ï¼Œç„¶ååƒåœ¾æ”¶é›†å™¨æ ¹æ®æ ‡è¯†æ¸…é™¤ç›¸åº”çš„å†…å®¹ï¼Œç»™å †å†…å­˜è…¾å‡ºç›¸åº”çš„ç©ºé—´</p><blockquote><p>æ³¨æ„ï¼šè¿™é‡Œçš„æ¸…é™¤å¹¶ä¸æ˜¯å°†å†…å­˜ç©ºé—´å­—èŠ‚æ¸…é›¶ï¼Œè€Œæ˜¯è®°å½•è¿™æ®µå†…å­˜çš„èµ·å§‹åœ°å€ï¼Œä¸‹æ¬¡åˆ†é…å†…å­˜çš„æ—¶å€™ï¼Œä¼šç›´æ¥è¦†ç›–è¿™æ®µå†…å­˜ã€‚</p></blockquote><p><strong>ä¼˜ç‚¹</strong>ï¼šé€Ÿåº¦å¿«</p><p><strong>ç¼ºç‚¹</strong>ï¼šå®¹æ˜“äº§ç”Ÿå†…å­˜ç¢ç‰‡ã€‚ä¸€æ—¦åˆ†é…è¾ƒå¤§å†…å­˜çš„å¯¹è±¡ï¼Œç”±äºå†…å­˜ä¸è¿ç»­ï¼Œå¯¼è‡´æ— æ³•åˆ†é…ï¼Œæœ€åå°±ä¼šé€ æˆå†…å­˜æº¢å‡ºé—®é¢˜</p><h4 id="_2-2-æ ‡è®°æ•´ç†" tabindex="-1"><a class="header-anchor" href="#_2-2-æ ‡è®°æ•´ç†"><span>2.2 æ ‡è®°æ•´ç†</span></a></h4><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806182.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p><strong>å®šä¹‰</strong>ï¼šåœ¨è™šæ‹Ÿæœºæ‰§è¡Œåƒåœ¾å›æ”¶çš„è¿‡ç¨‹ä¸­ï¼Œå…ˆé‡‡ç”¨æ ‡è®°ç®—æ³•ç¡®å®šå¯å›æ”¶å¯¹è±¡ï¼Œç„¶åæ•´ç†å‰©ä½™çš„å¯¹è±¡ï¼Œå°†å¯ç”¨çš„å¯¹è±¡ç§»åŠ¨åˆ°ä¸€èµ·ï¼Œä½¿å†…å­˜æ›´åŠ ç´§å‡‘ï¼Œè¿ç»­çš„ç©ºé—´å°±æ›´å¤šã€‚</p><p><strong>ä¼˜ç‚¹</strong>ï¼šä¸ä¼šæœ‰å†…å­˜ç¢ç‰‡</p><p><strong>ç¼ºç‚¹</strong>ï¼šæ•´ç†æ—¶éœ€è¦é‡æ–°å¤„ç†å¼•ç”¨å…³ç³»ï¼Œé€Ÿåº¦æ…¢</p><h4 id="_2-3-å¤åˆ¶" tabindex="-1"><a class="header-anchor" href="#_2-3-å¤åˆ¶"><span>2.3 å¤åˆ¶</span></a></h4><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806969.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p><strong>å®šä¹‰</strong>ï¼šå°†å†…å­˜åˆ†ä¸ºç­‰å¤§å°çš„ä¸¤ä¸ªåŒºåŸŸï¼ŒFROMå’ŒTOï¼ˆTOä¸­ä¸ºç©ºï¼‰ã€‚å°†è¢«GC Rootå¼•ç”¨çš„å¯¹è±¡ä»FROMæ”¾å…¥TOä¸­ï¼Œå†å›æ”¶ä¸è¢«GC Rootå¼•ç”¨çš„å¯¹è±¡ã€‚ç„¶åäº¤æ¢FROMå’ŒTOã€‚è¿™æ ·ä¹Ÿå¯ä»¥é¿å…å†…å­˜ç¢ç‰‡çš„é—®é¢˜ï¼Œä½†æ˜¯ä¼šå ç”¨åŒå€çš„å†…å­˜ç©ºé—´ã€‚</p><p><strong>ä¼˜ç‚¹</strong>ï¼šä¸ä¼šæœ‰å†…å­˜ç¢ç‰‡</p><p><strong>ç¼ºç‚¹</strong>ï¼šä¼šå ç”¨åŒå€çš„å†…å­˜ç©ºé—´ã€‚</p><h2 id="_3-åˆ†ä»£åƒåœ¾å›æ”¶" tabindex="-1"><a class="header-anchor" href="#_3-åˆ†ä»£åƒåœ¾å›æ”¶"><span>3. åˆ†ä»£åƒåœ¾å›æ”¶</span></a></h2><p>å°†å †å†…å­˜åˆ†ä¸º<strong>æ–°ç”Ÿä»£</strong>å’Œ<strong>è€å¹´ä»£</strong>ï¼Œæ–°ç”Ÿä»£æœ‰åˆ’åˆ†ä¸º<strong>ä¼Šç”¸å›­</strong>ï¼Œ<strong>å¹¸å­˜åŒºTo</strong>ï¼Œ<strong>å¹¸å­˜åŒºFrom</strong>ã€‚</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806904.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><h4 id="_3-1-å›æ”¶æµç¨‹" tabindex="-1"><a class="header-anchor" href="#_3-1-å›æ”¶æµç¨‹"><span>3.1 å›æ”¶æµç¨‹</span></a></h4><p>å¯¹è±¡é¦–å…ˆåˆ†é…åœ¨ä¼Šç”¸å›­åŒºåŸŸ</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806959.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>æ–°ç”Ÿä»£ç©ºé—´ä¸è¶³æ—¶ï¼Œè§¦å‘ <strong>Minor</strong> <strong>GC</strong>ï¼Œä¼Šç”¸å›­å’Œ from å­˜æ´»çš„å¯¹è±¡ä½¿ç”¨ copy å¤åˆ¶åˆ° to ä¸­ï¼Œå­˜æ´»çš„å¯¹è±¡<strong>å¹´é¾„åŠ  1</strong>å¹¶ä¸”äº¤æ¢ from to</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806010.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806615.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806783.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>å†æ¬¡åˆ›å»ºå¯¹è±¡ï¼Œè‹¥æ–°ç”Ÿä»£çš„ä¼Šç”¸å›­åˆæ»¡äº†ï¼Œåˆ™ä¼šå†æ¬¡è§¦å‘ <strong>Minor</strong> <strong>GC</strong>ï¼ˆminor gc ä¼šå¼•å‘ <strong>stop the worldï¼ˆå¯ä»¥çœ‹ä¸‹goè¯­è¨€çš„åƒåœ¾ä¸‰è‰²æ ‡è®°æœºåˆ¶ï¼Œå‡å°‘STWï¼‰</strong>ï¼Œæš‚åœå…¶å®ƒç”¨æˆ·çš„çº¿ç¨‹ï¼Œç­‰åƒåœ¾å›æ”¶ç»“æŸï¼Œç”¨æˆ·çº¿ç¨‹æ‰æ¢å¤è¿è¡Œï¼‰ï¼Œè¿™æ—¶ä¸ä»…ä¼šå›æ”¶ä¼Šç”¸å›­ä¸­çš„åƒåœ¾ï¼Œ<strong>è¿˜ä¼šå›æ”¶å¹¸å­˜åŒºä¸­çš„åƒåœ¾</strong>ï¼Œå†å°†æ´»è·ƒå¯¹è±¡å¤åˆ¶åˆ°å¹¸å­˜åŒºTOä¸­ã€‚å›æ”¶ä»¥åä¼šäº¤æ¢ä¸¤ä¸ªå¹¸å­˜åŒºï¼Œå¹¶è®©å¹¸å­˜åŒºä¸­çš„å¯¹è±¡<strong>å¯¿å‘½åŠ 1</strong></p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806878.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>å½“å¯¹è±¡å¯¿å‘½è¶…è¿‡é˜ˆå€¼æ—¶ï¼Œä¼šæ™‹å‡è‡³è€å¹´ä»£ï¼Œæœ€å¤§å¯¿å‘½æ˜¯<strong>15</strong>ï¼ˆ4bitï¼‰ï¼Œå› ä¸ºjavaå¯¹è±¡å¤´åªç”¨4ä¸ªbitæ¥è¡¨ç¤ºï¼Œæœ€å¤§è¡¨ç¤º2è¿›åˆ¶1111ã€‚</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806958.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>å½“è€å¹´ä»£ç©ºé—´ä¸è¶³ï¼Œä¼šå…ˆå°è¯•è§¦å‘<strong>Minor</strong> <strong>GC</strong>ï¼Œå¦‚æœä¹‹åç©ºé—´ä»ä¸è¶³ï¼Œé‚£ä¹ˆè§¦å‘ <strong>Full GC</strong>ï¼Œ<strong>stop the world</strong>çš„æ—¶é—´æ›´é•¿</p><h4 id="_3-2-gc-åˆ†æ" tabindex="-1"><a class="header-anchor" href="#_3-2-gc-åˆ†æ"><span>3.2 GC åˆ†æ</span></a></h4><h5 id="ç›¸å…³vmå‚æ•°" tabindex="-1"><a class="header-anchor" href="#ç›¸å…³vmå‚æ•°"><span><strong>ç›¸å…³<strong><strong>VM</strong></strong>å‚æ•°</strong></span></a></h5><p>å«ä¹‰å‚æ•°å †åˆå§‹å¤§å°-Xmså †æœ€å¤§å¤§å°-Xmx æˆ– -XX:MaxHeapSize=sizeæ–°ç”Ÿä»£å¤§å°-Xmn æˆ– (-XX:NewSize=size + -XX:MaxNewSize=size )å¹¸å­˜åŒºæ¯”ä¾‹ï¼ˆåŠ¨æ€ï¼‰-XX:InitialSurvivorRatio=ratio å’Œ -XX:+UseAdaptiveSizePolicyå¹¸å­˜åŒºæ¯”ä¾‹-XX:SurvivorRatio=ratioæ™‹å‡é˜ˆå€¼-XX:MaxTenuringThreshold=thresholdæ™‹å‡è¯¦æƒ…-XX:+PrintTenuringDistributionGCè¯¦æƒ…-XX:+PrintGCDetails -verbose:gcFullGC å‰ MinorGCXX:+ScavengeBeforeFullGC</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Code_10_GCTest</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">    private</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> final</span><span style="color:#81A1C1;"> int</span><span style="color:#D8DEE9;"> _512KB</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 512</span><span style="color:#81A1C1;"> *</span><span style="color:#B48EAD;"> 1024</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    private</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> final</span><span style="color:#81A1C1;"> int</span><span style="color:#D8DEE9;"> _1MB</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 1024</span><span style="color:#81A1C1;"> *</span><span style="color:#B48EAD;"> 1024</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    private</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> final</span><span style="color:#81A1C1;"> int</span><span style="color:#D8DEE9;"> _6MB</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 6</span><span style="color:#81A1C1;"> *</span><span style="color:#B48EAD;"> 1024</span><span style="color:#81A1C1;"> *</span><span style="color:#B48EAD;"> 1024</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    private</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> final</span><span style="color:#81A1C1;"> int</span><span style="color:#D8DEE9;"> _7MB</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 7</span><span style="color:#81A1C1;"> *</span><span style="color:#B48EAD;"> 1024</span><span style="color:#81A1C1;"> *</span><span style="color:#B48EAD;"> 1024</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    private</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> final</span><span style="color:#81A1C1;"> int</span><span style="color:#D8DEE9;"> _8MB</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 8</span><span style="color:#81A1C1;"> *</span><span style="color:#B48EAD;"> 1024</span><span style="color:#81A1C1;"> *</span><span style="color:#B48EAD;"> 1024</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // -Xms20m -Xmx20m -Xmn10m -XX:+UseSerialGC -XX:+PrintGCDetails -verbose:gc</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">        List</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#81A1C1;">byte</span><span style="color:#ECEFF4;">[]&gt;</span><span style="color:#D8DEE9;"> list</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#8FBCBB;"> ArrayList</span><span style="color:#ECEFF4;">&lt;&gt;()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        list</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">add</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">new</span><span style="color:#81A1C1;"> byte</span><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">_6MB</span><span style="color:#ECEFF4;">])</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        list</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">add</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">new</span><span style="color:#81A1C1;"> byte</span><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">_512KB</span><span style="color:#ECEFF4;">])</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        list</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">add</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">new</span><span style="color:#81A1C1;"> byte</span><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">_6MB</span><span style="color:#ECEFF4;">])</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        list</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">add</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">new</span><span style="color:#81A1C1;"> byte</span><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">_512KB</span><span style="color:#ECEFF4;">])</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        list</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">add</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">new</span><span style="color:#81A1C1;"> byte</span><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">_6MB</span><span style="color:#ECEFF4;">])</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡ä¸Šé¢çš„ä»£ç ï¼Œç»™ list åˆ†é…å†…å­˜ï¼Œæ¥è§‚å¯Ÿ æ–°ç”Ÿä»£å’Œè€å¹´ä»£çš„æƒ…å†µï¼Œä»€ä¹ˆæ—¶å€™è§¦å‘ minor gcï¼Œä»€ä¹ˆæ—¶å€™è§¦å‘ full gc ç­‰æƒ…å†µï¼Œä½¿ç”¨å‰éœ€è¦è®¾ç½® jvm å‚æ•°ã€‚</p><h5 id="å¤§å¯¹è±¡å¤„ç†ç­–ç•¥" tabindex="-1"><a class="header-anchor" href="#å¤§å¯¹è±¡å¤„ç†ç­–ç•¥"><span><strong>å¤§å¯¹è±¡å¤„ç†ç­–ç•¥</strong></span></a></h5><p>é‡åˆ°ä¸€ä¸ªè¾ƒå¤§çš„å¯¹è±¡æ—¶ï¼Œå°±ç®—æ–°ç”Ÿä»£çš„ä¼Šç”¸å›­ä¸ºç©ºï¼Œä¹Ÿ<strong>æ— æ³•å®¹çº³è¯¥å¯¹è±¡</strong>æ—¶ï¼Œä¼šå°†è¯¥å¯¹è±¡<strong>ç›´æ¥æ™‹å‡ä¸ºè€å¹´ä»£</strong></p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">/**</span></span>
<span class="line"><span style="color:#616E88;"> *  æ¼”ç¤ºå†…å­˜çš„åˆ†é…ç­–ç•¥</span></span>
<span class="line"><span style="color:#616E88;"> */</span></span>
<span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Main</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    private</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> final</span><span style="color:#81A1C1;"> int</span><span style="color:#D8DEE9;"> _512KB</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 512</span><span style="color:#81A1C1;"> *</span><span style="color:#B48EAD;"> 1024</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    private</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> final</span><span style="color:#81A1C1;"> int</span><span style="color:#D8DEE9;"> _1MB</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 1024</span><span style="color:#81A1C1;"> *</span><span style="color:#B48EAD;"> 1024</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    private</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> final</span><span style="color:#81A1C1;"> int</span><span style="color:#D8DEE9;"> _6MB</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 6</span><span style="color:#81A1C1;"> *</span><span style="color:#B48EAD;"> 1024</span><span style="color:#81A1C1;"> *</span><span style="color:#B48EAD;"> 1024</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    private</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> final</span><span style="color:#81A1C1;"> int</span><span style="color:#D8DEE9;"> _7MB</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 7</span><span style="color:#81A1C1;"> *</span><span style="color:#B48EAD;"> 1024</span><span style="color:#81A1C1;"> *</span><span style="color:#B48EAD;"> 1024</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    private</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> final</span><span style="color:#81A1C1;"> int</span><span style="color:#D8DEE9;"> _8MB</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 8</span><span style="color:#81A1C1;"> *</span><span style="color:#B48EAD;"> 1024</span><span style="color:#81A1C1;"> *</span><span style="color:#B48EAD;"> 1024</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">    // -Xms20M -Xmx20M -Xmn10M -XX:+UseSerialGC -XX:+PrintGCDetails -verbose:gc -XX:-ScavengeBeforeFullGC</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> throws</span><span style="color:#8FBCBB;"> InterruptedException</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">        ArrayList</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#81A1C1;">byte</span><span style="color:#ECEFF4;">[]&gt;</span><span style="color:#D8DEE9;"> list</span><span style="color:#81A1C1;">=new</span><span style="color:#8FBCBB;"> ArrayList</span><span style="color:#ECEFF4;">&lt;&gt;()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        list</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">add</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">new</span><span style="color:#81A1C1;"> byte</span><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">_8MB</span><span style="color:#ECEFF4;">])</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806023.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><h5 id="çº¿ç¨‹å†…å­˜æº¢å‡º" tabindex="-1"><a class="header-anchor" href="#çº¿ç¨‹å†…å­˜æº¢å‡º"><span><strong>çº¿ç¨‹<strong><strong>å†…å­˜</strong></strong>æº¢å‡º</strong></span></a></h5><p>æŸä¸ªçº¿ç¨‹çš„å†…å­˜æº¢å‡ºäº†è€ŒæŠ›å¼‚å¸¸ï¼ˆout of memoryï¼‰ï¼Œä¸ä¼šè®©å…¶ä»–çš„çº¿ç¨‹ç»“æŸè¿è¡Œã€‚è¿™æ˜¯å› ä¸ºå½“ä¸€ä¸ªçº¿ç¨‹<strong>æŠ›å‡º<strong><strong>OOM</strong></strong>å¼‚å¸¸å</strong>ï¼Œ<strong>å®ƒæ‰€å æ®çš„å†…å­˜èµ„æºä¼šå…¨éƒ¨è¢«é‡Šæ”¾æ‰</strong>ï¼Œä»è€Œä¸ä¼šå½±å“å…¶ä»–çº¿ç¨‹çš„è¿è¡Œï¼Œ<strong>è¿›ç¨‹ä¾ç„¶æ­£å¸¸</strong></p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">/**</span></span>
<span class="line"><span style="color:#616E88;"> * æ¼”ç¤ºå†…å­˜çš„åˆ†é…ç­–ç•¥</span></span>
<span class="line"><span style="color:#616E88;"> */</span></span>
<span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Main</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    private</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> final</span><span style="color:#81A1C1;"> int</span><span style="color:#D8DEE9;"> _512KB</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 512</span><span style="color:#81A1C1;"> *</span><span style="color:#B48EAD;"> 1024</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    private</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> final</span><span style="color:#81A1C1;"> int</span><span style="color:#D8DEE9;"> _1MB</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 1024</span><span style="color:#81A1C1;"> *</span><span style="color:#B48EAD;"> 1024</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    private</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> final</span><span style="color:#81A1C1;"> int</span><span style="color:#D8DEE9;"> _6MB</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 6</span><span style="color:#81A1C1;"> *</span><span style="color:#B48EAD;"> 1024</span><span style="color:#81A1C1;"> *</span><span style="color:#B48EAD;"> 1024</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    private</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> final</span><span style="color:#81A1C1;"> int</span><span style="color:#D8DEE9;"> _7MB</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 7</span><span style="color:#81A1C1;"> *</span><span style="color:#B48EAD;"> 1024</span><span style="color:#81A1C1;"> *</span><span style="color:#B48EAD;"> 1024</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    private</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> final</span><span style="color:#81A1C1;"> int</span><span style="color:#D8DEE9;"> _8MB</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 8</span><span style="color:#81A1C1;"> *</span><span style="color:#B48EAD;"> 1024</span><span style="color:#81A1C1;"> *</span><span style="color:#B48EAD;"> 1024</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">    // -Xms20M -Xmx20M -Xmn10M -XX:+UseSerialGC -XX:+PrintGCDetails -verbose:gc -XX:-ScavengeBeforeFullGC</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> throws</span><span style="color:#8FBCBB;"> InterruptedException</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">        new</span><span style="color:#88C0D0;"> Thread</span><span style="color:#ECEFF4;">(()</span><span style="color:#8FBCBB;"> -&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">            ArrayList</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#81A1C1;">byte</span><span style="color:#ECEFF4;">[]&gt;</span><span style="color:#D8DEE9;"> list</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#8FBCBB;"> ArrayList</span><span style="color:#ECEFF4;">&lt;&gt;()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">            list</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">add</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">new</span><span style="color:#81A1C1;"> byte</span><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">_8MB</span><span style="color:#ECEFF4;">])</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">            list</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">add</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">new</span><span style="color:#81A1C1;"> byte</span><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">_8MB</span><span style="color:#ECEFF4;">])</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }).</span><span style="color:#88C0D0;">start</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">                //ä¸»çº¿ç¨‹è¿˜æ˜¯ä¼šæ­£å¸¸æ‰§è¡Œ</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">sleep....</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        Thread</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">sleep</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">1000L</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806120.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><h2 id="_4-åƒåœ¾å›æ”¶å™¨" tabindex="-1"><a class="header-anchor" href="#_4-åƒåœ¾å›æ”¶å™¨"><span>4. åƒåœ¾å›æ”¶å™¨</span></a></h2><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806464.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>åƒåœ¾æ”¶é›†å™¨ç‰¹ç‚¹ç®—æ³•é€‚ç”¨åœºæ™¯ä¼˜ç‚¹ç¼ºç‚¹Serialæœ€åŸºæœ¬ã€å†å²æœ€æ‚ ä¹…çš„å•çº¿ç¨‹åƒåœ¾æ”¶é›†å™¨ã€‚æ–°ç”Ÿä»£é‡‡ç”¨æ ‡è®°-å¤åˆ¶ç®—æ³•è¿è¡Œåœ¨ Client æ¨¡å¼ä¸‹çš„è™šæ‹Ÿæœºç®€å•ã€é«˜æ•ˆåƒåœ¾å›æ”¶æ—¶å¿…é¡»æš‚åœå…¶ä»–æ‰€æœ‰çš„å·¥ä½œçº¿ç¨‹ParNewSerial æ”¶é›†å™¨çš„å¤šçº¿ç¨‹ç‰ˆæœ¬æ–°ç”Ÿä»£é‡‡ç”¨æ ‡è®°-å¤åˆ¶ç®—æ³•è¿è¡Œåœ¨ Server æ¨¡å¼ä¸‹çš„è™šæ‹Ÿæœºå¹¶è¡Œï¼Œæ•ˆç‡é«˜ Parallel Scavengeä½¿ç”¨æ ‡è®°-å¤åˆ¶ç®—æ³•çš„å¤šçº¿ç¨‹æ”¶é›†å™¨ï¼Œå…³æ³¨ååé‡æ–°ç”Ÿä»£é‡‡ç”¨æ ‡è®°-å¤åˆ¶ç®—æ³•JDK1.8 é»˜è®¤æ”¶é›†å™¨åœ¨æ³¨é‡ååé‡åŠCPUèµ„æºçš„åœºåˆååé‡é«˜ Serial OldSerial æ”¶é›†å™¨çš„è€å¹´ä»£ç‰ˆæœ¬æ ‡è®°-æ•´ç†ç®—æ³•åœ¨ JDK&lt;1.5ä¸ Parallel Scavenge æ”¶é›†å™¨æ­é…ä½¿ç”¨ä½œä¸ºCMSæ”¶é›†å™¨çš„åå¤‡æ–¹æ¡ˆç®€å•ã€é«˜æ•ˆåƒåœ¾å›æ”¶æ—¶å¿…é¡»æš‚åœå…¶ä»–æ‰€æœ‰çš„å·¥ä½œçº¿ç¨‹Parallel OldParallel Scavenge æ”¶é›†å™¨çš„è€å¹´ä»£æ ‡è®°-æ•´ç†ç®—æ³•åœ¨æ³¨é‡ååé‡åŠCPUèµ„æºçš„åœºåˆååé‡é«˜ CMSå¤šçº¿ç¨‹çš„åƒåœ¾æ”¶é›†å™¨ï¼ˆç”¨æˆ·çº¿ç¨‹å’Œåƒåœ¾å›æ”¶çº¿ç¨‹å¯ä»¥åŒæ—¶è¿›è¡Œï¼‰æ ‡è®°-æ¸…é™¤ç®—æ³•å¸Œæœ›ç³»ç»Ÿåœé¡¿æ—¶é—´æœ€çŸ­ï¼Œæ³¨é‡æœåŠ¡çš„å“åº”é€Ÿåº¦çš„åœºæ™¯å¹¶å‘æ”¶é›†ã€ä½åœé¡¿å¯¹ CPU èµ„æºæ•æ„Ÿï¼Œæ— æ³•å¤„ç†æµ®åŠ¨åƒåœ¾ï¼Œäº§ç”Ÿåƒåœ¾ç¢ç‰‡G1ä¸€æ¬¾é¢å‘æœåŠ¡å™¨çš„åƒåœ¾æ”¶é›†å™¨ï¼Œå¹¶è¡Œå¹¶å‘ï¼Œç©ºé—´æ•´åˆï¼Œå¯é¢„æµ‹çš„åœé¡¿æ—¶é—´æ ‡è®°-å¤åˆ¶ç®—æ³•æœåŠ¡ç«¯åº”ç”¨ã€é’ˆå¯¹å…·æœ‰å¤§å†…å­˜å¤šå¤„ç†å™¨çš„æœºå™¨åœé¡¿æ—¶é—´å¯æ§ã€åŸºæœ¬æ— ç©ºé—´ç¢ç‰‡å¯èƒ½å­˜åœ¨ç©ºé—´æµªè´¹ã€ç¨‹åºè¿è¡Œæ—¶çš„é¢å¤–æ‰§è¡Œè´Ÿè½½é«˜</p><p><strong>ç›¸å…³æ¦‚å¿µ</strong>ï¼š</p><ul><li><strong>å¹¶è¡Œ****æ”¶é›†</strong>ï¼šæŒ‡å¤šæ¡åƒåœ¾æ”¶é›†çº¿ç¨‹å¹¶è¡Œå·¥ä½œï¼Œä½†æ­¤æ—¶<strong>ç”¨æˆ·çº¿ç¨‹****ä»å¤„äºç­‰å¾…çŠ¶æ€</strong></li><li><strong>å¹¶å‘æ”¶é›†</strong>ï¼šæŒ‡ç”¨æˆ·çº¿ç¨‹ä¸åƒåœ¾æ”¶é›†çº¿ç¨‹<strong>åŒæ—¶å·¥ä½œ</strong>ï¼ˆä¸ä¸€å®šæ˜¯å¹¶è¡Œçš„å¯èƒ½ä¼šäº¤æ›¿æ‰§è¡Œï¼‰ã€‚ç”¨æˆ·ç¨‹åºåœ¨ç»§ç»­è¿è¡Œï¼Œè€Œåƒåœ¾æ”¶é›†ç¨‹åºè¿è¡Œåœ¨å¦ä¸€ä¸ªCPUä¸Š</li><li><strong>ååé‡</strong>ï¼šå³CPUç”¨äº<strong>è¿è¡Œç”¨æˆ·ä»£ç çš„æ—¶é—´</strong>ä¸CPU<strong>æ€»æ¶ˆè€—æ—¶é—´</strong>çš„æ¯”å€¼ï¼ˆååé‡ = è¿è¡Œç”¨æˆ·ä»£ç æ—¶é—´ / ( è¿è¡Œç”¨æˆ·ä»£ç æ—¶é—´ + åƒåœ¾æ”¶é›†æ—¶é—´ )ï¼‰ï¼Œä¹Ÿå°±æ˜¯ã€‚ä¾‹å¦‚ï¼šè™šæ‹Ÿæœºå…±è¿è¡Œ100åˆ†é’Ÿï¼Œåƒåœ¾æ”¶é›†å™¨èŠ±æ‰1åˆ†é’Ÿï¼Œé‚£ä¹ˆååé‡å°±æ˜¯99%</li></ul><h4 id="_4-1-ä¸²è¡Œ-serial-serialold-æ–°ç”Ÿä»£å¤åˆ¶-è€å¹´ä»£æ ‡è®°æ•´ç†" tabindex="-1"><a class="header-anchor" href="#_4-1-ä¸²è¡Œ-serial-serialold-æ–°ç”Ÿä»£å¤åˆ¶-è€å¹´ä»£æ ‡è®°æ•´ç†"><span>4.1 ä¸²è¡Œï¼ˆSerial + SerialOldï¼Œæ–°ç”Ÿä»£å¤åˆ¶ï¼Œè€å¹´ä»£æ ‡è®°æ•´ç†ï¼‰</span></a></h4><ul><li>å•çº¿ç¨‹</li><li>å †å†…å­˜å°ï¼Œé€‚åˆä¸ªäººç”µè„‘</li></ul><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806544.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p><strong>å¼€å¯ä¸²è¡Œå›æ”¶å™¨</strong>ï¼š</p><p><code>XX:+UseSerialGC = Serial + SerialOld</code>ï¼Œæ–°ç”Ÿä»£<strong>Serial</strong> ï¼Œè€å¹´ä»£<strong>SerialOld</strong></p><p><strong>å®‰å…¨ç‚¹</strong>ï¼šè®©å…¶ä»–çº¿ç¨‹éƒ½åœ¨è¿™ä¸ªç‚¹åœä¸‹æ¥ï¼Œä»¥å…åƒåœ¾å›æ”¶æ—¶ç§»åŠ¨å¯¹è±¡åœ°å€ï¼Œä½¿å¾—å…¶ä»–çº¿ç¨‹æ‰¾ä¸åˆ°è¢«ç§»åŠ¨çš„å¯¹è±¡ã€‚</p><p><strong>é˜»å¡</strong>ï¼šå› ä¸ºæ˜¯ä¸²è¡Œçš„ï¼Œæ‰€ä»¥åªæœ‰ä¸€ä¸ªåƒåœ¾å›æ”¶çº¿ç¨‹ã€‚ä¸”åœ¨è¯¥çº¿ç¨‹æ‰§è¡Œå›æ”¶å·¥ä½œæ—¶ï¼Œå…¶ä»–çº¿ç¨‹è¿›å…¥<strong>é˜»å¡</strong>çŠ¶æ€</p><p><strong>Serial æ”¶é›†å™¨</strong>ï¼š</p><ul><li>å®šä¹‰ï¼šSerialæ”¶é›†å™¨æ˜¯æœ€åŸºæœ¬çš„ã€å‘å±•å†å²æœ€æ‚ ä¹…çš„æ”¶é›†å™¨</li><li>ç‰¹ç‚¹ï¼š<strong>å•çº¿ç¨‹</strong>æ”¶é›†å™¨ã€‚é‡‡ç”¨<strong>å¤åˆ¶</strong>ç®—æ³•ã€‚å·¥ä½œåœ¨<strong>æ–°ç”Ÿä»£</strong></li><li>Serial æ”¶é›†å™¨æ˜¯æœ€åŸºæœ¬çš„ã€å‘å±•å†å²æœ€æ‚ ä¹…çš„æ”¶é›†å™¨ <strong>ç‰¹ç‚¹</strong>ï¼šå•çº¿ç¨‹ã€ç®€å•é«˜æ•ˆï¼ˆä¸å…¶ä»–æ”¶é›†å™¨çš„å•çº¿ç¨‹ç›¸æ¯”ï¼‰ï¼Œé‡‡ç”¨å¤åˆ¶ç®—æ³•ã€‚å¯¹äºé™å®šå•ä¸ª CPU çš„ç¯å¢ƒæ¥è¯´ï¼ŒSerial æ”¶é›†å™¨ç”±äºæ²¡æœ‰çº¿ç¨‹äº¤äº’çš„å¼€é”€ï¼Œä¸“å¿ƒåšåƒåœ¾æ”¶é›†è‡ªç„¶å¯ä»¥è·å¾—æœ€é«˜çš„å•çº¿ç¨‹æ”¶é›†æ•ˆç‡ã€‚æ”¶é›†å™¨è¿›è¡Œåƒåœ¾å›æ”¶æ—¶ï¼Œå¿…é¡»æš‚åœå…¶ä»–æ‰€æœ‰çš„å·¥ä½œçº¿ç¨‹ï¼Œç›´åˆ°å®ƒç»“æŸï¼ˆStop The Worldï¼‰ï¼</li></ul><p><strong>Serial Oldæ”¶é›†å™¨</strong>ï¼š</p><ul><li>å®šä¹‰ï¼šSerial Oldæ˜¯Serialæ”¶é›†å™¨çš„è€å¹´ä»£ç‰ˆæœ¬</li><li>ç‰¹ç‚¹ï¼š<strong>å•çº¿ç¨‹</strong>æ”¶é›†å™¨ã€‚é‡‡ç”¨<strong>æ ‡è®°-æ•´ç†</strong>ç®—æ³•ã€‚å·¥ä½œåœ¨<strong>è€å¹´ä»£</strong></li><li>åŒæ ·æ˜¯å•çº¿ç¨‹æ”¶é›†å™¨ï¼Œé‡‡ç”¨æ ‡è®°-æ•´ç†ç®—æ³•</li></ul><p><strong>ParNew æ”¶é›†å™¨</strong> ParNew æ”¶é›†å™¨å…¶å®å°±æ˜¯ Serial æ”¶é›†å™¨çš„å¤šçº¿ç¨‹ç‰ˆæœ¬ <strong>ç‰¹ç‚¹</strong>ï¼šå¤šçº¿ç¨‹ã€ParNew æ”¶é›†å™¨é»˜è®¤å¼€å¯çš„æ”¶é›†çº¿ç¨‹æ•°ä¸CPUçš„æ•°é‡ç›¸åŒï¼Œåœ¨ CPU éå¸¸å¤šçš„ç¯å¢ƒä¸­ï¼Œå¯ä»¥ä½¿ç”¨ -XX:ParallelGCThreads å‚æ•°æ¥é™åˆ¶åƒåœ¾æ”¶é›†çš„çº¿ç¨‹æ•°ã€‚å’Œ Serial æ”¶é›†å™¨ä¸€æ ·å­˜åœ¨ Stop The World é—®é¢˜</p><h4 id="_4-2-ååé‡ä¼˜å…ˆ" tabindex="-1"><a class="header-anchor" href="#_4-2-ååé‡ä¼˜å…ˆ"><span>4.2 ååé‡ä¼˜å…ˆ</span></a></h4><ul><li>å¤šçº¿ç¨‹</li><li>å †å†…å­˜è¾ƒå¤§ï¼Œå¤šæ ¸cpu</li><li>è®©<strong>å•ä½æ—¶é—´****å†…</strong>æš‚åœæ—¶é—´ï¼ˆSTWï¼‰æœ€çŸ­</li><li><strong>JDK1.8é»˜è®¤ä½¿ç”¨</strong>çš„åƒåœ¾å›æ”¶å™¨</li></ul><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806723.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">-</span><span style="color:#D8DEE9FF;">XX</span><span style="color:#81A1C1;">:+</span><span style="color:#D8DEE9FF;">UseParallelGC </span><span style="color:#81A1C1;">~</span><span style="color:#81A1C1;"> -</span><span style="color:#D8DEE9FF;">XX</span><span style="color:#81A1C1;">:+</span><span style="color:#8FBCBB;">UsePrallerOldGC</span></span>
<span class="line"><span style="color:#81A1C1;">-</span><span style="color:#D8DEE9FF;">XX</span><span style="color:#81A1C1;">:+</span><span style="color:#8FBCBB;">UseAdaptiveSizePolicy</span></span>
<span class="line"><span style="color:#81A1C1;">-</span><span style="color:#D8DEE9FF;">XX</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;">GCTimeRatio</span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;">ratio </span><span style="color:#616E88;">// 1/(1+radio)</span></span>
<span class="line"><span style="color:#81A1C1;">-</span><span style="color:#D8DEE9FF;">XX</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;">MaxGCPauseMillis</span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;">ms </span><span style="color:#616E88;">// 200ms</span></span>
<span class="line"><span style="color:#81A1C1;">-</span><span style="color:#D8DEE9FF;">XX</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;">ParallelGCThreads</span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;">n</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Parallel æ”¶é›†å™¨</strong>ï¼š</p><ul><li>å®šä¹‰ï¼šä¸ååé‡å…³ç³»å¯†åˆ‡ï¼Œæ•…ä¹Ÿç§°ä¸ºååé‡ä¼˜å…ˆæ”¶é›†å™¨</li><li>ç‰¹ç‚¹ï¼š<strong>å¹¶è¡Œ****çš„</strong>ï¼Œå·¥ä½œäº<strong>æ–°ç”Ÿä»£</strong>ï¼Œé‡‡ç”¨<strong>å¤åˆ¶</strong>ç®—æ³•</li><li>ä¸ååé‡å…³ç³»å¯†åˆ‡ï¼Œæ•…ä¹Ÿç§°ä¸ºååé‡ä¼˜å…ˆæ”¶é›†å™¨ <strong>ç‰¹ç‚¹</strong>ï¼šå±äºæ–°ç”Ÿä»£æ”¶é›†å™¨ä¹Ÿæ˜¯é‡‡ç”¨å¤åˆ¶ç®—æ³•çš„æ”¶é›†å™¨ï¼ˆç”¨åˆ°äº†æ–°ç”Ÿä»£çš„å¹¸å­˜åŒºï¼‰ï¼Œåˆæ˜¯å¹¶è¡Œçš„å¤šçº¿ç¨‹æ”¶é›†å™¨ï¼ˆä¸ ParNew æ”¶é›†å™¨ç±»ä¼¼ï¼‰</li><li>è¯¥æ”¶é›†å™¨çš„ç›®æ ‡æ˜¯è¾¾åˆ°ä¸€ä¸ªå¯æ§åˆ¶çš„ååé‡ã€‚è¿˜æœ‰ä¸€ä¸ªå€¼å¾—å…³æ³¨çš„ç‚¹æ˜¯ï¼šGCè‡ªé€‚åº”è°ƒèŠ‚ç­–ç•¥ï¼ˆä¸ ParNew æ”¶é›†å™¨æœ€é‡è¦çš„ä¸€ä¸ªåŒºåˆ«ï¼‰</li><li>GCè‡ªé€‚åº”è°ƒèŠ‚ç­–ç•¥ï¼š Parallel Scavenge æ”¶é›†å™¨å¯è®¾ç½® -XX:+UseAdptiveSizePolicy å‚æ•°ã€‚ å½“å¼€å…³æ‰“å¼€æ—¶ä¸éœ€è¦æ‰‹åŠ¨æŒ‡å®šæ–°ç”Ÿä»£çš„å¤§å°ï¼ˆ-Xmnï¼‰ã€Eden ä¸ Survivor åŒºçš„æ¯”ä¾‹ï¼ˆ-XX:SurvivorRationï¼‰ã€ æ™‹å‡è€å¹´ä»£çš„å¯¹è±¡å¹´é¾„ï¼ˆ-XX:PretenureSizeThresholdï¼‰ç­‰ï¼Œè™šæ‹Ÿæœºä¼šæ ¹æ®ç³»ç»Ÿçš„è¿è¡ŒçŠ¶å†µæ”¶é›†æ€§èƒ½ç›‘æ§ä¿¡æ¯ï¼ŒåŠ¨æ€è®¾ç½®è¿™äº›å‚æ•°ä»¥æä¾›æœ€ä¼˜çš„åœé¡¿æ—¶é—´å’Œæœ€é«˜çš„ååé‡ï¼Œè¿™ç§è°ƒèŠ‚æ–¹å¼ç§°ä¸º GC çš„è‡ªé€‚åº”è°ƒèŠ‚ç­–ç•¥ã€‚</li></ul><p>Parallel Scavenge æ”¶é›†å™¨ä½¿ç”¨ä¸¤ä¸ªå‚æ•°æ§åˆ¶ååé‡ï¼š</p><ul><li>XX:MaxGCPauseMillis=ms æ§åˆ¶æœ€å¤§çš„åƒåœ¾æ”¶é›†åœé¡¿æ—¶é—´ï¼ˆé»˜è®¤200msï¼‰</li><li>XX:GCTimeRatio=rario ç›´æ¥è®¾ç½®ååé‡çš„å¤§å°</li></ul><p><strong>Parallel Old æ”¶é›†å™¨</strong>ï¼š</p><ul><li>å®šä¹‰ï¼šæ˜¯Parallel æ”¶é›†å™¨çš„è€å¹´ä»£ç‰ˆæœ¬</li><li>ç‰¹ç‚¹ï¼š<strong>å¹¶è¡Œ****çš„</strong>ï¼Œå·¥ä½œä¸<strong>è€å¹´ä»£</strong>ï¼Œé‡‡ç”¨<strong>æ ‡è®°-æ•´ç†ç®—æ³•</strong></li><li>æ˜¯ Parallel Scavenge æ”¶é›†å™¨çš„è€å¹´ä»£ç‰ˆæœ¬ <strong>ç‰¹ç‚¹</strong>ï¼šå¤šçº¿ç¨‹ï¼Œé‡‡ç”¨æ ‡è®°-æ•´ç†ç®—æ³•ï¼ˆè€å¹´ä»£æ²¡æœ‰å¹¸å­˜åŒºï¼‰</li></ul><h4 id="_4-3-å“åº”æ—¶é—´ä¼˜å…ˆ" tabindex="-1"><a class="header-anchor" href="#_4-3-å“åº”æ—¶é—´ä¼˜å…ˆ"><span>4.3 å“åº”æ—¶é—´ä¼˜å…ˆ</span></a></h4><ul><li>å¤šçº¿ç¨‹</li><li>å †å†…å­˜è¾ƒå¤§ï¼Œå¤šæ ¸cpu</li><li>å°½å¯èƒ½è®©<strong>å•æ¬¡çš„</strong>æš‚åœæ—¶é—´ï¼ˆSTWï¼‰æœ€çŸ­</li></ul><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806901.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">-</span><span style="color:#D8DEE9FF;">XX</span><span style="color:#81A1C1;">:+</span><span style="color:#D8DEE9FF;">UseConcMarkSweepGC </span><span style="color:#81A1C1;">~</span><span style="color:#81A1C1;"> -</span><span style="color:#D8DEE9FF;">XX</span><span style="color:#81A1C1;">:+</span><span style="color:#D8DEE9FF;">UseParNewGC </span><span style="color:#81A1C1;">~</span><span style="color:#8FBCBB;"> SerialOld</span></span>
<span class="line"><span style="color:#81A1C1;">-</span><span style="color:#D8DEE9FF;">XX</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;">ParallelGCThreads</span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;">n </span><span style="color:#81A1C1;">~</span><span style="color:#81A1C1;"> -</span><span style="color:#D8DEE9FF;">XX</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;">ConcGCThreads</span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;">threads</span></span>
<span class="line"><span style="color:#81A1C1;">-</span><span style="color:#D8DEE9FF;">XX</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;">CMSInitiatingOccupancyFraction</span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;">percent</span></span>
<span class="line"><span style="color:#81A1C1;">-</span><span style="color:#D8DEE9FF;">XX</span><span style="color:#81A1C1;">:+</span><span style="color:#8FBCBB;">CMSScavengeBeforeRemark</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>CMS****æ”¶é›†å™¨</strong>ï¼š</p><ul><li>å®šä¹‰ï¼šConcurrent Mark Sweepï¼ˆå¹¶å‘ï¼Œæ ‡è®°ï¼Œæ¸…é™¤ï¼‰</li><li>ç‰¹ç‚¹ï¼šåŸºäº<strong>æ ‡è®°-æ¸…é™¤</strong>ç®—æ³•çš„åƒåœ¾å›æ”¶å™¨ã€‚æ˜¯å¹¶å‘çš„ã€‚å·¥ä½œåœ¨<strong>è€å¹´ä»£</strong>ã€‚</li><li>Concurrent Mark Sweepï¼Œä¸€ç§ä»¥è·å–æœ€çŸ­å›æ”¶åœé¡¿æ—¶é—´ä¸ºç›®æ ‡çš„<strong>è€å¹´ä»£æ”¶é›†å™¨</strong> <strong>ç‰¹ç‚¹</strong>ï¼šåŸºäºæ ‡è®°-æ¸…é™¤ç®—æ³•å®ç°ã€‚å¹¶å‘æ”¶é›†ã€ä½åœé¡¿ï¼Œä½†æ˜¯ä¼šäº§ç”Ÿå†…å­˜ç¢ç‰‡ <strong>åº”ç”¨åœºæ™¯</strong>ï¼šé€‚ç”¨äºæ³¨é‡æœåŠ¡çš„å“åº”é€Ÿåº¦ï¼Œå¸Œæœ›ç³»ç»Ÿåœé¡¿æ—¶é—´æœ€çŸ­ï¼Œç»™ç”¨æˆ·å¸¦æ¥æ›´å¥½çš„ä½“éªŒç­‰åœºæ™¯ä¸‹ã€‚å¦‚ web ç¨‹åºã€b/s æœåŠ¡</li></ul><p><strong>CMS</strong> <strong>æ”¶é›†å™¨çš„è¿è¡Œè¿‡ç¨‹åˆ†ä¸ºä¸‹åˆ—4æ­¥ï¼š</strong></p><ul><li><strong>åˆå§‹æ ‡è®°</strong>ï¼šæ ‡è®° GC Roots èƒ½ç›´æ¥åˆ°çš„å¯¹è±¡ã€‚é€Ÿåº¦å¾ˆå¿«ä½†æ˜¯ä»å­˜åœ¨ Stop The World é—®é¢˜ã€‚</li><li><strong>å¹¶å‘æ ‡è®°</strong>ï¼šè¿›è¡Œ GC Roots Tracing çš„è¿‡ç¨‹ï¼Œæ‰¾å‡ºå­˜æ´»å¯¹è±¡ä¸”ç”¨æˆ·çº¿ç¨‹å¯å¹¶å‘æ‰§è¡Œã€‚</li><li><strong>é‡æ–°æ ‡è®°</strong>ï¼šä¸ºäº†ä¿®æ­£å¹¶å‘æ ‡è®°æœŸé—´å› ç”¨æˆ·ç¨‹åºç»§ç»­è¿è¡Œè€Œå¯¼è‡´æ ‡è®°äº§ç”Ÿå˜åŠ¨çš„é‚£ä¸€éƒ¨åˆ†å¯¹è±¡çš„æ ‡è®°è®°å½•ã€‚ä»ç„¶å­˜åœ¨ Stop The World é—®é¢˜</li><li><strong>å¹¶å‘æ¸…é™¤</strong>ï¼šå¯¹æ ‡è®°çš„å¯¹è±¡è¿›è¡Œæ¸…é™¤å›æ”¶ï¼Œæ¸…é™¤çš„è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä»»ç„¶ä¼šæœ‰æ–°çš„åƒåœ¾äº§ç”Ÿï¼Œè¿™äº›åƒåœ¾å°±å«æµ®åŠ¨åƒåœ¾ï¼Œå¦‚æœå½“ç”¨æˆ·éœ€è¦å­˜å…¥ä¸€ä¸ªå¾ˆå¤§çš„å¯¹è±¡æ—¶ï¼Œæ–°ç”Ÿä»£æ”¾ä¸ä¸‹å»ï¼Œè€å¹´ä»£ç”±äºæµ®åŠ¨åƒåœ¾è¿‡å¤šï¼Œå°±ä¼šé€€åŒ–ä¸º serial Old æ”¶é›†å™¨ï¼Œå°†è€å¹´ä»£åƒåœ¾è¿›è¡Œæ ‡è®°-æ•´ç†ï¼Œå½“ç„¶è¿™ä¹Ÿæ˜¯å¾ˆè€—è´¹æ—¶é—´çš„ï¼</li></ul><p>CMS æ”¶é›†å™¨çš„å†…å­˜å›æ”¶è¿‡ç¨‹æ˜¯ä¸ç”¨æˆ·çº¿ç¨‹ä¸€èµ·å¹¶å‘æ‰§è¡Œçš„ï¼Œå¯ä»¥æ­é… ParNew æ”¶é›†å™¨ï¼ˆå¤šçº¿ç¨‹ï¼Œæ–°ç”Ÿä»£ï¼Œå¤åˆ¶ç®—æ³•ï¼‰ä¸ Serial Old æ”¶é›†å™¨ï¼ˆå•çº¿ç¨‹ï¼Œè€å¹´ä»£ï¼Œæ ‡è®°-æ•´ç†ç®—æ³•ï¼‰ä½¿ç”¨ã€‚</p><p><strong>ParNew æ”¶é›†å™¨</strong>ï¼š</p><ul><li>å®šä¹‰ï¼šParNewæ”¶é›†å™¨å…¶å®å°±æ˜¯Serialæ”¶é›†å™¨çš„å¤šçº¿ç¨‹ç‰ˆæœ¬</li><li>ç‰¹ç‚¹ï¼šå·¥ä½œåœ¨<strong>æ–°ç”Ÿä»£</strong>ï¼ŒåŸºäº<strong>å¤åˆ¶</strong>ç®—æ³•çš„åƒåœ¾å›æ”¶å™¨ã€‚</li></ul><h4 id="_4-4-garbage-first" tabindex="-1"><a class="header-anchor" href="#_4-4-garbage-first"><span>4.4 Garbage First</span></a></h4><ul><li>JDK 9ä»¥åé»˜è®¤ä½¿ç”¨ï¼Œè€Œä¸”æ›¿ä»£äº†CMS æ”¶é›†å™¨</li></ul><p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š</p><ul><li>åŒæ—¶æ³¨é‡<strong>ååé‡****ï¼ˆ<strong><strong>Throughput</strong></strong>ï¼‰å’Œ****ä½å»¶è¿Ÿ</strong>ï¼ˆLow latencyï¼‰ï¼Œé»˜è®¤çš„æš‚åœç›®æ ‡æ˜¯ 200 ms</li><li>è¶…å¤§å †å†…å­˜ï¼Œä¼šå°†å †åˆ’åˆ†ä¸ºå¤šä¸ª<strong>å¤§å°ç›¸ç­‰</strong>çš„ <strong>Region</strong></li><li>æ•´ä½“ä¸Šæ˜¯ <strong>æ ‡è®°+æ•´ç†</strong> ç®—æ³•ï¼Œä¸¤ä¸ªåŒºåŸŸä¹‹é—´æ˜¯ <strong>å¤åˆ¶</strong> ç®—æ³•</li></ul><p><strong>ç›¸å…³å‚æ•°ï¼š</strong> JDK8 å¹¶ä¸æ˜¯é»˜è®¤å¼€å¯çš„ï¼Œæ‰€éœ€è¦å‚æ•°å¼€å¯</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">-</span><span style="color:#D8DEE9FF;">XX</span><span style="color:#81A1C1;">:+</span><span style="color:#8FBCBB;">UseG1GC</span></span>
<span class="line"><span style="color:#81A1C1;">-</span><span style="color:#D8DEE9FF;">XX</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;">G1HeapRegionSize</span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;">size</span></span>
<span class="line"><span style="color:#81A1C1;">-</span><span style="color:#D8DEE9FF;">XX</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;">MaxGCPauseMillis</span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;">time</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>åƒåœ¾å›æ”¶****é˜¶æ®µ</strong>ï¼š</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806946.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>æ–°ç”Ÿä»£ä¼Šç”¸å›­åƒåœ¾å›æ”¶â€”â€“&gt;å†…å­˜ä¸è¶³ï¼Œæ–°ç”Ÿä»£å›æ”¶+å¹¶å‘æ ‡è®°â€”â€“&gt;æ··åˆæ”¶é›†ï¼Œå›æ”¶æ–°ç”Ÿä»£ä¼Šç”¸å›­ã€å¹¸å­˜åŒºã€è€å¹´ä»£å†…å­˜â€”â€”&gt;æ–°ç”Ÿä»£ä¼Šç”¸å›­åƒåœ¾å›æ”¶ï¼ˆé‡æ–°å¼€å§‹ï¼‰</p><p>Young Collectionï¼šå¯¹æ–°ç”Ÿä»£åƒåœ¾æ”¶é›† Young Collection + Concurrent Markï¼šå¦‚æœè€å¹´ä»£å†…å­˜åˆ°è¾¾ä¸€å®šçš„é˜ˆå€¼äº†ï¼Œæ–°ç”Ÿä»£åƒåœ¾æ”¶é›†åŒæ—¶ä¼šæ‰§è¡Œä¸€äº›å¹¶å‘çš„æ ‡è®°ã€‚ Mixed Collectionï¼šä¼šå¯¹æ–°ç”Ÿä»£ + è€å¹´ä»£ + å¹¸å­˜åŒºç­‰è¿›è¡Œæ··åˆæ”¶é›†ï¼Œç„¶åæ”¶é›†ç»“æŸï¼Œä¼šé‡æ–°è¿›å…¥æ–°ç”Ÿä»£æ”¶é›†ã€‚</p><h5 id="young-collection" tabindex="-1"><a class="header-anchor" href="#young-collection"><span>Young Collection</span></a></h5><p><strong>æ–°ç”Ÿä»£å­˜åœ¨ STWï¼š</strong> åˆ†ä»£æ˜¯æŒ‰å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸåˆ’åˆ†ï¼Œåˆ†åŒºåˆ™æ˜¯å°†å †ç©ºé—´åˆ’åˆ†è¿ç»­å‡ ä¸ªä¸åŒå°åŒºé—´ï¼Œæ¯ä¸€ä¸ªå°åŒºé—´ç‹¬ç«‹å›æ”¶ï¼Œå¯ä»¥æ§åˆ¶ä¸€æ¬¡å›æ”¶å¤šå°‘ä¸ªå°åŒºé—´ï¼Œæ–¹ä¾¿æ§åˆ¶ GC äº§ç”Ÿçš„åœé¡¿æ—¶é—´ï¼ Eï¼šedenï¼ŒSï¼šå¹¸å­˜åŒºï¼ŒOï¼šè€å¹´ä»£ æ–°ç”Ÿä»£æ”¶é›†ä¼šäº§ç”Ÿ STW ï¼</p><p>Eï¼šä¼Šç”¸å›­ Sï¼šå¹¸å­˜åŒº Oï¼šè€å¹´ä»£</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806753.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806075.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806106.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><h5 id="young-collection-cm" tabindex="-1"><a class="header-anchor" href="#young-collection-cm"><span><strong>Young Collection +</strong> <strong>CM</strong>ï¼š</span></a></h5><ul><li>CMï¼šå¹¶å‘æ ‡è®°</li><li>åœ¨ Young GC æ—¶ä¼š<strong>å¯¹ GC Root è¿›è¡Œåˆå§‹æ ‡è®°</strong></li><li>åœ¨è€å¹´ä»£<strong>å ç”¨<strong><strong>å †å†…å­˜</strong></strong>çš„æ¯”ä¾‹</strong>è¾¾åˆ°é˜ˆå€¼æ—¶ï¼Œå¯¹è¿›è¡Œå¹¶å‘æ ‡è®°ï¼ˆä¸ä¼šSTWï¼‰ï¼Œé˜ˆå€¼å¯ä»¥æ ¹æ®ç”¨æˆ·æ¥è¿›è¡Œè®¾å®šï¼Œç”±ä¸‹é¢çš„ JVM å‚æ•°å†³å®š -XX:InitiatingHeapOccupancyPercent=percent ï¼ˆé»˜è®¤45%ï¼‰</li></ul><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806741.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><h5 id="mixed-collection" tabindex="-1"><a class="header-anchor" href="#mixed-collection"><span><strong>Mixed Collection</strong></span></a></h5><p>ä¼šå¯¹E S O è¿›è¡Œ<strong>å…¨é¢çš„å›æ”¶</strong></p><ul><li>æœ€ç»ˆæ ‡è®°ï¼ˆRemarkï¼‰ä¼šSTW</li><li>æ‹·è´å­˜æ´»ï¼ˆEvacuationï¼‰ä¼šSTW</li><li><code>-XX:MaxGCPauseMills:xxx</code> ï¼šç”¨äºæŒ‡å®šæœ€é•¿çš„åœé¡¿æ—¶é—´</li></ul><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806880.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><blockquote><p><strong>é—®</strong>ï¼šä¸ºä»€ä¹ˆæœ‰çš„è€å¹´ä»£è¢«æ‹·è´äº†ï¼Œæœ‰çš„æ²¡æ‹·è´ï¼Ÿ</p><p>å› ä¸ºæŒ‡å®šäº†æœ€å¤§åœé¡¿æ—¶é—´ï¼Œå¦‚æœå¯¹æ‰€æœ‰è€å¹´ä»£éƒ½è¿›è¡Œå›æ”¶ï¼Œè€—æ—¶å¯èƒ½è¿‡é«˜ã€‚ä¸ºäº†ä¿è¯æ—¶é—´ä¸è¶…è¿‡è®¾å®šçš„åœé¡¿æ—¶é—´ï¼Œä¼š<strong>å›æ”¶æœ€æœ‰ä»·å€¼çš„è€å¹´ä»£</strong>ï¼ˆå›æ”¶åï¼Œèƒ½å¤Ÿå¾—åˆ°æ›´å¤šå†…å­˜ï¼‰</p></blockquote><h5 id="full-gc" tabindex="-1"><a class="header-anchor" href="#full-gc"><span><strong>Full</strong> <strong>GC</strong></span></a></h5><ul><li><strong>SerialGC</strong><ul><li>æ–°ç”Ÿä»£å†…å­˜ä¸è¶³å‘ç”Ÿçš„åƒåœ¾æ”¶é›† - minor gc</li><li>è€å¹´ä»£å†…å­˜ä¸è¶³å‘ç”Ÿçš„åƒåœ¾æ”¶é›† - full gc</li></ul></li><li><strong>ParallelGC</strong><ul><li>æ–°ç”Ÿä»£å†…å­˜ä¸è¶³å‘ç”Ÿçš„åƒåœ¾æ”¶é›† - minor gc</li><li>è€å¹´ä»£å†…å­˜ä¸è¶³å‘ç”Ÿçš„åƒåœ¾æ”¶é›† - full gc</li></ul></li><li><strong>CMS</strong><ul><li>æ–°ç”Ÿä»£å†…å­˜ä¸è¶³å‘ç”Ÿçš„åƒåœ¾æ”¶é›† - minor gc</li><li>è€å¹´ä»£å†…å­˜ä¸è¶³</li></ul></li><li><strong>G1</strong><ul><li>æ–°ç”Ÿä»£å†…å­˜ä¸è¶³å‘ç”Ÿçš„åƒåœ¾æ”¶é›† - minor gc</li><li>è€å¹´ä»£å†…å­˜ä¸è¶³ï¼ˆè€å¹´ä»£æ‰€å å†…å­˜è¶…è¿‡é˜ˆå€¼ï¼‰ <ul><li>å¦‚æœåƒåœ¾äº§ç”Ÿé€Ÿåº¦æ…¢äºåƒåœ¾å›æ”¶é€Ÿåº¦ï¼Œä¸ä¼šè§¦å‘Full GCï¼Œè¿˜æ˜¯å¹¶å‘åœ°è¿›è¡Œæ¸…ç†</li><li>å¦‚æœåƒåœ¾äº§ç”Ÿé€Ÿåº¦å¿«äºåƒåœ¾å›æ”¶é€Ÿåº¦ï¼Œä¾¿ä¼šè§¦å‘Full GCï¼Œç„¶åé€€åŒ–æˆ serial Old æ”¶é›†å™¨ä¸²è¡Œçš„æ”¶é›†ï¼Œå°±ä¼šå¯¼è‡´åœé¡¿çš„æ—¶å€™é•¿ã€‚</li></ul></li></ul></li></ul><h5 id="young-collection-è·¨ä»£å¼•ç”¨" tabindex="-1"><a class="header-anchor" href="#young-collection-è·¨ä»£å¼•ç”¨"><span>Young Collection è·¨ä»£å¼•ç”¨</span></a></h5><ul><li>æ–°ç”Ÿä»£å›æ”¶çš„è·¨ä»£å¼•ç”¨ï¼ˆè€å¹´ä»£å¼•ç”¨æ–°ç”Ÿä»£ï¼‰é—®é¢˜</li></ul><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806753.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><ul><li>å¡è¡¨ï¼šè€å¹´ä»£è¢«åˆ’ä¸ºä¸€ä¸ªä¸ªå¡è¡¨</li><li>Remembered Setï¼šRemembered Set å­˜åœ¨äºEï¼ˆæ–°ç”Ÿä»£ï¼‰ä¸­ï¼Œç”¨äºä¿å­˜æ–°ç”Ÿä»£å¯¹è±¡å¯¹åº”çš„è„å¡</li><li>è„å¡ï¼šOè¢«åˆ’åˆ†ä¸ºå¤šä¸ªåŒºåŸŸï¼ˆä¸€ä¸ªåŒºåŸŸ512Kï¼‰ï¼Œå¦‚æœè¯¥åŒºåŸŸå¼•ç”¨äº†æ–°ç”Ÿä»£å¯¹è±¡ï¼Œåˆ™è¯¥åŒºåŸŸè¢«ç§°ä¸ºè„å¡</li><li>åœ¨å¼•ç”¨å˜æ›´æ—¶é€šè¿‡post-write barried + dirty card queue</li><li>concurrent refinement threads æ›´æ–° Remembered Set</li></ul><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806868.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><h5 id="remark" tabindex="-1"><a class="header-anchor" href="#remark"><span><strong>Remark</strong></span></a></h5><p>é‡æ–°æ ‡è®°é˜¶æ®µ åœ¨åƒåœ¾å›æ”¶æ—¶ï¼Œæ”¶é›†å™¨å¤„ç†å¯¹è±¡çš„è¿‡ç¨‹ä¸­</p><ul><li>é»‘è‰²ï¼šå·²è¢«å¤„ç†ï¼Œéœ€è¦ä¿ç•™çš„</li><li>ç°è‰²ï¼šæ­£åœ¨å¤„ç†ä¸­çš„</li><li>ç™½è‰²ï¼šè¿˜æœªå¤„ç†çš„</li></ul><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806873.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806924.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806440.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>ä½†æ˜¯åœ¨<strong>å¹¶å‘æ ‡è®°è¿‡ç¨‹ä¸­</strong>ï¼Œæœ‰å¯èƒ½é»‘è‰²Aè¢«å¤„ç†äº†ä»¥åæœªå¼•ç”¨Cï¼Œåé¢åˆå¼•ç”¨äº†Cï¼Œè¿™æ—¶å°±ä¼šç”¨åˆ°remark</p><ul><li>ä¹‹å‰Cæœªè¢«å¼•ç”¨ï¼Œè¿™æ—¶Aå¼•ç”¨äº†Cï¼Œå°±ä¼šç»™CåŠ ä¸€ä¸ªå†™å±éšœï¼Œå†™å±éšœçš„æŒ‡ä»¤ä¼šè¢«æ‰§è¡Œï¼Œå°†Cæ”¾å…¥ä¸€ä¸ªé˜Ÿåˆ—å½“ä¸­ï¼Œå¹¶å°†Cå˜ä¸º å¤„ç†ä¸­ çŠ¶æ€</li><li>åœ¨<strong>å¹¶å‘æ ‡è®°</strong>é˜¶æ®µç»“æŸä»¥åï¼Œé‡æ–°æ ‡è®°é˜¶æ®µä¼šSTWï¼Œç„¶åå°†æ”¾åœ¨è¯¥é˜Ÿåˆ—ä¸­çš„å¯¹è±¡é‡æ–°å¤„ç†ï¼Œå‘ç°æœ‰å¼ºå¼•ç”¨å¼•ç”¨å®ƒï¼Œå°±ä¼šå¤„ç†å®ƒ</li></ul><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806424.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806496.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><h5 id="jdk-8u20-å­—ç¬¦ä¸²å»é‡" tabindex="-1"><a class="header-anchor" href="#jdk-8u20-å­—ç¬¦ä¸²å»é‡"><span><strong>JDK 8u20 å­—ç¬¦ä¸²å»é‡</strong>ï¼š</span></a></h5><ul><li>ä¼˜ç‚¹ï¼šèŠ‚çœå¤§é‡å†…å­˜</li><li>ç¼ºç‚¹ï¼šç•¥å¾®å¤šå ç”¨äº† cpu æ—¶é—´ï¼Œæ–°ç”Ÿä»£å›æ”¶æ—¶é—´ç•¥å¾®å¢åŠ </li></ul><p>ä¾‹å¦‚ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#8FBCBB;">String</span><span style="color:#D8DEE9;"> s1</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> String</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">hello</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // char[]{&#39;h&#39;,&#39;e&#39;,&#39;l&#39;,&#39;l&#39;,&#39;o&#39;}</span></span>
<span class="line"><span style="color:#8FBCBB;">String</span><span style="color:#D8DEE9;"> s2</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> String</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">hello</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // char[]{&#39;h&#39;,&#39;e&#39;,&#39;l&#39;,&#39;l&#39;,&#39;o&#39;}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>å°†æ‰€æœ‰æ–°åˆ†é…çš„å­—ç¬¦ä¸²ï¼ˆåº•å±‚æ˜¯char[]ï¼‰æ”¾å…¥ä¸€ä¸ªé˜Ÿåˆ—</li><li>å½“æ–°ç”Ÿä»£å›æ”¶æ—¶ï¼ŒG1å¹¶å‘æ£€æŸ¥æ˜¯å¦æœ‰é‡å¤çš„å­—ç¬¦ä¸²</li><li>å¦‚æœå­—ç¬¦ä¸²çš„å€¼ä¸€æ ·ï¼Œå°±è®©ä»–ä»¬<strong>å¼•ç”¨åŒä¸€ä¸ªå­—ç¬¦ä¸²å¯¹è±¡</strong></li><li>æ³¨æ„ï¼Œå…¶ä¸String.internçš„åŒºåˆ« <ul><li>internå…³æ³¨çš„æ˜¯å­—ç¬¦ä¸²å¯¹è±¡</li><li>å­—ç¬¦ä¸²å»é‡å…³æ³¨çš„æ˜¯char[]</li><li>åœ¨JVMå†…éƒ¨ï¼Œä½¿ç”¨äº†ä¸åŒçš„å­—ç¬¦ä¸²è¡¨</li></ul></li></ul><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">-</span><span style="color:#D8DEE9FF;">XX</span><span style="color:#81A1C1;">:+</span><span style="color:#8FBCBB;">UseStringDeduplication</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h5 id="jdk-8u40-å¹¶å‘æ ‡è®°ç±»å¸è½½" tabindex="-1"><a class="header-anchor" href="#jdk-8u40-å¹¶å‘æ ‡è®°ç±»å¸è½½"><span><strong>JDK 8u40 å¹¶å‘æ ‡è®°ç±»å¸è½½</strong></span></a></h5><p>æ‰€æœ‰å¯¹è±¡éƒ½ç»è¿‡å¹¶å‘æ ‡è®°åï¼Œå°±èƒ½çŸ¥é“å“ªäº›ç±»ä¸å†è¢«ä½¿ç”¨ï¼Œå½“ä¸€ä¸ªç±»åŠ è½½å™¨çš„æ‰€æœ‰ç±»éƒ½ä¸å†ä½¿ç”¨ï¼Œåˆ™å¸è½½å®ƒæ‰€åŠ è½½çš„æ‰€æœ‰ç±»</p><p><code>-XX:+ClassUnloadingWithConcurrentMark</code> é»˜è®¤å¯ç”¨</p><h5 id="jdk-8u60-å›æ”¶å·¨å‹å¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#jdk-8u60-å›æ”¶å·¨å‹å¯¹è±¡"><span>JDK 8u60 å›æ”¶å·¨å‹å¯¹è±¡</span></a></h5><ul><li>ä¸€ä¸ªå¯¹è±¡å¤§äºregionçš„ä¸€åŠæ—¶ï¼Œå°±ç§°ä¸ºå·¨å‹å¯¹è±¡</li><li>G1ä¸ä¼šå¯¹å·¨å‹å¯¹è±¡è¿›è¡Œæ‹·è´</li><li>å›æ”¶æ—¶è¢«ä¼˜å…ˆè€ƒè™‘</li><li>G1ä¼šè·Ÿè¸ªè€å¹´ä»£æ‰€æœ‰incomingå¼•ç”¨ï¼Œå¦‚æœè€å¹´ä»£incomingå¼•ç”¨ä¸º0çš„å·¨å‹å¯¹è±¡å°±å¯ä»¥åœ¨æ–°ç”Ÿä»£åƒåœ¾å›æ”¶æ—¶å¤„ç†æ‰</li></ul><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806602.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p><strong>JDK 9 å¹¶å‘æ ‡è®°èµ·å§‹æ—¶é—´çš„è°ƒæ•´</strong>ï¼š</p><ul><li>å¹¶å‘æ ‡è®°å¿…é¡»åœ¨å †ç©ºé—´å æ»¡å‰å®Œæˆï¼Œå¦åˆ™é€€åŒ–ä¸º FullGC</li><li>JDK 9 ä¹‹å‰éœ€è¦ä½¿ç”¨ <code>-XX:InitiatingHeapOccupancyPercent</code></li><li>JDK 9 å¯ä»¥åŠ¨æ€è°ƒæ•´ <ul><li><code>-XX:InitiatingHeapOccupancyPercent</code> ç”¨æ¥è®¾ç½®åˆå§‹å€¼</li><li>è¿›è¡Œæ•°æ®é‡‡æ ·å¹¶åŠ¨æ€è°ƒæ•´</li><li>æ€»ä¼šæ·»åŠ ä¸€ä¸ªå®‰å…¨çš„ç©ºæ¡£ç©ºé—´</li></ul></li></ul><h2 id="_5-åƒåœ¾å›æ”¶è°ƒä¼˜" tabindex="-1"><a class="header-anchor" href="#_5-åƒåœ¾å›æ”¶è°ƒä¼˜"><span>5. åƒåœ¾å›æ”¶è°ƒä¼˜</span></a></h2><p>æŸ¥çœ‹è™šæ‹Ÿæœºå‚æ•°å‘½ä»¤</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;">D</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;">\</span><span style="color:#D8DEE9;">JavaJDK1</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">8</span><span style="color:#D8DEE9FF;">\bin\java  </span><span style="color:#81A1C1;">-</span><span style="color:#D8DEE9FF;">XX</span><span style="color:#81A1C1;">:+</span><span style="color:#D8DEE9FF;">PrintFlagsFinal </span><span style="color:#81A1C1;">-</span><span style="color:#D8DEE9FF;">version </span><span style="color:#81A1C1;">|</span><span style="color:#D8DEE9FF;"> findstr </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">GC</span><span style="color:#ECEFF4;">&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>å¯ä»¥æ ¹æ®å‚æ•°å»æŸ¥è¯¢å…·ä½“çš„ä¿¡æ¯</p><h4 id="_5-1-è°ƒä¼˜é¢†åŸŸ" tabindex="-1"><a class="header-anchor" href="#_5-1-è°ƒä¼˜é¢†åŸŸ"><span>5.1 è°ƒä¼˜é¢†åŸŸ</span></a></h4><ul><li>å†…å­˜</li><li>é”ç«äº‰</li><li>cpu å ç”¨</li><li>io</li><li>gc</li></ul><h4 id="_5-2-ç¡®å®šç›®æ ‡" tabindex="-1"><a class="header-anchor" href="#_5-2-ç¡®å®šç›®æ ‡"><span>5.2 ç¡®å®šç›®æ ‡</span></a></h4><p>ä½å»¶è¿Ÿ/é«˜ååé‡ï¼Ÿ é€‰æ‹©åˆé€‚çš„GCï¼Œç§‘å­¦è¿ç®—æ³¨é‡ååé‡ï¼Œäº’è”ç½‘æ³¨é‡ä½å»¶è¿Ÿã€‚</p><ul><li>CMS G1 ZGCï¼Œä½å»¶è¿Ÿ</li><li>ParallelGCï¼Œé«˜ååé‡</li><li>Zing</li></ul><h4 id="_5-3-æœ€å¿«çš„-gcæ˜¯ä¸å‘ç”Ÿgc" tabindex="-1"><a class="header-anchor" href="#_5-3-æœ€å¿«çš„-gcæ˜¯ä¸å‘ç”Ÿgc"><span>5.3 æœ€å¿«çš„ GCæ˜¯ä¸å‘ç”ŸGC</span></a></h4><p>é¦–å…ˆæ’é™¤å‡å°‘å› ä¸ºè‡ªèº«ç¼–å†™çš„ä»£ç è€Œå¼•å‘çš„å†…å­˜é—®é¢˜</p><ul><li>æŸ¥çœ‹ Full GC å‰åçš„å†…å­˜å ç”¨ï¼Œè€ƒè™‘ä»¥ä¸‹å‡ ä¸ªé—®é¢˜ <ul><li>æ•°æ®æ˜¯ä¸æ˜¯å¤ªå¤šï¼Ÿ <ul><li>resultSet = statement.executeQuery(â€œselect * from å¤§è¡¨ limit nâ€)</li></ul></li><li>æ•°æ®è¡¨ç¤ºæ˜¯å¦å¤ªè‡ƒè‚¿ <ul><li>å¯¹è±¡å›¾</li><li>å¯¹è±¡å¤§å° 16 Integer 24 int 4</li></ul></li><li>æ˜¯å¦å­˜åœ¨å†…å­˜æ³„æ¼ <ul><li>static Map map â€¦</li><li>è½¯</li><li>å¼±</li><li>ç¬¬ä¸‰æ–¹ç¼“å­˜å®ç° redis......</li></ul></li></ul></li></ul><h4 id="_5-4-æ–°ç”Ÿä»£è°ƒä¼˜" tabindex="-1"><a class="header-anchor" href="#_5-4-æ–°ç”Ÿä»£è°ƒä¼˜"><span>5.4 æ–°ç”Ÿä»£è°ƒä¼˜</span></a></h4><ul><li>æ–°ç”Ÿä»£çš„ç‰¹ç‚¹ <ul><li>æ‰€æœ‰çš„ new æ“ä½œåˆ†é…å†…å­˜éƒ½æ˜¯éå¸¸å»‰ä»·çš„ <ul><li>TLAB thread-local allocation bufferï¼ˆå¯é˜²æ­¢å¤šä¸ªçº¿ç¨‹åˆ›å»ºå¯¹è±¡æ—¶çš„å¹²æ‰°ï¼‰</li></ul></li><li>æ­»äº¡å¯¹è±¡å›æ”¶é›¶ä»£ä»·</li><li>å¤§éƒ¨åˆ†å¯¹è±¡ç”¨è¿‡å³æ­»ï¼ˆæœç”Ÿå¤•æ­»ï¼‰</li><li>Minor GC æ‰€ç”¨æ—¶é—´è¿œå°äº Full GC</li></ul></li><li>æ–°ç”Ÿä»£å†…å­˜è¶Šå¤§è¶Šå¥½ä¹ˆï¼Ÿ <ul><li>ä¸æ˜¯ <ul><li>æ–°ç”Ÿä»£å†…å­˜å¤ªå°ï¼šé¢‘ç¹è§¦å‘ Minor GC ï¼Œä¼š STW ï¼Œä¼šä½¿å¾—ååé‡ä¸‹é™</li><li>æ–°ç”Ÿä»£å†…å­˜å¤ªå¤§ï¼šè€å¹´ä»£å†…å­˜å æ¯”æœ‰æ‰€é™ä½ï¼Œä¼šæ›´é¢‘ç¹åœ°è§¦å‘ Full GCã€‚è€Œä¸”è§¦å‘ Minor GC æ—¶ï¼Œæ¸…ç†æ–°ç”Ÿä»£æ‰€èŠ±è´¹çš„æ—¶é—´ä¼šæ›´é•¿</li></ul></li><li>æ–°ç”Ÿä»£å†…å­˜è®¾ç½®ä¸ºå†…å®¹çº³[å¹¶å‘é‡*(è¯·æ±‚-å“åº”)]çš„æ•°æ®ä¸ºå®œ</li></ul></li></ul><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806701.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><ul><li>å¹¸å­˜åŒºéœ€è¦èƒ½å¤Ÿä¿å­˜ å½“å‰æ´»è·ƒå¯¹è±¡+éœ€è¦æ™‹å‡çš„å¯¹è±¡</li><li>æ™‹å‡é˜ˆå€¼é…ç½®å¾—å½“ï¼Œè®©é•¿æ—¶é—´å­˜æ´»çš„å¯¹è±¡å°½å¿«æ™‹å‡</li></ul><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">-</span><span style="color:#D8DEE9FF;">XX</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;">MaxTenuringThreshold</span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;">threshold</span></span>
<span class="line"><span style="color:#81A1C1;">-</span><span style="color:#D8DEE9FF;">XX</span><span style="color:#81A1C1;">:+</span><span style="color:#8FBCBB;">PrintTenuringDistrubution</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_5-5-è€å¹´ä»£è°ƒä¼˜" tabindex="-1"><a class="header-anchor" href="#_5-5-è€å¹´ä»£è°ƒä¼˜"><span>5.5 è€å¹´ä»£è°ƒä¼˜</span></a></h4><p>ä»¥ CMS ä¸ºä¾‹ï¼š</p><ul><li>CMS çš„è€å¹´ä»£å†…å­˜è¶Šå¤§è¶Šå¥½</li><li>å…ˆå°è¯•ä¸åšè°ƒä¼˜ï¼Œå¦‚æœæ²¡æœ‰ Full GC é‚£ä¹ˆå·²ç»ï¼Œå¦è€…å…ˆå°è¯•è°ƒä¼˜æ–°ç”Ÿä»£ã€‚</li><li>è§‚å¯Ÿå‘ç° Full GC æ—¶è€å¹´ä»£å†…å­˜å ç”¨ï¼Œå°†è€å¹´ä»£å†…å­˜é¢„è®¾è°ƒå¤§ 1/4 ~ 1/3</li></ul><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">-</span><span style="color:#D8DEE9FF;">XX</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;">CMSInitiatingOccupancyFraction</span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;">percent</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="_5-6-æ¡ˆä¾‹" tabindex="-1"><a class="header-anchor" href="#_5-6-æ¡ˆä¾‹"><span>5.6 æ¡ˆä¾‹</span></a></h4><p>æ¡ˆä¾‹1ï¼šFull GC å’Œ Minor GC é¢‘ç¹ æ¡ˆä¾‹2ï¼šè¯·æ±‚é«˜å³°æœŸå‘ç”Ÿ Full GCï¼Œå•æ¬¡æš‚åœæ—¶é—´ç‰¹åˆ«é•¿ï¼ˆCMSï¼‰ æ¡ˆä¾‹3ï¼šè€å¹´ä»£å……è£•æƒ…å†µä¸‹ï¼Œå‘ç”Ÿ Full GCï¼ˆjdk1.7ï¼‰</p><h1 id="ä¸‰ã€ç±»åŠ è½½ä¸å­—èŠ‚ç æŠ€æœ¯" tabindex="-1"><a class="header-anchor" href="#ä¸‰ã€ç±»åŠ è½½ä¸å­—èŠ‚ç æŠ€æœ¯"><span>ä¸‰ã€ç±»åŠ è½½ä¸å­—èŠ‚ç æŠ€æœ¯</span></a></h1><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806770.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><h2 id="_1-ç±»æ–‡ä»¶ç»“æ„" tabindex="-1"><a class="header-anchor" href="#_1-ç±»æ–‡ä»¶ç»“æ„"><span>1. ç±»æ–‡ä»¶ç»“æ„</span></a></h2><p>ä¸€ä¸ªç®€å•çš„ <code>HelloWorld.java</code></p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// HelloWorld ç¤ºä¾‹</span></span>
<span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> HelloWorld</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">hello world</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ‰§è¡Œ <code>javac -parameters -d . HellowWorld.java</code></p><blockquote><p>Linux ä¸ºï¼šod -t xC HelloWorld.class</p></blockquote><p>ç¼–è¯‘ä¸º <code>HelloWorld.class</code> å¾—åˆ°çš„<strong>å­—èŠ‚ç æ–‡ä»¶</strong>æ˜¯è¿™ä¸ªæ ·å­çš„ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#B48EAD;">0000000</span><span style="color:#D8DEE9FF;"> ca fe ba be </span><span style="color:#B48EAD;">00</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 34</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 23</span><span style="color:#D8DEE9FF;"> 0a </span><span style="color:#B48EAD;">00</span><span style="color:#B48EAD;"> 06</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 15</span><span style="color:#D8DEE9FF;"> 09 </span></span>
<span class="line"><span style="color:#B48EAD;">0000020</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 16</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 17</span><span style="color:#D8DEE9FF;"> 08 </span><span style="color:#B48EAD;">00</span><span style="color:#B48EAD;"> 18</span><span style="color:#D8DEE9FF;"> 0a </span><span style="color:#B48EAD;">00</span><span style="color:#B48EAD;"> 19</span><span style="color:#B48EAD;"> 00</span><span style="color:#D8DEE9FF;"> 1a </span><span style="color:#B48EAD;">07</span><span style="color:#B48EAD;"> 00</span><span style="color:#D8DEE9FF;"> 1b </span><span style="color:#B48EAD;">07</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#B48EAD;">0000040</span><span style="color:#B48EAD;"> 00</span><span style="color:#D8DEE9FF;"> 1c </span><span style="color:#B48EAD;">01</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 06</span><span style="color:#D8DEE9FF;"> 3c </span><span style="color:#B48EAD;">69</span><span style="color:#D8DEE9FF;"> 6e </span><span style="color:#B48EAD;">69</span><span style="color:#B48EAD;"> 74</span><span style="color:#D8DEE9FF;"> 3e </span><span style="color:#B48EAD;">01</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 03</span><span style="color:#B48EAD;"> 28</span><span style="color:#B48EAD;"> 29</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#B48EAD;">0000060</span><span style="color:#B48EAD;"> 56</span><span style="color:#B48EAD;"> 01</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 04</span><span style="color:#B48EAD;"> 43</span><span style="color:#B48EAD;"> 6f</span><span style="color:#B48EAD;"> 64</span><span style="color:#B48EAD;"> 65</span><span style="color:#B48EAD;"> 01</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 0f</span><span style="color:#D8DEE9FF;"> 4c </span><span style="color:#B48EAD;">69</span><span style="color:#D8DEE9FF;"> 6e </span><span style="color:#B48EAD;">65</span><span style="color:#D8DEE9FF;"> 4e </span></span>
<span class="line"><span style="color:#B48EAD;">0000100</span><span style="color:#B48EAD;"> 75</span><span style="color:#B48EAD;"> 6d</span><span style="color:#B48EAD;"> 62</span><span style="color:#B48EAD;"> 65</span><span style="color:#B48EAD;"> 72</span><span style="color:#B48EAD;"> 54</span><span style="color:#B48EAD;"> 61</span><span style="color:#B48EAD;"> 62</span><span style="color:#D8DEE9FF;"> 6c </span><span style="color:#B48EAD;">65</span><span style="color:#B48EAD;"> 01</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 12</span><span style="color:#D8DEE9FF;"> 4c </span><span style="color:#B48EAD;">6f</span><span style="color:#B48EAD;"> 63</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#B48EAD;">0000120</span><span style="color:#B48EAD;"> 61</span><span style="color:#D8DEE9FF;"> 6c </span><span style="color:#B48EAD;">56</span><span style="color:#B48EAD;"> 61</span><span style="color:#B48EAD;"> 72</span><span style="color:#B48EAD;"> 69</span><span style="color:#B48EAD;"> 61</span><span style="color:#B48EAD;"> 62</span><span style="color:#D8DEE9FF;"> 6c </span><span style="color:#B48EAD;">65</span><span style="color:#B48EAD;"> 54</span><span style="color:#B48EAD;"> 61</span><span style="color:#B48EAD;"> 62</span><span style="color:#D8DEE9FF;"> 6c </span><span style="color:#B48EAD;">65</span><span style="color:#B48EAD;"> 01</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#B48EAD;">0000140</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 04</span><span style="color:#B48EAD;"> 74</span><span style="color:#B48EAD;"> 68</span><span style="color:#B48EAD;"> 69</span><span style="color:#B48EAD;"> 73</span><span style="color:#B48EAD;"> 01</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 1d</span><span style="color:#D8DEE9FF;"> 4c </span><span style="color:#B48EAD;">63</span><span style="color:#D8DEE9FF;"> 6e </span><span style="color:#B48EAD;">2f</span><span style="color:#B48EAD;"> 69</span><span style="color:#B48EAD;"> 74</span><span style="color:#B48EAD;"> 63</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#B48EAD;">0000160</span><span style="color:#B48EAD;"> 61</span><span style="color:#B48EAD;"> 73</span><span style="color:#B48EAD;"> 74</span><span style="color:#B48EAD;"> 2f</span><span style="color:#D8DEE9FF;"> 6a </span><span style="color:#B48EAD;">76</span><span style="color:#B48EAD;"> 6d</span><span style="color:#B48EAD;"> 2f</span><span style="color:#B48EAD;"> 74</span><span style="color:#B48EAD;"> 35</span><span style="color:#B48EAD;"> 2f</span><span style="color:#B48EAD;"> 48</span><span style="color:#B48EAD;"> 65</span><span style="color:#D8DEE9FF;"> 6c 6c </span><span style="color:#B48EAD;">6f</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#B48EAD;">0000200</span><span style="color:#B48EAD;"> 57</span><span style="color:#B48EAD;"> 6f</span><span style="color:#B48EAD;"> 72</span><span style="color:#D8DEE9FF;"> 6c </span><span style="color:#B48EAD;">64</span><span style="color:#D8DEE9FF;"> 3b </span><span style="color:#B48EAD;">01</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 04</span><span style="color:#B48EAD;"> 6d</span><span style="color:#B48EAD;"> 61</span><span style="color:#B48EAD;"> 69</span><span style="color:#D8DEE9FF;"> 6e </span><span style="color:#B48EAD;">01</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 16</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#B48EAD;">0000220</span><span style="color:#B48EAD;"> 28</span><span style="color:#D8DEE9FF;"> 5b 4c 6a </span><span style="color:#B48EAD;">61</span><span style="color:#B48EAD;"> 76</span><span style="color:#B48EAD;"> 61</span><span style="color:#B48EAD;"> 2f</span><span style="color:#D8DEE9FF;"> 6c </span><span style="color:#B48EAD;">61</span><span style="color:#D8DEE9FF;"> 6e </span><span style="color:#B48EAD;">67</span><span style="color:#B48EAD;"> 2f</span><span style="color:#B48EAD;"> 53</span><span style="color:#B48EAD;"> 74</span><span style="color:#B48EAD;"> 72</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#B48EAD;">0000240</span><span style="color:#B48EAD;"> 69</span><span style="color:#D8DEE9FF;"> 6e </span><span style="color:#B48EAD;">67</span><span style="color:#D8DEE9FF;"> 3b </span><span style="color:#B48EAD;">29</span><span style="color:#B48EAD;"> 56</span><span style="color:#B48EAD;"> 01</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 04</span><span style="color:#B48EAD;"> 61</span><span style="color:#B48EAD;"> 72</span><span style="color:#B48EAD;"> 67</span><span style="color:#B48EAD;"> 73</span><span style="color:#B48EAD;"> 01</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 13</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#B48EAD;">0000260</span><span style="color:#D8DEE9FF;"> 5b 4c 6a </span><span style="color:#B48EAD;">61</span><span style="color:#B48EAD;"> 76</span><span style="color:#B48EAD;"> 61</span><span style="color:#B48EAD;"> 2f</span><span style="color:#D8DEE9FF;"> 6c </span><span style="color:#B48EAD;">61</span><span style="color:#D8DEE9FF;"> 6e </span><span style="color:#B48EAD;">67</span><span style="color:#B48EAD;"> 2f</span><span style="color:#B48EAD;"> 53</span><span style="color:#B48EAD;"> 74</span><span style="color:#B48EAD;"> 72</span><span style="color:#B48EAD;"> 69</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#B48EAD;">0000300</span><span style="color:#D8DEE9FF;"> 6e </span><span style="color:#B48EAD;">67</span><span style="color:#D8DEE9FF;"> 3b </span><span style="color:#B48EAD;">01</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 10</span><span style="color:#B48EAD;"> 4d</span><span style="color:#B48EAD;"> 65</span><span style="color:#B48EAD;"> 74</span><span style="color:#B48EAD;"> 68</span><span style="color:#B48EAD;"> 6f</span><span style="color:#B48EAD;"> 64</span><span style="color:#B48EAD;"> 50</span><span style="color:#B48EAD;"> 61</span><span style="color:#B48EAD;"> 72</span><span style="color:#B48EAD;"> 61</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#B48EAD;">0000320</span><span style="color:#B48EAD;"> 6d</span><span style="color:#B48EAD;"> 65</span><span style="color:#B48EAD;"> 74</span><span style="color:#B48EAD;"> 65</span><span style="color:#B48EAD;"> 72</span><span style="color:#B48EAD;"> 73</span><span style="color:#B48EAD;"> 01</span><span style="color:#B48EAD;"> 00</span><span style="color:#D8DEE9FF;"> 0a </span><span style="color:#B48EAD;">53</span><span style="color:#B48EAD;"> 6f</span><span style="color:#B48EAD;"> 75</span><span style="color:#B48EAD;"> 72</span><span style="color:#B48EAD;"> 63</span><span style="color:#B48EAD;"> 65</span><span style="color:#B48EAD;"> 46</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#B48EAD;">0000340</span><span style="color:#B48EAD;"> 69</span><span style="color:#D8DEE9FF;"> 6c </span><span style="color:#B48EAD;">65</span><span style="color:#B48EAD;"> 01</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 0f</span><span style="color:#B48EAD;"> 48</span><span style="color:#B48EAD;"> 65</span><span style="color:#D8DEE9FF;"> 6c 6c </span><span style="color:#B48EAD;">6f</span><span style="color:#B48EAD;"> 57</span><span style="color:#B48EAD;"> 6f</span><span style="color:#B48EAD;"> 72</span><span style="color:#D8DEE9FF;"> 6c </span><span style="color:#B48EAD;">64</span></span>
<span class="line"><span style="color:#B48EAD;">0000360</span><span style="color:#D8DEE9FF;"> 2e 6a </span><span style="color:#B48EAD;">61</span><span style="color:#B48EAD;"> 76</span><span style="color:#B48EAD;"> 61</span><span style="color:#D8DEE9FF;"> 0c </span><span style="color:#B48EAD;">00</span><span style="color:#B48EAD;"> 07</span><span style="color:#B48EAD;"> 00</span><span style="color:#D8DEE9FF;"> 08 </span><span style="color:#B48EAD;">07</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 1d</span><span style="color:#D8DEE9FF;"> 0c </span><span style="color:#B48EAD;">00</span><span style="color:#D8DEE9FF;"> 1e </span></span>
<span class="line"><span style="color:#B48EAD;">0000400</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 1f</span><span style="color:#B48EAD;"> 01</span><span style="color:#B48EAD;"> 00</span><span style="color:#D8DEE9FF;"> 0b </span><span style="color:#B48EAD;">68</span><span style="color:#B48EAD;"> 65</span><span style="color:#D8DEE9FF;"> 6c 6c </span><span style="color:#B48EAD;">6f</span><span style="color:#B48EAD;"> 20</span><span style="color:#B48EAD;"> 77</span><span style="color:#B48EAD;"> 6f</span><span style="color:#B48EAD;"> 72</span><span style="color:#D8DEE9FF;"> 6c </span><span style="color:#B48EAD;">64</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#B48EAD;">0000420</span><span style="color:#B48EAD;"> 07</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 20</span><span style="color:#D8DEE9FF;"> 0c </span><span style="color:#B48EAD;">00</span><span style="color:#B48EAD;"> 21</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 22</span><span style="color:#B48EAD;"> 01</span><span style="color:#B48EAD;"> 00</span><span style="color:#D8DEE9FF;"> 1b </span><span style="color:#B48EAD;">63</span><span style="color:#D8DEE9FF;"> 6e </span><span style="color:#B48EAD;">2f</span><span style="color:#B48EAD;"> 69</span><span style="color:#B48EAD;"> 74</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#B48EAD;">0000440</span><span style="color:#B48EAD;"> 63</span><span style="color:#B48EAD;"> 61</span><span style="color:#B48EAD;"> 73</span><span style="color:#B48EAD;"> 74</span><span style="color:#B48EAD;"> 2f</span><span style="color:#D8DEE9FF;"> 6a </span><span style="color:#B48EAD;">76</span><span style="color:#B48EAD;"> 6d</span><span style="color:#B48EAD;"> 2f</span><span style="color:#B48EAD;"> 74</span><span style="color:#B48EAD;"> 35</span><span style="color:#B48EAD;"> 2f</span><span style="color:#B48EAD;"> 48</span><span style="color:#B48EAD;"> 65</span><span style="color:#D8DEE9FF;"> 6c 6c </span></span>
<span class="line"><span style="color:#B48EAD;">0000460</span><span style="color:#B48EAD;"> 6f</span><span style="color:#B48EAD;"> 57</span><span style="color:#B48EAD;"> 6f</span><span style="color:#B48EAD;"> 72</span><span style="color:#D8DEE9FF;"> 6c </span><span style="color:#B48EAD;">64</span><span style="color:#B48EAD;"> 01</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 10</span><span style="color:#D8DEE9FF;"> 6a </span><span style="color:#B48EAD;">61</span><span style="color:#B48EAD;"> 76</span><span style="color:#B48EAD;"> 61</span><span style="color:#B48EAD;"> 2f</span><span style="color:#D8DEE9FF;"> 6c </span><span style="color:#B48EAD;">61</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#B48EAD;">0000500</span><span style="color:#D8DEE9FF;"> 6e </span><span style="color:#B48EAD;">67</span><span style="color:#B48EAD;"> 2f</span><span style="color:#B48EAD;"> 4f</span><span style="color:#B48EAD;"> 62</span><span style="color:#D8DEE9FF;"> 6a </span><span style="color:#B48EAD;">65</span><span style="color:#B48EAD;"> 63</span><span style="color:#B48EAD;"> 74</span><span style="color:#B48EAD;"> 01</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 10</span><span style="color:#D8DEE9FF;"> 6a </span><span style="color:#B48EAD;">61</span><span style="color:#B48EAD;"> 76</span><span style="color:#B48EAD;"> 61</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#B48EAD;">0000520</span><span style="color:#B48EAD;"> 2f</span><span style="color:#D8DEE9FF;"> 6c </span><span style="color:#B48EAD;">61</span><span style="color:#D8DEE9FF;"> 6e </span><span style="color:#B48EAD;">67</span><span style="color:#B48EAD;"> 2f</span><span style="color:#B48EAD;"> 53</span><span style="color:#B48EAD;"> 79</span><span style="color:#B48EAD;"> 73</span><span style="color:#B48EAD;"> 74</span><span style="color:#B48EAD;"> 65</span><span style="color:#B48EAD;"> 6d</span><span style="color:#B48EAD;"> 01</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 03</span><span style="color:#B48EAD;"> 6f</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#B48EAD;">0000540</span><span style="color:#B48EAD;"> 75</span><span style="color:#B48EAD;"> 74</span><span style="color:#B48EAD;"> 01</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 15</span><span style="color:#D8DEE9FF;"> 4c 6a </span><span style="color:#B48EAD;">61</span><span style="color:#B48EAD;"> 76</span><span style="color:#B48EAD;"> 61</span><span style="color:#B48EAD;"> 2f</span><span style="color:#B48EAD;"> 69</span><span style="color:#B48EAD;"> 6f</span><span style="color:#B48EAD;"> 2f</span><span style="color:#B48EAD;"> 50</span><span style="color:#B48EAD;"> 72</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#B48EAD;">0000560</span><span style="color:#B48EAD;"> 69</span><span style="color:#D8DEE9FF;"> 6e </span><span style="color:#B48EAD;">74</span><span style="color:#B48EAD;"> 53</span><span style="color:#B48EAD;"> 74</span><span style="color:#B48EAD;"> 72</span><span style="color:#B48EAD;"> 65</span><span style="color:#B48EAD;"> 61</span><span style="color:#B48EAD;"> 6d</span><span style="color:#D8DEE9FF;"> 3b </span><span style="color:#B48EAD;">01</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 13</span><span style="color:#D8DEE9FF;"> 6a </span><span style="color:#B48EAD;">61</span><span style="color:#B48EAD;"> 76</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#B48EAD;">0000600</span><span style="color:#B48EAD;"> 61</span><span style="color:#B48EAD;"> 2f</span><span style="color:#B48EAD;"> 69</span><span style="color:#B48EAD;"> 6f</span><span style="color:#B48EAD;"> 2f</span><span style="color:#B48EAD;"> 50</span><span style="color:#B48EAD;"> 72</span><span style="color:#B48EAD;"> 69</span><span style="color:#D8DEE9FF;"> 6e </span><span style="color:#B48EAD;">74</span><span style="color:#B48EAD;"> 53</span><span style="color:#B48EAD;"> 74</span><span style="color:#B48EAD;"> 72</span><span style="color:#B48EAD;"> 65</span><span style="color:#B48EAD;"> 61</span><span style="color:#B48EAD;"> 6d</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#B48EAD;">0000620</span><span style="color:#B48EAD;"> 01</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 07</span><span style="color:#B48EAD;"> 70</span><span style="color:#B48EAD;"> 72</span><span style="color:#B48EAD;"> 69</span><span style="color:#D8DEE9FF;"> 6e </span><span style="color:#B48EAD;">74</span><span style="color:#D8DEE9FF;"> 6c 6e </span><span style="color:#B48EAD;">01</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 15</span><span style="color:#B48EAD;"> 28</span><span style="color:#D8DEE9FF;"> 4c 6a </span></span>
<span class="line"><span style="color:#B48EAD;">0000640</span><span style="color:#B48EAD;"> 61</span><span style="color:#B48EAD;"> 76</span><span style="color:#B48EAD;"> 61</span><span style="color:#B48EAD;"> 2f</span><span style="color:#D8DEE9FF;"> 6c </span><span style="color:#B48EAD;">61</span><span style="color:#D8DEE9FF;"> 6e </span><span style="color:#B48EAD;">67</span><span style="color:#B48EAD;"> 2f</span><span style="color:#B48EAD;"> 53</span><span style="color:#B48EAD;"> 74</span><span style="color:#B48EAD;"> 72</span><span style="color:#B48EAD;"> 69</span><span style="color:#D8DEE9FF;"> 6e </span><span style="color:#B48EAD;">67</span><span style="color:#D8DEE9FF;"> 3b </span></span>
<span class="line"><span style="color:#B48EAD;">0000660</span><span style="color:#B48EAD;"> 29</span><span style="color:#B48EAD;"> 56</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 21</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 05</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 06</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 02</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 01</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#B48EAD;">0000700</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 07</span><span style="color:#B48EAD;"> 00</span><span style="color:#D8DEE9FF;"> 08 </span><span style="color:#B48EAD;">00</span><span style="color:#B48EAD;"> 01</span><span style="color:#B48EAD;"> 00</span><span style="color:#D8DEE9FF;"> 09 </span><span style="color:#B48EAD;">00</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 2f</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 01</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 01</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#B48EAD;">0000720</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 05</span><span style="color:#D8DEE9FF;"> 2a b7 </span><span style="color:#B48EAD;">00</span><span style="color:#B48EAD;"> 01</span><span style="color:#D8DEE9FF;"> b1 </span><span style="color:#B48EAD;">00</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 02</span><span style="color:#B48EAD;"> 00</span><span style="color:#D8DEE9FF;"> 0a </span><span style="color:#B48EAD;">00</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#B48EAD;">0000740</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 06</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 01</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 04</span><span style="color:#B48EAD;"> 00</span><span style="color:#D8DEE9FF;"> 0b </span><span style="color:#B48EAD;">00</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 00</span><span style="color:#D8DEE9FF;"> 0c </span><span style="color:#B48EAD;">00</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#B48EAD;">0000760</span><span style="color:#B48EAD;"> 01</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 05</span><span style="color:#B48EAD;"> 00</span><span style="color:#D8DEE9FF;"> 0c </span><span style="color:#B48EAD;">00</span><span style="color:#B48EAD;"> 0d</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 00</span><span style="color:#D8DEE9FF;"> 09 </span><span style="color:#B48EAD;">00</span><span style="color:#D8DEE9FF;"> 0e </span><span style="color:#B48EAD;">00</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#B48EAD;">0001000</span><span style="color:#B48EAD;"> 0f</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 02</span><span style="color:#B48EAD;"> 00</span><span style="color:#D8DEE9FF;"> 09 </span><span style="color:#B48EAD;">00</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 37</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 02</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 01</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 00</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#B48EAD;">0001020</span><span style="color:#D8DEE9FF;"> 09 b2 </span><span style="color:#B48EAD;">00</span><span style="color:#B48EAD;"> 02</span><span style="color:#B48EAD;"> 12</span><span style="color:#B48EAD;"> 03</span><span style="color:#D8DEE9FF;"> b6 </span><span style="color:#B48EAD;">00</span><span style="color:#B48EAD;"> 04</span><span style="color:#D8DEE9FF;"> b1 </span><span style="color:#B48EAD;">00</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 02</span><span style="color:#B48EAD;"> 00</span><span style="color:#D8DEE9FF;"> 0a </span></span>
<span class="line"><span style="color:#B48EAD;">0001040</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 00</span><span style="color:#D8DEE9FF;"> 0a </span><span style="color:#B48EAD;">00</span><span style="color:#B48EAD;"> 02</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 06</span><span style="color:#B48EAD;"> 00</span><span style="color:#D8DEE9FF;"> 08 </span><span style="color:#B48EAD;">00</span><span style="color:#B48EAD;"> 07</span><span style="color:#B48EAD;"> 00</span><span style="color:#D8DEE9FF;"> 0b </span></span>
<span class="line"><span style="color:#B48EAD;">0001060</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 00</span><span style="color:#D8DEE9FF;"> 0c </span><span style="color:#B48EAD;">00</span><span style="color:#B48EAD;"> 01</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 00</span><span style="color:#D8DEE9FF;"> 09 </span><span style="color:#B48EAD;">00</span><span style="color:#B48EAD;"> 10</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 11</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 00</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#B48EAD;">0001100</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 12</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 05</span><span style="color:#B48EAD;"> 01</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 10</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 01</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 13</span><span style="color:#B48EAD;"> 00</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#B48EAD;">0001120</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 02</span><span style="color:#B48EAD;"> 00</span><span style="color:#B48EAD;"> 14</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ ¹æ® JVM è§„èŒƒï¼Œ<strong>ç±»æ–‡ä»¶ç»“æ„</strong>å¦‚ä¸‹</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;">u4             magic</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">u2             minor_version</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;">    </span></span>
<span class="line"><span style="color:#D8DEE9FF;">u2             major_version</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;">    </span></span>
<span class="line"><span style="color:#D8DEE9FF;">u2             constant_pool_count</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;">    </span></span>
<span class="line"><span style="color:#D8DEE9FF;">cp_info        constant_pool</span><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">constant_pool_count</span><span style="color:#81A1C1;">-</span><span style="color:#B48EAD;">1</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;">    </span></span>
<span class="line"><span style="color:#D8DEE9FF;">u2             access_flags</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;">    </span></span>
<span class="line"><span style="color:#D8DEE9FF;">u2             this_class</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;">    </span></span>
<span class="line"><span style="color:#D8DEE9FF;">u2             super_class</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;">   </span></span>
<span class="line"><span style="color:#D8DEE9FF;">u2             interfaces_count</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;">    </span></span>
<span class="line"><span style="color:#D8DEE9FF;">u2             interfaces</span><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">interfaces_count</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;">   </span></span>
<span class="line"><span style="color:#D8DEE9FF;">u2             fields_count</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;">    </span></span>
<span class="line"><span style="color:#D8DEE9FF;">field_info     fields</span><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">fields_count</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;">   </span></span>
<span class="line"><span style="color:#D8DEE9FF;">u2             methods_count</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;">    </span></span>
<span class="line"><span style="color:#D8DEE9FF;">method_info    methods</span><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">methods_count</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;">    </span></span>
<span class="line"><span style="color:#D8DEE9FF;">u2             attributes_count</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;">    </span></span>
<span class="line"><span style="color:#D8DEE9FF;">attribute_info attributes</span><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">attributes_count</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-1-é­”æ•°" tabindex="-1"><a class="header-anchor" href="#_1-1-é­”æ•°"><span>1.1 é­”æ•°</span></a></h3><p>u4 magic</p><p>å¯¹åº”å­—èŠ‚ç æ–‡ä»¶ 0~3 å­—èŠ‚ï¼Œè¡¨ç¤ºå®ƒæ˜¯å¦æ˜¯ã€classã€‘ç±»å‹çš„æ–‡ä»¶</p><p>0000000 <strong>ca fe ba be</strong> 00 00 00 34 00 23 0a 00 06 00 15 09</p><p>ca fe ba be ï¼šæ„æ€æ˜¯ .class æ–‡ä»¶ï¼Œä¸åŒçš„ä¸œè¥¿æœ‰ä¸åŒçš„é­”æ•°ï¼Œæ¯”å¦‚ jpgã€png å›¾ç‰‡ç­‰ï¼</p><h3 id="_1-2-ç‰ˆæœ¬" tabindex="-1"><a class="header-anchor" href="#_1-2-ç‰ˆæœ¬"><span>1.2 ç‰ˆæœ¬</span></a></h3><p>u2 minor_version; u2 major_version; 0000000 ca fe ba be 00 00 00 34 00 23 0a 00 06 00 15 09 00 00 00 34ï¼š34Hï¼ˆ16è¿›åˆ¶ï¼‰ = 52ï¼ˆ10è¿›åˆ¶ï¼‰ï¼Œä»£è¡¨JDK8</p><p>å¯¹åº”å­—èŠ‚ç æ–‡ä»¶ 4~7 å­—èŠ‚ï¼Œè¡¨ç¤ºç±»çš„ç‰ˆæœ¬ 00 34ï¼ˆ52ï¼‰ è¡¨ç¤ºæ˜¯ Java 8</p><p>0000000 ca fe ba be <strong>00 00 00 34</strong> 00 23 0a 00 06 00 15 09</p><h3 id="_1-3-å¸¸é‡æ± " tabindex="-1"><a class="header-anchor" href="#_1-3-å¸¸é‡æ± "><span>1.3 å¸¸é‡æ± </span></a></h3><p>å‚è€ƒæ–‡æ¡£ <a href="https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-4.html" target="_blank" rel="noopener noreferrer">ä¼ é€é—¨</a></p><table><thead><tr><th><strong>Constant Type</strong></th><th><strong>Value</strong></th></tr></thead><tbody><tr><td>CONSTANT_Class</td><td>7</td></tr><tr><td>CONSTANT_Fieldref</td><td>9</td></tr><tr><td>CONSTANT_Methodref</td><td>10</td></tr><tr><td>CONSTANT_InterfaceMethodref</td><td>11</td></tr><tr><td>CONSTANT_String</td><td>8</td></tr><tr><td>CONSTANT_Integer</td><td>3</td></tr><tr><td>CONSTANT_Float</td><td>4</td></tr><tr><td>CONSTANT_Long</td><td>5</td></tr><tr><td>CONSTANT_Double</td><td>6</td></tr><tr><td>CONSTANT_NameAndType</td><td>12</td></tr><tr><td>CONSTANT_Utf8</td><td>1</td></tr><tr><td>CONSTANT_MethodHandle</td><td>15</td></tr><tr><td>CONSTANT_MethodType</td><td>16</td></tr><tr><td>CONSTANT_InvokeDynamic</td><td>18</td></tr></tbody></table><p>8~9 å­—èŠ‚ï¼Œè¡¨ç¤ºå¸¸é‡æ± é•¿åº¦ï¼Œ00 23 ï¼ˆ35ï¼‰ è¡¨ç¤ºå¸¸é‡æ± æœ‰ #1~#34é¡¹ï¼Œæ³¨æ„ #0 é¡¹ä¸è®¡å…¥ï¼Œä¹Ÿæ²¡æœ‰å€¼ï¼Œ</p><p>åˆ†æè¿‡ç¨‹ï¼Œç¢°åˆ°å±äº<strong>Constant Typeçš„å€¼å°±å»è¡¨ä¸­æ‰¾ç±»å‹ï¼Œ</strong></p><p>æ¯”å¦‚ç¬¬ä¸€é¡¹0aæ˜¯CONSTANT_Methodrefï¼Œ00 06 00 15å¼•ç”¨äº†å¸¸é‡æ± ä¸­ #6 å’Œ #21 é¡¹ï¼Œåé¢09æ˜¯CONSTANT_Fieldrefï¼Œ00 16 00 17è¡¨ç¤ºå®ƒå¼•ç”¨äº†å¸¸é‡æ± ä¸­ #22 å’Œ # 23 é¡¹ï¼Œä¾æ¬¡ç±»æ¨ï¼Œå¦å¤–utf-8çš„ä¸²ç”¨2ä¸ªå­—èŠ‚æ¥è¡¨ç¤ºé•¿åº¦ï¼Œåé¢æ˜¯æ•°æ®ã€‚</p><p>0000000 ca fe ba be 00 00 00 34 00 23 0a 00 06 00 15 09</p><ol><li>ç¬¬#1é¡¹ 0a è¡¨ç¤ºä¸€ä¸ª Method ä¿¡æ¯ï¼Œ00 06 å’Œ 00 15ï¼ˆ21ï¼‰ è¡¨ç¤ºå®ƒå¼•ç”¨äº†å¸¸é‡æ± ä¸­ #6 å’Œ #21 é¡¹æ¥è·å¾—è¿™ä¸ªæ–¹æ³•çš„ã€æ‰€å±ç±»ã€‘å’Œã€æ–¹æ³•åã€‘</li></ol><p>0000000 ca fe ba be 00 00 00 34 00 23 0a 00 06 00 15 09</p><ol><li>ç¬¬#2é¡¹ 09 è¡¨ç¤ºä¸€ä¸ª Field ä¿¡æ¯ï¼Œ00 16ï¼ˆ22ï¼‰å’Œ 00 17ï¼ˆ23ï¼‰ è¡¨ç¤ºå®ƒå¼•ç”¨äº†å¸¸é‡æ± ä¸­ #22 å’Œ # 23 é¡¹æ¥è·å¾—è¿™ä¸ªæˆå‘˜å˜é‡çš„ã€æ‰€å±ç±»ã€‘å’Œã€æˆå‘˜å˜é‡åã€‘ <ol><li><p>0000000 ca fe ba be 00 00 00 34 00 23 0a 00 06 00 15 09</p></li><li><p>0000020 00 16 00 17 08 00 18 0a 00 19 00 1a 07 00 1b 07</p></li></ol></li><li>ç¬¬#3é¡¹ 08 è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ä¸²å¸¸é‡åç§°ï¼Œ00 18ï¼ˆ24ï¼‰è¡¨ç¤ºå®ƒå¼•ç”¨äº†å¸¸é‡æ± ä¸­ #24 é¡¹</li></ol><p>0000020 00 16 00 17 08 00 18 0a 00 19 00 1a 07 00 1b 07</p><ol><li>ç¬¬#4é¡¹ 0a è¡¨ç¤ºä¸€ä¸ª Method ä¿¡æ¯ï¼Œ00 19ï¼ˆ25ï¼‰ å’Œ 00 1aï¼ˆ26ï¼‰ è¡¨ç¤ºå®ƒå¼•ç”¨äº†å¸¸é‡æ± ä¸­ #25 å’Œ #26</li></ol><p>é¡¹æ¥è·å¾—è¿™ä¸ªæ–¹æ³•çš„ã€æ‰€å±ç±»ã€‘å’Œã€æ–¹æ³•åã€‘</p><p>0000020 00 16 00 17 08 00 18 0a 00 19 00 1a 07 00 1b 07</p><ol><li>ç¬¬#5é¡¹ 07 è¡¨ç¤ºä¸€ä¸ª Class ä¿¡æ¯ï¼Œ00 1bï¼ˆ27ï¼‰ è¡¨ç¤ºå®ƒå¼•ç”¨äº†å¸¸é‡æ± ä¸­ #27 é¡¹</li></ol><p>0000020 00 16 00 17 08 00 18 0a 00 19 00 1a 07 00 1b 07</p><ol><li>ç¬¬#6é¡¹ 07 è¡¨ç¤ºä¸€ä¸ª Class ä¿¡æ¯ï¼Œ00 1cï¼ˆ28ï¼‰ è¡¨ç¤ºå®ƒå¼•ç”¨äº†å¸¸é‡æ± ä¸­ #28 é¡¹ <ol><li><p>0000020 00 16 00 17 08 00 18 0a 00 19 00 1a 07 00 1b 07</p></li><li><p>0000040 00 1c 01 00 06 3c 69 6e 69 74 3e 01 00 03 28 29</p></li></ol></li><li>ç¬¬#7é¡¹ 01 è¡¨ç¤ºä¸€ä¸ª utf8 ä¸²ï¼Œ00 06 è¡¨ç¤ºé•¿åº¦ï¼Œ3c 69 6e 69 74 3e æ˜¯ã€ &lt;init&gt; ã€‘</li></ol><p>0000040 00 1c 01 00 06 3c 69 6e 69 74 3e 01 00 03 28 29</p><ol><li>ç¬¬#8é¡¹ 01 è¡¨ç¤ºä¸€ä¸ª utf8 ä¸²ï¼Œ00 03 è¡¨ç¤ºé•¿åº¦ï¼Œ28 29 56 æ˜¯ã€()Vã€‘å…¶å®å°±æ˜¯è¡¨ç¤ºæ— å‚ã€æ— è¿”å›å€¼</li></ol><p>0000040 00 1c 01 00 06 3c 69 6e 69 74 3e 01 00 03 28 29</p><p>0000060 56 01 00 04 43 6f 64 65 01 00 0f 4c 69 6e 65 4e</p><ol><li>ç¬¬#9é¡¹ 01 è¡¨ç¤ºä¸€ä¸ª utf8 ä¸²ï¼Œ00 04 è¡¨ç¤ºé•¿åº¦ï¼Œ43 6f 64 65 æ˜¯ã€Codeã€‘</li></ol><p>0000060 56 01 00 04 43 6f 64 65 01 00 0f 4c 69 6e 65 4e</p><ol><li>ç¬¬#10é¡¹ 01 è¡¨ç¤ºä¸€ä¸ª utf8 ä¸²ï¼Œ00 0fï¼ˆ15ï¼‰ è¡¨ç¤ºé•¿åº¦ï¼Œ4c 69 6e 65 4e 75 6d 62 65 72 54 61 62 6c 65æ˜¯ã€LineNumberTableã€‘ <ol><li><p>0000060 56 01 00 04 43 6f 64 65 01 00 0f 4c 69 6e 65 4e</p></li><li><p>0000100 75 6d 62 65 72 54 61 62 6c 65 01 00 12 4c 6f 63</p></li></ol></li><li>ç¬¬#11é¡¹ 01 è¡¨ç¤ºä¸€ä¸ª utf8 ä¸²ï¼Œ00 12ï¼ˆ18ï¼‰ è¡¨ç¤ºé•¿åº¦ï¼Œ4c 6f 63 61 6c 56 61 72 69 61 62 6c 65 54 61 62 6c 65æ˜¯ã€LocalVariableTableã€‘ <ol><li><p>0000100 75 6d 62 65 72 54 61 62 6c 65 01 00 12 4c 6f 63</p></li><li><p>0000120 61 6c 56 61 72 69 61 62 6c 65 54 61 62 6c 65 01</p></li></ol></li><li>ç¬¬#12é¡¹ 01 è¡¨ç¤ºä¸€ä¸ª utf8 ä¸²ï¼Œ00 04 è¡¨ç¤ºé•¿åº¦ï¼Œ74 68 69 73 æ˜¯ã€thisã€‘ <ol><li><p>0000120 61 6c 56 61 72 69 61 62 6c 65 54 61 62 6c 65 01</p></li><li><p>0000140 00 04 74 68 69 73 01 00 1d 4c 63 6e 2f 69 74 63</p></li></ol></li><li>ç¬¬#13é¡¹ 01 è¡¨ç¤ºä¸€ä¸ª utf8 ä¸²ï¼Œ00 1dï¼ˆ29ï¼‰ è¡¨ç¤ºé•¿åº¦ï¼Œæ˜¯ã€Lcn/itcast/jvm/t5/HelloWorld;ã€‘ <ol><li><p>0000140 00 04 74 68 69 73 01 00 1d 4c 63 6e 2f 69 74 63</p></li><li><p>0000160 61 73 74 2f 6a 76 6d 2f 74 35 2f 48 65 6c 6c 6f</p></li><li><p>0000200 57 6f 72 6c 64 3b 01 00 04 6d 61 69 6e 01 00 16</p></li></ol></li><li>ç¬¬#14é¡¹ 01 è¡¨ç¤ºä¸€ä¸ª utf8 ä¸²ï¼Œ00 04 è¡¨ç¤ºé•¿åº¦ï¼Œ74 68 69 73 æ˜¯ã€mainã€‘</li></ol><p>0000200 57 6f 72 6c 64 3b 01 00 04 6d 61 69 6e 01 00 16</p><ol><li>ç¬¬#15é¡¹ 01 è¡¨ç¤ºä¸€ä¸ª utf8 ä¸²ï¼Œ00 16ï¼ˆ22ï¼‰ è¡¨ç¤ºé•¿åº¦ï¼Œæ˜¯ã€([Ljava/lang/String;)Vã€‘å…¶å®å°±æ˜¯å‚æ•°ä¸ºå­—ç¬¦ä¸²æ•°ç»„ï¼Œæ— è¿”å›å€¼</li></ol><p>0000200 57 6f 72 6c 64 3b 01 00 04 6d 61 69 6e 01 00 16</p><p>0000220 28 5b 4c 6a 61 76 61 2f 6c 61 6e 67 2f 53 74 72</p><p>0000240 69 6e 67 3b 29 56 01 00 04 61 72 67 73 01 00 13</p><ol><li>ç¬¬#16é¡¹ 01 è¡¨ç¤ºä¸€ä¸ª utf8 ä¸²ï¼Œ00 04 è¡¨ç¤ºé•¿åº¦ï¼Œæ˜¯ã€argsã€‘</li></ol><p>0000240 69 6e 67 3b 29 56 01 00 04 61 72 67 73 01 00 13</p><ol><li>ç¬¬#17é¡¹ 01 è¡¨ç¤ºä¸€ä¸ª utf8 ä¸²ï¼Œ00 13ï¼ˆ19ï¼‰ è¡¨ç¤ºé•¿åº¦ï¼Œæ˜¯ã€[Ljava/lang/String;ã€‘ <ol><li><p>0000240 69 6e 67 3b 29 56 01 00 04 61 72 67 73 01 00 13</p></li><li><p>0000260 5b 4c 6a 61 76 61 2f 6c 61 6e 67 2f 53 74 72 69</p></li><li><p>0000300 6e 67 3b 01 00 10 4d 65 74 68 6f 64 50 61 72 61</p></li></ol></li><li>ç¬¬#18é¡¹ 01 è¡¨ç¤ºä¸€ä¸ª utf8 ä¸²ï¼Œ00 10ï¼ˆ16ï¼‰ è¡¨ç¤ºé•¿åº¦ï¼Œæ˜¯ã€MethodParametersã€‘ <ol><li><p>0000300 6e 67 3b 01 00 10 4d 65 74 68 6f 64 50 61 72 61</p></li><li><p>0000320 6d 65 74 65 72 73 01 00 0a 53 6f 75 72 63 65 46</p></li></ol></li><li>ç¬¬#19é¡¹ 01 è¡¨ç¤ºä¸€ä¸ª utf8 ä¸²ï¼Œ00 0aï¼ˆ10ï¼‰ è¡¨ç¤ºé•¿åº¦ï¼Œæ˜¯ã€SourceFileã€‘ <ol><li><p>0000320 6d 65 74 65 72 73 01 00 0a 53 6f 75 72 63 65 46</p></li><li><p>0000340 69 6c 65 01 00 0f 48 65 6c 6c 6f 57 6f 72 6c 64</p></li></ol></li><li>ç¬¬#20é¡¹ 01 è¡¨ç¤ºä¸€ä¸ª utf8 ä¸²ï¼Œ00 0fï¼ˆ15ï¼‰ è¡¨ç¤ºé•¿åº¦ï¼Œæ˜¯ã€HelloWorld.javaã€‘ <ol><li><p>0000340 69 6c 65 01 00 0f 48 65 6c 6c 6f 57 6f 72 6c 64</p></li><li><p>0000360 2e 6a 61 76 61 0c 00 07 00 08 07 00 1d 0c 00 1e</p></li></ol></li><li>ç¬¬#21é¡¹ 0c è¡¨ç¤ºä¸€ä¸ª ã€å+ç±»å‹ã€‘ï¼Œ00 07 00 08 å¼•ç”¨äº†å¸¸é‡æ± ä¸­ #7 #8 ä¸¤é¡¹</li></ol><p>0000360 2e 6a 61 76 61 0c 00 07 00 08 07 00 1d 0c 00 1e</p><ol><li>ç¬¬#22é¡¹ 07 è¡¨ç¤ºä¸€ä¸ª Class ä¿¡æ¯ï¼Œ00 1dï¼ˆ29ï¼‰ å¼•ç”¨äº†å¸¸é‡æ± ä¸­ #29 é¡¹</li></ol><p>0000360 2e 6a 61 76 61 0c 00 07 00 08 07 00 1d 0c 00 1e</p><ol><li>ç¬¬#23é¡¹ 0c è¡¨ç¤ºä¸€ä¸ª ã€å+ç±»å‹ã€‘ï¼Œ00 1eï¼ˆ30ï¼‰ 00 1f ï¼ˆ31ï¼‰å¼•ç”¨äº†å¸¸é‡æ± ä¸­ #30 #31 ä¸¤é¡¹ <ol><li><p>0000360 2e 6a 61 76 61 0c 00 07 00 08 07 00 1d 0c 00 1e</p></li><li><p>0000400 00 1f 01 00 0b 68 65 6c 6c 6f 20 77 6f 72 6c 64</p></li></ol></li><li>ç¬¬#24é¡¹ 01 è¡¨ç¤ºä¸€ä¸ª utf8 ä¸²ï¼Œ00 0fï¼ˆ15ï¼‰ è¡¨ç¤ºé•¿åº¦ï¼Œæ˜¯ã€hello worldã€‘</li></ol><p>0000400 00 1f 01 00 0b 68 65 6c 6c 6f 20 77 6f 72 6c 64</p><ol><li>ç¬¬#25é¡¹ 07 è¡¨ç¤ºä¸€ä¸ª Class ä¿¡æ¯ï¼Œ00 20ï¼ˆ32ï¼‰ å¼•ç”¨äº†å¸¸é‡æ± ä¸­ #32 é¡¹</li></ol><p>0000420 07 00 20 0c 00 21 00 22 01 00 1b 63 6e 2f 69 74</p><ol><li>ç¬¬#26é¡¹ 0c è¡¨ç¤ºä¸€ä¸ª ã€å+ç±»å‹ã€‘ï¼Œ00 21ï¼ˆ33ï¼‰ 00 22ï¼ˆ34ï¼‰å¼•ç”¨äº†å¸¸é‡æ± ä¸­ #33 #34 ä¸¤é¡¹</li></ol><p>0000420 07 00 20 0c 00 21 00 22 01 00 1b 63 6e 2f 69 74</p><ol><li>ç¬¬#27é¡¹ 01 è¡¨ç¤ºä¸€ä¸ª utf8 ä¸²ï¼Œ00 1bï¼ˆ27ï¼‰ è¡¨ç¤ºé•¿åº¦ï¼Œæ˜¯ã€cn/itcast/jvm/t5/HelloWorldã€‘ <ol><li><p>0000420 07 00 20 0c 00 21 00 22 01 00 1b 63 6e 2f 69 74</p></li><li><p>0000440 63 61 73 74 2f 6a 76 6d 2f 74 35 2f 48 65 6c 6c</p></li><li><p>0000460 6f 57 6f 72 6c 64 01 00 10 6a 61 76 61 2f 6c 61</p></li></ol></li><li>ç¬¬#28é¡¹ 01 è¡¨ç¤ºä¸€ä¸ª utf8 ä¸²ï¼Œ00 10ï¼ˆ16ï¼‰ è¡¨ç¤ºé•¿åº¦ï¼Œæ˜¯ã€java/lang/Objectã€‘ <ol><li><p>0000460 6f 57 6f 72 6c 64 01 00 10 6a 61 76 61 2f 6c 61</p></li><li><p>0000500 6e 67 2f 4f 62 6a 65 63 74 01 00 10 6a 61 76 61</p></li></ol></li><li>ç¬¬#29é¡¹ 01 è¡¨ç¤ºä¸€ä¸ª utf8 ä¸²ï¼Œ00 10ï¼ˆ16ï¼‰ è¡¨ç¤ºé•¿åº¦ï¼Œæ˜¯ã€java/lang/Systemã€‘ <ol><li><p>0000500 6e 67 2f 4f 62 6a 65 63 74 01 00 10 6a 61 76 61</p></li><li><p>0000520 2f 6c 61 6e 67 2f 53 79 73 74 65 6d 01 00 03 6f</p></li></ol></li><li>ç¬¬#30é¡¹ 01 è¡¨ç¤ºä¸€ä¸ª utf8 ä¸²ï¼Œ00 03 è¡¨ç¤ºé•¿åº¦ï¼Œæ˜¯ã€outã€‘ <ol><li><p>0000520 2f 6c 61 6e 67 2f 53 79 73 74 65 6d 01 00 03 6f</p></li><li><p>0000540 75 74 01 00 15 4c 6a 61 76 61 2f 69 6f 2f 50 72</p></li></ol></li><li>ç¬¬#31é¡¹ 01 è¡¨ç¤ºä¸€ä¸ª utf8 ä¸²ï¼Œ00 15ï¼ˆ21ï¼‰ è¡¨ç¤ºé•¿åº¦ï¼Œæ˜¯ã€Ljava/io/PrintStream;ã€‘ <ol><li><p>0000540 75 74 01 00 15 4c 6a 61 76 61 2f 69 6f 2f 50 72</p></li><li><p>0000560 69 6e 74 53 74 72 65 61 6d 3b 01 00 13 6a 61 76</p></li><li><p>Flag Name Value Interpretation</p></li><li><p>ACC_PUBLIC 0x0001</p></li><li><p>Declared public ; may be accessed from outside its</p></li><li><p>package.</p></li><li><p>ACC_FINAL 0x0010 Declared final ; no subclasses allowed.</p></li><li><p>ACC_SUPER 0x0020</p></li><li><p>Treat superclass methods specially when invoked by the</p></li><li><p>invokespecial instruction.</p></li><li><p>ACC_INTERFACE 0x0200 Is an interface, not a class.</p></li><li><p>ACC_ABSTRACT 0x0400 Declared abstract ; must not be instantiated.</p></li><li><p>ACC_SYNTHETIC 0x1000 Declared synthetic; not present in the source code.</p></li><li><p>ACC_ANNOTATION 0x2000 Declared as an annotation type.</p></li><li><p>ACC_ENUM 0x4000 Declared as an enum type.</p></li></ol></li><li>ç¬¬#32é¡¹ 01 è¡¨ç¤ºä¸€ä¸ª utf8 ä¸²ï¼Œ00 13ï¼ˆ19ï¼‰ è¡¨ç¤ºé•¿åº¦ï¼Œæ˜¯ã€java/io/PrintStreamã€‘ <ol><li><p>0000560 69 6e 74 53 74 72 65 61 6d 3b 01 00 13 6a 61 76</p></li><li><p>0000600 61 2f 69 6f 2f 50 72 69 6e 74 53 74 72 65 61 6d</p></li></ol></li><li>ç¬¬#33é¡¹ 01 è¡¨ç¤ºä¸€ä¸ª utf8 ä¸²ï¼Œ00 07 è¡¨ç¤ºé•¿åº¦ï¼Œæ˜¯ã€printlnã€‘</li></ol><p>0000620 01 00 07 70 72 69 6e 74 6c 6e 01 00 15 28 4c 6a</p><ol><li>ç¬¬#34é¡¹ 01 è¡¨ç¤ºä¸€ä¸ª utf8 ä¸²ï¼Œ00 15ï¼ˆ21ï¼‰ è¡¨ç¤ºé•¿åº¦ï¼Œæ˜¯ã€(Ljava/lang/String;)Vã€‘ <ol><li><p>0000620 01 00 07 70 72 69 6e 74 6c 6e 01 00 15 28 4c 6a</p></li><li><p>0000640 61 76 61 2f 6c 61 6e 67 2f 53 74 72 69 6e 67 3b</p></li><li><p>0000660 29 56 00 21 00 05 00 06 00 00 00 00 00 02 00 01</p></li></ol></li></ol><h3 id="_1-4-è®¿é—®æ ‡è¯†ä¸ç»§æ‰¿ä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#_1-4-è®¿é—®æ ‡è¯†ä¸ç»§æ‰¿ä¿¡æ¯"><span>1.4 è®¿é—®æ ‡è¯†ä¸ç»§æ‰¿ä¿¡æ¯</span></a></h3><p>21 è¡¨ç¤ºè¯¥ class æ˜¯ä¸€ä¸ªç±»ï¼Œå…¬å…±çš„</p><p>0000660 29 56 00 21 00 05 00 06 00 00 00 00 00 02 00 01</p><p>05 è¡¨ç¤ºæ ¹æ®å¸¸é‡æ± ä¸­ #5 æ‰¾åˆ°æœ¬ç±»å…¨é™å®šå</p><p>0000660 29 56 00 21 00 05 00 06 00 00 00 00 00 02 00 01</p><p>06 è¡¨ç¤ºæ ¹æ®å¸¸é‡æ± ä¸­ #6 æ‰¾åˆ°çˆ¶ç±»å…¨é™å®šå</p><p>0000660 29 56 00 21 00 05 00 06 00 00 00 00 00 02 00 01</p><p>è¡¨ç¤ºæ¥å£çš„æ•°é‡ï¼Œæœ¬ç±»ä¸º 0</p><p>0000660 29 56 00 21 00 05 00 06 00 00 00 00 00 02 00 01</p><h2 id="_2-å­—èŠ‚ç æŒ‡ä»¤" tabindex="-1"><a class="header-anchor" href="#_2-å­—èŠ‚ç æŒ‡ä»¤"><span>2. å­—èŠ‚ç æŒ‡ä»¤</span></a></h2><p>å¯å‚è€ƒï¼š <a href="https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-6.html#jvms-6.5" target="_blank" rel="noopener noreferrer">å­—èŠ‚ç æŒ‡ä»¤</a></p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806182.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806241.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><h3 id="_2-1-javapå·¥å…·" tabindex="-1"><a class="header-anchor" href="#_2-1-javapå·¥å…·"><span>2.1 javapå·¥å…·</span></a></h3><p>Oracle æä¾›äº† javap å·¥å…·æ¥åç¼–è¯‘ class æ–‡ä»¶ï¼Œè¿˜æœ‰å…¶ä»–çš„ideaæ’ä»¶å¯ä»¥ç›´æ¥æŸ¥çœ‹ã€‚</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;">javap </span><span style="color:#81A1C1;">-</span><span style="color:#D8DEE9FF;">v ç±»å</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">class</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_2-2-å›¾è§£æ–¹æ³•æ‰§è¡Œæµç¨‹" tabindex="-1"><a class="header-anchor" href="#_2-2-å›¾è§£æ–¹æ³•æ‰§è¡Œæµç¨‹"><span>2.2 å›¾è§£æ–¹æ³•æ‰§è¡Œæµç¨‹</span></a></h3><h4 id="_1-ä»£ç " tabindex="-1"><a class="header-anchor" href="#_1-ä»£ç "><span>ï¼ˆ1ï¼‰<strong>ä»£ç </strong></span></a></h4><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Demo3_1</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9FF;">    </span></span>
<span class="line"><span style="color:#81A1C1;">        public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9FF;">        </span></span>
<span class="line"><span style="color:#81A1C1;">                int</span><span style="color:#D8DEE9;"> a</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 10</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;">        </span></span>
<span class="line"><span style="color:#81A1C1;">                int</span><span style="color:#D8DEE9;"> b</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Short</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">MAX_VALUE</span><span style="color:#81A1C1;"> +</span><span style="color:#B48EAD;"> 1</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;">        </span></span>
<span class="line"><span style="color:#81A1C1;">                int</span><span style="color:#D8DEE9;"> c</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9FF;"> a </span><span style="color:#81A1C1;">+</span><span style="color:#D8DEE9FF;"> b</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;">                </span></span>
<span class="line"><span style="color:#D8DEE9;">                System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">c</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;">   </span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-ç¼–è¯‘åçš„å­—èŠ‚ç æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#_2-ç¼–è¯‘åçš„å­—èŠ‚ç æ–‡ä»¶"><span>ï¼ˆ2ï¼‰ç¼–è¯‘åçš„å­—èŠ‚ç æ–‡ä»¶</span></a></h4><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;">C</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;">\Users\</span><span style="color:#B48EAD;">30287</span><span style="color:#D8DEE9FF;">\IdeaProjects\paiXppLL\src\main</span><span style="color:#81A1C1;">&gt;</span><span style="color:#D8DEE9FF;">javap </span><span style="color:#81A1C1;">-</span><span style="color:#D8DEE9FF;">v </span><span style="color:#D8DEE9;">Main</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">class</span></span>
<span class="line"><span style="color:#D8DEE9FF;">Classfile </span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">C</span><span style="color:#81A1C1;">:/</span><span style="color:#D8DEE9FF;">Users</span><span style="color:#81A1C1;">/</span><span style="color:#B48EAD;">30287</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">IdeaProjects</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">paiXppLL</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">src</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">main</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9;">Main</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">class</span></span>
<span class="line"><span style="color:#8FBCBB;">  Last</span><span style="color:#D8DEE9FF;"> modified </span><span style="color:#B48EAD;">2021</span><span style="color:#81A1C1;">-</span><span style="color:#B48EAD;">10</span><span style="color:#81A1C1;">-</span><span style="color:#B48EAD;">14</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> size </span><span style="color:#B48EAD;">419</span><span style="color:#D8DEE9FF;"> bytes</span></span>
<span class="line"><span style="color:#8FBCBB;">  MD5</span><span style="color:#D8DEE9FF;"> checksum eda2e7897356a975438fe5899c0b4a6c</span></span>
<span class="line"><span style="color:#8FBCBB;">  Compiled</span><span style="color:#D8DEE9FF;"> from </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">Main.java</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> main</span><span style="color:#D8DEE9FF;">.Main</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  minor version: 0</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  major version: 52</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  flags: ACC_PUBLIC, ACC_SUPER</span></span>
<span class="line"><span style="color:#D8DEE9FF;">Constant pool:</span></span>
<span class="line"><span style="color:#D8DEE9FF;">   #1 = Methodref          #6.#15         </span><span style="color:#616E88;">// java/lang/Object.&quot;&lt;init&gt;&quot;:()V</span></span>
<span class="line"><span style="color:#D8DEE9FF;">   #2 = Fieldref           #16.#17        </span><span style="color:#616E88;">// java/lang/System.out:Ljava/io/PrintStream;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">   #3 = String             #18            </span><span style="color:#616E88;">// hello world!</span></span>
<span class="line"><span style="color:#D8DEE9FF;">   #4 = Methodref          #19.#20        </span><span style="color:#616E88;">// java/io/PrintStream.println:(Ljava/lang/String;)V</span></span>
<span class="line"><span style="color:#D8DEE9FF;">   #5 = Class              #21            </span><span style="color:#616E88;">// main/Main</span></span>
<span class="line"><span style="color:#D8DEE9FF;">   #6 = Class              #22            </span><span style="color:#616E88;">// java/lang/Object</span></span>
<span class="line"><span style="color:#D8DEE9FF;">   #7 = Utf8               </span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">init</span><span style="color:#ECEFF4;">&gt;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">   #8 = Utf8               ()V</span></span>
<span class="line"><span style="color:#D8DEE9FF;">   #9 = Utf8               Code</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  #10 = Utf8               LineNumberTable</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  #11 = Utf8               main</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  #12 = Utf8               ([Ljava/lang/String;)V</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  #13 = Utf8               SourceFile</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  #14 = Utf8               Main.java</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  #15 = NameAndType        #7:#8          </span><span style="color:#616E88;">// &quot;&lt;init&gt;&quot;:()V</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  #16 = Class              #23            </span><span style="color:#616E88;">// java/lang/System</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  #17 = NameAndType        #24:#25        </span><span style="color:#616E88;">// out:Ljava/io/PrintStream;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  #18 = Utf8               hello world!</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  #19 = Class              #26            </span><span style="color:#616E88;">// java/io/PrintStream</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  #20 = NameAndType        #27:#28        </span><span style="color:#616E88;">// println:(Ljava/lang/String;)V</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  #21 = Utf8               main/Main</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  #22 = Utf8               java/lang/Object</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  #23 = Utf8               java/lang/System</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  #24 = Utf8               out</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  #25 = Utf8               Ljava/io/PrintStream;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  #26 = Utf8               java/io/PrintStream</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  #27 = Utf8               println</span></span>
<span class="line"><span style="color:#D8DEE9FF;">  #28 = Utf8               (Ljava/lang/String;)V</span></span>
<span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#81A1C1;">  public</span><span style="color:#D8DEE9FF;"> main.</span><span style="color:#88C0D0;">Main</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    descriptor: ()V</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    flags: ACC_PUBLIC</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    Code:</span></span>
<span class="line"><span style="color:#D8DEE9FF;">      stack=1, locals=1, args_size=1</span></span>
<span class="line"><span style="color:#D8DEE9FF;">         0: aload_0</span></span>
<span class="line"><span style="color:#D8DEE9FF;">         1: invokespecial #1                  </span><span style="color:#616E88;">// Method java/lang/Object.&quot;&lt;init&gt;&quot;:()V</span></span>
<span class="line"><span style="color:#D8DEE9FF;">         4: return</span></span>
<span class="line"><span style="color:#D8DEE9FF;">      LineNumberTable:</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        line 13: 0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">  public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">java</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">lang</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[])</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    descriptor: ([Ljava/lang/String</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#8FBCBB;">V</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    flags</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> ACC_PUBLIC</span><span style="color:#ECEFF4;">,</span><span style="color:#8FBCBB;"> ACC_STATIC</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    Code</span><span style="color:#81A1C1;">:</span></span>
<span class="line"><span style="color:#D8DEE9FF;">      stack</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">2</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> locals</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">1</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> args_size</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">1</span></span>
<span class="line"><span style="color:#B48EAD;">         0</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> getstatic     #</span><span style="color:#B48EAD;">2</span><span style="color:#616E88;">                  // Field java/lang/System.out:Ljava/io/PrintStream;</span></span>
<span class="line"><span style="color:#B48EAD;">         3</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> ldc           #</span><span style="color:#B48EAD;">3</span><span style="color:#616E88;">                  // String hello world!</span></span>
<span class="line"><span style="color:#B48EAD;">         5</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> invokevirtual #</span><span style="color:#B48EAD;">4</span><span style="color:#616E88;">                  // Method java/io/PrintStream.println:(Ljava/lang/String;)V</span></span>
<span class="line"><span style="color:#B48EAD;">         8</span><span style="color:#81A1C1;">:</span><span style="color:#81A1C1;"> return</span></span>
<span class="line"><span style="color:#D8DEE9FF;">      LineNumberTable</span><span style="color:#81A1C1;">:</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        line </span><span style="color:#B48EAD;">15</span><span style="color:#81A1C1;">:</span><span style="color:#B48EAD;"> 0</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        line </span><span style="color:#B48EAD;">16</span><span style="color:#81A1C1;">:</span><span style="color:#B48EAD;"> 8</span></span>
<span class="line"><span style="color:#D8DEE9FF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-å¸¸é‡æ± è½½å…¥è¿è¡Œæ—¶å¸¸é‡æ± " tabindex="-1"><a class="header-anchor" href="#_3-å¸¸é‡æ± è½½å…¥è¿è¡Œæ—¶å¸¸é‡æ± "><span>ï¼ˆ3ï¼‰å¸¸é‡æ± è½½å…¥è¿è¡Œæ—¶å¸¸é‡æ± </span></a></h4><p>å¸¸é‡æ± ä¹Ÿå±äºæ–¹æ³•åŒºï¼Œåªä¸è¿‡è¿™é‡Œå•ç‹¬æå‡ºæ¥äº†</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806174.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><h4 id="_4-æ–¹æ³•å­—èŠ‚ç è½½å…¥æ–¹æ³•åŒº" tabindex="-1"><a class="header-anchor" href="#_4-æ–¹æ³•å­—èŠ‚ç è½½å…¥æ–¹æ³•åŒº"><span>ï¼ˆ4ï¼‰<strong>æ–¹æ³•å­—èŠ‚ç è½½å…¥æ–¹æ³•åŒº</strong></span></a></h4><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806552.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><h4 id="_5-main-çº¿ç¨‹å¼€å§‹è¿è¡Œ-åˆ†é…æ ˆå¸§å†…å­˜" tabindex="-1"><a class="header-anchor" href="#_5-main-çº¿ç¨‹å¼€å§‹è¿è¡Œ-åˆ†é…æ ˆå¸§å†…å­˜"><span>ï¼ˆ5ï¼‰main çº¿ç¨‹å¼€å§‹è¿è¡Œï¼Œåˆ†é…æ ˆå¸§å†…å­˜</span></a></h4><p>stack=2ï¼Œlocals=4ï¼‰ å¯¹åº”æ“ä½œæ•°æ ˆæœ‰2ä¸ªç©ºé—´ï¼ˆæ¯ä¸ªç©ºé—´4ä¸ªå­—èŠ‚ï¼‰ï¼Œå±€éƒ¨å˜é‡è¡¨ä¸­æœ‰4ä¸ªæ§½ä½</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806608.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><h4 id="_6-æ‰§è¡Œå¼•æ“å¼€å§‹æ‰§è¡Œå­—èŠ‚ç -bipush-10" tabindex="-1"><a class="header-anchor" href="#_6-æ‰§è¡Œå¼•æ“å¼€å§‹æ‰§è¡Œå­—èŠ‚ç -bipush-10"><span><strong>ï¼ˆ6ï¼‰æ‰§è¡Œå¼•æ“å¼€å§‹æ‰§è¡Œå­—èŠ‚ç </strong> <strong>bipush 10</strong></span></a></h4><ul><li><strong>å°†ä¸€ä¸ª byte å‹å…¥æ“ä½œæ•°æ ˆ</strong>ï¼ˆå…¶é•¿åº¦ä¼šè¡¥é½ 4 ä¸ªå­—èŠ‚ï¼‰ï¼Œç±»ä¼¼çš„æŒ‡ä»¤è¿˜æœ‰</li><li>sipush å°†ä¸€ä¸ª short å‹å…¥æ“ä½œæ•°æ ˆï¼ˆå…¶é•¿åº¦ä¼šè¡¥é½ 4 ä¸ªå­—èŠ‚ï¼‰</li><li>ldc å°†ä¸€ä¸ª int å‹å…¥æ“ä½œæ•°æ ˆ</li><li>ldc2_w å°†ä¸€ä¸ª long å‹å…¥æ“ä½œæ•°æ ˆï¼ˆ<strong>åˆ†ä¸¤æ¬¡å‹å…¥</strong>ï¼Œå› ä¸º long æ˜¯ 8 ä¸ªå­—èŠ‚ï¼‰</li><li>è¿™é‡Œå°çš„æ•°å­—éƒ½æ˜¯å’Œå­—èŠ‚ç æŒ‡ä»¤å­˜åœ¨ä¸€èµ·ï¼Œ<strong>è¶…è¿‡ short èŒƒå›´çš„æ•°å­—å­˜å…¥äº†****å¸¸é‡æ± </strong></li></ul><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806670.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p><strong>istore 1</strong> å°†æ“ä½œæ•°æ ˆæ ˆé¡¶å…ƒç´ å¼¹å‡ºï¼Œæ”¾å…¥å±€éƒ¨å˜é‡è¡¨çš„ slot 1 ä¸­ å¯¹åº”ä»£ç ä¸­çš„ a = 10</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806036.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806984.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p><strong>ldc #3</strong></p><ul><li>è¯»å–è¿è¡Œæ—¶å¸¸é‡æ± ä¸­ #3 ï¼Œå³ 32768 (è¶…è¿‡ short æœ€å¤§å€¼èŒƒå›´çš„æ•°ä¼šè¢«æ”¾åˆ°è¿è¡Œæ—¶å¸¸é‡æ± ä¸­)ï¼Œå°†å…¶åŠ è½½åˆ°æ“ä½œæ•°æ ˆä¸­</li><li>æ³¨æ„ Short.MAX_VALUE æ˜¯ 32767ï¼Œæ‰€ä»¥ 32768 = Short.MAX_VALUE + 1 å®é™…æ˜¯åœ¨ç¼–è¯‘æœŸé—´è®¡ç®—å¥½çš„ã€‚</li></ul><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806093.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p><strong>istore 2</strong> å°†æ“ä½œæ•°æ ˆä¸­çš„å…ƒç´ å¼¹å‡ºï¼Œæ”¾åˆ°å±€éƒ¨å˜é‡è¡¨çš„ 2 å·ä½ç½®</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806432.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p><strong>iload1 iload2</strong> å°†å±€éƒ¨å˜é‡è¡¨ä¸­ 1 å·ä½ç½®å’Œ 2 å·ä½ç½®çš„å…ƒç´ æ”¾å…¥æ“ä½œæ•°æ ˆä¸­ã€‚å› ä¸ºåªèƒ½åœ¨æ“ä½œæ•°æ ˆä¸­æ‰§è¡Œè¿ç®—æ“ä½œ</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806537.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806754.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p><strong>iadd</strong> å°†æ“ä½œæ•°æ ˆä¸­çš„ä¸¤ä¸ªå…ƒç´ å¼¹å‡ºæ ˆå¹¶ç›¸åŠ ï¼Œç»“æœåœ¨å‹å…¥æ“ä½œæ•°æ ˆä¸­ã€‚</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806177.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806829.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p><strong>istore 3</strong> å°†æ“ä½œæ•°æ ˆä¸­çš„å…ƒç´ å¼¹å‡ºï¼Œæ”¾å…¥å±€éƒ¨å˜é‡è¡¨çš„3å·ä½ç½®ã€‚</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806104.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p><strong>getstatic #4</strong> åœ¨è¿è¡Œæ—¶å¸¸é‡æ± ä¸­æ‰¾åˆ° #4 ï¼Œå‘ç°æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œåœ¨å †å†…å­˜ä¸­æ‰¾åˆ°è¯¥å¯¹è±¡ï¼Œå¹¶å°†å…¶å¼•ç”¨æ”¾å…¥æ“ä½œæ•°æ ˆä¸­</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806300.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806281.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p><strong>iload 3</strong> å°†å±€éƒ¨å˜é‡è¡¨ä¸­ 3 å·ä½ç½®çš„å…ƒç´ å‹å…¥æ“ä½œæ•°æ ˆä¸­ã€‚</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806529.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806658.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p><strong>invokevirtual #5</strong></p><ul><li>æ‰¾åˆ°å¸¸é‡æ±  #5 é¡¹ï¼Œ</li><li>å®šä½åˆ°æ–¹æ³•åŒº java/io/PrintStream.println:(I)V æ–¹æ³•</li><li>ç”Ÿæˆæ–°çš„æ ˆå¸§ï¼ˆåˆ†é… localsã€stackç­‰ï¼‰</li><li>ä¼ é€’å‚æ•°ï¼Œæ‰§è¡Œæ–°æ ˆå¸§ä¸­çš„å­—èŠ‚ç </li></ul><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806004.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>æ‰§è¡Œå®Œæ¯•ï¼Œå¼¹å‡ºæ ˆå¸§ æ¸…é™¤ main æ“ä½œæ•°æ ˆå†…å®¹</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806053.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p><strong>return</strong> å®Œæˆ main æ–¹æ³•è°ƒç”¨ï¼Œå¼¹å‡º main æ ˆå¸§ï¼Œç¨‹åºç»“æŸ</p><h3 id="_2-3-ç»ƒä¹ -åˆ†æ-i" tabindex="-1"><a class="header-anchor" href="#_2-3-ç»ƒä¹ -åˆ†æ-i"><span>2.3 ç»ƒä¹  - åˆ†æ i++</span></a></h3><p>ä»£ç </p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">package</span><span style="color:#8FBCBB;"> cn</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">itcast</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">jvm</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">t3</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">bytecode</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">/**</span></span>
<span class="line"><span style="color:#616E88;">* ä»å­—èŠ‚ç è§’åº¦åˆ†æ a++ ç›¸å…³é¢˜ç›®</span></span>
<span class="line"><span style="color:#616E88;">*/</span></span>
<span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Demo3_2</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    int</span><span style="color:#D8DEE9;"> a</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 10</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    int</span><span style="color:#D8DEE9;"> b</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9FF;"> a</span><span style="color:#81A1C1;">++</span><span style="color:#81A1C1;"> +</span><span style="color:#81A1C1;"> ++</span><span style="color:#D8DEE9FF;">a </span><span style="color:#81A1C1;">+</span><span style="color:#D8DEE9FF;"> a</span><span style="color:#81A1C1;">--;</span></span>
<span class="line"><span style="color:#D8DEE9;">    System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">a</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">b</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">java</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">lang</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">String</span><span style="color:#ECEFF4;">[])</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">descriptor</span><span style="color:#81A1C1;">:</span><span style="color:#ECEFF4;"> ([</span><span style="color:#D8DEE9FF;">Ljava</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">lang</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">String</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#8FBCBB;">V</span></span>
<span class="line"><span style="color:#D8DEE9FF;">flags</span><span style="color:#81A1C1;">:</span><span style="color:#ECEFF4;"> (</span><span style="color:#B48EAD;">0x0009</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> ACC_PUBLIC</span><span style="color:#ECEFF4;">,</span><span style="color:#8FBCBB;"> ACC_STATIC</span></span>
<span class="line"><span style="color:#D8DEE9FF;">Code</span><span style="color:#81A1C1;">:</span></span>
<span class="line"><span style="color:#D8DEE9FF;">stack</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">2</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> locals</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">3</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> args_size</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">1</span></span>
<span class="line"><span style="color:#B48EAD;">0</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> bipush </span><span style="color:#B48EAD;">10</span></span>
<span class="line"><span style="color:#B48EAD;">2</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> istore_1</span></span>
<span class="line"><span style="color:#B48EAD;">3</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> iload_1</span></span>
<span class="line"><span style="color:#B48EAD;">4</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> iinc </span><span style="color:#B48EAD;">1</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 1</span></span>
<span class="line"><span style="color:#B48EAD;">7</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> iinc </span><span style="color:#B48EAD;">1</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 1</span></span>
<span class="line"><span style="color:#B48EAD;">10</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> iload_1</span></span>
<span class="line"><span style="color:#B48EAD;">11</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> iadd</span></span>
<span class="line"><span style="color:#B48EAD;">12</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> iload_1</span></span>
<span class="line"><span style="color:#B48EAD;">13</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> iinc </span><span style="color:#B48EAD;">1</span><span style="color:#ECEFF4;">,</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;">1</span></span>
<span class="line"><span style="color:#B48EAD;">16</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> iadd</span></span>
<span class="line"><span style="color:#B48EAD;">17</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> istore_2</span></span>
<span class="line"><span style="color:#B48EAD;">18</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> getstatic #</span><span style="color:#B48EAD;">2</span><span style="color:#616E88;"> // Field</span></span>
<span class="line"><span style="color:#D8DEE9FF;">java</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">lang</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9;">System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;">Ljava</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">io</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">PrintStream</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#B48EAD;">21</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> iload_1</span></span>
<span class="line"><span style="color:#B48EAD;">22</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> invokevirtual #</span><span style="color:#B48EAD;">3</span><span style="color:#616E88;"> // Method</span></span>
<span class="line"><span style="color:#D8DEE9FF;">java</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">io</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9;">PrintStream</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">println</span><span style="color:#81A1C1;">:</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">I</span><span style="color:#ECEFF4;">)</span><span style="color:#8FBCBB;">V</span></span>
<span class="line"><span style="color:#B48EAD;">25</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> getstatic #</span><span style="color:#B48EAD;">2</span><span style="color:#616E88;"> // Field</span></span>
<span class="line"><span style="color:#D8DEE9FF;">java</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">lang</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9;">System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;">Ljava</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">io</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">PrintStream</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#B48EAD;">28</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> iload_2</span></span>
<span class="line"><span style="color:#B48EAD;">29</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> invokevirtual #</span><span style="color:#B48EAD;">3</span><span style="color:#616E88;"> // Method</span></span>
<span class="line"><span style="color:#D8DEE9FF;">java</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">io</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9;">PrintStream</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">println</span><span style="color:#81A1C1;">:</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">I</span><span style="color:#ECEFF4;">)</span><span style="color:#8FBCBB;">V</span></span>
<span class="line"><span style="color:#B48EAD;">32</span><span style="color:#81A1C1;">:</span><span style="color:#81A1C1;"> return</span></span>
<span class="line"><span style="color:#D8DEE9FF;">LineNumberTable</span><span style="color:#81A1C1;">:</span></span>
<span class="line"><span style="color:#D8DEE9FF;">line </span><span style="color:#B48EAD;">8</span><span style="color:#81A1C1;">:</span><span style="color:#B48EAD;"> 0</span></span>
<span class="line"><span style="color:#D8DEE9FF;">line </span><span style="color:#B48EAD;">9</span><span style="color:#81A1C1;">:</span><span style="color:#B48EAD;"> 3</span></span>
<span class="line"><span style="color:#D8DEE9FF;">line </span><span style="color:#B48EAD;">10</span><span style="color:#81A1C1;">:</span><span style="color:#B48EAD;"> 18</span></span>
<span class="line"><span style="color:#D8DEE9FF;">line </span><span style="color:#B48EAD;">11</span><span style="color:#81A1C1;">:</span><span style="color:#B48EAD;"> 25</span></span>
<span class="line"><span style="color:#D8DEE9FF;">line </span><span style="color:#B48EAD;">12</span><span style="color:#81A1C1;">:</span><span style="color:#B48EAD;"> 32</span></span>
<span class="line"><span style="color:#D8DEE9FF;">LocalVariableTable</span><span style="color:#81A1C1;">:</span></span>
<span class="line"><span style="color:#8FBCBB;">Start</span><span style="color:#8FBCBB;"> Length</span><span style="color:#8FBCBB;"> Slot</span><span style="color:#8FBCBB;"> Name</span><span style="color:#8FBCBB;"> Signature</span></span>
<span class="line"><span style="color:#B48EAD;">0</span><span style="color:#B48EAD;"> 33</span><span style="color:#B48EAD;"> 0</span><span style="color:#D8DEE9FF;"> args </span><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">Ljava</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">lang</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">String</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#B48EAD;">3</span><span style="color:#B48EAD;"> 30</span><span style="color:#B48EAD;"> 1</span><span style="color:#D8DEE9FF;"> a </span><span style="color:#8FBCBB;">I</span></span>
<span class="line"><span style="color:#B48EAD;">18</span><span style="color:#B48EAD;"> 15</span><span style="color:#B48EAD;"> 2</span><span style="color:#D8DEE9FF;"> b </span><span style="color:#8FBCBB;">I</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åˆ†æï¼š</p><p>æ³¨æ„ iinc æŒ‡ä»¤æ˜¯ç›´æ¥åœ¨å±€éƒ¨å˜é‡ slot ä¸Šè¿›è¡Œè¿ç®—</p><p>a++ å’Œ ++a çš„åŒºåˆ«æ˜¯å…ˆæ‰§è¡Œ iload è¿˜æ˜¯ å…ˆæ‰§è¡Œ iinc</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806072.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806127.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806165.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806461.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806768.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806950.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806098.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806079.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806159.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806271.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806382.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><h3 id="_2-4-æ¡ä»¶åˆ¤æ–­æŒ‡ä»¤" tabindex="-1"><a class="header-anchor" href="#_2-4-æ¡ä»¶åˆ¤æ–­æŒ‡ä»¤"><span>2.4 æ¡ä»¶åˆ¤æ–­æŒ‡ä»¤</span></a></h3><table><thead><tr><th>æŒ‡ä»¤</th><th>åŠ©è®°ç¬¦</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>0x99</td><td>ifeq</td><td>åˆ¤æ–­æ˜¯å¦ == 0</td></tr><tr><td>0x9a</td><td>ifne</td><td>åˆ¤æ–­æ˜¯å¦ != 0</td></tr><tr><td>0x9b</td><td>iflt</td><td>åˆ¤æ–­æ˜¯å¦ &lt; 0</td></tr></tbody></table><p>å‡ ç‚¹è¯´æ˜ï¼š</p><ul><li>byteï¼Œshortï¼Œchar éƒ½ä¼šæŒ‰ int æ¯”è¾ƒï¼Œå› ä¸ºæ“ä½œæ•°æ ˆéƒ½æ˜¯ 4 å­—èŠ‚</li><li>goto ç”¨æ¥è¿›è¡Œè·³è½¬åˆ°æŒ‡å®šè¡Œå·çš„å­—èŠ‚ç </li></ul><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Demo3_3</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">        int</span><span style="color:#D8DEE9;"> a</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">        if</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">a </span><span style="color:#81A1C1;">==</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9FF;">            a </span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;"> 10</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        a </span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;"> 20</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#B48EAD;">0</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> iconst_0</span></span>
<span class="line"><span style="color:#B48EAD;">1</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> istore_1</span></span>
<span class="line"><span style="color:#B48EAD;">2</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> iload_1</span></span>
<span class="line"><span style="color:#B48EAD;">3</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> ifne </span><span style="color:#B48EAD;">12</span></span>
<span class="line"><span style="color:#B48EAD;">6</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> bipush </span><span style="color:#B48EAD;">10</span></span>
<span class="line"><span style="color:#B48EAD;">8</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> istore_1</span></span>
<span class="line"><span style="color:#B48EAD;">9</span><span style="color:#81A1C1;">:</span><span style="color:#81A1C1;"> goto</span><span style="color:#B48EAD;"> 15</span></span>
<span class="line"><span style="color:#B48EAD;">12</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> bipush </span><span style="color:#B48EAD;">20</span></span>
<span class="line"><span style="color:#B48EAD;">14</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> istore_1</span></span>
<span class="line"><span style="color:#B48EAD;">15</span><span style="color:#81A1C1;">:</span><span style="color:#81A1C1;"> return</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>æ€è€ƒ</p><p>ç»†å¿ƒçš„åŒå­¦åº”å½“æ³¨æ„åˆ°ï¼Œä»¥ä¸Šæ¯”è¾ƒæŒ‡ä»¤ä¸­æ²¡æœ‰ longï¼Œfloatï¼Œdouble çš„æ¯”è¾ƒï¼Œé‚£ä¹ˆå®ƒä»¬è¦æ¯”è¾ƒæ€ä¹ˆåŠï¼Ÿ</p><p>å‚è€ƒ https://docs.oracle.com/javase/specs/jvms/se7/html/jvms-6.html#jvms-6.5.lcmp</p></blockquote><h3 id="_2-5-å¾ªç¯æ§åˆ¶æŒ‡ä»¤" tabindex="-1"><a class="header-anchor" href="#_2-5-å¾ªç¯æ§åˆ¶æŒ‡ä»¤"><span>2.5 å¾ªç¯æ§åˆ¶æŒ‡ä»¤</span></a></h3><p>å…¶å®å¾ªç¯æ§åˆ¶è¿˜æ˜¯å‰é¢ä»‹ç»çš„é‚£äº›æŒ‡ä»¤ï¼Œä¾‹å¦‚ while å¾ªç¯ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Demo3_4</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">int</span><span style="color:#D8DEE9;"> a</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">while</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9FF;">a </span><span style="color:#81A1C1;">&lt;</span><span style="color:#B48EAD;"> 10</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9FF;">a</span><span style="color:#81A1C1;">++;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#B48EAD;">0</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> iconst_0</span></span>
<span class="line"><span style="color:#B48EAD;">1</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> istore_1</span></span>
<span class="line"><span style="color:#B48EAD;">2</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> iload_1</span></span>
<span class="line"><span style="color:#B48EAD;">3</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> bipush </span><span style="color:#B48EAD;">10</span></span>
<span class="line"><span style="color:#B48EAD;">5</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> if_icmpge </span><span style="color:#B48EAD;">14</span></span>
<span class="line"><span style="color:#B48EAD;">8</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> iinc </span><span style="color:#B48EAD;">1</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 1</span></span>
<span class="line"><span style="color:#B48EAD;">11</span><span style="color:#81A1C1;">:</span><span style="color:#81A1C1;"> goto</span><span style="color:#B48EAD;"> 2</span></span>
<span class="line"><span style="color:#B48EAD;">14</span><span style="color:#81A1C1;">:</span><span style="color:#81A1C1;"> return</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å†æ¯”å¦‚ do while å¾ªç¯ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Demo3_5</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">int</span><span style="color:#D8DEE9;"> a</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">do</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9FF;">a</span><span style="color:#81A1C1;">++;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> while</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9FF;">a </span><span style="color:#81A1C1;">&lt;</span><span style="color:#B48EAD;"> 10</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#D8DEE9FF;">å­—èŠ‚ç æ˜¯ï¼š</span></span>
<span class="line"><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> iconst_0</span></span>
<span class="line"><span style="color:#B48EAD;"> 1</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> istore_1</span></span>
<span class="line"><span style="color:#B48EAD;"> 2</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> iinc </span><span style="color:#B48EAD;">1</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 1</span></span>
<span class="line"><span style="color:#B48EAD;"> 5</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> iload_1</span></span>
<span class="line"><span style="color:#B48EAD;"> 6</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> bipush </span><span style="color:#B48EAD;">10</span></span>
<span class="line"><span style="color:#B48EAD;"> 8</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> if_icmplt </span><span style="color:#B48EAD;">2</span></span>
<span class="line"><span style="color:#B48EAD;">11</span><span style="color:#81A1C1;">:</span><span style="color:#81A1C1;"> return</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æœ€åå†çœ‹çœ‹ for å¾ªç¯ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Demo3_6</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">for</span><span style="color:#ECEFF4;"> (</span><span style="color:#81A1C1;">int</span><span style="color:#D8DEE9;"> i</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> i </span><span style="color:#81A1C1;">&lt;</span><span style="color:#B48EAD;"> 10</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> i</span><span style="color:#81A1C1;">++</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#B48EAD;">0</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> iconst_0</span></span>
<span class="line"><span style="color:#B48EAD;">1</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> istore_1</span></span>
<span class="line"><span style="color:#B48EAD;">2</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> iload_1</span></span>
<span class="line"><span style="color:#B48EAD;">3</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> bipush </span><span style="color:#B48EAD;">10</span></span>
<span class="line"><span style="color:#B48EAD;">5</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> if_icmpge </span><span style="color:#B48EAD;">14</span></span>
<span class="line"><span style="color:#B48EAD;">8</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> iinc </span><span style="color:#B48EAD;">1</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 1</span></span>
<span class="line"><span style="color:#B48EAD;">11</span><span style="color:#81A1C1;">:</span><span style="color:#81A1C1;"> goto</span><span style="color:#B48EAD;"> 2</span></span>
<span class="line"><span style="color:#B48EAD;">14</span><span style="color:#81A1C1;">:</span><span style="color:#81A1C1;"> return</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>æ³¨æ„</p><p>æ¯”è¾ƒ while å’Œ for çš„å­—èŠ‚ç ï¼Œä½ å‘ç°å®ƒä»¬æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ï¼Œæ®Šé€”ä¹Ÿèƒ½åŒå½’ğŸ˜Š</p></blockquote><h3 id="_2-6-ç»ƒä¹ -åˆ¤æ–­ç»“æœ" tabindex="-1"><a class="header-anchor" href="#_2-6-ç»ƒä¹ -åˆ¤æ–­ç»“æœ"><span>2.6 ç»ƒä¹ -åˆ¤æ–­ç»“æœ</span></a></h3><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Code_11_ByteCodeTest</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">        int</span><span style="color:#D8DEE9;"> i</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">        int</span><span style="color:#D8DEE9;"> x</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">        while</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9FF;">i </span><span style="color:#81A1C1;">&lt;</span><span style="color:#B48EAD;"> 10</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9FF;">            x </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> x</span><span style="color:#81A1C1;">++;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">            i</span><span style="color:#81A1C1;">++;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">x</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // 0</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806675.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>ä¸ºä»€ä¹ˆæœ€ç»ˆçš„ x ç»“æœä¸º 0 å‘¢ï¼Ÿ é€šè¿‡åˆ†æå­—èŠ‚ç æŒ‡ä»¤å³å¯çŸ¥æ™“</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;">Code</span><span style="color:#81A1C1;">:</span></span>
<span class="line"><span style="color:#D8DEE9FF;">     stack</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">2</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> locals</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">3</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> args_size</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">1</span><span style="color:#616E88;">        // æ“ä½œæ•°æ ˆåˆ†é…2ä¸ªç©ºé—´ï¼Œå±€éƒ¨å˜é‡è¡¨åˆ†é… 3 ä¸ªç©ºé—´</span></span>
<span class="line"><span style="color:#B48EAD;">        0</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> iconst_0        </span><span style="color:#616E88;">// å‡†å¤‡ä¸€ä¸ªå¸¸æ•° 0</span></span>
<span class="line"><span style="color:#B48EAD;">        1</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> istore_1        </span><span style="color:#616E88;">// å°†å¸¸æ•° 0 æ”¾å…¥å±€éƒ¨å˜é‡è¡¨çš„ 1 å·æ§½ä½ i = 0</span></span>
<span class="line"><span style="color:#B48EAD;">        2</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> iconst_0        </span><span style="color:#616E88;">// å‡†å¤‡ä¸€ä¸ªå¸¸æ•° 0</span></span>
<span class="line"><span style="color:#B48EAD;">        3</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> istore_2        </span><span style="color:#616E88;">// å°†å¸¸æ•° 0 æ”¾å…¥å±€éƒ¨å˜é‡çš„ 2 å·æ§½ä½ x = 0        </span></span>
<span class="line"><span style="color:#B48EAD;">        4</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> iload_1                </span><span style="color:#616E88;">// å°†å±€éƒ¨å˜é‡è¡¨ 1 å·æ§½ä½çš„æ•°æ”¾å…¥æ“ä½œæ•°æ ˆä¸­</span></span>
<span class="line"><span style="color:#B48EAD;">        5</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> bipush        </span><span style="color:#B48EAD;">10</span><span style="color:#616E88;">        // å°†æ•°å­— 10 æ”¾å…¥æ“ä½œæ•°æ ˆä¸­ï¼Œæ­¤æ—¶æ“ä½œæ•°æ ˆä¸­æœ‰ 2 ä¸ªæ•°</span></span>
<span class="line"><span style="color:#B48EAD;">        7</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> if_icmpge     </span><span style="color:#B48EAD;">21</span><span style="color:#616E88;">        // æ¯”è¾ƒæ“ä½œæ•°æ ˆä¸­çš„ä¸¤ä¸ªæ•°ï¼Œå¦‚æœä¸‹é¢çš„æ•°å¤§äºä¸Šé¢çš„æ•°ï¼Œå°±è·³è½¬åˆ° 21 ã€‚è¿™é‡Œçš„æ¯”è¾ƒæ˜¯å°†ä¸¤ä¸ªæ•°åšå‡æ³•ã€‚å› ä¸ºæ¶‰åŠè¿ç®—æ“ä½œï¼Œæ‰€ä»¥ä¼šå°†ä¸¤ä¸ªæ•°å¼¹å‡ºæ“ä½œæ•°æ ˆæ¥è¿›è¡Œè¿ç®—ã€‚è¿ç®—ç»“æŸåæ“ä½œæ•°æ ˆä¸ºç©º</span></span>
<span class="line"><span style="color:#B48EAD;">       10</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> iload_2                </span><span style="color:#616E88;">// å°†å±€éƒ¨å˜é‡ 2 å·æ§½ä½çš„æ•°æ”¾å…¥æ“ä½œæ•°æ ˆä¸­ï¼Œæ”¾å…¥çš„å€¼æ˜¯ 0 </span></span>
<span class="line"><span style="color:#B48EAD;">       11</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> iinc          </span><span style="color:#B48EAD;">2</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 1</span><span style="color:#616E88;">        // å°†å±€éƒ¨å˜é‡ 2 å·æ§½ä½çš„æ•°åŠ  1 ï¼Œè‡ªå¢åï¼Œæ§½ä½ä¸­çš„å€¼ä¸º 1 </span></span>
<span class="line"><span style="color:#B48EAD;">       14</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> istore_2        </span><span style="color:#616E88;">//å°†æ“ä½œæ•°æ ˆä¸­çš„æ•°æ”¾å…¥åˆ°å±€éƒ¨å˜é‡è¡¨çš„ 2 å·æ§½ä½ï¼Œ2 å·æ§½ä½çš„å€¼åˆå˜ä¸ºäº†0</span></span>
<span class="line"><span style="color:#B48EAD;">       15</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> iinc          </span><span style="color:#B48EAD;">1</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 1</span><span style="color:#616E88;"> // 1 å·æ§½ä½çš„å€¼è‡ªå¢ 1 </span></span>
<span class="line"><span style="color:#B48EAD;">       18</span><span style="color:#81A1C1;">:</span><span style="color:#81A1C1;"> goto</span><span style="color:#B48EAD;">          4</span><span style="color:#616E88;"> // è·³è½¬åˆ°ç¬¬4æ¡æŒ‡ä»¤</span></span>
<span class="line"><span style="color:#B48EAD;">       21</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> getstatic     #</span><span style="color:#B48EAD;">2</span><span style="color:#616E88;">                  // Field java/lang/System.out:Ljava/io/PrintStream;</span></span>
<span class="line"><span style="color:#B48EAD;">       24</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> iload_2</span></span>
<span class="line"><span style="color:#B48EAD;">       25</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> invokevirtual #</span><span style="color:#B48EAD;">3</span><span style="color:#616E88;">                  // Method java/io/PrintStream.println:(I)V</span></span>
<span class="line"><span style="color:#B48EAD;">       28</span><span style="color:#81A1C1;">:</span><span style="color:#81A1C1;"> return</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-7-æ„é€ æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_2-7-æ„é€ æ–¹æ³•"><span>2.7 æ„é€ æ–¹æ³•</span></a></h3><p><strong>cinit()V</strong></p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Code_12_CinitTest</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">        static</span><span style="color:#81A1C1;"> int</span><span style="color:#D8DEE9;"> i</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 10</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">        static</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9FF;">                i </span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;"> 20</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">        static</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9FF;">                i </span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;"> 30</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">        public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">                System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">i</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // 30</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç¼–è¯‘å™¨ä¼šæŒ‰<strong>ä»ä¸Šè‡³ä¸‹</strong>çš„é¡ºåºï¼Œæ”¶é›†æ‰€æœ‰ <code>static</code> é™æ€ä»£ç å—å’Œé™æ€æˆå‘˜èµ‹å€¼çš„ä»£ç ï¼Œ<strong>åˆå¹¶</strong>ä¸ºä¸€ä¸ªç‰¹æ®Šçš„æ–¹æ³• <code>cinit()V</code> ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;">stack</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">1</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> locals</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">0</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> args_size</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">0</span></span>
<span class="line"><span style="color:#B48EAD;">         0</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> bipush        </span><span style="color:#B48EAD;">10</span></span>
<span class="line"><span style="color:#B48EAD;">         2</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> putstatic     #</span><span style="color:#B48EAD;">3</span><span style="color:#616E88;">                  // Field i:I</span></span>
<span class="line"><span style="color:#B48EAD;">         5</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> bipush        </span><span style="color:#B48EAD;">20</span></span>
<span class="line"><span style="color:#B48EAD;">         7</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> putstatic     #</span><span style="color:#B48EAD;">3</span><span style="color:#616E88;">                  // Field i:I</span></span>
<span class="line"><span style="color:#B48EAD;">        10</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> bipush        </span><span style="color:#B48EAD;">30</span></span>
<span class="line"><span style="color:#B48EAD;">        12</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> putstatic     #</span><span style="color:#B48EAD;">3</span><span style="color:#616E88;">                  // Field i:I</span></span>
<span class="line"><span style="color:#B48EAD;">        15</span><span style="color:#81A1C1;">:</span><span style="color:#81A1C1;"> return</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>cinit()V</code> æ–¹æ³•ä¼šåœ¨<a href="https://so.csdn.net/so/search?q=%E7%B1%BB%E5%8A%A0%E8%BD%BD&amp;spm=1001.2101.3001.7020" target="_blank" rel="noopener noreferrer">ç±»åŠ è½½</a>çš„åˆå§‹åŒ–é˜¶æ®µè¢«è°ƒç”¨</p><p><strong>init()V</strong></p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Main</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    private</span><span style="color:#8FBCBB;"> String</span><span style="color:#D8DEE9;"> a</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">s1</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ECEFF4;">    {</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        b </span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;"> 20</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">    private</span><span style="color:#81A1C1;"> int</span><span style="color:#D8DEE9;"> b</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 10</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ECEFF4;">    {</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        a </span><span style="color:#81A1C1;">=</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">s2</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#88C0D0;"> Main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#D8DEE9;"> a</span><span style="color:#ECEFF4;">,</span><span style="color:#81A1C1;"> int</span><span style="color:#D8DEE9;"> b</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">        this</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">a</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9FF;"> a</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">        this</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">b</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9FF;"> b</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">        Main</span><span style="color:#D8DEE9;"> d</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Main</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">s3</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 30</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">d</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">a</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;">//s3</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">d</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">b</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;">//30</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#D8DEE9FF;">    </span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç¼–è¯‘å™¨ä¼šæŒ‰<strong>ä»ä¸Šè‡³ä¸‹</strong>çš„é¡ºåºï¼Œæ”¶é›†æ‰€æœ‰ {} ä»£ç å—å’Œæˆå‘˜å˜é‡èµ‹å€¼çš„ä»£ç ï¼Œ<strong>å½¢æˆæ–°çš„æ„é€ æ–¹æ³•</strong>ï¼Œä½†<strong>åŸå§‹æ„é€ æ–¹æ³•</strong>å†…çš„ä»£ç <strong>æ€»æ˜¯åœ¨å</strong></p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;">Code</span><span style="color:#81A1C1;">:</span></span>
<span class="line"><span style="color:#D8DEE9FF;">stack</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">2</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> locals</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">3</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> args_size</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">3</span></span>
<span class="line"><span style="color:#B48EAD;">0</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> aload_0</span></span>
<span class="line"><span style="color:#B48EAD;">1</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> invokespecial #</span><span style="color:#B48EAD;">1</span><span style="color:#616E88;"> // super.&lt;init&gt;()V</span></span>
<span class="line"><span style="color:#B48EAD;">4</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> aload_0</span></span>
<span class="line"><span style="color:#B48EAD;">5</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> ldc #</span><span style="color:#B48EAD;">2</span><span style="color:#616E88;">         // &lt;- &quot;s1&quot;</span></span>
<span class="line"><span style="color:#B48EAD;">7</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> putfield #</span><span style="color:#B48EAD;">3</span><span style="color:#616E88;">    // -&gt; this.a</span></span>
<span class="line"><span style="color:#B48EAD;">10</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> aload_0</span></span>
<span class="line"><span style="color:#B48EAD;">11</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> bipush </span><span style="color:#B48EAD;">20</span><span style="color:#616E88;">     // &lt;- 20</span></span>
<span class="line"><span style="color:#B48EAD;">13</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> putfield #</span><span style="color:#B48EAD;">4</span><span style="color:#616E88;">   // -&gt; this.b</span></span>
<span class="line"><span style="color:#B48EAD;">16</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> aload_0</span></span>
<span class="line"><span style="color:#B48EAD;">17</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> bipush </span><span style="color:#B48EAD;">10</span><span style="color:#616E88;">     // &lt;- 10</span></span>
<span class="line"><span style="color:#B48EAD;">19</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> putfield #</span><span style="color:#B48EAD;">4</span><span style="color:#616E88;">   // -&gt; this.b</span></span>
<span class="line"><span style="color:#B48EAD;">22</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> aload_0</span></span>
<span class="line"><span style="color:#B48EAD;">23</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> ldc #</span><span style="color:#B48EAD;">5</span><span style="color:#616E88;">        // &lt;- &quot;s2&quot;</span></span>
<span class="line"><span style="color:#B48EAD;">25</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> putfield #</span><span style="color:#B48EAD;">3</span><span style="color:#616E88;">   // -&gt; this.a</span></span>
<span class="line"><span style="color:#B48EAD;">28</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> aload_0       </span><span style="color:#616E88;">// ------------------------------</span></span>
<span class="line"><span style="color:#B48EAD;">29</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> aload_1       </span><span style="color:#616E88;">// &lt;- slot 1(a) &quot;s3&quot;            |</span></span>
<span class="line"><span style="color:#B48EAD;">30</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> putfield #</span><span style="color:#B48EAD;">3</span><span style="color:#616E88;">   // -&gt; this.a                    |</span></span>
<span class="line"><span style="color:#B48EAD;">33</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> aload_0                                       </span><span style="color:#81A1C1;">|</span></span>
<span class="line"><span style="color:#B48EAD;">34</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> iload_2       </span><span style="color:#616E88;">// &lt;- slot 2(b) 30              |</span></span>
<span class="line"><span style="color:#B48EAD;">35</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> putfield #</span><span style="color:#B48EAD;">4</span><span style="color:#616E88;">   // -&gt; this.b --------------------</span></span>
<span class="line"><span style="color:#B48EAD;">38</span><span style="color:#81A1C1;">:</span><span style="color:#81A1C1;"> return</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-8-æ–¹æ³•è°ƒç”¨" tabindex="-1"><a class="header-anchor" href="#_2-8-æ–¹æ³•è°ƒç”¨"><span>2.8 æ–¹æ³•è°ƒç”¨</span></a></h3><p>çœ‹ä¸€ä¸‹å‡ ç§ä¸åŒçš„æ–¹æ³•è°ƒç”¨å¯¹åº”çš„å­—èŠ‚ç æŒ‡ä»¤</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">package</span><span style="color:#8FBCBB;"> main</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Main</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#88C0D0;"> Main</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">    private</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> test1</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">    private</span><span style="color:#81A1C1;"> final</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> test2</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> test3</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> test4</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">        Main</span><span style="color:#D8DEE9;"> m</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Main</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        m</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">test1</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        m</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">test2</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        m</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">test3</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        Main</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">test4</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸åŒæ–¹æ³•åœ¨è°ƒç”¨æ—¶ï¼Œå¯¹åº”çš„è™šæ‹ŸæœºæŒ‡ä»¤æœ‰æ‰€åŒºåˆ«ï¼š</p><ul><li><strong>ç§æœ‰</strong>ã€<strong>æ„é€ </strong>ã€è¢«<strong>final</strong>ä¿®é¥°çš„æ–¹æ³•ï¼Œåœ¨è°ƒç”¨æ—¶éƒ½ä½¿ç”¨<strong>invokespecial</strong>æŒ‡ä»¤ï¼Œå±äº<strong>é™æ€ç»‘å®š</strong></li><li><strong>æ™®é€šæˆå‘˜</strong>æ–¹æ³•åœ¨è°ƒç”¨æ—¶ï¼Œä½¿ç”¨<strong>invokevirtual</strong>æŒ‡ä»¤ã€‚å› ä¸ºç¼–è¯‘æœŸé—´æ— æ³•ç¡®å®šè¯¥æ–¹æ³•çš„å†…å®¹ï¼Œåªæœ‰åœ¨è¿è¡ŒæœŸé—´æ‰èƒ½ç¡®å®šï¼Œå±äº<strong>åŠ¨æ€ç»‘å®š</strong>ï¼Œå³æ”¯æŒå¤šæ€</li><li><strong>é™æ€æ–¹æ³•</strong>åœ¨è°ƒç”¨æ—¶ä½¿ç”¨<strong>invokestatic</strong>æŒ‡ä»¤</li></ul><p>å¯¹åº”çš„å­—èŠ‚ç æ–‡ä»¶ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;"> Code</span><span style="color:#81A1C1;">:</span></span>
<span class="line"><span style="color:#D8DEE9FF;">      stack</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">2</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> locals</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">2</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> args_size</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">1</span></span>
<span class="line"><span style="color:#B48EAD;">         0</span><span style="color:#81A1C1;">:</span><span style="color:#81A1C1;"> new</span><span style="color:#D8DEE9FF;">           #2                  </span><span style="color:#616E88;">// class main/Main</span></span>
<span class="line"><span style="color:#D8DEE9FF;">         3</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> dup</span></span>
<span class="line"><span style="color:#B48EAD;">         4</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> invokespecial #</span><span style="color:#B48EAD;">3</span><span style="color:#616E88;">                  // Method &quot;&lt;init&gt;&quot;:()V</span></span>
<span class="line"><span style="color:#B48EAD;">         7</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> astore_1</span></span>
<span class="line"><span style="color:#B48EAD;">         8</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> aload_1</span></span>
<span class="line"><span style="color:#B48EAD;">         9</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> invokespecial #</span><span style="color:#B48EAD;">4</span><span style="color:#616E88;">                  // Method test1:()V</span></span>
<span class="line"><span style="color:#B48EAD;">        12</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> aload_1</span></span>
<span class="line"><span style="color:#B48EAD;">        13</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> invokespecial #</span><span style="color:#B48EAD;">5</span><span style="color:#616E88;">                  // Method test2:()V</span></span>
<span class="line"><span style="color:#B48EAD;">        16</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> aload_1</span></span>
<span class="line"><span style="color:#B48EAD;">        17</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> invokevirtual #</span><span style="color:#B48EAD;">6</span><span style="color:#616E88;">                  // Method test3:()V</span></span>
<span class="line"><span style="color:#B48EAD;">        20</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> invokestatic  #</span><span style="color:#B48EAD;">7</span><span style="color:#616E88;">                  // Method test4:()V</span></span>
<span class="line"><span style="color:#B48EAD;">        23</span><span style="color:#81A1C1;">:</span><span style="color:#81A1C1;"> return</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>new æ˜¯åˆ›å»ºã€å¯¹è±¡ã€‘ï¼Œç»™å¯¹è±¡åˆ†é…å †å†…å­˜ï¼Œæ‰§è¡ŒæˆåŠŸä¼šå°†ã€å¯¹è±¡å¼•ç”¨ã€‘å‹å…¥æ“ä½œæ•°æ ˆ</li><li>dup æ˜¯å¤åˆ¶æ“ä½œæ•°æ ˆæ ˆé¡¶çš„å†…å®¹ï¼Œæœ¬ä¾‹å³ä¸ºã€å¯¹è±¡å¼•ç”¨ã€‘ï¼Œä¸ºä»€ä¹ˆéœ€è¦ä¸¤ä»½å¼•ç”¨å‘¢ï¼Œä¸€ä¸ªæ˜¯è¦é…åˆ <code>invokespecial</code> è°ƒç”¨è¯¥å¯¹è±¡çš„æ„é€ æ–¹æ³• <code>&quot;&lt;init&gt;&quot;:()V</code> ï¼ˆä¼šæ¶ˆè€—æ‰æ ˆé¡¶ä¸€ä¸ªå¼•ç”¨ï¼‰ï¼Œå¦ä¸€ä¸ªè¦é…åˆ <code>astore_1</code> èµ‹å€¼ç»™å±€éƒ¨å˜é‡</li><li>ç»ˆæ–¹æ³•ï¼ˆï¬nalï¼‰ï¼Œç§æœ‰æ–¹æ³•ï¼ˆprivateï¼‰ï¼Œæ„é€ æ–¹æ³•éƒ½æ˜¯ç”± invokespecial æŒ‡ä»¤æ¥è°ƒç”¨ï¼Œå±äºé™æ€ç»‘å®š</li><li>æ™®é€šæˆå‘˜æ–¹æ³•æ˜¯ç”± invokevirtual è°ƒç”¨ï¼Œå±äºåŠ¨æ€ç»‘å®šï¼Œå³æ”¯æŒå¤šæ€ï¼Œæˆå‘˜æ–¹æ³•ä¸é™æ€æ–¹æ³•è°ƒç”¨çš„å¦ä¸€ä¸ªåŒºåˆ«æ˜¯ï¼Œæ‰§è¡Œæ–¹æ³•å‰æ˜¯å¦éœ€è¦ã€å¯¹è±¡å¼•ç”¨ã€‘</li><li>æ¯”è¾ƒæœ‰æ„æ€çš„æ˜¯ d.test4(); æ˜¯é€šè¿‡ã€å¯¹è±¡å¼•ç”¨ã€‘è°ƒç”¨ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œå¯ä»¥çœ‹åˆ°åœ¨è°ƒç”¨invokestatic ä¹‹å‰æ‰§è¡Œäº† pop æŒ‡ä»¤ï¼ŒæŠŠã€å¯¹è±¡å¼•ç”¨ã€‘ä»æ“ä½œæ•°æ ˆå¼¹æ‰äº†ğŸ˜‚</li><li>è¿˜æœ‰ä¸€ä¸ªæ‰§è¡Œ invokespecial çš„æƒ…å†µæ˜¯é€šè¿‡ super è°ƒç”¨çˆ¶ç±»æ–¹æ³•</li></ul><h3 id="_2-9-å¤šæ€çš„åŸç†" tabindex="-1"><a class="header-anchor" href="#_2-9-å¤šæ€çš„åŸç†"><span>2.9 å¤šæ€çš„åŸç†</span></a></h3><p>å› ä¸ºæ™®é€šæˆå‘˜æ–¹æ³•éœ€è¦åœ¨è¿è¡Œæ—¶æ‰èƒ½ç¡®å®šå…·ä½“çš„å†…å®¹ï¼Œæ‰€ä»¥è™šæ‹Ÿæœºéœ€è¦è°ƒç”¨<strong>invokevirtual</strong>æŒ‡ä»¤</p><p>åœ¨æ‰§è¡Œ<strong>invokevirtual</strong>æŒ‡ä»¤æ—¶ï¼Œç»å†äº†ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤</p><ul><li>å…ˆé€šè¿‡æ ˆå¸§ä¸­å¯¹è±¡çš„å¼•ç”¨æ‰¾åˆ°å¯¹è±¡</li><li>åˆ†æå¯¹è±¡å¤´ï¼Œæ‰¾åˆ°å¯¹è±¡å®é™…çš„Class</li><li>Classç»“æ„ä¸­æœ‰<strong>vtable</strong>ï¼Œå®ƒåœ¨ç±»åŠ è½½çš„é“¾æ¥é˜¶æ®µå°±å·²ç»æ ¹æ®æ–¹æ³•çš„é‡å†™è§„åˆ™ç”Ÿæˆå¥½äº†</li><li>æŸ¥è¯¢<strong>vtable</strong>æ‰¾åˆ°æ–¹æ³•çš„å…·ä½“åœ°å€</li><li>æ‰§è¡Œæ–¹æ³•çš„å­—èŠ‚ç </li></ul><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">package</span><span style="color:#8FBCBB;"> cn</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">itcast</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">jvm</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">t3</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">bytecode</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">import</span><span style="color:#8FBCBB;"> java</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">io</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">IOException</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">/**</span></span>
<span class="line"><span style="color:#616E88;">* æ¼”ç¤ºå¤šæ€åŸç†ï¼Œæ³¨æ„åŠ ä¸Šä¸‹é¢çš„ JVM å‚æ•°ï¼Œç¦ç”¨æŒ‡é’ˆå‹ç¼©</span></span>
<span class="line"><span style="color:#616E88;">* -XX:-UseCompressedOops -XX:-UseCompressedClassPointers</span></span>
<span class="line"><span style="color:#616E88;">*/</span></span>
<span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Demo3_10</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> test</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">Animal</span><span style="color:#D8DEE9;"> animal</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">        animal</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">eat</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">animal</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">toString</span><span style="color:#ECEFF4;">())</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> throws</span><span style="color:#8FBCBB;"> IOException</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#88C0D0;">        test</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">new</span><span style="color:#88C0D0;"> Cat</span><span style="color:#ECEFF4;">())</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#88C0D0;">        test</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">new</span><span style="color:#88C0D0;"> Dog</span><span style="color:#ECEFF4;">())</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">in</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">read</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#81A1C1;">abstract</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Animal</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> abstract</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> eat</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    @</span><span style="color:#D08770;">Override</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#8FBCBB;"> String</span><span style="color:#88C0D0;"> toString</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">        return</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">æˆ‘æ˜¯</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;"> +</span><span style="color:#81A1C1;"> this</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getClass</span><span style="color:#ECEFF4;">().</span><span style="color:#88C0D0;">getSimpleName</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#81A1C1;">class</span><span style="color:#8FBCBB;"> Dog</span><span style="color:#81A1C1;"> extends</span><span style="color:#8FBCBB;font-weight:bold;"> Animal</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">    @</span><span style="color:#D08770;">Override</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> eat</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">å•ƒéª¨å¤´</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#81A1C1;">class</span><span style="color:#8FBCBB;"> Cat</span><span style="color:#81A1C1;"> extends</span><span style="color:#8FBCBB;font-weight:bold;"> Animal</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">    @</span><span style="color:#D08770;">Override</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> eat</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">åƒé±¼</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_1-è¿è¡Œä»£ç " tabindex="-1"><a class="header-anchor" href="#_1-è¿è¡Œä»£ç "><span>1ï¼‰è¿è¡Œä»£ç </span></a></h4><p>åœåœ¨ System.in.read() æ–¹æ³•ä¸Šï¼Œè¿™æ—¶è¿è¡Œ jps è·å–è¿›ç¨‹ id</p><h4 id="_2-è¿è¡Œ-hsdb-å·¥å…·" tabindex="-1"><a class="header-anchor" href="#_2-è¿è¡Œ-hsdb-å·¥å…·"><span>2ï¼‰è¿è¡Œ HSDB å·¥å…·</span></a></h4><p>è¿›å…¥ JDK å®‰è£…ç›®å½•ï¼Œæ‰§è¡Œ</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;">java </span><span style="color:#81A1C1;">-</span><span style="color:#D8DEE9FF;">cp </span><span style="color:#ECEFF4;">.</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">lib</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">sa</span><span style="color:#81A1C1;">-</span><span style="color:#D8DEE9;">jdi</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">jar</span><span style="color:#D8DEE9;"> sun</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">jvm</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">hotspot</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">HSDB</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿›å…¥å›¾å½¢ç•Œé¢ attach è¿›ç¨‹ id</p><h4 id="_3-æŸ¥æ‰¾æŸä¸ªå¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#_3-æŸ¥æ‰¾æŸä¸ªå¯¹è±¡"><span>3ï¼‰æŸ¥æ‰¾æŸä¸ªå¯¹è±¡</span></a></h4><p>æ‰“å¼€ Tools -&gt; Find Object By Query</p><p>è¾“å…¥</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;">select d from </span><span style="color:#D8DEE9;">cn</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">itcast</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">jvm</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">t3</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">bytecode</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">Dog</span><span style="color:#D8DEE9FF;"> d</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ç‚¹å‡» Execute æ‰§è¡Œ</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806863.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><h4 id="_4-æŸ¥çœ‹å¯¹è±¡å†…å­˜ç»“æ„" tabindex="-1"><a class="header-anchor" href="#_4-æŸ¥çœ‹å¯¹è±¡å†…å­˜ç»“æ„"><span>4ï¼‰æŸ¥çœ‹å¯¹è±¡å†…å­˜ç»“æ„</span></a></h4><p>ç‚¹å‡»è¶…é“¾æ¥å¯ä»¥çœ‹åˆ°å¯¹è±¡çš„å†…å­˜ç»“æ„ï¼Œæ­¤å¯¹è±¡æ²¡æœ‰ä»»ä½•å±æ€§ï¼Œå› æ­¤åªæœ‰å¯¹è±¡å¤´çš„ 16 å­—èŠ‚ï¼Œå‰ 8 å­—èŠ‚æ˜¯</p><p>MarkWordï¼Œå 8 å­—èŠ‚å°±æ˜¯å¯¹è±¡çš„ Class æŒ‡é’ˆ</p><p>ä½†ç›®å‰çœ‹ä¸åˆ°å®ƒçš„å®é™…åœ°å€</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806948.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><h4 id="_5-æŸ¥çœ‹å¯¹è±¡-class-çš„å†…å­˜åœ°å€" tabindex="-1"><a class="header-anchor" href="#_5-æŸ¥çœ‹å¯¹è±¡-class-çš„å†…å­˜åœ°å€"><span>5ï¼‰æŸ¥çœ‹å¯¹è±¡ Class çš„å†…å­˜åœ°å€</span></a></h4><p>å¯ä»¥é€šè¿‡ Windows -&gt; Console è¿›å…¥å‘½ä»¤è¡Œæ¨¡å¼ï¼Œæ‰§è¡Œ</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;">mem </span><span style="color:#B48EAD;">0x00000001299b4978</span><span style="color:#B48EAD;"> 2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>mem æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œå‚æ•° 1 æ˜¯å¯¹è±¡åœ°å€ï¼Œå‚æ•° 2 æ˜¯æŸ¥çœ‹ 2 è¡Œï¼ˆå³ 16 å­—èŠ‚ï¼‰</p><p>ç»“æœä¸­ç¬¬äºŒè¡Œ 0x000000001b7d4028 å³ä¸º Class çš„å†…å­˜åœ°å€</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806050.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><h4 id="_6-æŸ¥çœ‹ç±»çš„-vtable" tabindex="-1"><a class="header-anchor" href="#_6-æŸ¥çœ‹ç±»çš„-vtable"><span>6ï¼‰æŸ¥çœ‹ç±»çš„ vtable</span></a></h4><p>æ–¹æ³•1ï¼šAlt+R è¿›å…¥ Inspector å·¥å…·ï¼Œè¾“å…¥åˆšæ‰çš„ Class å†…å­˜åœ°å€ï¼Œçœ‹åˆ°å¦‚ä¸‹ç•Œé¢</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806161.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>æ–¹æ³•2ï¼šæˆ–è€… Tools -&gt; Class Browser è¾“å…¥ Dog æŸ¥æ‰¾ï¼Œå¯ä»¥å¾—åˆ°ç›¸åŒçš„ç»“æœ</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806177.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>æ— è®ºé€šè¿‡å“ªç§æ–¹æ³•ï¼Œéƒ½å¯ä»¥æ‰¾åˆ° Dog Class çš„ vtable é•¿åº¦ä¸º 6ï¼Œæ„æ€å°±æ˜¯ Dog ç±»æœ‰ 6 ä¸ªè™šæ–¹æ³•ï¼ˆå¤šæ€ç›¸å…³çš„ï¼Œfinalï¼Œstatic ä¸ä¼šåˆ—å…¥ï¼‰</p><p>é‚£ä¹ˆè¿™ 6 ä¸ªæ–¹æ³•éƒ½æ˜¯è°å‘¢ï¼Ÿä» Class çš„èµ·å§‹åœ°å€å¼€å§‹ç®—ï¼Œåç§» 0x1b8 å°±æ˜¯ vtable çš„èµ·å§‹åœ°å€ï¼Œè¿›è¡Œè®¡ç®—å¾—åˆ°ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#B48EAD;">0x000000001b7d4028</span></span>
<span class="line"><span style="color:#D8DEE9FF;">               1b8 </span><span style="color:#81A1C1;">+</span></span>
<span class="line"><span style="color:#81A1C1;">---------------------</span></span>
<span class="line"><span style="color:#B48EAD;">0x000000001b7d41e0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡ Windows -&gt; Console è¿›å…¥å‘½ä»¤è¡Œæ¨¡å¼ï¼Œæ‰§è¡Œ</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;">mem </span><span style="color:#B48EAD;">0x000000001b7d41e0</span><span style="color:#B48EAD;"> 6</span></span>
<span class="line"><span style="color:#B48EAD;">0x000000001b7d41e0</span><span style="color:#81A1C1;">:</span><span style="color:#B48EAD;"> 0x000000001b3d1b10</span></span>
<span class="line"><span style="color:#B48EAD;">0x000000001b7d41e8</span><span style="color:#81A1C1;">:</span><span style="color:#B48EAD;"> 0x000000001b3d15e8</span></span>
<span class="line"><span style="color:#B48EAD;">0x000000001b7d41f0</span><span style="color:#81A1C1;">:</span><span style="color:#B48EAD;"> 0x000000001b7d35e8</span></span>
<span class="line"><span style="color:#B48EAD;">0x000000001b7d41f8</span><span style="color:#81A1C1;">:</span><span style="color:#B48EAD;"> 0x000000001b3d1540</span></span>
<span class="line"><span style="color:#B48EAD;">0x000000001b7d4200</span><span style="color:#81A1C1;">:</span><span style="color:#B48EAD;"> 0x000000001b3d1678</span></span>
<span class="line"><span style="color:#B48EAD;">0x000000001b7d4208</span><span style="color:#81A1C1;">:</span><span style="color:#B48EAD;"> 0x000000001b7d3fa8</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å°±å¾—åˆ°äº† 6 ä¸ªè™šæ–¹æ³•çš„å…¥å£åœ°å€</p><h4 id="_7-éªŒè¯æ–¹æ³•åœ°å€" tabindex="-1"><a class="header-anchor" href="#_7-éªŒè¯æ–¹æ³•åœ°å€"><span>7ï¼‰éªŒè¯æ–¹æ³•åœ°å€</span></a></h4><p>é€šè¿‡ Tools -&gt; Class Browser æŸ¥çœ‹æ¯ä¸ªç±»çš„æ–¹æ³•å®šä¹‰ï¼Œæ¯”è¾ƒå¯çŸ¥</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806295.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;">Dog </span><span style="color:#81A1C1;">-</span><span style="color:#81A1C1;"> public</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> eat</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> @</span><span style="color:#D08770;">0x000000001b7d3fa8</span></span>
<span class="line"><span style="color:#D8DEE9FF;">Animal </span><span style="color:#81A1C1;">-</span><span style="color:#81A1C1;"> public</span><span style="color:#D8DEE9;"> java</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">lang</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">String</span><span style="color:#88C0D0;"> toString</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> @</span><span style="color:#D08770;">0x000000001b7d35e8</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">Object </span><span style="color:#81A1C1;">-</span><span style="color:#81A1C1;"> protected</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> finalize</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> @</span><span style="color:#D08770;">0x000000001b3d1b10</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">Object </span><span style="color:#81A1C1;">-</span><span style="color:#81A1C1;"> public</span><span style="color:#81A1C1;"> boolean</span><span style="color:#88C0D0;"> equals</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">java</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">lang</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">Object</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> @</span><span style="color:#D08770;">0x000000001b3d15e8</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">Object </span><span style="color:#81A1C1;">-</span><span style="color:#81A1C1;"> public</span><span style="color:#81A1C1;"> native</span><span style="color:#81A1C1;"> int</span><span style="color:#88C0D0;"> hashCode</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> @</span><span style="color:#D08770;">0x000000001b3d1540</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">Object </span><span style="color:#81A1C1;">-</span><span style="color:#81A1C1;"> protected</span><span style="color:#81A1C1;"> native</span><span style="color:#D8DEE9;"> java</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">lang</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">Object</span><span style="color:#88C0D0;"> clone</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> @</span><span style="color:#D08770;">0x000000001b3d1678</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯¹å·å…¥åº§ï¼Œå‘ç°</p><ul><li>eat() æ–¹æ³•æ˜¯ Dog ç±»è‡ªå·±çš„</li><li>toString() æ–¹æ³•æ˜¯ç»§æ‰¿ String ç±»çš„</li><li>finalize() ï¼Œequals()ï¼ŒhashCode()ï¼Œclone() éƒ½æ˜¯ç»§æ‰¿ Object ç±»çš„</li></ul><h4 id="_8-å°ç»“" tabindex="-1"><a class="header-anchor" href="#_8-å°ç»“"><span>8ï¼‰å°ç»“</span></a></h4><p>å½“æ‰§è¡Œ invokevirtual æŒ‡ä»¤æ—¶ï¼Œ</p><ol><li>å…ˆé€šè¿‡æ ˆå¸§ä¸­çš„å¯¹è±¡å¼•ç”¨æ‰¾åˆ°å¯¹è±¡</li><li>åˆ†æå¯¹è±¡å¤´ï¼Œæ‰¾åˆ°å¯¹è±¡çš„å®é™… Class</li><li>Class ç»“æ„ä¸­æœ‰ vtableï¼Œå®ƒåœ¨ç±»åŠ è½½çš„é“¾æ¥é˜¶æ®µå°±å·²ç»æ ¹æ®æ–¹æ³•çš„é‡å†™è§„åˆ™ç”Ÿæˆå¥½äº†</li><li>æŸ¥è¡¨å¾—åˆ°æ–¹æ³•çš„å…·ä½“åœ°å€</li><li>æ‰§è¡Œæ–¹æ³•çš„å­—èŠ‚ç </li></ol><h3 id="_2-10-å¼‚å¸¸å¤„ç†" tabindex="-1"><a class="header-anchor" href="#_2-10-å¼‚å¸¸å¤„ç†"><span>2.10 å¼‚å¸¸å¤„ç†</span></a></h3><h4 id="_1-try-catch" tabindex="-1"><a class="header-anchor" href="#_1-try-catch"><span>ï¼ˆ1ï¼‰try-catch</span></a></h4><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Main</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">        int</span><span style="color:#D8DEE9;"> i</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">        try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9FF;">            i </span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;"> 10</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span><span style="color:#81A1C1;"> catch</span><span style="color:#ECEFF4;"> (</span><span style="color:#8FBCBB;">Exception</span><span style="color:#D8DEE9;"> e</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9FF;">            i </span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;"> 20</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯¹åº”çš„å­—èŠ‚ç æ–‡ä»¶ï¼ˆä¸ºäº†æŠ“ä½é‡ç‚¹ï¼Œä¸‹é¢çš„å­—èŠ‚ç çœç•¥äº†ä¸é‡è¦çš„éƒ¨åˆ†ï¼‰ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;">  Code</span><span style="color:#81A1C1;">:</span></span>
<span class="line"><span style="color:#D8DEE9FF;">      stack</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">1</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> locals</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">3</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> args_size</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">1</span></span>
<span class="line"><span style="color:#B48EAD;">         0</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> iconst_0</span></span>
<span class="line"><span style="color:#B48EAD;">         1</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> istore_1</span></span>
<span class="line"><span style="color:#B48EAD;">         2</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> bipush        </span><span style="color:#B48EAD;">10</span></span>
<span class="line"><span style="color:#B48EAD;">         4</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> istore_1</span></span>
<span class="line"><span style="color:#B48EAD;">         5</span><span style="color:#81A1C1;">:</span><span style="color:#81A1C1;"> goto</span><span style="color:#B48EAD;">          12</span></span>
<span class="line"><span style="color:#B48EAD;">         8</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> astore_2</span></span>
<span class="line"><span style="color:#B48EAD;">         9</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> bipush        </span><span style="color:#B48EAD;">20</span></span>
<span class="line"><span style="color:#B48EAD;">        11</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> istore_1</span></span>
<span class="line"><span style="color:#B48EAD;">        12</span><span style="color:#81A1C1;">:</span><span style="color:#81A1C1;"> return</span></span>
<span class="line"><span style="color:#8FBCBB;">      Exception</span><span style="color:#D8DEE9;"> table</span><span style="color:#81A1C1;">:</span></span>
<span class="line"><span style="color:#D8DEE9FF;">         from    to  target type</span></span>
<span class="line"><span style="color:#B48EAD;">             2</span><span style="color:#B48EAD;">     5</span><span style="color:#B48EAD;">     8</span><span style="color:#8FBCBB;">   Class</span><span style="color:#D8DEE9FF;"> java</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">lang</span><span style="color:#81A1C1;">/</span><span style="color:#8FBCBB;">Exception</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>å¯ä»¥çœ‹åˆ°å¤šå‡ºæ¥ä¸€ä¸ª <strong>Exception table</strong> çš„ç»“æ„ï¼Œ[from, to) æ˜¯<strong>å‰é—­åå¼€</strong>ï¼ˆä¹Ÿå°±æ˜¯æ£€æµ‹2~4è¡Œï¼‰çš„æ£€æµ‹èŒƒå›´ï¼Œä¸€æ—¦è¿™ä¸ªèŒƒå›´å†…çš„å­—èŠ‚ç æ‰§è¡Œå‡ºç°å¼‚å¸¸ï¼Œåˆ™é€šè¿‡ type åŒ¹é…å¼‚å¸¸ç±»å‹ï¼Œå¦‚æœä¸€è‡´ï¼Œè¿›å…¥ target æ‰€æŒ‡ç¤ºè¡Œå·</li><li>8è¡Œçš„å­—èŠ‚ç æŒ‡ä»¤ astore_2 æ˜¯å°†å¼‚å¸¸å¯¹è±¡å¼•ç”¨å­˜å…¥å±€éƒ¨å˜é‡è¡¨çš„2å·ä½ç½®ï¼ˆä¸ºeï¼‰</li></ul><h4 id="_2-å¤šä¸ª-single-catch-å—çš„æƒ…å†µ" tabindex="-1"><a class="header-anchor" href="#_2-å¤šä¸ª-single-catch-å—çš„æƒ…å†µ"><span>ï¼ˆ2ï¼‰å¤šä¸ª single-catch å—çš„æƒ…å†µ</span></a></h4><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Demo3_11_2</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">        int</span><span style="color:#D8DEE9;"> i</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">        try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9FF;">            i </span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;"> 10</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span><span style="color:#81A1C1;"> catch</span><span style="color:#ECEFF4;"> (</span><span style="color:#8FBCBB;">ArithmeticException</span><span style="color:#D8DEE9;"> e</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9FF;">            i </span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;"> 30</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span><span style="color:#81A1C1;"> catch</span><span style="color:#ECEFF4;"> (</span><span style="color:#8FBCBB;">NullPointerException</span><span style="color:#D8DEE9;"> e</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9FF;">            i </span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;"> 40</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span><span style="color:#81A1C1;"> catch</span><span style="color:#ECEFF4;"> (</span><span style="color:#8FBCBB;">Exception</span><span style="color:#D8DEE9;"> e</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9FF;">            i </span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;"> 50</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯¹åº”çš„å­—èŠ‚ç æ–‡ä»¶ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">java</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">lang</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">String</span><span style="color:#ECEFF4;">[])</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    descriptor</span><span style="color:#81A1C1;">:</span><span style="color:#ECEFF4;"> ([</span><span style="color:#D8DEE9FF;">Ljava</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">lang</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">String</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#8FBCBB;">V</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    flags</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> ACC_PUBLIC</span><span style="color:#ECEFF4;">,</span><span style="color:#8FBCBB;"> ACC_STATIC</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    Code</span><span style="color:#81A1C1;">:</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        stack</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">1</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> locals</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">3</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> args_size</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">1</span></span>
<span class="line"><span style="color:#B48EAD;">            0</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> iconst_0</span></span>
<span class="line"><span style="color:#B48EAD;">            1</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> istore_1</span></span>
<span class="line"><span style="color:#B48EAD;">            2</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> bipush            </span><span style="color:#B48EAD;">10</span></span>
<span class="line"><span style="color:#B48EAD;">            4</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> istore_1</span></span>
<span class="line"><span style="color:#B48EAD;">            5</span><span style="color:#81A1C1;">:</span><span style="color:#81A1C1;"> goto</span><span style="color:#B48EAD;">              26</span></span>
<span class="line"><span style="color:#B48EAD;">            8</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> astore_2</span></span>
<span class="line"><span style="color:#B48EAD;">            9</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> bipush            </span><span style="color:#B48EAD;">30</span></span>
<span class="line"><span style="color:#B48EAD;">            11</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> istore_1</span></span>
<span class="line"><span style="color:#B48EAD;">            12</span><span style="color:#81A1C1;">:</span><span style="color:#81A1C1;"> goto</span><span style="color:#B48EAD;">             26</span></span>
<span class="line"><span style="color:#B48EAD;">            15</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> astore_2</span></span>
<span class="line"><span style="color:#B48EAD;">            16</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> bipush           </span><span style="color:#B48EAD;">40</span></span>
<span class="line"><span style="color:#B48EAD;">            18</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> istore_1</span></span>
<span class="line"><span style="color:#B48EAD;">            19</span><span style="color:#81A1C1;">:</span><span style="color:#81A1C1;"> goto</span><span style="color:#B48EAD;">             26</span></span>
<span class="line"><span style="color:#B48EAD;">            22</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> astore_2</span></span>
<span class="line"><span style="color:#B48EAD;">            23</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> bipush           </span><span style="color:#B48EAD;">50</span></span>
<span class="line"><span style="color:#B48EAD;">            25</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> istore_1</span></span>
<span class="line"><span style="color:#B48EAD;">            26</span><span style="color:#81A1C1;">:</span><span style="color:#81A1C1;"> return</span></span>
<span class="line"><span style="color:#8FBCBB;">    Exception</span><span style="color:#D8DEE9;"> table</span><span style="color:#81A1C1;">:</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    from to target type</span></span>
<span class="line"><span style="color:#B48EAD;">       2</span><span style="color:#B48EAD;">  5</span><span style="color:#B48EAD;">   8</span><span style="color:#8FBCBB;">     Class</span><span style="color:#D8DEE9FF;"> java</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">lang</span><span style="color:#81A1C1;">/</span><span style="color:#8FBCBB;">ArithmeticException</span></span>
<span class="line"><span style="color:#B48EAD;">       2</span><span style="color:#B48EAD;">  5</span><span style="color:#B48EAD;">   15</span><span style="color:#8FBCBB;">     Class</span><span style="color:#D8DEE9FF;"> java</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">lang</span><span style="color:#81A1C1;">/</span><span style="color:#8FBCBB;">NullPointerException</span></span>
<span class="line"><span style="color:#B48EAD;">       2</span><span style="color:#B48EAD;">  5</span><span style="color:#B48EAD;">   22</span><span style="color:#8FBCBB;">     Class</span><span style="color:#D8DEE9FF;"> java</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">lang</span><span style="color:#81A1C1;">/</span><span style="color:#8FBCBB;">Exception</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    LineNumberTable</span><span style="color:#81A1C1;">:</span><span style="color:#ECEFF4;"> ...</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    LocalVariableTable</span><span style="color:#81A1C1;">:</span></span>
<span class="line"><span style="color:#8FBCBB;">    Start</span><span style="color:#8FBCBB;"> Length</span><span style="color:#8FBCBB;"> Slot</span><span style="color:#8FBCBB;"> Name</span><span style="color:#8FBCBB;"> Signature</span></span>
<span class="line"><span style="color:#B48EAD;">        9</span><span style="color:#B48EAD;">     3</span><span style="color:#B48EAD;">     2</span><span style="color:#D8DEE9FF;">   e     Ljava</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">lang</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">ArithmeticException</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#B48EAD;">       16</span><span style="color:#B48EAD;">     3</span><span style="color:#B48EAD;">     2</span><span style="color:#D8DEE9FF;">   e     Ljava</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">lang</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">NullPointerException</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#B48EAD;">       23</span><span style="color:#B48EAD;">     3</span><span style="color:#B48EAD;">     2</span><span style="color:#D8DEE9FF;">   e     Ljava</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">lang</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">Exception</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#B48EAD;">        0</span><span style="color:#B48EAD;">    27</span><span style="color:#B48EAD;">     0</span><span style="color:#D8DEE9FF;">  args   </span><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">Ljava</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">lang</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">String</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#B48EAD;">        2</span><span style="color:#B48EAD;">    25</span><span style="color:#B48EAD;">     1</span><span style="color:#D8DEE9FF;">   i     </span><span style="color:#8FBCBB;">I</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    StackMapTable</span><span style="color:#81A1C1;">:</span><span style="color:#ECEFF4;"> ...</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    MethodParameters</span><span style="color:#81A1C1;">:</span><span style="color:#ECEFF4;"> ...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>å› ä¸ºå¼‚å¸¸å‡ºç°æ—¶ï¼Œ<strong>åªèƒ½è¿›å…¥</strong> Exception table ä¸­<strong>ä¸€ä¸ªåˆ†æ”¯</strong>ï¼Œæ‰€ä»¥å±€éƒ¨å˜é‡è¡¨ slot 2 ä½ç½®<strong>è¢«å…±ç”¨</strong></li></ul><h4 id="_3-multi-catch-çš„æƒ…å†µ" tabindex="-1"><a class="header-anchor" href="#_3-multi-catch-çš„æƒ…å†µ"><span>ï¼ˆ3ï¼‰multi-catch çš„æƒ…å†µ</span></a></h4><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Demo3_11_3</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">        try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">                Method</span><span style="color:#D8DEE9;"> test</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Demo3_11_3</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">class</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getMethod</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">test</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">                test</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">invoke</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">null</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">            }</span><span style="color:#81A1C1;"> catch</span><span style="color:#ECEFF4;"> (</span><span style="color:#8FBCBB;">NoSuchMethodException</span><span style="color:#ECEFF4;"> |</span><span style="color:#8FBCBB;"> IllegalAccessException</span><span style="color:#ECEFF4;"> |</span></span>
<span class="line"><span style="color:#8FBCBB;">            InvocationTargetException</span><span style="color:#D8DEE9;"> e</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">                e</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">printStackTrace</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">                }</span></span>
<span class="line"><span style="color:#ECEFF4;">            }</span></span>
<span class="line"><span style="color:#81A1C1;">        public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> test</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">            System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ok</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">java</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">lang</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">String</span><span style="color:#ECEFF4;">[])</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">descriptor</span><span style="color:#81A1C1;">:</span><span style="color:#ECEFF4;"> ([</span><span style="color:#D8DEE9FF;">Ljava</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">lang</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">String</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;">)</span><span style="color:#8FBCBB;">V</span></span>
<span class="line"><span style="color:#D8DEE9FF;">flags</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> ACC_PUBLIC</span><span style="color:#ECEFF4;">,</span><span style="color:#8FBCBB;"> ACC_STATIC</span></span>
<span class="line"><span style="color:#D8DEE9FF;">Code</span><span style="color:#81A1C1;">:</span></span>
<span class="line"><span style="color:#D8DEE9FF;">stack</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">3</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> locals</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">2</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> args_size</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">1</span></span>
<span class="line"><span style="color:#B48EAD;">0</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> ldc #</span><span style="color:#B48EAD;">2</span></span>
<span class="line"><span style="color:#B48EAD;">2</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> ldc #</span><span style="color:#B48EAD;">3</span></span>
<span class="line"><span style="color:#B48EAD;">4</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> iconst_0</span></span>
<span class="line"><span style="color:#B48EAD;">5</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> anewarray #</span><span style="color:#B48EAD;">4</span></span>
<span class="line"><span style="color:#B48EAD;">8</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> invokevirtual #</span><span style="color:#B48EAD;">5</span></span>
<span class="line"><span style="color:#B48EAD;">11</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> astore_1</span></span>
<span class="line"><span style="color:#B48EAD;">12</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> aload_1</span></span>
<span class="line"><span style="color:#B48EAD;">13</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> aconst_null</span></span>
<span class="line"><span style="color:#B48EAD;">14</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> iconst_0</span></span>
<span class="line"><span style="color:#B48EAD;">15</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> anewarray #</span><span style="color:#B48EAD;">6</span></span>
<span class="line"><span style="color:#B48EAD;">18</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> invokevirtual #</span><span style="color:#B48EAD;">7</span></span>
<span class="line"><span style="color:#B48EAD;">21</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> pop</span></span>
<span class="line"><span style="color:#B48EAD;">22</span><span style="color:#81A1C1;">:</span><span style="color:#81A1C1;"> goto</span><span style="color:#B48EAD;"> 30</span></span>
<span class="line"><span style="color:#B48EAD;">25</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> astore_1</span></span>
<span class="line"><span style="color:#B48EAD;">26</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> aload_1</span></span>
<span class="line"><span style="color:#B48EAD;">27</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> invokevirtual #</span><span style="color:#B48EAD;">11</span><span style="color:#616E88;"> // e.printStackTrace:()V</span></span>
<span class="line"><span style="color:#B48EAD;">30</span><span style="color:#81A1C1;">:</span><span style="color:#81A1C1;"> return</span></span>
<span class="line"><span style="color:#8FBCBB;">Exception</span><span style="color:#D8DEE9;"> table</span><span style="color:#81A1C1;">:</span></span>
<span class="line"><span style="color:#D8DEE9FF;">from to target type</span></span>
<span class="line"><span style="color:#B48EAD;">0</span><span style="color:#B48EAD;"> 22</span><span style="color:#B48EAD;"> 25</span><span style="color:#8FBCBB;"> Class</span><span style="color:#D8DEE9FF;"> java</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">lang</span><span style="color:#81A1C1;">/</span><span style="color:#8FBCBB;">NoSuchMethodException</span></span>
<span class="line"><span style="color:#B48EAD;">0</span><span style="color:#B48EAD;"> 22</span><span style="color:#B48EAD;"> 25</span><span style="color:#8FBCBB;"> Class</span><span style="color:#D8DEE9FF;"> java</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">lang</span><span style="color:#81A1C1;">/</span><span style="color:#8FBCBB;">IllegalAccessException</span></span>
<span class="line"><span style="color:#B48EAD;">0</span><span style="color:#B48EAD;"> 22</span><span style="color:#B48EAD;"> 25</span><span style="color:#8FBCBB;"> Class</span><span style="color:#D8DEE9FF;"> java</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">lang</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">reflect</span><span style="color:#81A1C1;">/</span><span style="color:#8FBCBB;">InvocationTargetException</span></span>
<span class="line"><span style="color:#D8DEE9FF;">LineNumberTable</span><span style="color:#81A1C1;">:</span><span style="color:#ECEFF4;"> ...</span></span>
<span class="line"><span style="color:#D8DEE9FF;">LocalVariableTable</span><span style="color:#81A1C1;">:</span></span>
<span class="line"><span style="color:#8FBCBB;">Start</span><span style="color:#8FBCBB;"> Length</span><span style="color:#8FBCBB;"> Slot</span><span style="color:#8FBCBB;"> Name</span><span style="color:#8FBCBB;"> Signature</span></span>
<span class="line"><span style="color:#B48EAD;">12</span><span style="color:#B48EAD;"> 10</span><span style="color:#B48EAD;"> 1</span><span style="color:#D8DEE9FF;"> test Ljava</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">lang</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">reflect</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">Method</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#B48EAD;">26</span><span style="color:#B48EAD;"> 4</span><span style="color:#B48EAD;"> 1</span><span style="color:#D8DEE9FF;"> e Ljava</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">lang</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">ReflectiveOperationException</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#B48EAD;">0</span><span style="color:#B48EAD;"> 31</span><span style="color:#B48EAD;"> 0</span><span style="color:#D8DEE9FF;"> args </span><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">Ljava</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">lang</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">String</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">StackMapTable</span><span style="color:#81A1C1;">:</span><span style="color:#ECEFF4;"> ...</span></span>
<span class="line"><span style="color:#D8DEE9FF;">MethodParameters</span><span style="color:#81A1C1;">:</span><span style="color:#ECEFF4;"> ...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4-finally" tabindex="-1"><a class="header-anchor" href="#_4-finally"><span>ï¼ˆ4ï¼‰finally</span></a></h4><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Main</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">        int</span><span style="color:#D8DEE9;"> i</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">        try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9FF;">            i </span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;"> 10</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span><span style="color:#81A1C1;"> catch</span><span style="color:#ECEFF4;"> (</span><span style="color:#8FBCBB;">Exception</span><span style="color:#D8DEE9;"> e</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9FF;">            i </span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;"> 20</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span><span style="color:#81A1C1;"> finally</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9FF;">            i </span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;"> 30</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯¹åº”çš„å­—èŠ‚ç æ–‡ä»¶ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;">   Code</span><span style="color:#81A1C1;">:</span></span>
<span class="line"><span style="color:#D8DEE9FF;">      stack</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">1</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> locals</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">4</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> args_size</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">1</span></span>
<span class="line"><span style="color:#D8DEE9FF;">          </span></span>
<span class="line"><span style="color:#B48EAD;">         0</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> iconst_0</span></span>
<span class="line"><span style="color:#B48EAD;">         1</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> istore_1</span></span>
<span class="line"><span style="color:#616E88;">          //tryå—</span></span>
<span class="line"><span style="color:#B48EAD;">         2</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> bipush        </span><span style="color:#B48EAD;">10</span></span>
<span class="line"><span style="color:#B48EAD;">         4</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> istore_1</span></span>
<span class="line"><span style="color:#B48EAD;">         5</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> bipush        </span><span style="color:#B48EAD;">30</span></span>
<span class="line"><span style="color:#616E88;">         //tryå—æ‰§è¡Œå®Œåï¼Œä¼šæ‰§è¡Œfinally </span></span>
<span class="line"><span style="color:#B48EAD;">         7</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> istore_1</span></span>
<span class="line"><span style="color:#B48EAD;">         8</span><span style="color:#81A1C1;">:</span><span style="color:#81A1C1;"> goto</span><span style="color:#B48EAD;">          27</span></span>
<span class="line"><span style="color:#616E88;">         //catchå—</span></span>
<span class="line"><span style="color:#B48EAD;">        11</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> astore_2</span></span>
<span class="line"><span style="color:#B48EAD;">        12</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> bipush        </span><span style="color:#B48EAD;">20</span></span>
<span class="line"><span style="color:#B48EAD;">        14</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> istore_1</span></span>
<span class="line"><span style="color:#616E88;">         //catchå—æ‰§è¡Œå®Œï¼Œä¼šæ‰§è¡Œfinally</span></span>
<span class="line"><span style="color:#B48EAD;">        15</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> bipush        </span><span style="color:#B48EAD;">30</span></span>
<span class="line"><span style="color:#B48EAD;">        17</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> istore_1</span></span>
<span class="line"><span style="color:#B48EAD;">        18</span><span style="color:#81A1C1;">:</span><span style="color:#81A1C1;"> goto</span><span style="color:#B48EAD;">          27</span></span>
<span class="line"><span style="color:#616E88;">        //å‡ºç°å¼‚å¸¸ï¼Œä½†æœªè¢«Exceptionæ•è·ï¼Œä¼šæŠ›å‡ºå…¶ä»–å¼‚å¸¸ï¼Œè¿™æ—¶ä¹Ÿéœ€è¦æ‰§è¡Œfinallyå—ä¸­çš„ä»£ç    </span></span>
<span class="line"><span style="color:#B48EAD;">        21</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> astore_3</span></span>
<span class="line"><span style="color:#B48EAD;">        22</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> bipush        </span><span style="color:#B48EAD;">30</span></span>
<span class="line"><span style="color:#B48EAD;">        24</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> istore_1</span></span>
<span class="line"><span style="color:#B48EAD;">        25</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> aload_3</span></span>
<span class="line"><span style="color:#B48EAD;">        26</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> athrow </span><span style="color:#616E88;">//æŠ›å‡ºå¼‚å¸¸</span></span>
<span class="line"><span style="color:#B48EAD;">        27</span><span style="color:#81A1C1;">:</span><span style="color:#81A1C1;"> return</span></span>
<span class="line"><span style="color:#8FBCBB;">      Exception</span><span style="color:#D8DEE9;"> table</span><span style="color:#81A1C1;">:</span></span>
<span class="line"><span style="color:#D8DEE9FF;">         from    to  target type</span></span>
<span class="line"><span style="color:#B48EAD;">             2</span><span style="color:#B48EAD;">     5</span><span style="color:#B48EAD;">    11</span><span style="color:#8FBCBB;">   Class</span><span style="color:#D8DEE9FF;"> java</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">lang</span><span style="color:#81A1C1;">/</span><span style="color:#8FBCBB;">Exception</span></span>
<span class="line"><span style="color:#B48EAD;">             2</span><span style="color:#B48EAD;">     5</span><span style="color:#B48EAD;">    21</span><span style="color:#D8DEE9FF;">   any </span><span style="color:#616E88;">//å‰©ä½™çš„å¼‚å¸¸ç±»å‹ï¼Œæ¯”å¦‚ Error</span></span>
<span class="line"><span style="color:#B48EAD;">            11</span><span style="color:#B48EAD;">    15</span><span style="color:#B48EAD;">    21</span><span style="color:#D8DEE9FF;">   any </span><span style="color:#616E88;">//å‰©ä½™çš„å¼‚å¸¸ç±»å‹ï¼Œæ¯”å¦‚ Erro</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯ä»¥çœ‹åˆ° finally ä¸­çš„ä»£ç è¢«å¤åˆ¶äº† 3 ä»½ï¼Œåˆ†åˆ«æ”¾å…¥ try æµç¨‹ï¼Œcatch æµç¨‹ä»¥åŠ catch å‰©ä½™çš„å¼‚å¸¸ç±»å‹æµç¨‹</p><blockquote><p>æ³¨æ„ï¼š</p><p>è™½ç„¶ä»å­—èŠ‚ç æŒ‡ä»¤çœ‹æ¥ï¼Œæ¯ä¸ªå—ä¸­éƒ½æœ‰finallyå—ï¼Œä½†æ˜¯finallyå—ä¸­çš„ä»£ç <strong>åªä¼šè¢«æ‰§è¡Œä¸€æ¬¡</strong></p></blockquote><h4 id="_5-finallyä¸­çš„return" tabindex="-1"><a class="header-anchor" href="#_5-finallyä¸­çš„return"><span>ï¼ˆ5ï¼‰finallyä¸­çš„return</span></a></h4><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Main</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">        int</span><span style="color:#D8DEE9;"> result</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> test</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">result</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;">//20</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> int</span><span style="color:#88C0D0;"> test</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">        try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">            return</span><span style="color:#B48EAD;"> 10</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span><span style="color:#81A1C1;"> finally</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">            return</span><span style="color:#B48EAD;"> 20</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯¹åº”çš„å­—èŠ‚ç æ–‡ä»¶ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;">Code</span><span style="color:#81A1C1;">:</span></span>
<span class="line"><span style="color:#D8DEE9FF;">     stack</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">1</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> locals</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">3</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> args_size</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">0</span></span>
<span class="line"><span style="color:#B48EAD;">        0</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> bipush        </span><span style="color:#B48EAD;">10</span></span>
<span class="line"><span style="color:#B48EAD;">        2</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> istore_0</span></span>
<span class="line"><span style="color:#B48EAD;">        3</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> iload_0</span></span>
<span class="line"><span style="color:#B48EAD;">        4</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> istore_1  </span><span style="color:#616E88;">// æš‚å­˜è¿”å›å€¼</span></span>
<span class="line"><span style="color:#B48EAD;">        5</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> bipush        </span><span style="color:#B48EAD;">20</span></span>
<span class="line"><span style="color:#B48EAD;">        7</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> istore_0</span></span>
<span class="line"><span style="color:#B48EAD;">        8</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> iload_0</span></span>
<span class="line"><span style="color:#B48EAD;">        9</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> ireturn        </span><span style="color:#616E88;">// ireturn ä¼šè¿”å›æ“ä½œæ•°æ ˆé¡¶çš„æ•´å‹å€¼ 20</span></span>
<span class="line"><span style="color:#616E88;">       // å¦‚æœå‡ºç°å¼‚å¸¸ï¼Œè¿˜æ˜¯ä¼šæ‰§è¡Œfinally å—ä¸­çš„å†…å®¹ï¼Œæ²¡æœ‰æŠ›å‡ºå¼‚å¸¸</span></span>
<span class="line"><span style="color:#B48EAD;">       10</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> astore_2</span></span>
<span class="line"><span style="color:#B48EAD;">       11</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> bipush        </span><span style="color:#B48EAD;">20</span></span>
<span class="line"><span style="color:#B48EAD;">       13</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> istore_0</span></span>
<span class="line"><span style="color:#B48EAD;">       14</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> iload_0</span></span>
<span class="line"><span style="color:#B48EAD;">       15</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> ireturn        </span><span style="color:#616E88;">// è¿™é‡Œæ²¡æœ‰ athrow äº†ï¼Œä¹Ÿå°±æ˜¯å¦‚æœåœ¨ finally å—ä¸­å¦‚æœæœ‰è¿”å›æ“ä½œçš„è¯ï¼Œä¸” try å—ä¸­å‡ºç°å¼‚å¸¸ï¼Œä¼šåæ‰å¼‚å¸¸ï¼</span></span>
<span class="line"><span style="color:#8FBCBB;">     Exception</span><span style="color:#D8DEE9;"> table</span><span style="color:#81A1C1;">:</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        from    to  target type</span></span>
<span class="line"><span style="color:#B48EAD;">            0</span><span style="color:#B48EAD;">     5</span><span style="color:#B48EAD;">    10</span><span style="color:#D8DEE9FF;">   any</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>ç”±äº finally ä¸­çš„ ireturn è¢«æ’å…¥äº†æ‰€æœ‰å¯èƒ½çš„æµç¨‹ï¼Œå› æ­¤è¿”å›ç»“æœè‚¯å®šä»¥ finally çš„ä¸ºå‡†</li><li>è·Ÿå‰ä¸€ä¸ªä¸­çš„ finally ç›¸æ¯”ï¼Œå‘ç°æ²¡æœ‰ athrow äº†ï¼Œè¿™å‘Šè¯‰æˆ‘ä»¬ï¼šå¦‚æœåœ¨ finally ä¸­å‡ºç°äº† returnï¼Œä¼šåæ‰å¼‚å¸¸</li><li>æ‰€ä»¥ä¸è¦åœ¨finallyä¸­è¿›è¡Œè¿”å›æ“ä½œ</li></ul><p>è¿è¡Œä¸‹é¢çš„ä»£ç ï¼Œä¸ä¼šæŠ›å‡ºå¼‚å¸¸ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Main</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">        int</span><span style="color:#D8DEE9;"> result</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> test</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">result</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> int</span><span style="color:#88C0D0;"> test</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">        try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">            int</span><span style="color:#D8DEE9;"> i</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 1</span><span style="color:#81A1C1;"> /</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">            return</span><span style="color:#B48EAD;"> 10</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span><span style="color:#81A1C1;"> finally</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">            return</span><span style="color:#B48EAD;"> 20</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_6-finallyä¸å¸¦return" tabindex="-1"><a class="header-anchor" href="#_6-finallyä¸å¸¦return"><span>ï¼ˆ6ï¼‰finallyä¸å¸¦return</span></a></h4><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Main</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">        int</span><span style="color:#D8DEE9;"> i</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Main</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">test</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">i</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;">//è¾“å‡ºä¸º10</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> int</span><span style="color:#88C0D0;"> test</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">        int</span><span style="color:#D8DEE9;"> i</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 10</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">        try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">            return</span><span style="color:#D8DEE9FF;"> i</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span><span style="color:#81A1C1;"> finally</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9FF;">            i </span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;"> 20</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯¹åº”çš„å­—èŠ‚ç æ–‡ä»¶ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;">Code</span><span style="color:#81A1C1;">:</span></span>
<span class="line"><span style="color:#D8DEE9FF;">      stack</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">1</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> locals</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">3</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> args_size</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">0</span></span>
<span class="line"><span style="color:#B48EAD;">        0</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> bipush        </span><span style="color:#B48EAD;">10</span></span>
<span class="line"><span style="color:#B48EAD;">        2</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> istore_0     </span><span style="color:#616E88;">//èµ‹å€¼ç»™i 10</span></span>
<span class="line"><span style="color:#B48EAD;">        3</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> iload_0      </span><span style="color:#616E88;">//åŠ è½½åˆ°æ“ä½œæ•°æ ˆé¡¶</span></span>
<span class="line"><span style="color:#B48EAD;">        4</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> istore_1     </span><span style="color:#616E88;">//åŠ è½½åˆ°å±€éƒ¨å˜é‡è¡¨çš„1å·ä½ç½®</span></span>
<span class="line"><span style="color:#B48EAD;">        5</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> bipush        </span><span style="color:#B48EAD;">20</span></span>
<span class="line"><span style="color:#B48EAD;">        7</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> istore_0     </span><span style="color:#616E88;">//èµ‹å€¼ç»™i 20</span></span>
<span class="line"><span style="color:#B48EAD;">        8</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> iload_1      </span><span style="color:#616E88;">//åŠ è½½å±€éƒ¨å˜é‡è¡¨1å·ä½ç½®çš„æ•°10åˆ°æ“ä½œæ•°æ ˆ</span></span>
<span class="line"><span style="color:#B48EAD;">        9</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> ireturn      </span><span style="color:#616E88;">//è¿”å›æ“ä½œæ•°æ ˆé¡¶å…ƒç´  10</span></span>
<span class="line"><span style="color:#B48EAD;">       10</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> astore_2</span></span>
<span class="line"><span style="color:#B48EAD;">       11</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> bipush        </span><span style="color:#B48EAD;">20</span></span>
<span class="line"><span style="color:#B48EAD;">       13</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> istore_0</span></span>
<span class="line"><span style="color:#B48EAD;">       14</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> aload_2      </span><span style="color:#616E88;">//åŠ è½½å¼‚å¸¸</span></span>
<span class="line"><span style="color:#B48EAD;">       15</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> athrow       </span><span style="color:#616E88;">//æŠ›å‡ºå¼‚å¸¸</span></span>
<span class="line"><span style="color:#8FBCBB;">      Exception</span><span style="color:#D8DEE9;"> table</span><span style="color:#81A1C1;">:</span></span>
<span class="line"><span style="color:#D8DEE9FF;">         from    to  target type</span></span>
<span class="line"><span style="color:#B48EAD;">             3</span><span style="color:#B48EAD;">     5</span><span style="color:#B48EAD;">    10</span><span style="color:#D8DEE9FF;">   any</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-11-synchronized" tabindex="-1"><a class="header-anchor" href="#_2-11-synchronized"><span>2.11 synchronized</span></a></h3><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Code_19_SyncTest</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">        Object</span><span style="color:#D8DEE9;"> lock</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Object</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">        synchronized</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9FF;">lock</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">            System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ok</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#D8DEE9FF;">Code</span><span style="color:#81A1C1;">:</span></span>
<span class="line"><span style="color:#D8DEE9FF;">      stack</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">2</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> locals</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">4</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> args_size</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">1</span></span>
<span class="line"><span style="color:#B48EAD;">         0</span><span style="color:#81A1C1;">:</span><span style="color:#81A1C1;"> new</span><span style="color:#D8DEE9FF;">           #2                  </span><span style="color:#616E88;">// class java/lang/Object</span></span>
<span class="line"><span style="color:#D8DEE9FF;">         3</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> dup </span><span style="color:#616E88;">// å¤åˆ¶ä¸€ä»½æ ˆé¡¶ï¼Œç„¶åå‹å…¥æ ˆä¸­ã€‚ç”¨äºå‡½æ•°æ¶ˆè€—</span></span>
<span class="line"><span style="color:#B48EAD;">         4</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> invokespecial #</span><span style="color:#B48EAD;">1</span><span style="color:#616E88;">                  // Method java/lang/Object.&quot;&lt;init&gt;&quot;:()V</span></span>
<span class="line"><span style="color:#B48EAD;">         7</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> astore_1 </span><span style="color:#616E88;">// å°†æ ˆé¡¶çš„å¯¹è±¡åœ°å€æ–¹æ³• å±€éƒ¨å˜é‡è¡¨ä¸­ 1 ä¸­</span></span>
<span class="line"><span style="color:#B48EAD;">         8</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> aload_1 </span><span style="color:#616E88;">// åŠ è½½åˆ°æ“ä½œæ•°æ ˆ</span></span>
<span class="line"><span style="color:#B48EAD;">         9</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> dup </span><span style="color:#616E88;">// å¤åˆ¶ä¸€ä»½ï¼Œæ”¾åˆ°æ“ä½œæ•°æ ˆï¼Œç”¨äºåŠ é”æ—¶æ¶ˆè€—</span></span>
<span class="line"><span style="color:#B48EAD;">        10</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> astore_2 </span><span style="color:#616E88;">// å°†æ“ä½œæ•°æ ˆé¡¶å…ƒç´ å¼¹å‡ºï¼Œæš‚å­˜åˆ°å±€éƒ¨å˜é‡è¡¨çš„ 2 å·æ§½ä½ã€‚è¿™æ—¶æ“ä½œæ•°æ ˆä¸­æœ‰ä¸€ä»½å¯¹è±¡çš„å¼•ç”¨</span></span>
<span class="line"><span style="color:#B48EAD;">        11</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> monitorenter </span><span style="color:#616E88;">// åŠ é”</span></span>
<span class="line"><span style="color:#B48EAD;">        12</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> getstatic     #</span><span style="color:#B48EAD;">3</span><span style="color:#616E88;">                  // Field java/lang/System.out:Ljava/io/PrintStream;</span></span>
<span class="line"><span style="color:#B48EAD;">        15</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> ldc           #</span><span style="color:#B48EAD;">4</span><span style="color:#616E88;">                  // String ok</span></span>
<span class="line"><span style="color:#B48EAD;">        17</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> invokevirtual #</span><span style="color:#B48EAD;">5</span><span style="color:#616E88;">                  // Method java/io/PrintStream.println:(Ljava/lang/String;)V</span></span>
<span class="line"><span style="color:#B48EAD;">        20</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> aload_2 </span><span style="color:#616E88;">// åŠ è½½å¯¹è±¡åˆ°æ ˆé¡¶</span></span>
<span class="line"><span style="color:#B48EAD;">        21</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> monitorexit </span><span style="color:#616E88;">// é‡Šæ”¾é”</span></span>
<span class="line"><span style="color:#B48EAD;">        22</span><span style="color:#81A1C1;">:</span><span style="color:#81A1C1;"> goto</span><span style="color:#B48EAD;">          30</span></span>
<span class="line"><span style="color:#616E88;">        // å¼‚å¸¸æƒ…å†µçš„è§£å†³æ–¹æ¡ˆ é‡Šæ”¾é”ï¼</span></span>
<span class="line"><span style="color:#B48EAD;">        25</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> astore_3</span></span>
<span class="line"><span style="color:#B48EAD;">        26</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> aload_2</span></span>
<span class="line"><span style="color:#B48EAD;">        27</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> monitorexit</span></span>
<span class="line"><span style="color:#B48EAD;">        28</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> aload_3</span></span>
<span class="line"><span style="color:#B48EAD;">        29</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> athrow</span></span>
<span class="line"><span style="color:#B48EAD;">        30</span><span style="color:#81A1C1;">:</span><span style="color:#81A1C1;"> return</span></span>
<span class="line"><span style="color:#616E88;">        // å¼‚å¸¸è¡¨ï¼</span></span>
<span class="line"><span style="color:#8FBCBB;">      Exception</span><span style="color:#D8DEE9;"> table</span><span style="color:#81A1C1;">:</span></span>
<span class="line"><span style="color:#D8DEE9FF;">         from    to  target type</span></span>
<span class="line"><span style="color:#B48EAD;">            12</span><span style="color:#B48EAD;">    22</span><span style="color:#B48EAD;">    25</span><span style="color:#D8DEE9FF;">   any</span></span>
<span class="line"><span style="color:#B48EAD;">            25</span><span style="color:#B48EAD;">    28</span><span style="color:#B48EAD;">    25</span><span style="color:#D8DEE9FF;">   any</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-ç¼–è¯‘å™¨å¤„ç†" tabindex="-1"><a class="header-anchor" href="#_3-ç¼–è¯‘å™¨å¤„ç†"><span>3. ç¼–è¯‘å™¨å¤„ç†</span></a></h2><p>æ‰€è°“çš„ <strong>è¯­æ³•ç³–</strong> ï¼Œå…¶å®å°±æ˜¯æŒ‡ java ç¼–è¯‘å™¨æŠŠ .java æºç ç¼–è¯‘ä¸º .class å­—èŠ‚ç çš„è¿‡ç¨‹ä¸­ï¼Œè‡ªåŠ¨ç”Ÿæˆå’Œè½¬æ¢çš„ä¸€äº›ä»£ç ï¼Œä¸»è¦æ˜¯ä¸ºäº†å‡è½»ç¨‹åºå‘˜çš„è´Ÿæ‹…ï¼Œç®—æ˜¯ java ç¼–è¯‘å™¨ç»™æˆ‘ä»¬çš„ä¸€ä¸ªé¢å¤–ç¦åˆ© <strong>æ³¨æ„</strong>ï¼Œä»¥ä¸‹ä»£ç çš„åˆ†æï¼Œå€ŸåŠ©äº† javap å·¥å…·ï¼Œidea çš„åç¼–è¯‘åŠŸèƒ½ï¼Œidea æ’ä»¶ jclasslib ç­‰å·¥å…·ã€‚å¦å¤–ï¼Œ ç¼–è¯‘å™¨è½¬æ¢çš„<strong>ç»“æœç›´æ¥å°±æ˜¯ class å­—èŠ‚ç </strong>ï¼Œåªæ˜¯ä¸ºäº†ä¾¿äºé˜…è¯»ï¼Œç»™å‡ºäº† å‡ ä¹ç­‰ä»· çš„ java æºç æ–¹å¼ï¼Œå¹¶ä¸æ˜¯ç¼–è¯‘å™¨è¿˜ä¼šè½¬æ¢å‡ºä¸­é—´çš„ java æºç ï¼Œåˆ‡è®°ã€‚</p><h3 id="_3-1-é»˜è®¤æ„é€ å™¨" tabindex="-1"><a class="header-anchor" href="#_3-1-é»˜è®¤æ„é€ å™¨"><span>3.1 é»˜è®¤æ„é€ å™¨</span></a></h3><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Candy1</span><span style="color:#ECEFF4;"> {}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ç¼–è¯‘æˆclassåçš„ä»£ç ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Candy1</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">   // è¿™ä¸ªæ— å‚æ„é€ å™¨æ˜¯javaç¼–è¯‘å™¨å¸®æˆ‘ä»¬åŠ ä¸Šçš„</span></span>
<span class="line"><span style="color:#81A1C1;">   public</span><span style="color:#88C0D0;"> Candy1</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">      // å³è°ƒç”¨çˆ¶ç±» Object çš„æ— å‚æ„é€ æ–¹æ³•ï¼Œå³è°ƒç”¨ java/lang/Object.&quot; &lt;init&gt;&quot;:()V</span></span>
<span class="line"><span style="color:#81A1C1;">      super</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">   }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-2-è‡ªåŠ¨æ‹†è£…ç®±" tabindex="-1"><a class="header-anchor" href="#_3-2-è‡ªåŠ¨æ‹†è£…ç®±"><span>3.2 è‡ªåŠ¨æ‹†è£…ç®±</span></a></h3><p>åŸºæœ¬ç±»å‹å’Œå…¶åŒ…è£…ç±»å‹çš„ç›¸äº’è½¬æ¢è¿‡ç¨‹ï¼Œç§°ä¸ºæ‹†è£…ç®± åœ¨ JDK 5 ä»¥åï¼Œå®ƒä»¬çš„è½¬æ¢å¯ä»¥åœ¨ç¼–è¯‘æœŸè‡ªåŠ¨å®Œæˆ</p><p>è¿™ä¸ªç‰¹æ€§æ˜¯ <code>JDK 5</code> å¼€å§‹åŠ å…¥çš„ï¼Œ å¦‚ä¸‹ä»£ç  ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Candy2</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">        Integer</span><span style="color:#D8DEE9;"> x</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 1</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">        int</span><span style="color:#D8DEE9;"> y</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9FF;"> x</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ®µä»£ç åœ¨ <code>JDK 5</code> ä¹‹å‰æ˜¯æ— æ³•ç¼–è¯‘é€šè¿‡çš„ï¼Œå¿…é¡»æ”¹å†™ä¸‹é¢è¿™æ · :</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Candy2</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">        //åŸºæœ¬ç±»å‹è½¬åŒ…è£…ç±»å‹â†’è£…ç®±</span></span>
<span class="line"><span style="color:#8FBCBB;">        Integer</span><span style="color:#D8DEE9;"> x</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Integer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">valueOf</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">1</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">        //åŒ…è£…ç±»å‹è½¬åŸºæœ¬ç±»å‹â†’æ‹†ç®±</span></span>
<span class="line"><span style="color:#81A1C1;">        int</span><span style="color:#D8DEE9;"> y</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> x</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">intValue</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è½¬æ¢è¿‡ç¨‹å¦‚ä¸‹</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Candy2</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">   public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">      // åŸºæœ¬ç±»å‹èµ‹å€¼ç»™åŒ…è£…ç±»å‹ï¼Œç§°ä¸ºè£…ç®±</span></span>
<span class="line"><span style="color:#8FBCBB;">      Integer</span><span style="color:#D8DEE9;"> x</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Integer</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">valueOf</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">1</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">      // åŒ…è£…ç±»å‹èµ‹å€¼ç»™åŸºæœ¬ç±»å‹ï¼Œç§°è°“æ‹†ç®±</span></span>
<span class="line"><span style="color:#81A1C1;">      int</span><span style="color:#D8DEE9;"> y</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> x</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">intValue</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">   }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-3-æ³›å‹é›†åˆå–å€¼" tabindex="-1"><a class="header-anchor" href="#_3-3-æ³›å‹é›†åˆå–å€¼"><span>3.3 æ³›å‹é›†åˆå–å€¼</span></a></h3><p>æ³›å‹ä¹Ÿæ˜¯åœ¨ <code>JDK 5</code> å¼€å§‹åŠ å…¥çš„ç‰¹æ€§ï¼Œä½† java åœ¨ç¼–è¯‘æ³›å‹ä»£ç åä¼šæ‰§è¡Œ<strong>æ³›å‹æ“¦é™¤</strong> çš„åŠ¨ä½œï¼Œå³æ³›å‹ä¿¡æ¯åœ¨ç¼–è¯‘ä¸ºå­—èŠ‚ç ä¹‹åå°±ä¸¢å¤±äº†ï¼ˆå®é™…ä¸Šæœ‰ä¸€äº›ç±»ä¿¡æ¯æ²¡è¢«æ“¦é™¤ï¼Œä¸ºäº†åå°„ä½¿ç”¨ï¼‰ï¼Œå®é™…çš„ç±»å‹éƒ½å½“åšäº† <strong>Object</strong> ç±»å‹æ¥å¤„ç†ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Candy3</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">        List</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">Integer</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9;"> list</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#8FBCBB;"> ArrayList</span><span style="color:#ECEFF4;">&lt;&gt;()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        list</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">add</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">10</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // å®é™…è°ƒç”¨çš„æ˜¯ List.add(Object e)</span></span>
<span class="line"><span style="color:#8FBCBB;">        Integer</span><span style="color:#D8DEE9;"> x</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> list</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">get</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">0</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // å®é™…è°ƒç”¨çš„æ˜¯ Object obj = List.get(int index);</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ‰€ä»¥åœ¨å–å€¼æ—¶ï¼Œç¼–è¯‘å™¨çœŸæ­£ç”Ÿæˆçš„å­—èŠ‚ç ä¸­ï¼Œè¿˜è¦é¢å¤–åšä¸€ä¸ªç±»å‹è½¬æ¢çš„æ“ä½œï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// éœ€è¦å°† Object è½¬ä¸º Integer</span></span>
<span class="line"><span style="color:#8FBCBB;">Integer</span><span style="color:#D8DEE9;"> x</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9FF;">Integer</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9;">list</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">get</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">0</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœå‰é¢çš„ x å˜é‡ç±»å‹ä¿®æ”¹ä¸º int åŸºæœ¬ç±»å‹é‚£ä¹ˆæœ€ç»ˆç”Ÿæˆçš„å­—èŠ‚ç æ˜¯ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// éœ€è¦å°† Object è½¬ä¸º Integer, å¹¶æ‰§è¡Œæ‹†ç®±æ“ä½œ</span></span>
<span class="line"><span style="color:#81A1C1;">int</span><span style="color:#D8DEE9;"> x</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> ((</span><span style="color:#D8DEE9FF;">Integer</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9;">list</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">get</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">0</span><span style="color:#ECEFF4;">)).</span><span style="color:#88C0D0;">intValue</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯¹åº”å­—èŠ‚ç ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;">Code</span><span style="color:#81A1C1;">:</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    stack</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">2</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> locals</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">3</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> args_size</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">1</span></span>
<span class="line"><span style="color:#B48EAD;">       0</span><span style="color:#81A1C1;">:</span><span style="color:#81A1C1;"> new</span><span style="color:#D8DEE9FF;">           #2                  </span><span style="color:#616E88;">// class java/util/ArrayList</span></span>
<span class="line"><span style="color:#D8DEE9FF;">       3</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> dup</span></span>
<span class="line"><span style="color:#B48EAD;">       4</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> invokespecial #</span><span style="color:#B48EAD;">3</span><span style="color:#616E88;">                  // Method java/util/ArrayList.&quot;&lt;init&gt;&quot;:()V</span></span>
<span class="line"><span style="color:#B48EAD;">       7</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> astore_1</span></span>
<span class="line"><span style="color:#B48EAD;">       8</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> aload_1</span></span>
<span class="line"><span style="color:#B48EAD;">       9</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> bipush        </span><span style="color:#B48EAD;">10</span></span>
<span class="line"><span style="color:#B48EAD;">      11</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> invokestatic  #</span><span style="color:#B48EAD;">4</span><span style="color:#616E88;">                  // Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;</span></span>
<span class="line"><span style="color:#616E88;">      //è¿™é‡Œè¿›è¡Œäº†æ³›å‹æ“¦é™¤ï¼Œå®é™…è°ƒç”¨çš„æ˜¯add(Objcet o)</span></span>
<span class="line"><span style="color:#B48EAD;">      14</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> invokeinterface #</span><span style="color:#B48EAD;">5</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;">  2</span><span style="color:#616E88;">            // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B48EAD;">      19</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> pop</span></span>
<span class="line"><span style="color:#B48EAD;">      20</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> aload_1</span></span>
<span class="line"><span style="color:#B48EAD;">      21</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> iconst_0</span></span>
<span class="line"><span style="color:#616E88;">      //è¿™é‡Œä¹Ÿè¿›è¡Œäº†æ³›å‹æ“¦é™¤ï¼Œå®é™…è°ƒç”¨çš„æ˜¯get(Object o)   </span></span>
<span class="line"><span style="color:#B48EAD;">      22</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> invokeinterface #</span><span style="color:#B48EAD;">6</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;">  2</span><span style="color:#616E88;">            // InterfaceMethod java/util/List.get:(I)Ljava/lang/Object;</span></span>
<span class="line"><span style="color:#616E88;">//è¿™é‡Œè¿›è¡Œäº†ç±»å‹è½¬æ¢ï¼Œå°†Objectè½¬æ¢æˆäº†Integer</span></span>
<span class="line"><span style="color:#B48EAD;">      27</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> checkcast     #</span><span style="color:#B48EAD;">7</span><span style="color:#616E88;">                  // class java/lang/Integer</span></span>
<span class="line"><span style="color:#B48EAD;">      30</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> astore_2</span></span>
<span class="line"><span style="color:#B48EAD;">      31</span><span style="color:#81A1C1;">:</span><span style="color:#81A1C1;"> return</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ‰€ä»¥è°ƒç”¨ get å‡½æ•°å–å€¼æ—¶ï¼Œæœ‰ä¸€ä¸ªç±»å‹è½¬æ¢çš„æ“ä½œã€‚</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#8FBCBB;">Integer</span><span style="color:#D8DEE9;"> x</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9FF;">Integer</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9;"> list</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">get</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">0</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>å¦‚æœè¦å°†è¿”å›ç»“æœèµ‹å€¼ç»™ä¸€ä¸ª int ç±»å‹çš„å˜é‡ï¼Œåˆ™è¿˜æœ‰è‡ªåŠ¨æ‹†ç®±çš„æ“ä½œ</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">int</span><span style="color:#D8DEE9;"> x</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9FF;">Integer</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9;"> list</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">get</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">0</span><span style="color:#ECEFF4;">).</span><span style="color:#88C0D0;">intValue</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_3-4åå°„è·å–æ³›å‹ä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#_3-4åå°„è·å–æ³›å‹ä¿¡æ¯"><span>3.4åå°„è·å–æ³›å‹ä¿¡æ¯</span></a></h3><p>æ“¦é™¤çš„æ˜¯å­—èŠ‚ç ä¸Šçš„æ³›å‹ä¿¡æ¯ï¼Œå¯ä»¥çœ‹åˆ° LocalVariableTypeTable ä»ç„¶ä¿ç•™äº†æ–¹æ³•å‚æ•°æ³›å‹çš„ä¿¡æ¯</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#D8DEE9;"> cn</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">itcast</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">jvm</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">t3</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">candy</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">Candy3</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    descriptor</span><span style="color:#81A1C1;">:</span><span style="color:#ECEFF4;"> ()</span><span style="color:#8FBCBB;">V</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    flags</span><span style="color:#81A1C1;">:</span><span style="color:#8FBCBB;"> ACC_PUBLIC</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    Code</span><span style="color:#81A1C1;">:</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        stack</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">1</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> locals</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">1</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> args_size</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">1</span></span>
<span class="line"><span style="color:#B48EAD;">        0</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> aload_0</span></span>
<span class="line"><span style="color:#B48EAD;">        1</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> invokespecial #</span><span style="color:#B48EAD;">1</span><span style="color:#616E88;"> // Method java/lang/Object.&quot;</span></span>
<span class="line"><span style="color:#81A1C1;"> &lt;</span><span style="color:#D8DEE9FF;">init</span><span style="color:#81A1C1;">&gt;</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">:()V</span></span>
<span class="line"><span style="color:#A3BE8C;">        4: return</span></span>
<span class="line"><span style="color:#A3BE8C;">       LineNumberTable:</span></span>
<span class="line"><span style="color:#A3BE8C;">        line 6: 0</span></span>
<span class="line"><span style="color:#A3BE8C;">        LocalVariableTable:</span></span>
<span class="line"><span style="color:#A3BE8C;">        Start Length Slot Name Signature</span></span>
<span class="line"><span style="color:#A3BE8C;">            0     5     0 this Lcn/itcast/jvm/t3/candy/Candy3;</span></span>
<span class="line"><span style="color:#A3BE8C;">  public static void main(java.lang.String[]);</span></span>
<span class="line"><span style="color:#A3BE8C;">       descriptor: ([Ljava/lang/String;)V</span></span>
<span class="line"><span style="color:#A3BE8C;">       flags: ACC_PUBLIC, ACC_STATIC</span></span>
<span class="line"><span style="color:#A3BE8C;">       Code:</span></span>
<span class="line"><span style="color:#A3BE8C;">        stack=2, locals=3, args_size=1</span></span>
<span class="line"><span style="color:#A3BE8C;">        0: new #2 // class java/util/ArrayList</span></span>
<span class="line"><span style="color:#A3BE8C;">        3: dup</span></span>
<span class="line"><span style="color:#A3BE8C;">        4: invokespecial #3 // Method java/util/ArrayList.</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#81A1C1;">        &lt;</span><span style="color:#D8DEE9FF;">init</span><span style="color:#81A1C1;">&gt;</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">:()V</span></span>
<span class="line"><span style="color:#A3BE8C;">        7: astore_1</span></span>
<span class="line"><span style="color:#A3BE8C;">        8: aload_1</span></span>
<span class="line"><span style="color:#A3BE8C;">        9: bipush 10</span></span>
<span class="line"><span style="color:#A3BE8C;">        11: invokestatic #4 // Method</span></span>
<span class="line"><span style="color:#A3BE8C;">        java/lang/Integer.valueOf:(I)Ljava/lang/Integer;</span></span>
<span class="line"><span style="color:#A3BE8C;">        14: invokeinterface #5, 2 // InterfaceMethod</span></span>
<span class="line"><span style="color:#A3BE8C;">        java/util/List.add:(Ljava/lang/Object;)Z</span></span>
<span class="line"><span style="color:#A3BE8C;">        19: pop</span></span>
<span class="line"><span style="color:#A3BE8C;">        20: aload_1</span></span>
<span class="line"><span style="color:#A3BE8C;">        21: iconst_0</span></span>
<span class="line"><span style="color:#A3BE8C;">        22: invokeinterface #6, 2 // InterfaceMethod</span></span>
<span class="line"><span style="color:#A3BE8C;">        java/util/List.get:(I)Ljava/lang/Object;</span></span>
<span class="line"><span style="color:#A3BE8C;">        27: checkcast #7 // class java/lang/Integer</span></span>
<span class="line"><span style="color:#A3BE8C;">        30: astore_2</span></span>
<span class="line"><span style="color:#A3BE8C;">        31: return</span></span>
<span class="line"><span style="color:#A3BE8C;">        LineNumberTable:</span></span>
<span class="line"><span style="color:#A3BE8C;">        line 8: 0</span></span>
<span class="line"><span style="color:#A3BE8C;">        line 9: 8</span></span>
<span class="line"><span style="color:#A3BE8C;">        line 10: 20</span></span>
<span class="line"><span style="color:#A3BE8C;">        line 11: 31</span></span>
<span class="line"><span style="color:#A3BE8C;">        LocalVariableTable:</span></span>
<span class="line"><span style="color:#A3BE8C;">        Start Length Slot Name Signature</span></span>
<span class="line"><span style="color:#A3BE8C;">            0     32   0  args [Ljava/lang/String;</span></span>
<span class="line"><span style="color:#A3BE8C;">            8     24   1  list Ljava/util/List;</span></span>
<span class="line"><span style="color:#A3BE8C;">        LocalVariableTypeTable:</span></span>
<span class="line"><span style="color:#A3BE8C;">        Start Length Slot Name Signature</span></span>
<span class="line"><span style="color:#A3BE8C;">            8     24  1   list Ljava/util/List&lt;Ljava/lang/Integer;&gt;;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½¿ç”¨åå°„å¯ä»¥å¾—åˆ°ï¼Œå‚æ•°çš„ç±»å‹ä»¥åŠæ³›å‹ç±»å‹ã€‚æ³›å‹åå°„ä»£ç å¦‚ä¸‹ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9FF;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> throws NoSuchMethodException </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#616E88;">        // 1. æ‹¿åˆ°æ–¹æ³•</span></span>
<span class="line"><span style="color:#8FBCBB;">        Method</span><span style="color:#D8DEE9;"> method</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Code_20_ReflectTest</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">class</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getMethod</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">test</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> List</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">class</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> Map</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">class</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">        // 2. å¾—åˆ°æ³›å‹å‚æ•°çš„ç±»å‹ä¿¡æ¯</span></span>
<span class="line"><span style="color:#8FBCBB;">        Type</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> types</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> method</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getGenericParameterTypes</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">        for</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">Type</span><span style="color:#D8DEE9;"> type</span><span style="color:#81A1C1;"> :</span><span style="color:#D8DEE9FF;"> types</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">            // 3. åˆ¤æ–­å‚æ•°ç±»å‹æ˜¯å¦ï¼Œå¸¦æ³›å‹çš„ç±»å‹ã€‚</span></span>
<span class="line"><span style="color:#81A1C1;">            if</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">type </span><span style="color:#81A1C1;">instanceof</span><span style="color:#D8DEE9FF;"> ParameterizedType</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">                ParameterizedType</span><span style="color:#D8DEE9;"> parameterizedType</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9FF;">ParameterizedType</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> type</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">                // 4. å¾—åˆ°åŸå§‹ç±»å‹</span></span>
<span class="line"><span style="color:#D8DEE9;">                System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">åŸå§‹ç±»å‹ - </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;"> +</span><span style="color:#D8DEE9;"> parameterizedType</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getRawType</span><span style="color:#ECEFF4;">())</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">                // 5. æ‹¿åˆ°æ³›å‹ç±»å‹</span></span>
<span class="line"><span style="color:#8FBCBB;">                Type</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> arguments</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> parameterizedType</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getActualTypeArguments</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">                for</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">int</span><span style="color:#D8DEE9;"> i</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> i </span><span style="color:#81A1C1;">&lt;</span><span style="color:#D8DEE9;"> arguments</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">length</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> i</span><span style="color:#81A1C1;">++</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">                    System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">printf</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">æ³›å‹å‚æ•°[%d] - %s</span><span style="color:#EBCB8B;">\n</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> i</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> arguments</span><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">i</span><span style="color:#ECEFF4;">])</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">                }</span></span>
<span class="line"><span style="color:#ECEFF4;">            }</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#8FBCBB;"> Set</span><span style="color:#81A1C1;">&lt;</span><span style="color:#D8DEE9FF;">Integer</span><span style="color:#81A1C1;">&gt;</span><span style="color:#88C0D0;"> test</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">List</span><span style="color:#81A1C1;">&lt;</span><span style="color:#D8DEE9FF;">String</span><span style="color:#81A1C1;">&gt;</span><span style="color:#D8DEE9FF;"> list</span><span style="color:#ECEFF4;">,</span><span style="color:#8FBCBB;"> Map</span><span style="color:#81A1C1;">&lt;</span><span style="color:#D8DEE9FF;">Integer</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> Object</span><span style="color:#81A1C1;">&gt;</span><span style="color:#D8DEE9FF;"> map</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">        return</span><span style="color:#81A1C1;"> null;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#D8DEE9FF;">åŸå§‹ç±»å‹ - </span><span style="color:#81A1C1;">interface</span><span style="color:#8FBCBB;"> java</span><span style="color:#D8DEE9FF;">.util.List</span></span>
<span class="line"><span style="color:#D8DEE9FF;">æ³›å‹å‚æ•°[0] - </span><span style="color:#81A1C1;">class</span><span style="color:#8FBCBB;"> java</span><span style="color:#D8DEE9FF;">.lang.String</span></span>
<span class="line"><span style="color:#D8DEE9FF;">åŸå§‹ç±»å‹ - </span><span style="color:#81A1C1;">interface</span><span style="color:#8FBCBB;"> java</span><span style="color:#D8DEE9FF;">.util.Map</span></span>
<span class="line"><span style="color:#D8DEE9FF;">æ³›å‹å‚æ•°[0] - </span><span style="color:#81A1C1;">class</span><span style="color:#8FBCBB;"> java</span><span style="color:#D8DEE9FF;">.lang.Integer</span></span>
<span class="line"><span style="color:#D8DEE9FF;">æ³›å‹å‚æ•°[1] - </span><span style="color:#81A1C1;">class</span><span style="color:#8FBCBB;"> java</span><span style="color:#D8DEE9FF;">.lang.Object</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-5-å¯å˜å‚æ•°" tabindex="-1"><a class="header-anchor" href="#_3-5-å¯å˜å‚æ•°"><span>3.5 å¯å˜å‚æ•°</span></a></h3><p>å¯å˜å‚æ•°ä¹Ÿæ˜¯ JDK 5 å¼€å§‹åŠ å…¥çš„æ–°ç‰¹æ€§ï¼š ä¾‹å¦‚ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Candy4</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">   public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> foo</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">...</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">      // å°† args èµ‹å€¼ç»™ arr ï¼Œå¯ä»¥çœ‹å‡º String... å®é™…å°±æ˜¯ String[]  </span></span>
<span class="line"><span style="color:#8FBCBB;">      String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> arr</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9FF;"> args</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">      System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">arr</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">length</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">   }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">   public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#88C0D0;">      foo</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">hello</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">world</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">   }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯å˜å‚æ•° <code>String... args</code> å…¶å®æ˜¯ä¸€ä¸ª <code>String[] args</code> ï¼Œä»ä»£ç ä¸­çš„èµ‹å€¼è¯­å¥ä¸­å°±å¯ä»¥çœ‹å‡ºæ¥ã€‚ åŒ æ · java ç¼–è¯‘å™¨ä¼šåœ¨ç¼–è¯‘æœŸé—´å°†ä¸Šè¿°ä»£ç å˜æ¢ä¸ºï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Candy4</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">   public</span><span style="color:#D8DEE9FF;"> Candy4 </span><span style="color:#ECEFF4;">{}</span></span>
<span class="line"><span style="color:#81A1C1;">   public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> foo</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">      String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> arr</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9FF;"> args</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">      System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">arr</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">length</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">   }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">   public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#88C0D0;">      foo</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">new</span><span style="color:#8FBCBB;"> String</span><span style="color:#ECEFF4;">[])</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">   }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„ï¼Œå¦‚æœè°ƒç”¨çš„æ˜¯ foo() ï¼Œå³æœªä¼ é€’å‚æ•°æ—¶ï¼Œç­‰ä»·ä»£ç ä¸º foo(new String[]{}) ï¼Œåˆ›å»ºäº†ä¸€ä¸ªç©ºæ•°ç»„ï¼Œè€Œä¸æ˜¯ç›´æ¥ä¼ é€’çš„ null .</p><h3 id="_3-6-foreach-å¾ªç¯" tabindex="-1"><a class="header-anchor" href="#_3-6-foreach-å¾ªç¯"><span>3.6 foreach å¾ªç¯</span></a></h3><p>ä»æ˜¯ JDK 5 å¼€å§‹å¼•å…¥çš„è¯­æ³•ç³–ï¼Œ<strong>æ•°ç»„</strong>çš„å¾ªç¯ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Candy5_1</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">        int</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> array</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> {</span><span style="color:#B48EAD;">1</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 2</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 3</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 4</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 5</span><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // æ•°ç»„èµ‹åˆå€¼çš„ç®€åŒ–å†™æ³•ä¹Ÿæ˜¯è¯­æ³•ç³–å“¦</span></span>
<span class="line"><span style="color:#81A1C1;">        for</span><span style="color:#ECEFF4;"> (</span><span style="color:#81A1C1;">int</span><span style="color:#D8DEE9;"> e</span><span style="color:#81A1C1;"> :</span><span style="color:#D8DEE9FF;"> array</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">            System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">e</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç¼–è¯‘å™¨ä¼šå¸®æˆ‘ä»¬è½¬æ¢ä¸º</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Candy5_1</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#88C0D0;"> Candy5_1</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">        int</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> array</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#81A1C1;"> int</span><span style="color:#ECEFF4;">[]{</span><span style="color:#B48EAD;">1</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 2</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 3</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 4</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 5</span><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">        for</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">int</span><span style="color:#D8DEE9;"> i</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> i </span><span style="color:#81A1C1;">&lt;</span><span style="color:#D8DEE9;"> array</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">length</span><span style="color:#81A1C1;">;</span><span style="color:#81A1C1;"> ++</span><span style="color:#D8DEE9FF;">i</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">            int</span><span style="color:#D8DEE9;"> e</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9FF;"> array</span><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">i</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">            System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">e</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœæ˜¯é›†åˆä½¿ç”¨ foreach</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Candy5_2</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">        List</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">Integer</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9;"> list</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Arrays</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">asList</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">1</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;">2</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;">3</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;">4</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;">5</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">        for</span><span style="color:#ECEFF4;"> (</span><span style="color:#8FBCBB;">Integer</span><span style="color:#D8DEE9;"> i</span><span style="color:#81A1C1;"> :</span><span style="color:#D8DEE9FF;"> list</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">            System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">i</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é›†åˆè¦ä½¿ç”¨ foreach ï¼Œéœ€è¦è¯¥é›†åˆç±»å®ç°äº† Iterable æ¥å£ï¼Œå› ä¸ºé›†åˆçš„éå†éœ€è¦ç”¨åˆ°è¿­ä»£å™¨ Iterator.</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Candy5</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#88C0D0;"> Candy5</span><span style="color:#ECEFF4;">(){}</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span></span>
<span class="line"><span style="color:#81A1C1;">   public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">      List</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">Integer</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9;"> list</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Arrays</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">asList</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">1</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 2</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 3</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 4</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 5</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">      // è·å¾—è¯¥é›†åˆçš„è¿­ä»£å™¨</span></span>
<span class="line"><span style="color:#8FBCBB;">      Iterator</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">Integer</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9;"> iterator</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> list</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">iterator</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">      while</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">iterator</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">hasNext</span><span style="color:#ECEFF4;">())</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">         Integer</span><span style="color:#D8DEE9;"> x</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> iterator</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">next</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">         System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">x</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">      }</span></span>
<span class="line"><span style="color:#ECEFF4;">   }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>æ³¨æ„</strong> ï¼šforeach å¾ªç¯å†™æ³•ï¼Œèƒ½å¤Ÿé…åˆæ•°ç»„ï¼Œä»¥åŠæ‰€æœ‰å®ç°äº† <strong>Iterable</strong> æ¥å£çš„é›†åˆç±»ä¸€èµ·ä½¿ç”¨ï¼Œå…¶ ä¸­ Iterable ç”¨æ¥è·å–é›†åˆçš„è¿­ä»£å™¨ï¼ˆ <strong>Iterator</strong> ï¼‰</p><h3 id="_3-7-switch-å­—ç¬¦ä¸²" tabindex="-1"><a class="header-anchor" href="#_3-7-switch-å­—ç¬¦ä¸²"><span>3.7 switch å­—ç¬¦ä¸²</span></a></h3><p>ä» JDK 7 å¼€å§‹ï¼Œswitch å¯ä»¥ä½œç”¨äºå­—ç¬¦ä¸²å’Œæšä¸¾ç±»ï¼Œè¿™ä¸ªåŠŸèƒ½å…¶å®ä¹Ÿæ˜¯è¯­æ³•ç³–ï¼Œä¾‹å¦‚ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Cnady6</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">   public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">      String</span><span style="color:#D8DEE9;"> str</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">hello</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">      switch</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9FF;">str</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">         case</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">hello</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;"> :</span></span>
<span class="line"><span style="color:#D8DEE9;">            System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">h</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">            break;</span></span>
<span class="line"><span style="color:#81A1C1;">         case</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">world</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;"> :</span></span>
<span class="line"><span style="color:#D8DEE9;">            System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">w</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">            break;</span></span>
<span class="line"><span style="color:#81A1C1;">         default:</span></span>
<span class="line"><span style="color:#81A1C1;">            break;</span></span>
<span class="line"><span style="color:#ECEFF4;">      }</span></span>
<span class="line"><span style="color:#ECEFF4;">   }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>æ³¨æ„</strong>ï¼š switch é…åˆ String å’Œæšä¸¾ä½¿ç”¨æ—¶ï¼Œå˜é‡ä¸èƒ½ä¸ºnullï¼ŒåŸå› åˆ†æå®Œè¯­æ³•ç³–è½¬æ¢åçš„ä»£ç åº”å½“è‡ªç„¶æ¸…æ¥š</p></blockquote><p>ä¼šè¢«ç¼–è¯‘å™¨è½¬æ¢ä¸ºï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Candy6</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">   public</span><span style="color:#88C0D0;"> Candy6</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9FF;">      </span></span>
<span class="line"><span style="color:#ECEFF4;">   }</span></span>
<span class="line"><span style="color:#81A1C1;">   public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">      String</span><span style="color:#D8DEE9;"> str</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">hello</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">      int</span><span style="color:#D8DEE9;"> x</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;">1</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">      // é€šè¿‡å­—ç¬¦ä¸²çš„ hashCode + value æ¥åˆ¤æ–­æ˜¯å¦åŒ¹é…</span></span>
<span class="line"><span style="color:#81A1C1;">      switch</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">str</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">hashCode</span><span style="color:#ECEFF4;">())</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">         // hello çš„ hashCode</span></span>
<span class="line"><span style="color:#81A1C1;">         case</span><span style="color:#B48EAD;"> 99162322</span><span style="color:#81A1C1;"> :</span></span>
<span class="line"><span style="color:#616E88;">            // å†æ¬¡æ¯”è¾ƒï¼Œå› ä¸ºå­—ç¬¦ä¸²çš„ hashCode æœ‰å¯èƒ½ç›¸ç­‰</span></span>
<span class="line"><span style="color:#81A1C1;">            if</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">str</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">equals</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">hello</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">))</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9FF;">               x </span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">            }</span></span>
<span class="line"><span style="color:#81A1C1;">            break;</span></span>
<span class="line"><span style="color:#616E88;">         // world çš„ hashCode</span></span>
<span class="line"><span style="color:#81A1C1;">         case</span><span style="color:#B48EAD;"> 11331880</span><span style="color:#81A1C1;"> :</span></span>
<span class="line"><span style="color:#81A1C1;">            if</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">str</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">equals</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">world</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">))</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9FF;">               x </span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;"> 1</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">            }</span></span>
<span class="line"><span style="color:#81A1C1;">            break;</span></span>
<span class="line"><span style="color:#81A1C1;">         default:</span></span>
<span class="line"><span style="color:#81A1C1;">            break;</span></span>
<span class="line"><span style="color:#ECEFF4;">      }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">      // ç”¨ç¬¬äºŒä¸ª switch åœ¨è¿›è¡Œè¾“å‡ºåˆ¤æ–­</span></span>
<span class="line"><span style="color:#81A1C1;">      switch</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9FF;">x</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">         case</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">:</span></span>
<span class="line"><span style="color:#D8DEE9;">            System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">h</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">            break;</span></span>
<span class="line"><span style="color:#81A1C1;">         case</span><span style="color:#B48EAD;"> 1</span><span style="color:#81A1C1;">:</span></span>
<span class="line"><span style="color:#D8DEE9;">            System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">w</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">            break;</span></span>
<span class="line"><span style="color:#81A1C1;">         default:</span></span>
<span class="line"><span style="color:#81A1C1;">            break;</span></span>
<span class="line"><span style="color:#ECEFF4;">      }</span></span>
<span class="line"><span style="color:#ECEFF4;">   }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿‡ç¨‹è¯´æ˜ï¼š</p><ul><li>åœ¨ç¼–è¯‘æœŸé—´ï¼Œå•ä¸ªçš„ switch è¢«åˆ†ä¸ºäº†ä¸¤ä¸ª <ul><li>ç¬¬ä¸€ä¸ªç”¨æ¥åŒ¹é…å­—ç¬¦ä¸²ï¼Œå¹¶ç»™ x èµ‹å€¼ <ul><li>å­—ç¬¦ä¸²çš„åŒ¹é…ç”¨åˆ°äº†å­—ç¬¦ä¸²çš„ hashCode ï¼Œè¿˜ç”¨åˆ°äº† equals æ–¹æ³•</li><li>ä½¿ç”¨ hashCode æ˜¯ä¸ºäº†æé«˜æ¯”è¾ƒæ•ˆç‡ï¼Œä½¿ç”¨ equals æ˜¯é˜²æ­¢æœ‰ hashCode å†²çªï¼ˆå¦‚ BM å’Œ C .ï¼‰</li></ul></li><li>ç¬¬äºŒä¸ªç”¨æ¥æ ¹æ®xçš„å€¼æ¥å†³å®šè¾“å‡ºè¯­å¥</li></ul></li></ul><p>ä»¥çœ‹åˆ°ï¼Œæ‰§è¡Œäº†ä¸¤é switchï¼Œç¬¬ä¸€éæ˜¯æ ¹æ®å­—ç¬¦ä¸²çš„ hashCode å’Œ equals å°†å­—ç¬¦ä¸²çš„è½¬æ¢ä¸ºç›¸åº” byte ç±»å‹ï¼Œç¬¬äºŒéæ‰æ˜¯åˆ©ç”¨ byte æ‰§è¡Œè¿›è¡Œæ¯”è¾ƒã€‚</p><blockquote><p><strong>é—®</strong>ï¼šä¸ºä»€ä¹ˆç¬¬ä¸€éæ—¶å¿…é¡»æ—¢æ¯”è¾ƒ hashCodeï¼Œåˆåˆ©ç”¨ equals æ¯”è¾ƒå‘¢ï¼ŸhashCode æ˜¯ä¸ºäº†æé«˜æ•ˆç‡ï¼Œå‡å°‘å¯èƒ½çš„æ¯”è¾ƒï¼›è€Œ equals æ˜¯ä¸ºäº†é˜²æ­¢ hashCode å†²çªã€‚</p><p>ä¾‹å¦‚ <code>BM</code> å’Œ <code>C.</code> è¿™ä¸¤ä¸ªå­—ç¬¦ä¸²çš„hashCodeå€¼éƒ½æ˜¯ 2123 ï¼Œå¦‚æœæœ‰å¦‚ä¸‹ä»£ç ï¼š</p></blockquote><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Candy6_1</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> choose</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#D8DEE9;"> str</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">        switch</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9FF;">str</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">            case</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">BM</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">                System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">h</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">                break;</span></span>
<span class="line"><span style="color:#ECEFF4;">            }</span></span>
<span class="line"><span style="color:#81A1C1;">            case</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">C.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">                System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">w</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">                break;</span></span>
<span class="line"><span style="color:#ECEFF4;">            }</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¼šè¢«ç¼–è¯‘å™¨è½¬æ¢ä¸ºï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Candy6_1</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#88C0D0;"> Candy6_1</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> choose</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#D8DEE9;"> var0</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">        byte</span><span style="color:#D8DEE9;"> var2</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> -</span><span style="color:#B48EAD;">1</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">        switch</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">var0</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">hashCode</span><span style="color:#ECEFF4;">())</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">        case</span><span style="color:#B48EAD;"> 2123</span><span style="color:#81A1C1;">:</span></span>
<span class="line"><span style="color:#81A1C1;">            if</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">var0</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">equals</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">C.</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">))</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9FF;">                var2 </span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;"> 1</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">            }</span><span style="color:#81A1C1;"> else</span><span style="color:#81A1C1;"> if</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">var0</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">equals</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">BM</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">))</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9FF;">                var2 </span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">            }</span></span>
<span class="line"><span style="color:#81A1C1;">        default:</span></span>
<span class="line"><span style="color:#81A1C1;">            switch</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">var2</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">            case</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">:</span></span>
<span class="line"><span style="color:#D8DEE9;">                System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">h</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">                break;</span></span>
<span class="line"><span style="color:#81A1C1;">            case</span><span style="color:#B48EAD;"> 1</span><span style="color:#81A1C1;">:</span></span>
<span class="line"><span style="color:#D8DEE9;">                System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">w</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">            }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-8-switch-æšä¸¾" tabindex="-1"><a class="header-anchor" href="#_3-8-switch-æšä¸¾"><span>3.8 switch æšä¸¾</span></a></h3><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">enum</span><span style="color:#D8DEE9FF;"> SEX </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">   MALE</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> FEMALE</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Candy7</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">   public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">      SEX</span><span style="color:#D8DEE9;"> sex</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> SEX</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">MALE</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">      switch</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9FF;">sex</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">         case</span><span style="color:#D8DEE9FF;"> MALE</span><span style="color:#81A1C1;">:</span></span>
<span class="line"><span style="color:#D8DEE9;">            System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">man</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">            break;</span></span>
<span class="line"><span style="color:#81A1C1;">         case</span><span style="color:#D8DEE9FF;"> FEMALE</span><span style="color:#81A1C1;">:</span></span>
<span class="line"><span style="color:#D8DEE9;">            System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">woman</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">            break;</span></span>
<span class="line"><span style="color:#81A1C1;">         default:</span></span>
<span class="line"><span style="color:#81A1C1;">            break;</span></span>
<span class="line"><span style="color:#ECEFF4;">      }</span></span>
<span class="line"><span style="color:#ECEFF4;">   }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#81A1C1;">enum</span><span style="color:#D8DEE9FF;"> SEX </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">   MALE</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> FEMALE</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Candy7</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">   /**     </span></span>
<span class="line"><span style="color:#616E88;">    * å®šä¹‰ä¸€ä¸ªåˆæˆç±»ï¼ˆä»… jvm ä½¿ç”¨ï¼Œå¯¹æˆ‘ä»¬ä¸å¯è§ï¼‰     </span></span>
<span class="line"><span style="color:#616E88;">    * ç”¨æ¥æ˜ å°„æšä¸¾çš„ ordinal ä¸æ•°ç»„å…ƒç´ çš„å…³ç³»     </span></span>
<span class="line"><span style="color:#616E88;">    * æšä¸¾çš„ ordinal è¡¨ç¤ºæšä¸¾å¯¹è±¡çš„åºå·ï¼Œä» 0 å¼€å§‹     </span></span>
<span class="line"><span style="color:#616E88;">    * å³ MALE çš„ ordinal()=0ï¼ŒFEMALE çš„ ordinal()=1     </span></span>
<span class="line"><span style="color:#616E88;">    */</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#81A1C1;">   static</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> $MAP</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">      // æ•°ç»„å¤§å°å³ä¸ºæšä¸¾å…ƒç´ ä¸ªæ•°ï¼Œé‡Œé¢å­˜æ”¾äº† case ç”¨äºæ¯”è¾ƒçš„æ•°å­—</span></span>
<span class="line"><span style="color:#81A1C1;">      static</span><span style="color:#81A1C1;"> int</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> map</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#81A1C1;"> int</span><span style="color:#ECEFF4;">[</span><span style="color:#B48EAD;">2</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">      static</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">         // ordinal å³æšä¸¾å…ƒç´ å¯¹åº”æ‰€åœ¨çš„ä½ç½®ï¼ŒMALE ä¸º 0 ï¼ŒFEMALE ä¸º 1</span></span>
<span class="line"><span style="color:#D8DEE9FF;">         map</span><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9;">SEX</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">MALE</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">ordinal</span><span style="color:#ECEFF4;">()]</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 1</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">         map</span><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9;">SEX</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">FEMALE</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">ordinal</span><span style="color:#ECEFF4;">()]</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 2</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">      }</span></span>
<span class="line"><span style="color:#ECEFF4;">   }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">   public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">      SEX</span><span style="color:#D8DEE9;"> sex</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> SEX</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">MALE</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">      // å°†å¯¹åº”ä½ç½®æšä¸¾å…ƒç´ çš„å€¼èµ‹ç»™ x ï¼Œç”¨äº case æ“ä½œ</span></span>
<span class="line"><span style="color:#81A1C1;">      int</span><span style="color:#D8DEE9;"> x</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> $MAP</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">map</span><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9;">sex</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">ordinal</span><span style="color:#ECEFF4;">()]</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">      switch</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9FF;">x</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">         case</span><span style="color:#B48EAD;"> 1</span><span style="color:#81A1C1;">:</span></span>
<span class="line"><span style="color:#D8DEE9;">            System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">man</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">            break;</span></span>
<span class="line"><span style="color:#81A1C1;">         case</span><span style="color:#B48EAD;"> 2</span><span style="color:#81A1C1;">:</span></span>
<span class="line"><span style="color:#D8DEE9;">            System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">woman</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">            break;</span></span>
<span class="line"><span style="color:#81A1C1;">         default:</span></span>
<span class="line"><span style="color:#81A1C1;">            break;</span></span>
<span class="line"><span style="color:#ECEFF4;">      }</span></span>
<span class="line"><span style="color:#ECEFF4;">   }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-9-æšä¸¾ç±»" tabindex="-1"><a class="header-anchor" href="#_3-9-æšä¸¾ç±»"><span>3.9 æšä¸¾ç±»</span></a></h3><p><code>JDK 7</code> æ–°å¢äº†æšä¸¾ç±»ï¼Œä»¥å‰é¢çš„æ€§åˆ«æšä¸¾ä¸ºä¾‹ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> enum</span><span style="color:#D8DEE9FF;"> Sex </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">    MALE</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;">FEMALE</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è½¬æ¢åçš„ä»£ç </p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> final</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Sex</span><span style="color:#81A1C1;"> extends</span><span style="color:#8FBCBB;font-weight:bold;"> Enum</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">Sex</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9FF;">   </span></span>
<span class="line"><span style="color:#616E88;">   // å¯¹åº”æšä¸¾ç±»ä¸­çš„å…ƒç´ </span></span>
<span class="line"><span style="color:#81A1C1;">   public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> final</span><span style="color:#8FBCBB;"> Sex</span><span style="color:#D8DEE9;"> MALE</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;">    </span></span>
<span class="line"><span style="color:#81A1C1;">   public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> final</span><span style="color:#8FBCBB;"> Sex</span><span style="color:#D8DEE9;"> FEMALE</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;">    </span></span>
<span class="line"><span style="color:#81A1C1;">   private</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> final</span><span style="color:#8FBCBB;"> Sex</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> $VALUES</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">   </span></span>
<span class="line"><span style="color:#81A1C1;">    static</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9FF;">       </span></span>
<span class="line"><span style="color:#616E88;">            // è°ƒç”¨æ„é€ å‡½æ•°ï¼Œä¼ å…¥æšä¸¾å…ƒç´ çš„å€¼åŠ ordinal</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        MALE </span><span style="color:#81A1C1;">=</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Sex</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">MALE</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;">    </span></span>
<span class="line"><span style="color:#D8DEE9FF;">        FEMALE </span><span style="color:#81A1C1;">=</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Sex</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">FEMALE</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 1</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;">   </span></span>
<span class="line"><span style="color:#D8DEE9FF;">        $VALUES </span><span style="color:#81A1C1;">=</span><span style="color:#81A1C1;"> new</span><span style="color:#8FBCBB;"> Sex</span><span style="color:#ECEFF4;">[]{</span><span style="color:#D8DEE9FF;">MALE</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> FEMALE</span><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">   }</span></span>
<span class="line"><span style="color:#D8DEE9FF;">         </span></span>
<span class="line"><span style="color:#616E88;">   // è°ƒç”¨çˆ¶ç±»ä¸­çš„æ–¹æ³•</span></span>
<span class="line"><span style="color:#81A1C1;">    private</span><span style="color:#88C0D0;"> Sex</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#D8DEE9;"> name</span><span style="color:#ECEFF4;">,</span><span style="color:#81A1C1;"> int</span><span style="color:#D8DEE9;"> ordinal</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9FF;">     </span></span>
<span class="line"><span style="color:#81A1C1;">        super</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">name</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> ordinal</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;">    </span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#D8DEE9FF;">   </span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#8FBCBB;"> Sex</span><span style="color:#ECEFF4;">[]</span><span style="color:#88C0D0;"> values</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9FF;">  </span></span>
<span class="line"><span style="color:#81A1C1;">        return</span><span style="color:#D8DEE9;"> $VALUES</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">clone</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;">  </span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#8FBCBB;"> Sex</span><span style="color:#88C0D0;"> valueOf</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#D8DEE9;"> name</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#81A1C1;">        return</span><span style="color:#D8DEE9;"> Enum</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">valueOf</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">Sex</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">class</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> name</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;">  </span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#D8DEE9FF;">   </span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-10-try-with-resources" tabindex="-1"><a class="header-anchor" href="#_3-10-try-with-resources"><span>3.10 try-with-resources</span></a></h3><p>JDK 7 å¼€å§‹æ–°å¢äº†å¯¹éœ€è¦å…³é—­çš„èµ„æºå¤„ç†çš„ç‰¹æ®Šè¯­æ³•ï¼Œâ€˜try-with-resourcesâ€™</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">try</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">èµ„æºå˜é‡ </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> åˆ›å»ºèµ„æºå¯¹è±¡</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span></span>
<span class="line"><span style="color:#ECEFF4;">}</span><span style="color:#81A1C1;"> catch</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å…¶ä¸­èµ„æºå¯¹è±¡éœ€è¦å®ç° AutoCloseable æ¥å£ï¼Œä¾‹å¦‚ InputStream ã€ OutputStream ã€ Connection ã€ Statement ã€ ResultSet ç­‰æ¥å£éƒ½å®ç°äº† AutoCloseable ï¼Œä½¿ç”¨ try-with- resources å¯ä»¥ä¸ç”¨å†™ finally è¯­å¥å—ï¼Œç¼–è¯‘å™¨ä¼šå¸®åŠ©ç”Ÿæˆå…³é—­èµ„æºä»£ç ï¼Œä¾‹å¦‚ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Candy9</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#81A1C1;">        public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">                try</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">InputStream</span><span style="color:#D8DEE9;"> is</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> FileInputStream</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">d:</span><span style="color:#EBCB8B;">\\</span><span style="color:#A3BE8C;">1.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)){</span><span style="color:#D8DEE9FF;">        </span></span>
<span class="line"><span style="color:#D8DEE9;">                        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">is</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">                }</span><span style="color:#81A1C1;"> catch</span><span style="color:#ECEFF4;"> (</span><span style="color:#8FBCBB;">IOException</span><span style="color:#D8DEE9;"> e</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#D8DEE9;">                        e</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">printStackTrace</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">                }</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¼šè¢«è½¬æ¢ä¸ºï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Candy9</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#D8DEE9FF;">    </span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#88C0D0;"> Candy9</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span><span style="color:#ECEFF4;"> }</span></span>
<span class="line"><span style="color:#D8DEE9FF;">   </span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#81A1C1;">        try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">            InputStream</span><span style="color:#D8DEE9;"> is</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> FileInputStream</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">d:</span><span style="color:#EBCB8B;">\\</span><span style="color:#A3BE8C;">1.txt</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#8FBCBB;">            Throwable</span><span style="color:#D8DEE9;"> t</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> null;</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#81A1C1;">            try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">                System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">is</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">            }</span><span style="color:#81A1C1;"> catch</span><span style="color:#ECEFF4;"> (</span><span style="color:#8FBCBB;">Throwable</span><span style="color:#D8DEE9;"> e1</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#616E88;">                // t æ˜¯æˆ‘ä»¬ä»£ç å‡ºç°çš„å¼‚å¸¸ </span></span>
<span class="line"><span style="color:#D8DEE9FF;">                t </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> e1</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#81A1C1;">                throw</span><span style="color:#D8DEE9FF;"> e1</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">            }</span><span style="color:#81A1C1;"> finally</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">                // åˆ¤æ–­äº†èµ„æºä¸ä¸ºç©º </span></span>
<span class="line"><span style="color:#81A1C1;">                if</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9FF;">is </span><span style="color:#81A1C1;">!=</span><span style="color:#81A1C1;"> null</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#616E88;">                    // å¦‚æœæˆ‘ä»¬ä»£ç æœ‰å¼‚å¸¸</span></span>
<span class="line"><span style="color:#81A1C1;">                    if</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9FF;">t </span><span style="color:#81A1C1;">!=</span><span style="color:#81A1C1;"> null</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#81A1C1;">                        try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">                            is</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">                        }</span><span style="color:#81A1C1;"> catch</span><span style="color:#ECEFF4;"> (</span><span style="color:#8FBCBB;">Throwable</span><span style="color:#D8DEE9;"> e2</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#616E88;">                            // å¦‚æœ close å‡ºç°å¼‚å¸¸ï¼Œä½œä¸ºè¢«å‹åˆ¶å¼‚å¸¸æ·»åŠ </span></span>
<span class="line"><span style="color:#D8DEE9;">                            t</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">addSuppressed</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">e2</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">                        }</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">                    }</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#616E88;">                        // å¦‚æœæˆ‘ä»¬ä»£ç æ²¡æœ‰å¼‚å¸¸ï¼Œclose å‡ºç°çš„å¼‚å¸¸å°±æ˜¯æœ€å catch å—ä¸­çš„ e </span></span>
<span class="line"><span style="color:#D8DEE9;">                        is</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">                    }</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">                }</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">            }</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span><span style="color:#81A1C1;"> catch</span><span style="color:#ECEFF4;"> (</span><span style="color:#8FBCBB;">IOException</span><span style="color:#D8DEE9;"> e</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">            e</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">printStackTrace</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸ºä»€ä¹ˆè¦è®¾è®¡ä¸€ä¸ª addSuppressed(Throwable e) ï¼ˆæ·»åŠ è¢«å‹åˆ¶å¼‚å¸¸ï¼‰çš„æ–¹æ³•å‘¢ï¼Ÿæ˜¯ä¸ºäº†é˜²æ­¢å¼‚å¸¸ä¿¡æ¯çš„ä¸¢å¤±ï¼ˆæƒ³æƒ³ try-with-resources ç”Ÿæˆçš„ fianlly ä¸­å¦‚æœæŠ›å‡ºäº†å¼‚å¸¸ï¼‰ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Test6</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#81A1C1;">        public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#81A1C1;">                try</span><span style="color:#ECEFF4;"> (</span><span style="color:#8FBCBB;">MyResource</span><span style="color:#D8DEE9;"> resource</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> MyResource</span><span style="color:#ECEFF4;">())</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#81A1C1;">                        int</span><span style="color:#D8DEE9;"> i</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 1</span><span style="color:#81A1C1;">/</span><span style="color:#B48EAD;">0</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">                }</span><span style="color:#81A1C1;"> catch</span><span style="color:#ECEFF4;"> (</span><span style="color:#8FBCBB;">Exception</span><span style="color:#D8DEE9;"> e</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#D8DEE9;">                        e</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">printStackTrace</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">                }</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#81A1C1;">class</span><span style="color:#8FBCBB;"> MyResource</span><span style="color:#81A1C1;"> implements</span><span style="color:#8FBCBB;font-weight:bold;"> AutoCloseable</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#81A1C1;">        public</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> close</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;"> throws</span><span style="color:#8FBCBB;"> Exception</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#81A1C1;">                throw</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Exception</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">close å¼‚å¸¸</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¾“å‡ºï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9;">java</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">lang</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">ArithmeticException</span><span style="color:#81A1C1;">:</span><span style="color:#81A1C1;"> /</span><span style="color:#D8DEE9FF;"> by zero </span></span>
<span class="line"><span style="color:#D8DEE9FF;">        at </span><span style="color:#D8DEE9;">test</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">Test6</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">main</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">Test6</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">java</span><span style="color:#81A1C1;">:</span><span style="color:#B48EAD;">7</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#D8DEE9FF;">        Suppressed</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9;"> java</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">lang</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">Exception</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> close å¼‚å¸¸ </span></span>
<span class="line"><span style="color:#D8DEE9FF;">                at </span><span style="color:#D8DEE9;">test</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">MyResource</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">close</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">Test6</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">java</span><span style="color:#81A1C1;">:</span><span style="color:#B48EAD;">18</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#D8DEE9FF;">                at </span><span style="color:#D8DEE9;">test</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">Test6</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">main</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">Test6</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">java</span><span style="color:#81A1C1;">:</span><span style="color:#B48EAD;">6</span><span style="color:#ECEFF4;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-11-æ–¹æ³•é‡å†™æ—¶çš„æ¡¥æ¥æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_3-11-æ–¹æ³•é‡å†™æ—¶çš„æ¡¥æ¥æ–¹æ³•"><span>3.11 æ–¹æ³•é‡å†™æ—¶çš„æ¡¥æ¥æ–¹æ³•</span></a></h3><ul><li>æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œæ–¹æ³•é‡å†™æ—¶å¯¹è¿”å›å€¼åˆ†ä¸¤ç§æƒ…å†µï¼š çˆ¶å­ç±»çš„è¿”å›å€¼å®Œå…¨ä¸€è‡´ å­ç±»è¿”å›å€¼å¯ä»¥æ˜¯çˆ¶ç±»è¿”å›å€¼çš„å­ç±»ï¼ˆæ¯”è¾ƒç»•å£ï¼Œè§ä¸‹é¢çš„ä¾‹å­ï¼‰</li></ul><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">class</span><span style="color:#8FBCBB;"> A</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#81A1C1;">        public</span><span style="color:#8FBCBB;"> Number</span><span style="color:#88C0D0;"> m</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#81A1C1;">                return</span><span style="color:#B48EAD;"> 1</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#81A1C1;">class</span><span style="color:#8FBCBB;"> B</span><span style="color:#81A1C1;"> extends</span><span style="color:#8FBCBB;font-weight:bold;"> A</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">        @</span><span style="color:#D08770;">Override</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#616E88;">        // å­ç±» m æ–¹æ³•çš„è¿”å›å€¼æ˜¯ Integer æ˜¯çˆ¶ç±» m æ–¹æ³•è¿”å›å€¼ Number çš„å­ç±»         </span></span>
<span class="line"><span style="color:#81A1C1;">        public</span><span style="color:#8FBCBB;"> Integer</span><span style="color:#88C0D0;"> m</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#81A1C1;">                return</span><span style="color:#B48EAD;"> 2</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯¹äºå­ç±»ï¼Œjava ç¼–è¯‘å™¨ä¼šåšå¦‚ä¸‹å¤„ç†ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">class</span><span style="color:#8FBCBB;"> B</span><span style="color:#81A1C1;"> extends</span><span style="color:#8FBCBB;font-weight:bold;"> A</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#81A1C1;">        public</span><span style="color:#8FBCBB;"> Integer</span><span style="color:#88C0D0;"> m</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#81A1C1;">                return</span><span style="color:#B48EAD;"> 2</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#616E88;">        // æ­¤æ–¹æ³•æ‰æ˜¯çœŸæ­£é‡å†™äº†çˆ¶ç±» public Number m() æ–¹æ³• </span></span>
<span class="line"><span style="color:#81A1C1;">        public</span><span style="color:#D8DEE9FF;"> synthetic bridge </span><span style="color:#8FBCBB;">Number</span><span style="color:#88C0D0;"> m</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#616E88;">                // è°ƒç”¨ public Integer m() </span></span>
<span class="line"><span style="color:#81A1C1;">                return</span><span style="color:#88C0D0;"> m</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å…¶ä¸­æ¡¥æ¥æ–¹æ³•æ¯”è¾ƒç‰¹æ®Šï¼Œä»…å¯¹ java è™šæ‹Ÿæœºå¯è§ï¼Œå¹¶ä¸”ä¸åŸæ¥çš„ public Integer m() æ²¡æœ‰å‘½åå†²çªï¼Œå¯ä»¥ ç”¨ä¸‹é¢åå°„ä»£ç æ¥éªŒè¯ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9FF;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">        for</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">Method</span><span style="color:#D8DEE9;"> m</span><span style="color:#81A1C1;"> :</span><span style="color:#D8DEE9;"> B</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">class</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getDeclaredMethods</span><span style="color:#ECEFF4;">())</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">            System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">m</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç»“æœï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#D8DEE9;"> java</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">lang</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">Integer</span><span style="color:#D8DEE9;"> cn</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">ali</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">jvm</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">test</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">B</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">m</span><span style="color:#ECEFF4;">()</span></span>
<span class="line"><span style="color:#81A1C1;">public</span><span style="color:#D8DEE9;"> java</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">lang</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">Number</span><span style="color:#D8DEE9;"> cn</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">ali</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">jvm</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">test</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">B</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">m</span><span style="color:#ECEFF4;">()</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-12-åŒ¿åå†…éƒ¨ç±»" tabindex="-1"><a class="header-anchor" href="#_3-12-åŒ¿åå†…éƒ¨ç±»"><span>3.12 åŒ¿åå†…éƒ¨ç±»</span></a></h3><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Candy10</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">   public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">      Runnable</span><span style="color:#D8DEE9;"> runnable</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Runnable</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">         @</span><span style="color:#D08770;">Override</span></span>
<span class="line"><span style="color:#81A1C1;">         public</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> run</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">            System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">running...</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">         }</span></span>
<span class="line"><span style="color:#ECEFF4;">      }</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">   }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è½¬æ¢åçš„ä»£ç </p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Candy10</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">   public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">      // ç”¨é¢å¤–åˆ›å»ºçš„ç±»æ¥åˆ›å»ºåŒ¿åå†…éƒ¨ç±»å¯¹è±¡</span></span>
<span class="line"><span style="color:#8FBCBB;">      Runnable</span><span style="color:#D8DEE9;"> runnable</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Candy10$1</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">   }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åˆ›å»ºäº†ä¸€ä¸ªé¢å¤–çš„ç±»ï¼Œå®ç°äº† Runnable æ¥å£</span></span>
<span class="line"><span style="color:#81A1C1;">final</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Candy10$1</span><span style="color:#81A1C1;"> implements</span><span style="color:#8FBCBB;font-weight:bold;"> Runnable</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">   public</span><span style="color:#D8DEE9FF;"> Demo8$</span><span style="color:#88C0D0;">1</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ECEFF4;">   @</span><span style="color:#D08770;">Override</span></span>
<span class="line"><span style="color:#81A1C1;">   public</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> run</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">      System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">running...</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">   }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¼•ç”¨å±€éƒ¨å˜é‡çš„åŒ¿åå†…éƒ¨ç±»ï¼Œæºä»£ç ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Candy11</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#81A1C1;">        public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> test</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">final</span><span style="color:#81A1C1;"> int</span><span style="color:#D8DEE9;"> x</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#8FBCBB;">                Runnable</span><span style="color:#D8DEE9;"> runnable</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Runnable</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">                        @</span><span style="color:#D08770;">Override</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#81A1C1;">                        public</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> run</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9FF;">         </span></span>
<span class="line"><span style="color:#D8DEE9;">                                System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ok:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;"> +</span><span style="color:#D8DEE9FF;"> x</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">                        }</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">                }</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è½¬æ¢åä»£ç ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// é¢å¤–ç”Ÿæˆçš„ç±» </span></span>
<span class="line"><span style="color:#81A1C1;">final</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Candy11$1</span><span style="color:#81A1C1;"> implements</span><span style="color:#8FBCBB;font-weight:bold;"> Runnable</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#81A1C1;">        int</span><span style="color:#D8DEE9;"> val$x</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#D8DEE9FF;">        Candy11$</span><span style="color:#88C0D0;">1</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">int</span><span style="color:#D8DEE9;"> x</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#81A1C1;">                this</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">val$x</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9FF;"> x</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#81A1C1;">        public</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> run</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#D8DEE9;">                System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ok:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;"> +</span><span style="color:#81A1C1;"> this</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">val$x</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Candy11</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#81A1C1;">        public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> test</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">final</span><span style="color:#81A1C1;"> int</span><span style="color:#D8DEE9;"> x</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#8FBCBB;">                Runnable</span><span style="color:#D8DEE9;"> runnable</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Candy11$1</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">x</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„ï¼šè¿™åŒæ—¶è§£é‡Šäº†ä¸ºä»€ä¹ˆåŒ¿åå†…éƒ¨ç±»å¼•ç”¨å±€éƒ¨å˜é‡æ—¶ï¼Œå±€éƒ¨å˜é‡å¿…é¡»æ˜¯ final çš„ï¼šå› ä¸ºåœ¨åˆ›å»º Candy11$1 å¯¹è±¡æ—¶ï¼Œå°† x çš„å€¼èµ‹å€¼ç»™äº† Candy11$1 å¯¹è±¡çš„ å€¼åï¼Œå¦‚æœä¸æ˜¯ final å£°æ˜çš„ x å€¼å‘ç”Ÿäº†æ”¹å˜ï¼ŒåŒ¿åå†…éƒ¨ç±»åˆ™å€¼ä¸ä¸€è‡´ã€‚</p><p>è¿™åŒæ—¶è§£é‡Šäº†ä¸ºä»€ä¹ˆåŒ¿åå†…éƒ¨ç±»å¼•ç”¨å±€éƒ¨å˜é‡æ—¶ï¼Œå±€éƒ¨å˜é‡å¿…é¡»æ˜¯finalçš„ï¼šå› ä¸ºåœ¨åˆ›å»ºCandy11$1å¯¹è±¡æ—¶ï¼Œå°†xçš„å€¼èµ‹å€¼ç»™äº†Candy11$1å¯¹è±¡çš„valaå±æ€§ï¼Œæ‰€ä»¥xä¸åº”è¯¥å†å‘ç”Ÿå˜åŒ–äº†ï¼Œå¦‚æœå˜åŒ–ï¼Œé‚£ä¹ˆualxå±æ€§æ²¡æœ‰æœºä¼šå†è·Ÿç€ä¸€èµ·å˜åŒ–</p><h2 id="_4-ç±»åŠ è½½é˜¶æ®µ" tabindex="-1"><a class="header-anchor" href="#_4-ç±»åŠ è½½é˜¶æ®µ"><span>4. ç±»åŠ è½½é˜¶æ®µ</span></a></h2><h3 id="_4-1-åŠ è½½" tabindex="-1"><a class="header-anchor" href="#_4-1-åŠ è½½"><span>4.1 åŠ è½½</span></a></h3><ul><li>å°†ç±»çš„å­—èŠ‚ç è½½å…¥æ–¹æ³•åŒºï¼ˆ1.8åä¸ºå…ƒç©ºé—´ï¼Œåœ¨æœ¬åœ°å†…å­˜ä¸­ï¼‰ä¸­ï¼Œå†…éƒ¨é‡‡ç”¨ C++ çš„ <strong>instanceKlass</strong> æè¿° java ç±»ï¼Œå®ƒçš„é‡è¦ ï¬eld æœ‰ï¼š <ul><li><strong>_java_mirror</strong> å³ <strong>java çš„ç±»é•œåƒ</strong>ï¼Œä¾‹å¦‚å¯¹ String æ¥è¯´ï¼Œå®ƒçš„é•œåƒç±»å°±æ˜¯ String.classï¼Œä½œç”¨æ˜¯æŠŠ klass æš´éœ²ç»™ java ä½¿ç”¨</li><li>_super å³çˆ¶ç±»</li><li>_ï¬elds å³æˆå‘˜å˜é‡</li><li>_methods å³æ–¹æ³•</li><li>_constants å³å¸¸é‡æ± </li><li>_class_loader å³ç±»åŠ è½½å™¨</li><li>_vtable è™šæ–¹æ³•è¡¨</li><li>_itable æ¥å£æ–¹æ³•</li></ul></li><li>å¦‚æœè¿™ä¸ªç±»è¿˜æœ‰çˆ¶ç±»æ²¡æœ‰åŠ è½½ï¼Œ<strong>å…ˆåŠ è½½çˆ¶ç±»</strong></li><li>åŠ è½½å’Œé“¾æ¥å¯èƒ½æ˜¯<strong>äº¤æ›¿è¿è¡Œ</strong>çš„</li><li><strong>instanceKlass</strong> è¿™æ ·çš„ã€å…ƒæ•°æ®ã€‘æ˜¯å­˜å‚¨åœ¨<strong>æ–¹æ³•åŒº</strong>ï¼ˆ1.8 åçš„å…ƒç©ºé—´å†…ï¼‰ï¼Œä½† <strong>_java_mirror</strong> æ˜¯å­˜å‚¨åœ¨<strong>å †</strong>ä¸­ï¼Œå¯ä»¥é€šè¿‡HSDBå·¥å…·æŸ¥çœ‹ã€‚</li><li>instanceKlasså’Œ_java_mirrorï¼ˆjavaé•œåƒç±»ï¼‰äº’ç›¸ä¿å­˜äº†å¯¹æ–¹çš„åœ°å€</li><li>ç±»çš„å¯¹è±¡åœ¨å¯¹è±¡å¤´ä¸­ä¿å­˜äº† *.class çš„åœ°å€ã€‚è®©å¯¹è±¡å¯ä»¥é€šè¿‡å…¶æ‰¾åˆ°æ–¹æ³•åŒºä¸­çš„instanceKlassï¼Œä»è€Œè·å–ç±»çš„å„ç§ä¿¡æ¯</li></ul><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407151806520.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p><strong>æ³¨æ„</strong></p><ul><li>instanceKlass è¿™æ ·çš„ã€å…ƒæ•°æ®ã€‘æ˜¯å­˜å‚¨åœ¨æ–¹æ³•åŒºï¼ˆ1.8 åçš„å…ƒç©ºé—´å†…ï¼‰ï¼Œä½† _java_mirror æ˜¯å­˜å‚¨åœ¨å †ä¸­</li><li>å¯ä»¥é€šè¿‡å‰é¢ä»‹ç»çš„ HSDB å·¥å…·æŸ¥çœ‹</li></ul><h3 id="_4-2-é“¾æ¥" tabindex="-1"><a class="header-anchor" href="#_4-2-é“¾æ¥"><span>4.2 é“¾æ¥</span></a></h3><h4 id="_1-éªŒè¯" tabindex="-1"><a class="header-anchor" href="#_1-éªŒè¯"><span>ï¼ˆ1ï¼‰éªŒè¯</span></a></h4><p>éªŒè¯ç±»æ˜¯å¦ç¬¦åˆ JVMè§„èŒƒï¼Œå®‰å…¨æ€§æ£€æŸ¥ ç”¨ UE ç­‰æ”¯æŒäºŒè¿›åˆ¶çš„ç¼–è¾‘å™¨ä¿®æ”¹ HelloWorld.class çš„é­”æ•°ï¼Œåœ¨æ§åˆ¶å°è¿è¡Œ</p><h4 id="_2-å‡†å¤‡" tabindex="-1"><a class="header-anchor" href="#_2-å‡†å¤‡"><span>ï¼ˆ2ï¼‰å‡†å¤‡</span></a></h4><p>ä¸º <code>static</code> å˜é‡åˆ†é…ç©ºé—´ï¼Œè®¾ç½®é»˜è®¤å€¼</p><ul><li>staticå˜é‡åœ¨JDK 7ä»¥å‰æ˜¯å­˜å‚¨ä¸instanceKlassæœ«å°¾ã€‚ä½†åœ¨JDK 7ä»¥åå°±å­˜å‚¨åœ¨_java_mirroræœ«å°¾äº†</li><li>staticå˜é‡åœ¨åˆ†é…ç©ºé—´å’Œèµ‹å€¼æ˜¯åœ¨ä¸¤ä¸ªé˜¶æ®µå®Œæˆçš„ã€‚<strong>åˆ†é…ç©ºé—´</strong>åœ¨<strong>å‡†å¤‡é˜¶æ®µ</strong>å®Œæˆï¼Œ<strong>èµ‹å€¼</strong>åœ¨<strong>åˆå§‹åŒ–é˜¶æ®µ</strong>å®Œæˆ</li><li>å¦‚æœ static å˜é‡æ˜¯ ï¬nal çš„<strong>åŸºæœ¬ç±»å‹</strong>ï¼Œä»¥åŠ<strong>å­—ç¬¦ä¸²å¸¸é‡</strong>ï¼Œé‚£ä¹ˆç¼–è¯‘é˜¶æ®µå€¼å°±ç¡®å®šäº†ï¼Œ<strong>èµ‹å€¼åœ¨å‡†å¤‡é˜¶æ®µå®Œæˆ</strong></li><li>å¦‚æœ static å˜é‡æ˜¯ ï¬nal çš„ï¼Œä½†å±äº<strong>å¼•ç”¨ç±»å‹</strong>ï¼Œé‚£ä¹ˆ<strong>èµ‹å€¼</strong>ä¹Ÿä¼šåœ¨<strong>åˆå§‹åŒ–é˜¶æ®µå®Œæˆ</strong></li></ul><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Code_22_AnalysisTest</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> throws</span><span style="color:#8FBCBB;"> ClassNotFoundException</span><span style="color:#ECEFF4;">,</span><span style="color:#8FBCBB;"> IOException</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">        ClassLoader</span><span style="color:#D8DEE9;"> classLoader</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Code_22_AnalysisTest</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">class</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getClassLoader</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#8FBCBB;">        Class</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">?</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9;"> c</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> classLoader</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">loadClass</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">cn.ali.jvm.test.C</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">        // new C();</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">in</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">read</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">class</span><span style="color:#8FBCBB;"> C</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">    D</span><span style="color:#D8DEE9;"> d</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> D</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">class</span><span style="color:#8FBCBB;"> D</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-è§£æ" tabindex="-1"><a class="header-anchor" href="#_3-è§£æ"><span>ï¼ˆ3ï¼‰è§£æ</span></a></h4><p>å°†å¸¸é‡æ± ä¸­çš„ç¬¦å·å¼•ç”¨è§£æä¸ºç›´æ¥å¼•ç”¨</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">package</span><span style="color:#8FBCBB;"> cn</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">itcast</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">jvm</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">t3</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">load</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">/**</span></span>
<span class="line"><span style="color:#616E88;">* è§£æçš„å«ä¹‰</span></span>
<span class="line"><span style="color:#616E88;">*/</span></span>
<span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Load2</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> throws</span><span style="color:#8FBCBB;"> ClassNotFoundException</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#8FBCBB;">    IOException</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">        ClassLoader</span><span style="color:#D8DEE9;"> classloader</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Load2</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">class</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getClassLoader</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">        // loadClass æ–¹æ³•ä¸ä¼šå¯¼è‡´ç±»çš„è§£æå’Œåˆå§‹åŒ–</span></span>
<span class="line"><span style="color:#8FBCBB;">        Class</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">?</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9;"> c</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> classloader</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">loadClass</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">cn.itcast.jvm.t3.load.C</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">        // new C();</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">in</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">read</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#81A1C1;">class</span><span style="color:#8FBCBB;"> C</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">    D</span><span style="color:#D8DEE9;"> d</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> D</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#81A1C1;">class</span><span style="color:#8FBCBB;"> D</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-3-åˆå§‹åŒ–" tabindex="-1"><a class="header-anchor" href="#_4-3-åˆå§‹åŒ–"><span>4-3 åˆå§‹åŒ–</span></a></h3><h4 id="_1-cinit-v-æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_1-cinit-v-æ–¹æ³•"><span>ï¼ˆ1ï¼‰&lt;cinit&gt;()v æ–¹æ³•</span></a></h4><p>åˆå§‹åŒ–å³è°ƒç”¨ <code>\&lt;cinit&gt;()</code>Vï¼Œè™šæ‹Ÿæœºä¼šä¿è¯è¿™ä¸ªç±»çš„ã€æ„é€ æ–¹æ³•ã€‘çš„çº¿ç¨‹å®‰å…¨</p><h4 id="_2-å‘ç”Ÿçš„æ—¶æœº" tabindex="-1"><a class="header-anchor" href="#_2-å‘ç”Ÿçš„æ—¶æœº"><span>ï¼ˆ2ï¼‰å‘ç”Ÿçš„æ—¶æœº</span></a></h4><p><strong>ç±»çš„åˆå§‹åŒ–çš„æ‡’æƒ°çš„</strong>ï¼Œä»¥ä¸‹æƒ…å†µä¼šåˆå§‹åŒ–ï¼š</p><ul><li>main æ–¹æ³•æ‰€åœ¨çš„ç±»ï¼Œæ€»ä¼šè¢«é¦–å…ˆåˆå§‹åŒ–</li><li>é¦–æ¬¡è®¿é—®è¿™ä¸ªç±»çš„é™æ€å˜é‡æˆ–é™æ€æ–¹æ³•æ—¶</li><li>å­ç±»åˆå§‹åŒ–ï¼Œå¦‚æœçˆ¶ç±»è¿˜æ²¡åˆå§‹åŒ–ï¼Œä¼šå¼•å‘</li><li>å­ç±»è®¿é—®çˆ¶ç±»çš„é™æ€å˜é‡ï¼Œåªä¼šè§¦å‘çˆ¶ç±»çš„åˆå§‹åŒ–</li><li><code>Class.forName</code></li><li>new ä¼šå¯¼è‡´åˆå§‹åŒ–</li></ul><p>ä»¥ä¸‹æƒ…å†µä¸ä¼šåˆå§‹åŒ–ï¼š</p><ul><li>è®¿é—®ç±»çš„ static ï¬nal é™æ€å¸¸é‡ï¼ˆåŸºæœ¬ç±»å‹å’Œå­—ç¬¦ä¸²ï¼‰</li><li>ç±»å¯¹è±¡.class ä¸ä¼šè§¦å‘åˆå§‹åŒ–</li><li>åˆ›å»ºè¯¥ç±»å¯¹è±¡çš„æ•°ç»„</li><li>ç±»åŠ è½½å™¨çš„.loadClassæ–¹æ³•</li><li><code>Class.forName</code>çš„å‚æ•°2ä¸ºfalseæ—¶</li></ul><p><strong>éªŒè¯ç±»æ˜¯å¦è¢«åˆå§‹åŒ–ï¼Œå¯ä»¥çœ‹æ”¹ç±»çš„é™æ€ä»£ç å—æ˜¯å¦è¢«æ‰§è¡Œ</strong></p><p>è¿™é‡Œä¸€ä¸ªä¾‹å­æ¥éªŒè¯ï¼šï¼ˆå®éªŒæ—¶è¯·å…ˆå…¨éƒ¨æ³¨é‡Šï¼Œæ¯æ¬¡åªæ‰§è¡Œå…¶ä¸­ä¸€ä¸ªï¼‰</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Load3</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    static</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">main init</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> throws</span><span style="color:#8FBCBB;"> ClassNotFoundException</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">        // 1. é™æ€å¸¸é‡ï¼ˆåŸºæœ¬ç±»å‹å’Œå­—ç¬¦ä¸²ï¼‰ä¸ä¼šè§¦å‘åˆå§‹åŒ–</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">B</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">b</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">        // 2. ç±»å¯¹è±¡.class ä¸ä¼šè§¦å‘åˆå§‹åŒ–</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">B</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">class</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">        // 3. åˆ›å»ºè¯¥ç±»çš„æ•°ç»„ä¸ä¼šè§¦å‘åˆå§‹åŒ–</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">new</span><span style="color:#8FBCBB;"> B</span><span style="color:#ECEFF4;">[</span><span style="color:#B48EAD;">0</span><span style="color:#ECEFF4;">])</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">        // 4. ä¸ä¼šåˆå§‹åŒ–ç±» Bï¼Œä½†ä¼šåŠ è½½ Bã€A</span></span>
<span class="line"><span style="color:#8FBCBB;">        ClassLoader</span><span style="color:#D8DEE9;"> cl</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Thread</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">currentThread</span><span style="color:#ECEFF4;">().</span><span style="color:#88C0D0;">getContextClassLoader</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        cl</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">loadClass</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">cn.itcast.jvm.t3.B</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">        // 5. ä¸ä¼šåˆå§‹åŒ–ç±» Bï¼Œä½†ä¼šåŠ è½½ Bã€A</span></span>
<span class="line"><span style="color:#8FBCBB;">        ClassLoader</span><span style="color:#D8DEE9;"> c2</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Thread</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">currentThread</span><span style="color:#ECEFF4;">().</span><span style="color:#88C0D0;">getContextClassLoader</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        Class</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">forName</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">cn.itcast.jvm.t3.B</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#81A1C1;"> false</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> c2</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        </span></span>
<span class="line"><span style="color:#616E88;">        // 1. é¦–æ¬¡è®¿é—®è¿™ä¸ªç±»çš„é™æ€å˜é‡æˆ–é™æ€æ–¹æ³•æ—¶</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">A</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">a</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">        // 2. å­ç±»åˆå§‹åŒ–ï¼Œå¦‚æœçˆ¶ç±»è¿˜æ²¡åˆå§‹åŒ–ï¼Œä¼šå¼•å‘</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">B</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">c</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">        // 3. å­ç±»è®¿é—®çˆ¶ç±»é™æ€å˜é‡ï¼Œåªè§¦å‘çˆ¶ç±»åˆå§‹åŒ–</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">B</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">a</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">        // 4. ä¼šåˆå§‹åŒ–ç±» Bï¼Œå¹¶å…ˆåˆå§‹åŒ–ç±» A</span></span>
<span class="line"><span style="color:#D8DEE9;">        Class</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">forName</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">cn.itcast.jvm.t3.B</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#81A1C1;">class</span><span style="color:#8FBCBB;"> A</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    static</span><span style="color:#81A1C1;"> int</span><span style="color:#D8DEE9;"> a</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    static</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">a init</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#81A1C1;">class</span><span style="color:#8FBCBB;"> B</span><span style="color:#81A1C1;"> extends</span><span style="color:#8FBCBB;font-weight:bold;"> A</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    final</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> double</span><span style="color:#D8DEE9;"> b</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 5.0</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    static</span><span style="color:#81A1C1;"> boolean</span><span style="color:#D8DEE9;"> c</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> false;</span></span>
<span class="line"><span style="color:#81A1C1;">    static</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">b init</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-ç»ƒä¹ " tabindex="-1"><a class="header-anchor" href="#_4-ç»ƒä¹ "><span>4ï¼‰ç»ƒä¹ </span></a></h3><p>ä»å­—èŠ‚ç åˆ†æï¼Œä½¿ç”¨ aï¼Œbï¼Œc è¿™ä¸‰ä¸ªå¸¸é‡æ˜¯å¦ä¼šå¯¼è‡´ E åˆå§‹åŒ–</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Load2</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">E</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">a</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">E</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">b</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">        // ä¼šå¯¼è‡´ E ç±»åˆå§‹åŒ–ï¼Œå› ä¸º Integer æ˜¯åŒ…è£…ç±»</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">E</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">c</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">class</span><span style="color:#8FBCBB;"> E</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> final</span><span style="color:#81A1C1;"> int</span><span style="color:#D8DEE9;"> a</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 10</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> final</span><span style="color:#8FBCBB;"> String</span><span style="color:#D8DEE9;"> b</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">hello</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> final</span><span style="color:#8FBCBB;"> Integer</span><span style="color:#D8DEE9;"> c</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 20</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">    static</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">E cinit</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å…¸å‹åº”ç”¨ - å®Œæˆæ‡’æƒ°åˆå§‹åŒ–å•ä¾‹æ¨¡å¼</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Singleton</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">    private</span><span style="color:#88C0D0;"> Singleton</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span><span style="color:#ECEFF4;"> }</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#616E88;">    // å†…éƒ¨ç±»ä¸­ä¿å­˜å•ä¾‹</span></span>
<span class="line"><span style="color:#81A1C1;">    private</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> LazyHolder</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#81A1C1;">        static</span><span style="color:#81A1C1;"> final</span><span style="color:#8FBCBB;"> Singleton</span><span style="color:#D8DEE9;"> INSTANCE</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Singleton</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#616E88;">    // ç¬¬ä¸€æ¬¡è°ƒç”¨ getInstance æ–¹æ³•ï¼Œæ‰ä¼šå¯¼è‡´å†…éƒ¨ç±»åŠ è½½å’Œåˆå§‹åŒ–å…¶é™æ€æˆå‘˜ </span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#8FBCBB;"> Singleton</span><span style="color:#88C0D0;"> getInstance</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#81A1C1;">        return</span><span style="color:#D8DEE9;"> LazyHolder</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">INSTANCE</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»¥ä¸Šçš„å®ç°ç‰¹ç‚¹æ˜¯ï¼š</p><ul><li>æ‡’æƒ°å®ä¾‹åŒ–</li><li>åˆå§‹åŒ–æ—¶çš„çº¿ç¨‹å®‰å…¨æ˜¯æœ‰ä¿éšœçš„</li></ul><h2 id="_5-ç±»åŠ è½½å™¨" tabindex="-1"><a class="header-anchor" href="#_5-ç±»åŠ è½½å™¨"><span>5.ç±»åŠ è½½å™¨</span></a></h2><p>ç±»åŠ è½½å™¨è™½ç„¶åªç”¨äºå®ç°ç±»çš„åŠ è½½åŠ¨ä½œï¼Œä½†å®ƒåœ¨Javaç¨‹åºä¸­èµ·åˆ°çš„ä½œç”¨å´è¿œè¶…ç±»åŠ è½½é˜¶æ®µ å¯¹äºä»»æ„ä¸€ä¸ªç±»ï¼Œéƒ½å¿…é¡»ç”±åŠ è½½å®ƒçš„ç±»åŠ è½½å™¨å’Œè¿™ä¸ªç±»æœ¬èº«ä¸€èµ·å…±åŒç¡®ç«‹å…¶åœ¨ Java è™šæ‹Ÿæœºä¸­çš„å”¯ä¸€æ€§ï¼Œæ¯ä¸€ä¸ªç±»åŠ è½½å™¨ï¼Œéƒ½æ‹¥æœ‰ä¸€ä¸ªç‹¬ç«‹çš„ç±»åç§°ç©ºé—´ã€‚è¿™å¥è¯å¯ä»¥è¡¨è¾¾å¾—æ›´é€šä¿—ä¸€äº›ï¼šæ¯”è¾ƒä¸¤ä¸ªç±»æ˜¯å¦â€œç›¸ç­‰â€ï¼Œåªæœ‰åœ¨è¿™ä¸¤ä¸ªç±»æ˜¯ç”±åŒä¸€ä¸ªç±»åŠ è½½å™¨åŠ è½½çš„å‰æä¸‹æ‰æœ‰æ„ä¹‰ï¼Œå¦åˆ™ï¼Œå³ä½¿è¿™ä¸¤ä¸ªç±»æ¥æºäºåŒä¸€ä¸ª Class æ–‡ä»¶ï¼Œè¢«åŒä¸€ä¸ª Java è™šæ‹ŸæœºåŠ è½½ï¼Œåªè¦åŠ è½½å®ƒä»¬çš„ç±»åŠ è½½å™¨ä¸åŒï¼Œé‚£è¿™ä¸¤ä¸ªç±»å°±å¿…å®šä¸ç›¸ç­‰ï¼</p><p>ä»¥ JDK 8 ä¸ºä¾‹ï¼š</p><p>åç§°åŠ è½½çš„ç±»è¯´æ˜</p><table><thead><tr><th>åç§°</th><th>åŠ è½½çš„ç±»</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>Bootstrap ClassLoaderï¼ˆå¯åŠ¨ç±»åŠ è½½å™¨ï¼‰</td><td>JAVA_HOME/jre/lib</td><td>æ— æ³•ç›´æ¥è®¿é—®</td></tr><tr><td>Extension ClassLoader(æ‹“å±•ç±»åŠ è½½å™¨)</td><td>JAVA_HOME/jre/lib/ext</td><td>ä¸Šçº§ä¸ºBootstrapï¼Œæ˜¾ç¤ºä¸ºnull</td></tr><tr><td>Application ClassLoader(åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨)</td><td>classpath</td><td>ä¸Šçº§ä¸ºExtension</td></tr><tr><td>è‡ªå®šä¹‰ç±»åŠ è½½å™¨</td><td>è‡ªå®šä¹‰</td><td>ä¸Šçº§ä¸ºApplication</td></tr></tbody></table><h3 id="_5-1-å¯åŠ¨ç±»çš„åŠ è½½å™¨" tabindex="-1"><a class="header-anchor" href="#_5-1-å¯åŠ¨ç±»çš„åŠ è½½å™¨"><span>5.1 å¯åŠ¨ç±»çš„åŠ è½½å™¨</span></a></h3><p>å¯é€šè¿‡åœ¨æ§åˆ¶å°è¾“å…¥æŒ‡ä»¤ï¼Œä½¿å¾—ç±»è¢«å¯åŠ¨ç±»åŠ å™¨åŠ è½½</p><p>ç”¨ Bootstrap ç±»åŠ è½½å™¨åŠ è½½ç±»ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">package</span><span style="color:#8FBCBB;"> cn</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">itcast</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">jvm</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">t3</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">load</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> F</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    static</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">bootstrap F init</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#81A1C1;">package</span><span style="color:#8FBCBB;"> cn</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">itcast</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">jvm</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">t3</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">load</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Load5_1</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> throws</span><span style="color:#8FBCBB;"> ClassNotFoundException</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">        Class</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">?</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9;"> aClass</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Class</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">forName</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">cn.itcast.jvm.t3.load.F</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">aClass</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getClassLoader</span><span style="color:#ECEFF4;">())</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#D8DEE9FF;">E</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;">\git\jvm\out\production\jvm</span><span style="color:#81A1C1;">&gt;</span><span style="color:#D8DEE9FF;">java </span><span style="color:#81A1C1;">-</span><span style="color:#D8DEE9FF;">Xbootclasspath</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">a</span><span style="color:#81A1C1;">:</span><span style="color:#ECEFF4;">.</span></span>
<span class="line"><span style="color:#D8DEE9;">cn</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">itcast</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">jvm</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">t3</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">load</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">Load5</span></span>
<span class="line"><span style="color:#D8DEE9FF;">bootstrap </span><span style="color:#8FBCBB;">F</span><span style="color:#D8DEE9FF;"> init</span></span>
<span class="line"><span style="color:#81A1C1;">null</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>-Xbootclasspath è¡¨ç¤ºè®¾ç½® bootclasspath</li><li>å…¶ä¸­ /a:. è¡¨ç¤ºå°†å½“å‰ç›®å½•è¿½åŠ è‡³ bootclasspath ä¹‹å</li><li>å¯ä»¥ç”¨è¿™ä¸ªåŠæ³•æ›¿æ¢æ ¸å¿ƒç±» <ul><li><code>java -Xbootclasspath:&lt;new bootclasspath&gt;</code></li></ul></li><li>ä¹Ÿå¯ä»¥è¿½åŠ  <ul><li><code>java -Xbootclasspath/a:&lt;è¿½åŠ è·¯å¾„&gt;</code>ï¼ˆåè¿½åŠ ï¼‰</li><li><code>java -Xbootclasspath/p:&lt;è¿½åŠ è·¯å¾„&gt;</code>ï¼ˆå‰è¿½åŠ ï¼‰</li></ul></li></ul><h3 id="_5-2-æ‰©å±•ç±»çš„åŠ è½½å™¨" tabindex="-1"><a class="header-anchor" href="#_5-2-æ‰©å±•ç±»çš„åŠ è½½å™¨"><span>5.2 æ‰©å±•ç±»çš„åŠ è½½å™¨</span></a></h3><p>å¦‚æœ classpath å’Œ JAVA_HOME/jre/lib/ext ä¸‹æœ‰åŒåç±»ï¼ŒåŠ è½½æ—¶ä¼šä½¿ç”¨æ‹“å±•ç±»åŠ è½½å™¨åŠ è½½ã€‚å½“åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨å‘ç°æ‹“å±•ç±»åŠ è½½å™¨å·²å°†è¯¥åŒåç±»åŠ è½½è¿‡äº†ï¼Œåˆ™ä¸ä¼šå†æ¬¡åŠ è½½ã€‚</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">package</span><span style="color:#8FBCBB;"> cn</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">itcast</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">jvm</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">t3</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">load</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> G</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    static</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">classpath G init</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#D8DEE9FF;">classpath </span><span style="color:#8FBCBB;">G</span><span style="color:#D8DEE9FF;"> init</span></span>
<span class="line"><span style="color:#D8DEE9;">sun</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">misc</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">Launcher$AppClassLoader</span><span style="color:#ECEFF4;">@</span><span style="color:#D08770;">18b4aac2</span></span>
<span class="line"><span style="color:#81A1C1;">package</span><span style="color:#8FBCBB;"> cn</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">itcast</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">jvm</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">t3</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">load</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> G</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">        static</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ext G init</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#D8DEE9FF;">E</span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;">\git\jvm\out\production\jvm</span><span style="color:#81A1C1;">&gt;</span><span style="color:#D8DEE9FF;">jar </span><span style="color:#81A1C1;">-</span><span style="color:#D8DEE9FF;">cvf </span><span style="color:#D8DEE9;">my</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">jar</span><span style="color:#D8DEE9FF;"> cn</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">itcast</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">jvm</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">t3</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">load</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9;">G</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">class</span></span>
<span class="line"><span style="color:#D8DEE9FF;">å·²æ·»åŠ æ¸…å•</span></span>
<span class="line"><span style="color:#D8DEE9FF;">æ­£åœ¨æ·»åŠ </span><span style="color:#81A1C1;">:</span><span style="color:#D8DEE9FF;"> cn</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">itcast</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">jvm</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">t3</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">load</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9;">G</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">class</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">è¾“å…¥ </span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;"> 481</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9FF;">è¾“å‡º </span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;"> 322</span><span style="color:#ECEFF4;">)(</span><span style="color:#D8DEE9FF;">å‹ç¼©äº† </span><span style="color:#B48EAD;">33</span><span style="color:#81A1C1;">%</span><span style="color:#ECEFF4;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å°† jar åŒ…æ‹·è´åˆ° JAVA_HOME/jre/lib/ext</p><p>é‡æ–°æ‰§è¡Œ Load5_2</p><p>è¾“å‡º</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;">ext </span><span style="color:#8FBCBB;">G</span><span style="color:#D8DEE9FF;"> init</span></span>
<span class="line"><span style="color:#D8DEE9;">sun</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">misc</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">Launcher$ExtClassLoader</span><span style="color:#ECEFF4;">@</span><span style="color:#D08770;">29453f44</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-3-åŒäº²å§”æ´¾æ¨¡å¼" tabindex="-1"><a class="header-anchor" href="#_5-3-åŒäº²å§”æ´¾æ¨¡å¼"><span>5.3 åŒäº²å§”æ´¾æ¨¡å¼</span></a></h3><ul><li>å½“AppClassLoaderåŠ è½½ä¸€ä¸ªclassæ—¶ï¼Œå®ƒé¦–å…ˆä¸ä¼šè‡ªå·±å»å°è¯•åŠ è½½è¿™ä¸ªç±»ï¼Œè€Œæ˜¯æŠŠç±»åŠ è½½è¯·æ±‚å§”æ´¾ç»™çˆ¶ç±»åŠ è½½å™¨ExtClassLoaderå»å®Œæˆã€‚</li><li>å½“ExtClassLoaderåŠ è½½ä¸€ä¸ªclassæ—¶ï¼Œå®ƒé¦–å…ˆä¹Ÿä¸ä¼šè‡ªå·±å»å°è¯•åŠ è½½è¿™ä¸ªç±»ï¼Œè€Œæ˜¯æŠŠç±»åŠ è½½è¯·æ±‚å§”æ´¾ç»™BootStrapClassLoaderå»å®Œæˆã€‚</li><li>å¦‚æœBootStrapClassLoaderåŠ è½½å¤±è´¥(ä¾‹å¦‚åœ¨$JAVA_HOME/jre/libé‡ŒæœªæŸ¥æ‰¾åˆ°è¯¥class)ï¼Œä¼šä½¿ç”¨ExtClassLoaderæ¥å°è¯•åŠ è½½ï¼›</li><li>è‹¥ExtClassLoaderä¹ŸåŠ è½½å¤±è´¥ï¼Œåˆ™ä¼šä½¿ç”¨AppClassLoaderæ¥åŠ è½½ï¼Œå¦‚æœAppClassLoaderä¹ŸåŠ è½½å¤±è´¥ï¼Œåˆ™ä¼šæŠ¥å‡ºå¼‚å¸¸ClassNotFoundExceptionã€‚</li></ul><p>æ‰€è°“çš„<strong>åŒäº²å§”æ´¾</strong>ï¼Œå°±æ˜¯æŒ‡è°ƒç”¨ç±»åŠ è½½å™¨çš„ <strong>loadClass</strong> æ–¹æ³•æ—¶ï¼ŒæŸ¥æ‰¾ç±»çš„è§„åˆ™</p><p>loadClassæºç </p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">protected</span><span style="color:#8FBCBB;"> Class</span><span style="color:#81A1C1;">&lt;?&gt;</span><span style="color:#88C0D0;"> loadClass</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#D8DEE9FF;"> name</span><span style="color:#ECEFF4;">,</span><span style="color:#81A1C1;"> boolean</span><span style="color:#D8DEE9FF;"> resolve</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    throws </span><span style="color:#8FBCBB;">ClassNotFoundException</span></span>
<span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#81A1C1;">    synchronized</span><span style="color:#ECEFF4;"> (</span><span style="color:#88C0D0;">getClassLoadingLock</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">name</span><span style="color:#ECEFF4;">))</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">        // é¦–å…ˆæŸ¥æ‰¾è¯¥ç±»æ˜¯å¦å·²ç»è¢«è¯¥ç±»åŠ è½½å™¨åŠ è½½è¿‡äº†</span></span>
<span class="line"><span style="color:#8FBCBB;">        Class</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">?</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9;"> c</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> findLoadedClass</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">name</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">        // å¦‚æœæ²¡æœ‰è¢«åŠ è½½è¿‡</span></span>
<span class="line"><span style="color:#81A1C1;">        if</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9FF;">c </span><span style="color:#81A1C1;">==</span><span style="color:#81A1C1;"> null</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">            long</span><span style="color:#D8DEE9;"> t0</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> System</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">nanoTime</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">            try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">                // çœ‹æ˜¯å¦è¢«å®ƒçš„ä¸Šçº§åŠ è½½å™¨åŠ è½½è¿‡äº† Extension çš„ä¸Šçº§æ˜¯Bootstarpï¼Œä½†å®ƒæ˜¾ç¤ºä¸ºnull</span></span>
<span class="line"><span style="color:#81A1C1;">                if</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9FF;">parent </span><span style="color:#81A1C1;">!=</span><span style="color:#81A1C1;"> null</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9FF;">                    c </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9;"> parent</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">loadClass</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">name</span><span style="color:#ECEFF4;">,</span><span style="color:#81A1C1;"> false</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">                }</span><span style="color:#81A1C1;"> else</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">                    // çœ‹æ˜¯å¦è¢«å¯åŠ¨ç±»åŠ è½½å™¨åŠ è½½è¿‡</span></span>
<span class="line"><span style="color:#D8DEE9FF;">                    c </span><span style="color:#81A1C1;">=</span><span style="color:#88C0D0;"> findBootstrapClassOrNull</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">name</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">                }</span></span>
<span class="line"><span style="color:#ECEFF4;">            }</span><span style="color:#81A1C1;"> catch</span><span style="color:#ECEFF4;"> (</span><span style="color:#8FBCBB;">ClassNotFoundException</span><span style="color:#D8DEE9;"> e</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">                // ClassNotFoundException thrown if class not found</span></span>
<span class="line"><span style="color:#616E88;">                // from the non-null parent class loader</span></span>
<span class="line"><span style="color:#616E88;">                //æ•è·å¼‚å¸¸ï¼Œä½†ä¸åšä»»ä½•å¤„ç†</span></span>
<span class="line"><span style="color:#ECEFF4;">            }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">            if</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9FF;">c </span><span style="color:#81A1C1;">==</span><span style="color:#81A1C1;"> null</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">                // å¦‚æœè¿˜æ˜¯æ²¡æœ‰æ‰¾åˆ°ï¼Œå…ˆè®©æ‹“å±•ç±»åŠ è½½å™¨è°ƒç”¨ findClass æ–¹æ³•å»æ‰¾åˆ°è¯¥ç±»ï¼Œå¦‚æœè¿˜æ˜¯æ²¡æ‰¾åˆ°ï¼Œå°±æŠ›å‡ºå¼‚å¸¸</span></span>
<span class="line"><span style="color:#616E88;">                // ç„¶åè®©åº”ç”¨ç±»åŠ è½½å™¨å»æ‰¾ classpath ä¸‹æ‰¾è¯¥ç±»</span></span>
<span class="line"><span style="color:#81A1C1;">                long</span><span style="color:#D8DEE9;"> t1</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> System</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">nanoTime</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">                c </span><span style="color:#81A1C1;">=</span><span style="color:#88C0D0;"> findClass</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">name</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">                // è®°å½•æ—¶é—´</span></span>
<span class="line"><span style="color:#D8DEE9;">                sun</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">misc</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">PerfCounter</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getParentDelegationTime</span><span style="color:#ECEFF4;">().</span><span style="color:#88C0D0;">addTime</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">t1 </span><span style="color:#81A1C1;">-</span><span style="color:#D8DEE9FF;"> t0</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">                sun</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">misc</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">PerfCounter</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getFindClassTime</span><span style="color:#ECEFF4;">().</span><span style="color:#88C0D0;">addElapsedTimeFrom</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">t1</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">                sun</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">misc</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">PerfCounter</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getFindClasses</span><span style="color:#ECEFF4;">().</span><span style="color:#88C0D0;">increment</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">            }</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#81A1C1;">        if</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9FF;">resolve</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#88C0D0;">            resolveClass</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">c</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#81A1C1;">        return</span><span style="color:#D8DEE9FF;"> c</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-4-è‡ªå®šä¹‰ç±»åŠ è½½å™¨" tabindex="-1"><a class="header-anchor" href="#_5-4-è‡ªå®šä¹‰ç±»åŠ è½½å™¨"><span>5.4 è‡ªå®šä¹‰ç±»åŠ è½½å™¨</span></a></h3><p><strong>ä½¿ç”¨åœºæ™¯</strong></p><ul><li>æƒ³åŠ è½½é classpath éšæ„è·¯å¾„ä¸­çš„ç±»æ–‡ä»¶</li><li>é€šè¿‡æ¥å£æ¥ä½¿ç”¨å®ç°ï¼Œå¸Œæœ›è§£è€¦æ—¶ï¼Œå¸¸ç”¨åœ¨æ¡†æ¶è®¾è®¡</li><li>è¿™äº›ç±»å¸Œæœ›äºˆä»¥éš”ç¦»ï¼Œä¸åŒåº”ç”¨çš„åŒåç±»éƒ½å¯ä»¥åŠ è½½ï¼Œä¸å†²çªï¼Œå¸¸è§äº tomcat å®¹å™¨</li></ul><p><strong>æ­¥éª¤</strong></p><ul><li>ç»§æ‰¿ ClassLoader çˆ¶ç±»</li><li>è¦éµä»åŒäº²å§”æ´¾æœºåˆ¶ï¼Œé‡å†™ ï¬ndClass æ–¹æ³• ä¸æ˜¯é‡å†™ loadClass æ–¹æ³•ï¼Œå¦åˆ™ä¸ä¼šèµ°åŒäº²å§”æ´¾æœºåˆ¶</li><li>è¯»å–ç±»æ–‡ä»¶çš„å­—èŠ‚ç </li><li>è°ƒç”¨çˆ¶ç±»çš„ deï¬neClass æ–¹æ³•æ¥åŠ è½½ç±»</li><li>ä½¿ç”¨è€…è°ƒç”¨è¯¥ç±»åŠ è½½å™¨çš„ loadClass æ–¹æ³•</li></ul><p><strong>ç ´ååŒäº²å§”æ´¾æ¨¡å¼</strong></p><ul><li>åŒäº²å§”æ´¾æ¨¡å‹çš„ç¬¬ä¸€æ¬¡â€œè¢«ç ´åâ€å…¶å®å‘ç”Ÿåœ¨åŒäº²å§”æ´¾æ¨¡å‹å‡ºç°ä¹‹å‰â€”â€”å³JDK1.2é¢ä¸–ä»¥å‰çš„â€œè¿œå¤â€æ—¶ä»£ <ul><li>å»ºè®®ç”¨æˆ·é‡å†™findClass()æ–¹æ³•ï¼Œåœ¨ç±»åŠ è½½å™¨ä¸­çš„loadClass()æ–¹æ³•ä¸­ä¹Ÿä¼šè°ƒç”¨è¯¥æ–¹æ³•</li></ul></li><li>åŒäº²å§”æ´¾æ¨¡å‹çš„ç¬¬äºŒæ¬¡â€œè¢«ç ´åâ€æ˜¯ç”±è¿™ä¸ªæ¨¡å‹è‡ªèº«çš„ç¼ºé™·å¯¼è‡´çš„ <ul><li>å¦‚æœæœ‰åŸºç¡€ç±»å‹åˆè¦è°ƒç”¨å›ç”¨æˆ·çš„ä»£ç ï¼Œæ­¤æ—¶ä¹Ÿä¼šç ´ååŒäº²å§”æ´¾æ¨¡å¼</li></ul></li><li>åŒäº²å§”æ´¾æ¨¡å‹çš„ç¬¬ä¸‰æ¬¡â€œè¢«ç ´åâ€æ˜¯ç”±äºç”¨æˆ·å¯¹ç¨‹åºåŠ¨æ€æ€§çš„è¿½æ±‚è€Œå¯¼è‡´çš„ <ul><li>è¿™é‡Œæ‰€è¯´çš„â€œåŠ¨æ€æ€§â€æŒ‡çš„æ˜¯ä¸€äº›éå¸¸â€œçƒ­â€é—¨çš„åè¯ï¼šä»£ç çƒ­æ›¿æ¢ï¼ˆHot Swapï¼‰ã€æ¨¡å—çƒ­éƒ¨ç½²ï¼ˆHot Deploymentï¼‰ç­‰</li></ul></li></ul><h3 id="_5-5-çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨" tabindex="-1"><a class="header-anchor" href="#_5-5-çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨"><span>5.5 çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨</span></a></h3><h4 id="èƒŒæ™¯" tabindex="-1"><a class="header-anchor" href="#èƒŒæ™¯"><span>èƒŒæ™¯</span></a></h4><p>æˆ‘ä»¬åœ¨ä½¿ç”¨ JDBC æ—¶ï¼Œéƒ½éœ€è¦åŠ è½½ Driver é©±åŠ¨ï¼Œä¸çŸ¥é“ä½ æ³¨æ„åˆ°æ²¡æœ‰ï¼Œä¸å†™</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9;">Class</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">forName</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">com.mysql.jdbc.Driver</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ä¹Ÿæ˜¯å¯ä»¥è®© com.mysql.jdbc.Driver æ­£ç¡®åŠ è½½çš„ï¼Œä½ çŸ¥é“æ˜¯æ€ä¹ˆåšçš„å—ï¼Ÿ è®©æˆ‘ä»¬è¿½è¸ªä¸€ä¸‹æºç ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> DriverManager</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // æ³¨å†Œé©±åŠ¨çš„é›†åˆ</span></span>
<span class="line"><span style="color:#81A1C1;">    private</span><span style="color:#81A1C1;"> final</span><span style="color:#81A1C1;"> static</span><span style="color:#8FBCBB;"> CopyOnWriteArrayList</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">DriverInfo</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9FF;"> registeredDrivers</span></span>
<span class="line"><span style="color:#81A1C1;">    =</span><span style="color:#81A1C1;"> new</span><span style="color:#8FBCBB;"> CopyOnWriteArrayList</span><span style="color:#ECEFF4;">&lt;&gt;()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">    // åˆå§‹åŒ–é©±åŠ¨</span></span>
<span class="line"><span style="color:#81A1C1;">    static</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#88C0D0;">    loadInitialDrivers</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#88C0D0;">    println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">JDBC DriverManager initialized</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å…ˆä¸çœ‹åˆ«çš„ï¼Œçœ‹çœ‹ DriverManager çš„ç±»åŠ è½½å™¨ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9;">System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">DriverManager</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">class</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getClassLoader</span><span style="color:#ECEFF4;">())</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>æ‰“å° nullï¼Œè¡¨ç¤ºå®ƒçš„ç±»åŠ è½½å™¨æ˜¯ Bootstrap ClassLoaderï¼Œä¼šåˆ° JAVA_HOME/jre/lib ä¸‹æœç´¢ç±»ï¼Œä½† JAVA_HOME/jre/lib ä¸‹æ˜¾ç„¶æ²¡æœ‰ mysql-connector-java-5.1.47.jar åŒ…ï¼Œè¿™æ ·é—®é¢˜æ¥äº†ï¼Œåœ¨ DriverManager çš„é™æ€ä»£ç å—ä¸­ï¼Œæ€ä¹ˆèƒ½æ­£ç¡®åŠ è½½ com.mysql.jdbc.Driver å‘¢ï¼Ÿ</p><h4 id="spi-æœåŠ¡æä¾›æ¥å£" tabindex="-1"><a class="header-anchor" href="#spi-æœåŠ¡æä¾›æ¥å£"><span>SPI æœåŠ¡æä¾›æ¥å£</span></a></h4><p>ç»§ç»­çœ‹ loadInitialDrivers() æ–¹æ³•ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">private</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> loadInitialDrivers</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">    String</span><span style="color:#D8DEE9;"> drivers</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        drivers </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9;"> AccessController</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">doPrivileged</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">new</span><span style="color:#8FBCBB;"> PrivilegedAction</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">&gt;</span></span>
<span class="line"><span style="color:#ECEFF4;">                ()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">            public</span><span style="color:#8FBCBB;"> String</span><span style="color:#88C0D0;"> run</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">                return</span><span style="color:#D8DEE9;"> System</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getProperty</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">jdbc.drivers</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">            }</span></span>
<span class="line"><span style="color:#ECEFF4;">        })</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#81A1C1;"> catch</span><span style="color:#ECEFF4;"> (</span><span style="color:#8FBCBB;">Exception</span><span style="color:#D8DEE9;"> ex</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        drivers </span><span style="color:#81A1C1;">=</span><span style="color:#81A1C1;"> null;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#616E88;">// 1ï¼‰ä½¿ç”¨ ServiceLoader æœºåˆ¶åŠ è½½é©±åŠ¨ï¼Œå³ SPI</span></span>
<span class="line"><span style="color:#D8DEE9;">    AccessController</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">doPrivileged</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">new</span><span style="color:#8FBCBB;"> PrivilegedAction</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">Void</span><span style="color:#ECEFF4;">&gt;()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">        public</span><span style="color:#8FBCBB;"> Void</span><span style="color:#88C0D0;"> run</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">            ServiceLoader</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">Driver</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9;"> loadedDrivers</span><span style="color:#81A1C1;"> =</span></span>
<span class="line"><span style="color:#D8DEE9;">                    ServiceLoader</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">load</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">Driver</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">class</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#8FBCBB;">            Iterator</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">Driver</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9;"> driversIterator</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> loadedDrivers</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">iterator</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">            try</span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#81A1C1;">                while</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">driversIterator</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">hasNext</span><span style="color:#ECEFF4;">())</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">                    driversIterator</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">next</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">                }</span></span>
<span class="line"><span style="color:#ECEFF4;">            }</span><span style="color:#81A1C1;"> catch</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">Throwable</span><span style="color:#D8DEE9;"> t</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">// Do nothing</span></span>
<span class="line"><span style="color:#ECEFF4;">            }</span></span>
<span class="line"><span style="color:#81A1C1;">            return</span><span style="color:#81A1C1;"> null;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#ECEFF4;">    })</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#88C0D0;">    println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">DriverManager.initialize: jdbc.drivers = </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;"> +</span><span style="color:#D8DEE9FF;"> drivers</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">// 2ï¼‰ä½¿ç”¨ jdbc.drivers å®šä¹‰çš„é©±åŠ¨ååŠ è½½é©±åŠ¨</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9FF;">drivers </span><span style="color:#81A1C1;">==</span><span style="color:#81A1C1;"> null</span><span style="color:#81A1C1;"> ||</span><span style="color:#D8DEE9;"> drivers</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">equals</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;&quot;</span><span style="color:#ECEFF4;">))</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">        return;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#8FBCBB;">    String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> driversList</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> drivers</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">split</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#88C0D0;">    println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">number of Drivers:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;"> +</span><span style="color:#D8DEE9;"> driversList</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">length</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    for</span><span style="color:#ECEFF4;"> (</span><span style="color:#8FBCBB;">String</span><span style="color:#D8DEE9;"> aDriver</span><span style="color:#81A1C1;"> :</span><span style="color:#D8DEE9FF;"> driversList</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">        try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#88C0D0;">            println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">DriverManager.Initialize: loading </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;"> +</span><span style="color:#D8DEE9FF;"> aDriver</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">// è¿™é‡Œçš„ ClassLoader.getSystemClassLoader() å°±æ˜¯åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨</span></span>
<span class="line"><span style="color:#D8DEE9;">            Class</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">forName</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">aDriver</span><span style="color:#ECEFF4;">,</span><span style="color:#81A1C1;"> true</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9;">                    ClassLoader</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getSystemClassLoader</span><span style="color:#ECEFF4;">())</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span><span style="color:#81A1C1;"> catch</span><span style="color:#ECEFF4;"> (</span><span style="color:#8FBCBB;">Exception</span><span style="color:#D8DEE9;"> ex</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#88C0D0;">            println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">DriverManager.Initialize: load failed: </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;"> +</span><span style="color:#D8DEE9FF;"> ex</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å…ˆçœ‹ 2ï¼‰å‘ç°å®ƒæœ€åæ˜¯ä½¿ç”¨ Class.forName å®Œæˆç±»çš„åŠ è½½å’Œåˆå§‹åŒ–ï¼Œå…³è”çš„æ˜¯åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨ï¼Œå› æ­¤ å¯ä»¥é¡ºåˆ©å®Œæˆç±»åŠ è½½ å†çœ‹ 1ï¼‰å®ƒå°±æ˜¯å¤§åé¼é¼çš„ Service Provider Interface ï¼ˆSPIï¼‰ çº¦å®šå¦‚ä¸‹ï¼Œåœ¨ jar åŒ…çš„ META-INF/services åŒ…ä¸‹ï¼Œä»¥æ¥å£å…¨é™å®šååä¸ºæ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹æ˜¯å®ç°ç±»åç§°</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407152008060.png" alt="image-20240715200831758" tabindex="0" loading="lazy"><figcaption>image-20240715200831758</figcaption></figure><h4 id="ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨"><span>ä½¿ç”¨</span></a></h4><p>è¿™æ ·å°±å¯ä»¥ä½¿ç”¨</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#8FBCBB;">ServiceLoader</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#D8DEE9FF;">æ¥å£ç±»å‹</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9;"> allImpls</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> ServiceLoader</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">load</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">æ¥å£ç±»å‹</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">class</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#8FBCBB;">Iterator</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#D8DEE9FF;">æ¥å£ç±»å‹</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9;"> iter</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> allImpls</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">iterator</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">while</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">iter</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">hasNext</span><span style="color:#ECEFF4;">())</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">        iter</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">next</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¥å¾—åˆ°å®ç°ç±»ï¼Œä½“ç°çš„æ˜¯ã€é¢å‘æ¥å£ç¼–ç¨‹+è§£è€¦ã€‘çš„æ€æƒ³ï¼Œåœ¨ä¸‹é¢ä¸€äº›æ¡†æ¶ä¸­éƒ½è¿ç”¨äº†æ­¤æ€æƒ³ï¼š</p><ul><li>JDBC</li><li>Servlet åˆå§‹åŒ–å™¨</li><li>Spring å®¹å™¨</li><li>Dubboï¼ˆå¯¹ SPI è¿›è¡Œäº†æ‰©å±•ï¼‰</li></ul><h4 id="åŸç†" tabindex="-1"><a class="header-anchor" href="#åŸç†"><span>åŸç†</span></a></h4><p>æ¥ç€çœ‹ ServiceLoader.load æ–¹æ³•:</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> &lt;</span><span style="color:#D8DEE9FF;">S</span><span style="color:#81A1C1;">&gt;</span><span style="color:#8FBCBB;"> ServiceLoader</span><span style="color:#81A1C1;">&lt;</span><span style="color:#D8DEE9FF;">S</span><span style="color:#81A1C1;">&gt;</span><span style="color:#88C0D0;"> load</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">Class</span><span style="color:#81A1C1;">&lt;</span><span style="color:#D8DEE9FF;">S</span><span style="color:#81A1C1;">&gt;</span><span style="color:#D8DEE9FF;"> service</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">// è·å–çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨</span></span>
<span class="line"><span style="color:#8FBCBB;">    ClassLoader</span><span style="color:#D8DEE9;"> cl</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Thread</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">currentThread</span><span style="color:#ECEFF4;">().</span><span style="color:#88C0D0;">getContextClassLoader</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    return</span><span style="color:#D8DEE9;"> ServiceLoader</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">load</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">service</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> cl</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨æ˜¯å½“å‰çº¿ç¨‹ä½¿ç”¨çš„ç±»åŠ è½½å™¨ï¼Œé»˜è®¤å°±æ˜¯åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨ï¼Œå®ƒå†…éƒ¨åˆæ˜¯ç”± Class.forName è°ƒç”¨äº†çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨å®Œæˆç±»åŠ è½½ï¼Œå…·ä½“ä»£ç åœ¨ ServiceLoader çš„å†…éƒ¨ç±» LazyIterator ä¸­ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">private</span><span style="color:#8FBCBB;"> S</span><span style="color:#88C0D0;"> nextService</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#ECEFF4;"> (</span><span style="color:#81A1C1;">!</span><span style="color:#88C0D0;">hasNextService</span><span style="color:#ECEFF4;">())</span></span>
<span class="line"><span style="color:#81A1C1;">        throw</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> NoSuchElementException</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#8FBCBB;">    String</span><span style="color:#D8DEE9;"> cn</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9FF;"> nextName</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    nextName </span><span style="color:#81A1C1;">=</span><span style="color:#81A1C1;"> null;</span></span>
<span class="line"><span style="color:#8FBCBB;">    Class</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">?</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9;"> c</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> null;</span></span>
<span class="line"><span style="color:#81A1C1;">    try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        c </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9;"> Class</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">forName</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">cn</span><span style="color:#ECEFF4;">,</span><span style="color:#81A1C1;"> false</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> loader</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#81A1C1;"> catch</span><span style="color:#ECEFF4;"> (</span><span style="color:#8FBCBB;">ClassNotFoundException</span><span style="color:#D8DEE9;"> x</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#88C0D0;">        fail</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">service</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#A3BE8C;">Provider </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;"> +</span><span style="color:#D8DEE9FF;"> cn </span><span style="color:#81A1C1;">+</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;"> not found</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#81A1C1;">    if</span><span style="color:#ECEFF4;"> (</span><span style="color:#81A1C1;">!</span><span style="color:#D8DEE9;">service</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isAssignableFrom</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">c</span><span style="color:#ECEFF4;">))</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#88C0D0;">        fail</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">service</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">                &quot;</span><span style="color:#A3BE8C;">Provider </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;"> +</span><span style="color:#D8DEE9FF;"> cn </span><span style="color:#81A1C1;">+</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;"> not a subtype</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#81A1C1;">    try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">        S</span><span style="color:#D8DEE9;"> p</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> service</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">cast</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">c</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">newInstance</span><span style="color:#ECEFF4;">())</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        providers</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">put</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">cn</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> p</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">        return</span><span style="color:#D8DEE9FF;"> p</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span><span style="color:#81A1C1;"> catch</span><span style="color:#ECEFF4;"> (</span><span style="color:#8FBCBB;">Throwable</span><span style="color:#D8DEE9;"> x</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#88C0D0;">        fail</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">service</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">                &quot;</span><span style="color:#A3BE8C;">Provider </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;"> +</span><span style="color:#D8DEE9FF;"> cn </span><span style="color:#81A1C1;">+</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;"> could not be instantiated</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9FF;">                x</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#81A1C1;">    throw</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Error</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // This cannot happen</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_6ã€è¿è¡ŒæœŸä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#_6ã€è¿è¡ŒæœŸä¼˜åŒ–"><span>6ã€è¿è¡ŒæœŸä¼˜åŒ–</span></a></h2><h3 id="_6-1-å³æ—¶ç¼–è¯‘" tabindex="-1"><a class="header-anchor" href="#_6-1-å³æ—¶ç¼–è¯‘"><span>6.1 å³æ—¶ç¼–è¯‘</span></a></h3><h4 id="_1-åˆ†å±‚ç¼–è¯‘" tabindex="-1"><a class="header-anchor" href="#_1-åˆ†å±‚ç¼–è¯‘"><span>ï¼ˆ1ï¼‰åˆ†å±‚ç¼–è¯‘</span></a></h4><p>JVM å°†æ‰§è¡ŒçŠ¶æ€åˆ†æˆäº† 5 ä¸ªå±‚æ¬¡ï¼š</p><ul><li>0å±‚ï¼šè§£é‡Šæ‰§è¡Œï¼Œç”¨è§£é‡Šå™¨å°†å­—èŠ‚ç ç¿»è¯‘ä¸ºæœºå™¨ç </li><li>1å±‚ï¼šä½¿ç”¨ C1 <strong>å³æ—¶ç¼–è¯‘å™¨</strong>ç¼–è¯‘æ‰§è¡Œï¼ˆä¸å¸¦ proï¬lingï¼‰</li><li>2å±‚ï¼šä½¿ç”¨ C1 å³æ—¶ç¼–è¯‘å™¨ç¼–è¯‘æ‰§è¡Œï¼ˆå¸¦åŸºæœ¬çš„profilingï¼‰</li><li>3å±‚ï¼šä½¿ç”¨ C1 å³æ—¶ç¼–è¯‘å™¨ç¼–è¯‘æ‰§è¡Œï¼ˆå¸¦å®Œå…¨çš„profilingï¼‰</li><li>4å±‚ï¼šä½¿ç”¨ C2 å³æ—¶ç¼–è¯‘å™¨ç¼–è¯‘æ‰§è¡Œ</li></ul><blockquote><p>proï¬ling æ˜¯æŒ‡åœ¨è¿è¡Œè¿‡ç¨‹ä¸­æ”¶é›†ä¸€äº›ç¨‹åºæ‰§è¡ŒçŠ¶æ€çš„æ•°æ®ï¼Œä¾‹å¦‚ã€æ–¹æ³•çš„è°ƒç”¨æ¬¡æ•°ã€‘ï¼Œã€å¾ªç¯çš„ å›è¾¹æ¬¡æ•°ã€‘ç­‰</p></blockquote><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> JIT1</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">        for</span><span style="color:#ECEFF4;"> (</span><span style="color:#81A1C1;">int</span><span style="color:#D8DEE9;"> i</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> i </span><span style="color:#81A1C1;">&lt;</span><span style="color:#B48EAD;"> 200</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> i</span><span style="color:#81A1C1;">++</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">            long</span><span style="color:#D8DEE9;"> start</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> System</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">nanoTime</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">            for</span><span style="color:#ECEFF4;"> (</span><span style="color:#81A1C1;">int</span><span style="color:#D8DEE9;"> j</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> j </span><span style="color:#81A1C1;">&lt;</span><span style="color:#B48EAD;"> 1000</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> j</span><span style="color:#81A1C1;">++</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">                new</span><span style="color:#88C0D0;"> Object</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">            }</span></span>
<span class="line"><span style="color:#81A1C1;">            long</span><span style="color:#D8DEE9;"> end</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> System</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">nanoTime</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">            System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">printf</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">%d</span><span style="color:#EBCB8B;">\t</span><span style="color:#A3BE8C;">%d</span><span style="color:#EBCB8B;">\n</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;">i</span><span style="color:#ECEFF4;">,(</span><span style="color:#D8DEE9FF;">end </span><span style="color:#81A1C1;">-</span><span style="color:#D8DEE9FF;"> start</span><span style="color:#ECEFF4;">))</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>å³æ—¶ç¼–è¯‘å™¨ï¼ˆJITï¼‰ä¸è§£é‡Šå™¨çš„åŒºåˆ«</strong>ï¼š</p><ul><li>è§£é‡Šå™¨ <ul><li>å°†å­—èŠ‚ç <strong>è§£é‡Š</strong>ä¸ºæœºå™¨ç ï¼Œä¸‹æ¬¡å³ä½¿é‡åˆ°ç›¸åŒçš„å­—èŠ‚ç ï¼Œä»ä¼šæ‰§è¡Œé‡å¤çš„è§£é‡Š</li><li>æ˜¯å°†å­—èŠ‚ç è§£é‡Šä¸ºé’ˆå¯¹æ‰€æœ‰å¹³å°éƒ½é€šç”¨çš„æœºå™¨ç </li></ul></li><li>å³æ—¶ç¼–è¯‘å™¨ <ul><li>å°†ä¸€äº›å­—èŠ‚ç <strong>ç¼–è¯‘</strong>ä¸ºæœºå™¨ç ï¼Œ<strong>å¹¶å­˜å…¥ Code Cache</strong>ï¼Œä¸‹æ¬¡é‡åˆ°ç›¸åŒçš„ä»£ç ï¼Œç›´æ¥æ‰§è¡Œï¼Œæ— éœ€å†ç¼–è¯‘</li><li>æ ¹æ®å¹³å°ç±»å‹ï¼Œç”Ÿæˆå¹³å°ç‰¹å®šçš„æœºå™¨ç </li></ul></li></ul><p>å¯¹äºå¤§éƒ¨åˆ†çš„ä¸å¸¸ç”¨çš„ä»£ç ï¼Œæˆ‘ä»¬æ— éœ€è€—è´¹æ—¶é—´å°†å…¶ç¼–è¯‘æˆæœºå™¨ç ï¼Œè€Œæ˜¯é‡‡å–è§£é‡Šæ‰§è¡Œçš„æ–¹å¼è¿è¡Œï¼›å¦ä¸€æ–¹é¢ï¼Œå¯¹äºä»…å æ®å°éƒ¨åˆ†çš„çƒ­ç‚¹ä»£ç ï¼Œæˆ‘ä»¬åˆ™å¯ä»¥å°†å…¶ç¼–è¯‘æˆæœºå™¨ç ï¼Œä»¥è¾¾åˆ°ç†æƒ³çš„è¿è¡Œé€Ÿåº¦ã€‚ æ‰§è¡Œæ•ˆç‡ä¸Šç®€å•æ¯”è¾ƒä¸€ä¸‹ Interpreter &lt; C1 &lt; C2ï¼Œæ€»çš„ç›®æ ‡æ˜¯å‘ç°çƒ­ç‚¹ä»£ç ï¼ˆhotspotåç§°çš„ç”± æ¥ï¼‰ï¼Œå¹¶ä¼˜åŒ–è¿™äº›çƒ­ç‚¹ä»£ç </p><p><strong>é€ƒé€¸åˆ†æ</strong>ï¼š</p><p>å‘ç°æ–°å»ºçš„å¯¹è±¡æ˜¯å¦é€ƒé€¸ã€‚å¯ä»¥ä½¿ç”¨ <code>-XX:- DoEscapeAnalysis</code> å…³é—­é€ƒé€¸åˆ†æ</p><h4 id="_2-æ–¹æ³•å†…è”" tabindex="-1"><a class="header-anchor" href="#_2-æ–¹æ³•å†…è”"><span>ï¼ˆ2ï¼‰æ–¹æ³•å†…è”</span></a></h4><p>ä¸¾ä¸ªæ —å­ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">private</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> int</span><span style="color:#88C0D0;"> square</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">final</span><span style="color:#81A1C1;"> int</span><span style="color:#D8DEE9FF;"> i</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    return</span><span style="color:#D8DEE9FF;"> i </span><span style="color:#81A1C1;">*</span><span style="color:#D8DEE9FF;"> i</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9;">System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#88C0D0;">square</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">9</span><span style="color:#ECEFF4;">))</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>å¦‚æœå‘ç° square æ˜¯çƒ­ç‚¹æ–¹æ³•ï¼Œå¹¶ä¸”é•¿åº¦ä¸å¤ªé•¿æ—¶ï¼Œä¼šè¿›è¡Œ<strong>å†…è”</strong>ï¼Œæ‰€è°“çš„å†…è”å°±æ˜¯æŠŠæ–¹æ³•å†…ä»£ç æ‹·è´ã€ ç²˜è´´åˆ°è°ƒç”¨è€…çš„ä½ç½®ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9;">System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">9</span><span style="color:#81A1C1;"> *</span><span style="color:#B48EAD;"> 9</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿˜èƒ½å¤Ÿè¿›è¡Œ<strong>å¸¸é‡æŠ˜å </strong>ï¼ˆconstant foldingï¼‰çš„ä¼˜åŒ–</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9;">System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">8</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> JIT2</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">    // -XX:+UnlockDiagnosticVMOptions -XX:+PrintInlining ï¼ˆè§£é”éšè—å‚æ•°ï¼‰æ‰“å°</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    inlining ä¿¡æ¯</span></span>
<span class="line"><span style="color:#616E88;">    // -XX:CompileCommand=dontinline,*JIT2.square ç¦æ­¢æŸä¸ªæ–¹æ³• inlining</span></span>
<span class="line"><span style="color:#616E88;">// -XX:+PrintCompilation æ‰“å°ç¼–è¯‘ä¿¡æ¯</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">        int</span><span style="color:#D8DEE9;"> x</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">        for</span><span style="color:#ECEFF4;"> (</span><span style="color:#81A1C1;">int</span><span style="color:#D8DEE9;"> i</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> i </span><span style="color:#81A1C1;">&lt;</span><span style="color:#B48EAD;"> 500</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> i</span><span style="color:#81A1C1;">++</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">            long</span><span style="color:#D8DEE9;"> start</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> System</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">nanoTime</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">            for</span><span style="color:#ECEFF4;"> (</span><span style="color:#81A1C1;">int</span><span style="color:#D8DEE9;"> j</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> j </span><span style="color:#81A1C1;">&lt;</span><span style="color:#B48EAD;"> 1000</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> j</span><span style="color:#81A1C1;">++</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9FF;">                x </span><span style="color:#81A1C1;">=</span><span style="color:#88C0D0;"> square</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">9</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">            }</span></span>
<span class="line"><span style="color:#81A1C1;">            long</span><span style="color:#D8DEE9;"> end</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> System</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">nanoTime</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">            System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">printf</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">%d</span><span style="color:#EBCB8B;">\t</span><span style="color:#A3BE8C;">%d</span><span style="color:#EBCB8B;">\t</span><span style="color:#A3BE8C;">%d</span><span style="color:#EBCB8B;">\n</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;">i</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;">x</span><span style="color:#ECEFF4;">,(</span><span style="color:#D8DEE9FF;">end </span><span style="color:#81A1C1;">-</span><span style="color:#D8DEE9FF;"> start</span><span style="color:#ECEFF4;">))</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#81A1C1;">    private</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> int</span><span style="color:#88C0D0;"> square</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">final</span><span style="color:#81A1C1;"> int</span><span style="color:#D8DEE9;"> i</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">        return</span><span style="color:#D8DEE9FF;"> i </span><span style="color:#81A1C1;">*</span><span style="color:#D8DEE9FF;"> i</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-å­—æ®µä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#_3-å­—æ®µä¼˜åŒ–"><span>ï¼ˆ3ï¼‰å­—æ®µä¼˜åŒ–</span></a></h4><p>JMH åŸºå‡†æµ‹è¯•è¯·å‚è€ƒï¼šhttp://openjdk.java.net/projects/code-tools/jmh/ åˆ›å»º maven å·¥ç¨‹ï¼Œæ·»åŠ ä¾èµ–å¦‚ä¸‹</p><div class="language-xml line-numbers-mode" data-highlighter="shiki" data-ext="xml" data-title="xml" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">&lt;dependency&gt;</span></span>
<span class="line"><span style="color:#81A1C1;">&lt;groupId&gt;</span><span style="color:#D8DEE9FF;">org.openjdk.jmh</span><span style="color:#81A1C1;">&lt;/groupId&gt;</span></span>
<span class="line"><span style="color:#81A1C1;">&lt;artifactId&gt;</span><span style="color:#D8DEE9FF;">jmh-core</span><span style="color:#81A1C1;">&lt;/artifactId&gt;</span></span>
<span class="line"><span style="color:#81A1C1;">&lt;version&gt;</span><span style="color:#D8DEE9FF;">${jmh.version}</span><span style="color:#81A1C1;">&lt;/version&gt;</span></span>
<span class="line"><span style="color:#81A1C1;">&lt;/dependency&gt;</span></span>
<span class="line"><span style="color:#81A1C1;">&lt;dependency&gt;</span></span>
<span class="line"><span style="color:#81A1C1;">&lt;groupId&gt;</span><span style="color:#D8DEE9FF;">org.openjdk.jmh</span><span style="color:#81A1C1;">&lt;/groupId&gt;</span></span>
<span class="line"><span style="color:#81A1C1;">&lt;artifactId&gt;</span><span style="color:#D8DEE9FF;">jmh-generator-annprocess</span><span style="color:#81A1C1;">&lt;/artifactId&gt;</span></span>
<span class="line"><span style="color:#81A1C1;">&lt;version&gt;</span><span style="color:#D8DEE9FF;">${jmh.version}</span><span style="color:#81A1C1;">&lt;/version&gt;</span></span>
<span class="line"><span style="color:#81A1C1;">&lt;scope&gt;</span><span style="color:#D8DEE9FF;">provided</span><span style="color:#81A1C1;">&lt;/scope&gt;</span></span>
<span class="line"><span style="color:#81A1C1;">&lt;/dependency&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">package</span><span style="color:#8FBCBB;"> test</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">import</span><span style="color:#8FBCBB;"> org</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">openjdk</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">jmh</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">annotations</span><span style="color:#ECEFF4;">.</span><span style="color:#81A1C1;">*;</span></span>
<span class="line"><span style="color:#81A1C1;">import</span><span style="color:#8FBCBB;"> org</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">openjdk</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">jmh</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">runner</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">Runner</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">import</span><span style="color:#8FBCBB;"> org</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">openjdk</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">jmh</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">runner</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">RunnerException</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">import</span><span style="color:#8FBCBB;"> org</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">openjdk</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">jmh</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">runner</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">options</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">Options</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">import</span><span style="color:#8FBCBB;"> org</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">openjdk</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">jmh</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">runner</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">options</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">OptionsBuilder</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">import</span><span style="color:#8FBCBB;"> java</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">util</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">Random</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">import</span><span style="color:#8FBCBB;"> java</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">util</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">concurrent</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">ThreadLocalRandom</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">@</span><span style="color:#D08770;">Warmup</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">iterations</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 2</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> time</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 1</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"><span style="color:#ECEFF4;">@</span><span style="color:#D08770;">Measurement</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">iterations</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 5</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> time</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 1</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"><span style="color:#ECEFF4;">@</span><span style="color:#D08770;">State</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">Scope</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">Benchmark</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Benchmark1</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    int</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> elements</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> randomInts</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">1_000</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    private</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> int</span><span style="color:#ECEFF4;">[]</span><span style="color:#88C0D0;"> randomInts</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">int</span><span style="color:#D8DEE9;"> size</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">        Random</span><span style="color:#D8DEE9;"> random</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> ThreadLocalRandom</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">current</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">        int</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> values</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#81A1C1;"> int</span><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">size</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">        for</span><span style="color:#ECEFF4;"> (</span><span style="color:#81A1C1;">int</span><span style="color:#D8DEE9;"> i</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> i </span><span style="color:#81A1C1;">&lt;</span><span style="color:#D8DEE9FF;"> size</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> i</span><span style="color:#81A1C1;">++</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9FF;">            values</span><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">i</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> random</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">nextInt</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#81A1C1;">        return</span><span style="color:#D8DEE9FF;"> values</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">    @</span><span style="color:#D08770;">Benchmark</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> test1</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">        for</span><span style="color:#ECEFF4;"> (</span><span style="color:#81A1C1;">int</span><span style="color:#D8DEE9;"> i</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> i </span><span style="color:#81A1C1;">&lt;</span><span style="color:#D8DEE9;"> elements</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">length</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> i</span><span style="color:#81A1C1;">++</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#88C0D0;">            doSum</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">elements</span><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">i</span><span style="color:#ECEFF4;">])</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">    @</span><span style="color:#D08770;">Benchmark</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> test2</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">        int</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> local</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> this</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">elements</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">        for</span><span style="color:#ECEFF4;"> (</span><span style="color:#81A1C1;">int</span><span style="color:#D8DEE9;"> i</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> i </span><span style="color:#81A1C1;">&lt;</span><span style="color:#D8DEE9;"> local</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">length</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> i</span><span style="color:#81A1C1;">++</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#88C0D0;">            doSum</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">local</span><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">i</span><span style="color:#ECEFF4;">])</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">    @</span><span style="color:#D08770;">Benchmark</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> test3</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">        for</span><span style="color:#ECEFF4;"> (</span><span style="color:#81A1C1;">int</span><span style="color:#D8DEE9;"> element</span><span style="color:#81A1C1;"> :</span><span style="color:#D8DEE9FF;"> elements</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#88C0D0;">            doSum</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">element</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#81A1C1;">    static</span><span style="color:#81A1C1;"> int</span><span style="color:#D8DEE9;"> sum</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    @</span><span style="color:#D08770;">CompilerControl</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">CompilerControl</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">Mode</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">INLINE</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"><span style="color:#81A1C1;">    static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> doSum</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">int</span><span style="color:#D8DEE9;"> x</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        sum </span><span style="color:#81A1C1;">+=</span><span style="color:#D8DEE9FF;"> x</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> throws</span><span style="color:#8FBCBB;"> RunnerException</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">        Options</span><span style="color:#D8DEE9;"> opt</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> OptionsBuilder</span><span style="color:#ECEFF4;">()</span></span>
<span class="line"><span style="color:#ECEFF4;">                .</span><span style="color:#88C0D0;">include</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">Benchmark1</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">class</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getSimpleName</span><span style="color:#ECEFF4;">())</span></span>
<span class="line"><span style="color:#ECEFF4;">                .</span><span style="color:#88C0D0;">forks</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">1</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"><span style="color:#ECEFF4;">                .</span><span style="color:#88C0D0;">build</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">        new</span><span style="color:#88C0D0;"> Runner</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">opt</span><span style="color:#ECEFF4;">).</span><span style="color:#88C0D0;">run</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é¦–å…ˆå¯ç”¨ doSum çš„æ–¹æ³•å†…è”ï¼Œæµ‹è¯•ç»“æœå¦‚ä¸‹ï¼ˆæ¯ç§’ååé‡ï¼Œåˆ†æ•°è¶Šé«˜çš„æ›´å¥½ï¼‰ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#8FBCBB;">Benchmark</span><span style="color:#8FBCBB;"> Mode</span><span style="color:#8FBCBB;"> Samples</span><span style="color:#8FBCBB;"> Score</span><span style="color:#8FBCBB;"> Score</span><span style="color:#D8DEE9FF;"> error </span><span style="color:#8FBCBB;">Units</span></span>
<span class="line"><span style="color:#D8DEE9;">t</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">Benchmark1</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">test1</span><span style="color:#D8DEE9FF;"> thrpt </span><span style="color:#B48EAD;">5</span><span style="color:#B48EAD;"> 2420286.539</span><span style="color:#B48EAD;"> 390747.467</span><span style="color:#D8DEE9FF;"> ops</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">s</span></span>
<span class="line"><span style="color:#D8DEE9;">t</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">Benchmark1</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">test2</span><span style="color:#D8DEE9FF;"> thrpt </span><span style="color:#B48EAD;">5</span><span style="color:#B48EAD;"> 2544313.594</span><span style="color:#B48EAD;"> 91304.136</span><span style="color:#D8DEE9FF;"> ops</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">s</span></span>
<span class="line"><span style="color:#D8DEE9;">t</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">Benchmark1</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">test3</span><span style="color:#D8DEE9FF;"> thrpt </span><span style="color:#B48EAD;">5</span><span style="color:#B48EAD;"> 2469176.697</span><span style="color:#B48EAD;"> 450570.647</span><span style="color:#D8DEE9FF;"> ops</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">s</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¥ä¸‹æ¥ç¦ç”¨ doSum æ–¹æ³•å†…è”</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">@</span><span style="color:#D08770;">CompilerControl</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">CompilerControl</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">Mode</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">DONT_INLINE</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"><span style="color:#81A1C1;">static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> doSum</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">int</span><span style="color:#D8DEE9FF;"> x</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9FF;">sum </span><span style="color:#81A1C1;">+=</span><span style="color:#D8DEE9FF;"> x</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æµ‹è¯•ç»“æœå¦‚ä¸‹ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#8FBCBB;">Benchmark</span><span style="color:#8FBCBB;"> Mode</span><span style="color:#8FBCBB;"> Samples</span><span style="color:#8FBCBB;"> Score</span><span style="color:#8FBCBB;"> Score</span><span style="color:#D8DEE9FF;"> error </span><span style="color:#8FBCBB;">Units</span></span>
<span class="line"><span style="color:#D8DEE9;">t</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">Benchmark1</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">test1</span><span style="color:#D8DEE9FF;"> thrpt </span><span style="color:#B48EAD;">5</span><span style="color:#B48EAD;"> 296141.478</span><span style="color:#B48EAD;"> 63649.220</span><span style="color:#D8DEE9FF;"> ops</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">s</span></span>
<span class="line"><span style="color:#D8DEE9;">t</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">Benchmark1</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">test2</span><span style="color:#D8DEE9FF;"> thrpt </span><span style="color:#B48EAD;">5</span><span style="color:#B48EAD;"> 371262.351</span><span style="color:#B48EAD;"> 83890.984</span><span style="color:#D8DEE9FF;"> ops</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">s</span></span>
<span class="line"><span style="color:#D8DEE9;">t</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">Benchmark1</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">test3</span><span style="color:#D8DEE9FF;"> thrpt </span><span style="color:#B48EAD;">5</span><span style="color:#B48EAD;"> 368960.847</span><span style="color:#B48EAD;"> 60163.391</span><span style="color:#D8DEE9FF;"> ops</span><span style="color:#81A1C1;">/</span><span style="color:#D8DEE9FF;">s</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åˆ†æï¼š åœ¨åˆšæ‰çš„ç¤ºä¾‹ä¸­ï¼ŒdoSum æ–¹æ³•æ˜¯å¦å†…è”ä¼šå½±å“ elements æˆå‘˜å˜é‡è¯»å–çš„ä¼˜åŒ–ï¼š å¦‚æœ doSum æ–¹æ³•å†…è”äº†ï¼Œåˆšæ‰çš„ test1 æ–¹æ³•ä¼šè¢«ä¼˜åŒ–æˆä¸‹é¢çš„æ ·å­ï¼ˆä¼ªä»£ç ï¼‰ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">@</span><span style="color:#D08770;">Benchmark</span></span>
<span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> test1</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">// elements.length é¦–æ¬¡è¯»å–ä¼šç¼“å­˜èµ·æ¥ -&gt; int[] local</span></span>
<span class="line"><span style="color:#81A1C1;">for</span><span style="color:#ECEFF4;"> (</span><span style="color:#81A1C1;">int</span><span style="color:#D8DEE9;"> i</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> i </span><span style="color:#81A1C1;">&lt;</span><span style="color:#D8DEE9;"> elements</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">length</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> i</span><span style="color:#81A1C1;">++</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span><span style="color:#616E88;"> // åç»­ 999 æ¬¡ æ±‚é•¿åº¦ &lt;- local</span></span>
<span class="line"><span style="color:#D8DEE9FF;">sum </span><span style="color:#81A1C1;">+=</span><span style="color:#D8DEE9FF;"> elements</span><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">i</span><span style="color:#ECEFF4;">]</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;"> // 1000 æ¬¡å–ä¸‹æ ‡ i çš„å…ƒç´  &lt;- local</span></span>
<span class="line"><span style="color:#ECEFF4;">   }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯ä»¥èŠ‚çœ 1999 æ¬¡ Field è¯»å–æ“ä½œ ä½†å¦‚æœ doSum æ–¹æ³•æ²¡æœ‰å†…è”ï¼Œåˆ™ä¸ä¼šè¿›è¡Œä¸Šé¢çš„ä¼˜åŒ– ç»ƒä¹ ï¼šåœ¨å†…è”æƒ…å†µä¸‹å°† elements æ·»åŠ  volatile ä¿®é¥°ç¬¦ï¼Œè§‚å¯Ÿæµ‹è¯•ç»“æœ</p><h3 id="_6-2-åå°„ä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#_6-2-åå°„ä¼˜åŒ–"><span>6.2 åå°„ä¼˜åŒ–</span></a></h3><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Reflect1</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">   public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> foo</span><span style="color:#ECEFF4;">()</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">      System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">foo...</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">   }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">   public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> throws</span><span style="color:#8FBCBB;"> NoSuchMethodException</span><span style="color:#ECEFF4;">,</span><span style="color:#8FBCBB;"> InvocationTargetException</span><span style="color:#ECEFF4;">,</span><span style="color:#8FBCBB;"> IllegalAccessException</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">      Method</span><span style="color:#D8DEE9;"> foo</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> Demo3</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">class</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getMethod</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">foo</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">      for</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">int</span><span style="color:#D8DEE9;"> i</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> i</span><span style="color:#81A1C1;">&lt;=</span><span style="color:#B48EAD;">16</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> i</span><span style="color:#81A1C1;">++</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">         foo</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">invoke</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">null</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">      }</span></span>
<span class="line"><span style="color:#ECEFF4;">   }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>foo.invoke å‰é¢ 0 ~ 15 æ¬¡è°ƒç”¨ä½¿ç”¨çš„æ˜¯ MethodAccessor çš„ NativeMethodAccessorImpl å®ç° invoke æ–¹æ³•æºç </p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">import</span><span style="color:#8FBCBB;"> java</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">lang</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">reflect</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">Method</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">import</span><span style="color:#8FBCBB;"> sun</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">reflect</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">misc</span><span style="color:#ECEFF4;">.</span><span style="color:#8FBCBB;">ReflectUtil</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">class</span><span style="color:#8FBCBB;"> NativeMethodAccessorImpl</span><span style="color:#81A1C1;"> extends</span><span style="color:#8FBCBB;font-weight:bold;"> MethodAccessorImpl</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    private</span><span style="color:#81A1C1;"> final</span><span style="color:#8FBCBB;"> Method</span><span style="color:#D8DEE9;"> method</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    private</span><span style="color:#8FBCBB;"> DelegatingMethodAccessorImpl</span><span style="color:#D8DEE9;"> parent</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    private</span><span style="color:#81A1C1;"> int</span><span style="color:#D8DEE9;"> numInvocations</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#88C0D0;">    NativeMethodAccessorImpl</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">Method</span><span style="color:#D8DEE9;"> method</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">        this</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">method</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9FF;"> method</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#8FBCBB;"> Object</span><span style="color:#88C0D0;"> invoke</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">Object</span><span style="color:#D8DEE9;"> target</span><span style="color:#ECEFF4;">,</span><span style="color:#8FBCBB;"> Object</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"><span style="color:#81A1C1;">            throws</span><span style="color:#8FBCBB;"> IllegalArgumentException</span><span style="color:#ECEFF4;">,</span><span style="color:#8FBCBB;"> InvocationTargetException</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">// inflationThreshold è†¨èƒ€é˜ˆå€¼ï¼Œé»˜è®¤ 15</span></span>
<span class="line"><span style="color:#81A1C1;">        if</span><span style="color:#ECEFF4;"> (</span><span style="color:#81A1C1;">++this</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">numInvocations</span><span style="color:#81A1C1;"> &gt;</span><span style="color:#D8DEE9;"> ReflectionFactory</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">inflationThreshold</span><span style="color:#ECEFF4;">()</span></span>
<span class="line"><span style="color:#81A1C1;">                &amp;&amp;</span><span style="color:#81A1C1;"> !</span><span style="color:#D8DEE9;">ReflectUtil</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">isVMAnonymousClass</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">this</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">method</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getDeclaringClass</span><span style="color:#ECEFF4;">()))</span></span>
<span class="line"><span style="color:#ECEFF4;">        {</span></span>
<span class="line"><span style="color:#616E88;">// ä½¿ç”¨ ASM åŠ¨æ€ç”Ÿæˆçš„æ–°å®ç°ä»£æ›¿æœ¬åœ°å®ç°ï¼Œé€Ÿåº¦è¾ƒæœ¬åœ°å®ç°å¿« 20 å€å·¦å³</span></span>
<span class="line"><span style="color:#8FBCBB;">            MethodAccessorImpl</span><span style="color:#D8DEE9;"> generatedMethodAccessor</span><span style="color:#81A1C1;"> =</span></span>
<span class="line"><span style="color:#ECEFF4;">                    (</span><span style="color:#D8DEE9FF;">MethodAccessorImpl</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"><span style="color:#ECEFF4;">                            (</span><span style="color:#81A1C1;">new</span><span style="color:#88C0D0;"> MethodAccessorGenerator</span><span style="color:#ECEFF4;">())</span></span>
<span class="line"><span style="color:#ECEFF4;">                                    .</span><span style="color:#88C0D0;">generateMethod</span><span style="color:#ECEFF4;">(</span></span>
<span class="line"><span style="color:#81A1C1;">                                            this</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">method</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getDeclaringClass</span><span style="color:#ECEFF4;">(),</span></span>
<span class="line"><span style="color:#81A1C1;">                                            this</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">method</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getName</span><span style="color:#ECEFF4;">(),</span></span>
<span class="line"><span style="color:#81A1C1;">                                            this</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">method</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getParameterTypes</span><span style="color:#ECEFF4;">(),</span></span>
<span class="line"><span style="color:#81A1C1;">                                            this</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">method</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getReturnType</span><span style="color:#ECEFF4;">(),</span></span>
<span class="line"><span style="color:#81A1C1;">                                            this</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">method</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getExceptionTypes</span><span style="color:#ECEFF4;">(),</span></span>
<span class="line"><span style="color:#81A1C1;">                                            this</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">method</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getModifiers</span><span style="color:#ECEFF4;">()</span></span>
<span class="line"><span style="color:#ECEFF4;">                                    )</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">            this</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">parent</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">setDelegate</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">generatedMethodAccessor</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#616E88;">// è°ƒç”¨æœ¬åœ°å®ç°</span></span>
<span class="line"><span style="color:#81A1C1;">        return</span><span style="color:#88C0D0;"> invoke0</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">this</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">method</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> target</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#81A1C1;">    void</span><span style="color:#88C0D0;"> setParent</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">DelegatingMethodAccessorImpl</span><span style="color:#D8DEE9;"> parent</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">        this</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">parent</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9FF;"> parent</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#81A1C1;">    private</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> native</span><span style="color:#8FBCBB;"> Object</span><span style="color:#88C0D0;"> invoke0</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">Method</span><span style="color:#D8DEE9;"> method</span><span style="color:#ECEFF4;">,</span><span style="color:#8FBCBB;"> Object</span><span style="color:#D8DEE9;"> target</span><span style="color:#ECEFF4;">,</span><span style="color:#8FBCBB;"> Object</span><span style="color:#ECEFF4;">[]</span></span>
<span class="line"><span style="color:#D8DEE9;">            args</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å½“è°ƒç”¨åˆ°ç¬¬ 16 æ¬¡ï¼ˆä»0å¼€å§‹ç®—ï¼‰æ—¶ï¼Œä¼šé‡‡ç”¨è¿è¡Œæ—¶ç”Ÿæˆçš„ç±»ä»£æ›¿æ‰æœ€åˆçš„å®ç°ï¼Œå¯ä»¥é€šè¿‡ debug å¾—åˆ° ç±»åä¸º sun.reflect.GeneratedMethodAccessor1 å¯ä»¥ä½¿ç”¨é˜¿é‡Œçš„ arthas å·¥å…·æŸ¥çœ‹ï¼š</p><p>java -jar arthas-boot.jar</p><h1 id="å››ã€å†…å­˜æ¨¡å‹" tabindex="-1"><a class="header-anchor" href="#å››ã€å†…å­˜æ¨¡å‹"><span>å››ã€å†…å­˜æ¨¡å‹</span></a></h1><ul><li>å¾ˆå¤šäººå°†ã€java å†…å­˜ç»“æ„ã€‘ä¸ã€java å†…å­˜æ¨¡å‹ã€‘å‚»å‚»åˆ†ä¸æ¸…ï¼Œã€java å†…å­˜æ¨¡å‹ã€‘æ˜¯ Java Memory Modelï¼ˆ<strong>JMM</strong>ï¼‰çš„æ„æ€ã€‚</li><li>ç®€å•çš„è¯´ï¼Œ<strong>JMM</strong> å®šä¹‰äº†ä¸€å¥—åœ¨å¤šçº¿ç¨‹è¯»å†™å…±äº«æ•°æ®æ—¶ï¼ˆæˆå‘˜å˜é‡ã€æ•°ç»„ï¼‰æ—¶ï¼Œå¯¹æ•°æ®çš„<strong>å¯è§æ€§</strong>ã€<strong>æœ‰åºæ€§</strong>ã€å’Œ<strong>åŸå­æ€§</strong>çš„è§„åˆ™å’Œä¿éšœ</li><li>JMM å³ Java Memory Modelï¼Œå®ƒå®šä¹‰äº†ä¸»å­˜ï¼ˆå…±äº«å†…å­˜ï¼‰ã€å·¥ä½œå†…å­˜ï¼ˆçº¿ç¨‹ç§æœ‰ï¼‰æŠ½è±¡æ¦‚å¿µï¼Œåº•å±‚å¯¹åº”ç€ CPU å¯„å­˜å™¨ã€ç¼“å­˜ã€ç¡¬ä»¶å†…å­˜ã€ CPU æŒ‡ä»¤ä¼˜åŒ–ç­‰ã€‚ JMM ä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ <ul><li>åŸå­æ€§ - ä¿è¯æŒ‡ä»¤ä¸ä¼šå—åˆ°çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢çš„å½±å“</li><li>å¯è§æ€§ - ä¿è¯æŒ‡ä»¤ä¸ä¼šå— cpu ç¼“å­˜çš„å½±å“</li><li>æœ‰åºæ€§ - ä¿è¯æŒ‡ä»¤ä¸ä¼šå— cpu æŒ‡ä»¤å¹¶è¡Œä¼˜åŒ–çš„å½±å“</li></ul></li></ul><h2 id="_1-åŸå­æ€§" tabindex="-1"><a class="header-anchor" href="#_1-åŸå­æ€§"><span>1. åŸå­æ€§</span></a></h2><h3 id="_1-1-é—®é¢˜è§£æ" tabindex="-1"><a class="header-anchor" href="#_1-1-é—®é¢˜è§£æ"><span>1-1 é—®é¢˜è§£æ</span></a></h3><p>æå‡ºé—®é¢˜ï¼šä¸¤ä¸ªçº¿ç¨‹å¯¹åˆå§‹å€¼ä¸º 0 çš„é™æ€å˜é‡ä¸€ä¸ªåšè‡ªå¢ï¼Œä¸€ä¸ªåšè‡ªå‡ï¼Œå„åš 5000 æ¬¡ï¼Œç»“æœæ˜¯ 0 å—ï¼Ÿ</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Demo1</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    static</span><span style="color:#81A1C1;"> int</span><span style="color:#D8DEE9;"> i</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> throws</span><span style="color:#8FBCBB;"> InterruptedException</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8FBCBB;">        Thread</span><span style="color:#D8DEE9;"> t1</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Thread</span><span style="color:#ECEFF4;">(()</span><span style="color:#8FBCBB;"> -&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">            for</span><span style="color:#ECEFF4;"> (</span><span style="color:#81A1C1;">int</span><span style="color:#D8DEE9;"> j</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> j </span><span style="color:#81A1C1;">&lt;</span><span style="color:#B48EAD;"> 50000</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> j</span><span style="color:#81A1C1;">++</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9FF;">                i</span><span style="color:#81A1C1;">++;</span></span>
<span class="line"><span style="color:#ECEFF4;">            }</span></span>
<span class="line"><span style="color:#ECEFF4;">        })</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#8FBCBB;">        Thread</span><span style="color:#D8DEE9;"> t2</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Thread</span><span style="color:#ECEFF4;">(()</span><span style="color:#8FBCBB;"> -&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">            for</span><span style="color:#ECEFF4;"> (</span><span style="color:#81A1C1;">int</span><span style="color:#D8DEE9;"> j</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> j </span><span style="color:#81A1C1;">&lt;</span><span style="color:#B48EAD;"> 50000</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> j</span><span style="color:#81A1C1;">++</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9FF;">                i</span><span style="color:#81A1C1;">--;</span></span>
<span class="line"><span style="color:#ECEFF4;">            }</span></span>
<span class="line"><span style="color:#ECEFF4;">        })</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        t1</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">start</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        t2</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">start</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        t1</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">join</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        t2</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">join</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">i</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»¥ä¸Šçš„ç»“æœå¯èƒ½æ˜¯æ­£æ•°ã€è´Ÿæ•°ã€é›¶ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸º Java ä¸­<strong>å¯¹é™æ€å˜é‡çš„è‡ªå¢ï¼Œè‡ªå‡</strong>å¹¶<strong>ä¸æ˜¯åŸå­æ“ä½œ</strong>ã€‚</p><p>ä¾‹å¦‚å¯¹äº <code>i++</code> è€Œè¨€ï¼ˆi ä¸ºé™æ€å˜é‡ï¼‰ï¼Œå®é™…ä¼šäº§ç”Ÿå¦‚ä¸‹çš„ JVM å­—èŠ‚ç æŒ‡ä»¤ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;">getstatic i </span><span style="color:#616E88;">// è·å–é™æ€å˜é‡içš„å€¼</span></span>
<span class="line"><span style="color:#D8DEE9FF;">iconst_1 </span><span style="color:#616E88;">// å‡†å¤‡å¸¸é‡1</span></span>
<span class="line"><span style="color:#D8DEE9FF;">iadd </span><span style="color:#616E88;">// åŠ æ³•</span></span>
<span class="line"><span style="color:#D8DEE9FF;">putstatic i </span><span style="color:#616E88;">// å°†ä¿®æ”¹åçš„å€¼å­˜å…¥é™æ€å˜é‡i</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è€Œå¯¹åº” <code>i--</code> ä¹Ÿæ˜¯ç±»ä¼¼ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;">getstatic i </span><span style="color:#616E88;">// è·å–é™æ€å˜é‡içš„å€¼</span></span>
<span class="line"><span style="color:#D8DEE9FF;">iconst_1 </span><span style="color:#616E88;">// å‡†å¤‡å¸¸é‡1</span></span>
<span class="line"><span style="color:#D8DEE9FF;">isub </span><span style="color:#616E88;">// å‡æ³•</span></span>
<span class="line"><span style="color:#D8DEE9FF;">putstatic i </span><span style="color:#616E88;">// å°†ä¿®æ”¹åçš„å€¼å­˜å…¥é™æ€å˜é‡i</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è€Œ Java çš„å†…å­˜æ¨¡å‹å¦‚ä¸‹ï¼Œå®Œæˆé™æ€å˜é‡çš„è‡ªå¢ï¼Œè‡ªå‡éœ€è¦åœ¨<strong>ä¸»å­˜</strong>å’Œ<strong>çº¿ç¨‹å†…å­˜</strong>ä¸­è¿›è¡Œæ•°æ®äº¤æ¢ï¼š</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407152130988.png" alt="image-20240715213034845" tabindex="0" loading="lazy"><figcaption>image-20240715213034845</figcaption></figure><p>å¦‚æœæ˜¯å•çº¿ç¨‹ä»¥ä¸Š 8 è¡Œä»£ç æ˜¯é¡ºåºæ‰§è¡Œï¼ˆä¸ä¼šäº¤é”™ï¼‰æ²¡æœ‰é—®é¢˜ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// å‡è®¾içš„åˆå§‹å€¼ä¸º0</span></span>
<span class="line"><span style="color:#D8DEE9FF;">getstatic i </span><span style="color:#616E88;">// çº¿ç¨‹1-è·å–é™æ€å˜é‡içš„å€¼ çº¿ç¨‹å†…i=0</span></span>
<span class="line"><span style="color:#D8DEE9FF;">iconst_1 </span><span style="color:#616E88;">// çº¿ç¨‹1-å‡†å¤‡å¸¸é‡1</span></span>
<span class="line"><span style="color:#D8DEE9FF;">iadd </span><span style="color:#616E88;">// çº¿ç¨‹1-è‡ªå¢ çº¿ç¨‹å†…i=1</span></span>
<span class="line"><span style="color:#D8DEE9FF;">putstatic i </span><span style="color:#616E88;">// çº¿ç¨‹1-å°†ä¿®æ”¹åçš„å€¼å­˜å…¥é™æ€å˜é‡i é™æ€å˜é‡i=1</span></span>
<span class="line"><span style="color:#D8DEE9FF;">getstatic i </span><span style="color:#616E88;">// çº¿ç¨‹1-è·å–é™æ€å˜é‡içš„å€¼ çº¿ç¨‹å†…i=1</span></span>
<span class="line"><span style="color:#D8DEE9FF;">iconst_1 </span><span style="color:#616E88;">// çº¿ç¨‹1-å‡†å¤‡å¸¸é‡1</span></span>
<span class="line"><span style="color:#D8DEE9FF;">isub </span><span style="color:#616E88;">// çº¿ç¨‹1-è‡ªå‡ çº¿ç¨‹å†…i=0</span></span>
<span class="line"><span style="color:#D8DEE9FF;">putstatic i </span><span style="color:#616E88;">// çº¿ç¨‹1-å°†ä¿®æ”¹åçš„å€¼å­˜å…¥é™æ€å˜é‡i é™æ€å˜é‡i=0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½†å¤šçº¿ç¨‹ä¸‹è¿™ 8 è¡Œä»£ç å¯èƒ½äº¤é”™è¿è¡Œï¼ˆä¸ºä»€ä¹ˆä¼šäº¤é”™ï¼Ÿæ€è€ƒä¸€ä¸‹ï¼‰ï¼š å‡ºç°è´Ÿæ•°çš„æƒ…å†µï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// å‡è®¾içš„åˆå§‹å€¼ä¸º0</span></span>
<span class="line"><span style="color:#D8DEE9FF;">getstatic i </span><span style="color:#616E88;">// çº¿ç¨‹1-è·å–é™æ€å˜é‡içš„å€¼ çº¿ç¨‹å†…i=0</span></span>
<span class="line"><span style="color:#D8DEE9FF;">getstatic i </span><span style="color:#616E88;">// çº¿ç¨‹2-è·å–é™æ€å˜é‡içš„å€¼ çº¿ç¨‹å†…i=0</span></span>
<span class="line"><span style="color:#D8DEE9FF;">iconst_1 </span><span style="color:#616E88;">// çº¿ç¨‹1-å‡†å¤‡å¸¸é‡1</span></span>
<span class="line"><span style="color:#D8DEE9FF;">iadd </span><span style="color:#616E88;">// çº¿ç¨‹1-è‡ªå¢ çº¿ç¨‹å†…i=1</span></span>
<span class="line"><span style="color:#D8DEE9FF;">putstatic i </span><span style="color:#616E88;">// çº¿ç¨‹1-å°†ä¿®æ”¹åçš„å€¼å­˜å…¥é™æ€å˜é‡i é™æ€å˜é‡i=1</span></span>
<span class="line"><span style="color:#D8DEE9FF;">iconst_1 </span><span style="color:#616E88;">// çº¿ç¨‹2-å‡†å¤‡å¸¸é‡1</span></span>
<span class="line"><span style="color:#D8DEE9FF;">isub </span><span style="color:#616E88;">// çº¿ç¨‹2-è‡ªå‡ çº¿ç¨‹å†…i=-1</span></span>
<span class="line"><span style="color:#D8DEE9FF;">putstatic i </span><span style="color:#616E88;">// çº¿ç¨‹2-å°†ä¿®æ”¹åçš„å€¼å­˜å…¥é™æ€å˜é‡i é™æ€å˜é‡i=-1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å‡ºç°æ­£æ•°çš„æƒ…å†µï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// å‡è®¾içš„åˆå§‹å€¼ä¸º0</span></span>
<span class="line"><span style="color:#D8DEE9FF;">getstatic i </span><span style="color:#616E88;">// çº¿ç¨‹1-è·å–é™æ€å˜é‡içš„å€¼ çº¿ç¨‹å†…i=0</span></span>
<span class="line"><span style="color:#D8DEE9FF;">getstatic i </span><span style="color:#616E88;">// çº¿ç¨‹2-è·å–é™æ€å˜é‡içš„å€¼ çº¿ç¨‹å†…i=0</span></span>
<span class="line"><span style="color:#D8DEE9FF;">iconst_1 </span><span style="color:#616E88;">// çº¿ç¨‹1-å‡†å¤‡å¸¸é‡1</span></span>
<span class="line"><span style="color:#D8DEE9FF;">iadd </span><span style="color:#616E88;">// çº¿ç¨‹1-è‡ªå¢ çº¿ç¨‹å†…i=1</span></span>
<span class="line"><span style="color:#D8DEE9FF;">iconst_1 </span><span style="color:#616E88;">// çº¿ç¨‹2-å‡†å¤‡å¸¸é‡1</span></span>
<span class="line"><span style="color:#D8DEE9FF;">isub </span><span style="color:#616E88;">// çº¿ç¨‹2-è‡ªå‡ çº¿ç¨‹å†…i=-1</span></span>
<span class="line"><span style="color:#D8DEE9FF;">putstatic i </span><span style="color:#616E88;">// çº¿ç¨‹2-å°†ä¿®æ”¹åçš„å€¼å­˜å…¥é™æ€å˜é‡i é™æ€å˜é‡i=-1</span></span>
<span class="line"><span style="color:#D8DEE9FF;">putstatic i </span><span style="color:#616E88;">// çº¿ç¨‹1-å°†ä¿®æ”¹åçš„å€¼å­˜å…¥é™æ€å˜é‡i é™æ€å˜é‡i=1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-2-è§£å†³æ–¹æ³•-åŠ é”" tabindex="-1"><a class="header-anchor" href="#_1-2-è§£å†³æ–¹æ³•-åŠ é”"><span>1-2 è§£å†³æ–¹æ³• -åŠ é”</span></a></h3><h4 id="_1-synchronized-åŒæ­¥å…³é”®å­—" tabindex="-1"><a class="header-anchor" href="#_1-synchronized-åŒæ­¥å…³é”®å­—"><span>ï¼ˆ1ï¼‰synchronizedï¼ˆåŒæ­¥å…³é”®å­—ï¼‰</span></a></h4><p>è¯­æ³•ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">synchronized</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;"> å¯¹è±¡ </span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    è¦ä½œä¸ºåŸå­æ“ä½œä»£ç </span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç”¨ <code>synchronized</code> è§£å†³å¹¶å‘é—®é¢˜ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Demo1</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    static</span><span style="color:#81A1C1;"> int</span><span style="color:#D8DEE9;"> i</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    static</span><span style="color:#8FBCBB;"> Object</span><span style="color:#D8DEE9;"> obj</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Object</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> throws</span><span style="color:#8FBCBB;"> InterruptedException</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8FBCBB;">        Thread</span><span style="color:#D8DEE9;"> t1</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Thread</span><span style="color:#ECEFF4;">(()</span><span style="color:#8FBCBB;"> -&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">            for</span><span style="color:#ECEFF4;"> (</span><span style="color:#81A1C1;">int</span><span style="color:#D8DEE9;"> j</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> j </span><span style="color:#81A1C1;">&lt;</span><span style="color:#B48EAD;"> 50000</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> j</span><span style="color:#81A1C1;">++</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">                synchronized</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9FF;">obj</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9FF;">                    i</span><span style="color:#81A1C1;">++;</span></span>
<span class="line"><span style="color:#ECEFF4;">                }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ECEFF4;">            }</span></span>
<span class="line"><span style="color:#ECEFF4;">        })</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#8FBCBB;">        Thread</span><span style="color:#D8DEE9;"> t2</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Thread</span><span style="color:#ECEFF4;">(()</span><span style="color:#8FBCBB;"> -&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">            for</span><span style="color:#ECEFF4;"> (</span><span style="color:#81A1C1;">int</span><span style="color:#D8DEE9;"> j</span><span style="color:#81A1C1;"> =</span><span style="color:#B48EAD;"> 0</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> j </span><span style="color:#81A1C1;">&lt;</span><span style="color:#B48EAD;"> 50000</span><span style="color:#81A1C1;">;</span><span style="color:#D8DEE9FF;"> j</span><span style="color:#81A1C1;">++</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">                synchronized</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9FF;">obj</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9FF;">                    i</span><span style="color:#81A1C1;">--;</span></span>
<span class="line"><span style="color:#ECEFF4;">                }</span></span>
<span class="line"><span style="color:#ECEFF4;">            }</span></span>
<span class="line"><span style="color:#ECEFF4;">        })</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        t1</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">start</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        t2</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">start</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        t1</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">join</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        t2</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">join</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        System</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">out</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">println</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">i</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span><span style="color:#616E88;">//è¾“å‡ºä¸º0</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>ä¸ºä»€ä¹ˆéœ€è¦è¿™é‡Œçš„ <code>obj</code> å¯¹è±¡å‘¢ï¼Ÿ</p></blockquote><p>æˆ‘ä»¬å¯ä»¥è¿™æ ·ç†è§£ï¼šå¯ä»¥æŠŠ obj æƒ³è±¡æˆä¸€ä¸ªæˆ¿é—´ï¼Œçº¿ç¨‹ t1ï¼Œt2 æƒ³è±¡æˆä¸¤ä¸ªäººã€‚</p><p>å½“çº¿ç¨‹ t1 æ‰§è¡Œåˆ° <code>synchronized(obj)</code> æ—¶å°±å¥½æ¯” t1 è¿›å…¥äº†è¿™ä¸ªæˆ¿é—´ï¼Œå¹¶åæ‰‹é”ä½äº†é—¨ï¼Œåœ¨é—¨å†…æ‰§è¡Œ count++ ä»£ç ã€‚</p><p>è¿™æ—¶å€™å¦‚æœ t2 ä¹Ÿè¿è¡Œåˆ°äº† <code>synchronized(obj)</code> æ—¶ï¼Œå®ƒå‘ç°é—¨è¢«é”ä½äº†ï¼Œåªèƒ½åœ¨é—¨å¤–ç­‰å¾…ã€‚</p><p>å½“ t1 æ‰§è¡Œå®Œ <code>synchronized{}</code> å—å†…çš„ä»£ç ï¼Œè¿™æ—¶å€™æ‰ä¼šè§£å¼€é—¨ä¸Šçš„é”ï¼Œä» obj æˆ¿é—´å‡ºæ¥ã€‚t2 çº¿ç¨‹è¿™æ—¶æ‰å¯ä»¥è¿›å…¥ obj æˆ¿é—´ï¼Œåé”ä½é—¨ï¼Œæ‰§è¡Œå®ƒçš„ count-- ä»£ç ã€‚</p><blockquote><p>æ€ä¹ˆä»JVMè§’åº¦ç†è§£å‘¢ï¼Ÿï¼ˆè¿™é‡Œå¼•ç”¨ã€ŠJavaå¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯ã€‹é‡Œçš„ä¸€æ®µè¯ï¼‰</p></blockquote><p>ä»JVMè§„èŒƒä¸­å¯ä»¥çœ‹åˆ°<code>Synchonized</code>åœ¨JVMé‡Œçš„å®ç°åŸç†ï¼ŒJVMåŸºäºè¿›å…¥å’Œé€€å‡º<code>Monitor</code>å¯¹è±¡æ¥å®ç°æ–¹æ³•åŒæ­¥å’Œä»£ç å—åŒæ­¥ï¼Œä½†ä¸¤è€…çš„å®ç°ç»†èŠ‚ä¸ä¸€æ ·ã€‚ä»£ç å—åŒæ­¥æ˜¯ä½¿ç”¨<code>monitorenter</code> å’Œ<code>monitorexit</code>æŒ‡ä»¤å®ç°çš„ã€‚ <code>monitorenter</code>æŒ‡ä»¤æ˜¯åœ¨ç¼–è¯‘åæ’å…¥åˆ°åŒæ­¥ä»£ç å—çš„<strong>å¼€å§‹ä½ç½®</strong>ï¼Œè€Œ<code>monitorexit</code>æ˜¯æ’å…¥åˆ°<strong>æ–¹æ³•ç»“æŸå¤„</strong>å’Œ<strong>å¼‚å¸¸å¤„</strong>ï¼ŒJVMè¦ä¿è¯æ¯ä¸ª<code>monitorenter</code>å¿…é¡»æœ‰å¯¹åº”çš„<code>monitorexit</code>ä¸ä¹‹é…å¯¹ã€‚ä»»ä½•å¯¹è±¡éƒ½æœ‰ä¸€ä¸ª<code>monitor</code>ä¸ä¹‹å…³è”ï¼Œå½“ä¸”ä¸€ä¸ª<code>monitor</code>è¢«æŒæœ‰åï¼Œå®ƒå°†å¤„äºé”å®šçŠ¶æ€ã€‚çº¿ç¨‹æ‰§è¡Œåˆ°<code>monitorenter</code> æŒ‡ä»¤æ—¶ï¼Œå°†ä¼šå°è¯•è·å–å¯¹è±¡æ‰€å¯¹åº”çš„<code>monitor</code>çš„æ‰€æœ‰æƒï¼Œå³å°è¯•è·å¾—å¯¹è±¡çš„é”ã€‚</p><h2 id="_2-å¯è§æ€§" tabindex="-1"><a class="header-anchor" href="#_2-å¯è§æ€§"><span>2.å¯è§æ€§</span></a></h2><h4 id="_2-1-é€€ä¸å‡ºçš„å¾ªç¯" tabindex="-1"><a class="header-anchor" href="#_2-1-é€€ä¸å‡ºçš„å¾ªç¯"><span>2-1 é€€ä¸å‡ºçš„å¾ªç¯</span></a></h4><p>å…ˆæ¥çœ‹ä¸€ä¸ªç°è±¡ï¼Œmain çº¿ç¨‹å¯¹ run å˜é‡çš„ä¿®æ”¹å¯¹äº t çº¿ç¨‹ä¸å¯è§ï¼Œå¯¼è‡´äº† t çº¿ç¨‹æ— æ³•åœæ­¢ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">static</span><span style="color:#81A1C1;"> boolean</span><span style="color:#D8DEE9;"> run</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> true;</span></span>
<span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9FF;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9FF;"> throws InterruptedException </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#8FBCBB;">    Thread</span><span style="color:#D8DEE9;"> t</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Thread</span><span style="color:#ECEFF4;">(()</span><span style="color:#8FBCBB;">-&gt;</span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#81A1C1;">        while</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">run</span><span style="color:#ECEFF4;">){</span></span>
<span class="line"><span style="color:#616E88;">            // ....</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#ECEFF4;">    })</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    t</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">start</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">    Thread</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">sleep</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">1000</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">    run </span><span style="color:#81A1C1;">=</span><span style="color:#81A1C1;"> false;</span><span style="color:#616E88;"> // çº¿ç¨‹tä¸ä¼šå¦‚é¢„æƒ³çš„åœä¸‹æ¥</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿ</p><ol><li>åˆå§‹çŠ¶æ€ï¼Œ t çº¿ç¨‹åˆšå¼€å§‹ä»ä¸»å†…å­˜è¯»å–äº† run çš„å€¼åˆ°å·¥ä½œå†…å­˜ã€‚</li></ol><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407152221819.png" alt="image-20240715222147607" tabindex="0" loading="lazy"><figcaption>image-20240715222147607</figcaption></figure><ol start="2"><li>å› ä¸º t çº¿ç¨‹è¦é¢‘ç¹ä»<strong>ä¸»å†…å­˜</strong>ä¸­è¯»å– run çš„å€¼ï¼Œ<strong>JIT ç¼–è¯‘å™¨</strong>ä¼šå°† run çš„å€¼ç¼“å­˜è‡³è‡ªå·±å·¥ä½œå†…å­˜ä¸­çš„<strong>é«˜é€Ÿç¼“å­˜</strong>ä¸­ï¼Œå‡å°‘å¯¹ä¸»å­˜ä¸­ run çš„è®¿é—®ï¼Œæé«˜æ•ˆç‡</li></ol><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407152223824.png" alt="image-20240715222337696" tabindex="0" loading="lazy"><figcaption>image-20240715222337696</figcaption></figure><ol start="3"><li>1 ç§’ä¹‹åï¼Œmain çº¿ç¨‹ä¿®æ”¹äº† run çš„å€¼ï¼Œå¹¶åŒæ­¥è‡³ä¸»å­˜ï¼Œè€Œ t æ˜¯ä»è‡ªå·±å·¥ä½œå†…å­˜ä¸­çš„é«˜é€Ÿç¼“å­˜ä¸­è¯»å–è¿™ä¸ªå˜é‡çš„å€¼ï¼Œç»“æœæ°¸è¿œæ˜¯æ—§å€¼</li></ol><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407152224719.png" alt="image-20240715222432570" tabindex="0" loading="lazy"><figcaption>image-20240715222432570</figcaption></figure><h4 id="_2-2-è§£å†³åŠæ³•" tabindex="-1"><a class="header-anchor" href="#_2-2-è§£å†³åŠæ³•"><span>2-2 è§£å†³åŠæ³•</span></a></h4><h5 id="_1-volatile-æ˜“å˜å…³é”®å­—" tabindex="-1"><a class="header-anchor" href="#_1-volatile-æ˜“å˜å…³é”®å­—"><span>ï¼ˆ1ï¼‰volatileï¼ˆæ˜“å˜å…³é”®å­—ï¼‰</span></a></h5><p>å®ƒå¯ä»¥ç”¨æ¥ä¿®é¥°<strong>æˆå‘˜å˜é‡</strong>å’Œ<strong>é™æ€æˆå‘˜å˜é‡</strong>ï¼Œä»–å¯ä»¥é¿å…çº¿ç¨‹ä»è‡ªå·±çš„å·¥ä½œç¼“å­˜ä¸­æŸ¥æ‰¾å˜é‡çš„å€¼ï¼Œå¿…é¡»åˆ°ä¸»å­˜ä¸­è·å–å®ƒçš„å€¼ï¼Œçº¿ç¨‹æ“ä½œ <strong>volatile</strong> å˜é‡éƒ½æ˜¯ç›´æ¥æ“ä½œä¸»å­˜ï¼Œä¿è¯äº†å…±äº«å˜é‡çš„<strong>å¯è§æ€§</strong>ï¼Œä½†<strong>ä¸èƒ½ä¿è¯åŸå­æ€§</strong></p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Demo1</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    volatile</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> boolean</span><span style="color:#D8DEE9;"> run</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> true;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> static</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> main</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">String</span><span style="color:#ECEFF4;">[]</span><span style="color:#D8DEE9;"> args</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> throws</span><span style="color:#8FBCBB;"> InterruptedException</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#8FBCBB;">        Thread</span><span style="color:#D8DEE9;"> t</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> Thread</span><span style="color:#ECEFF4;">(()</span><span style="color:#8FBCBB;"> -&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">            while</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9FF;">run</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">// ....</span></span>
<span class="line"><span style="color:#ECEFF4;">            }</span></span>
<span class="line"><span style="color:#ECEFF4;">        })</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        t</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">start</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">        Thread</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">sleep</span><span style="color:#ECEFF4;">(</span><span style="color:#B48EAD;">1000</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">        run </span><span style="color:#81A1C1;">=</span><span style="color:#81A1C1;"> false;</span><span style="color:#616E88;"> // çº¿ç¨‹tå¦‚é¢„æƒ³çš„åœä¸‹æ¥</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>æ³¨æ„</strong>ï¼š</p><p><code>synchronized</code> è¯­å¥å—æ—¢å¯ä»¥ä¿è¯ä»£ç å—çš„<strong>åŸå­æ€§</strong>ï¼Œä¹ŸåŒæ—¶ä¿è¯ä»£ç å—å†…å˜é‡çš„<strong>å¯è§æ€§</strong>ã€‚ä½† ç¼ºç‚¹æ˜¯<code>synchronized</code>æ˜¯å±äºé‡é‡çº§æ“ä½œï¼Œ<strong>æ€§èƒ½ç›¸å¯¹æ›´ä½</strong></p><p>å¦‚æœåœ¨å‰é¢ç¤ºä¾‹çš„æ­»å¾ªç¯ä¸­åŠ å…¥ <code>System.out.println()</code> ä¼šå‘ç°å³ä½¿ä¸åŠ  volatile ä¿®é¥°ç¬¦ï¼Œçº¿ç¨‹ t ä¹Ÿ èƒ½æ­£ç¡®çœ‹åˆ°å¯¹ run å˜é‡çš„ä¿®æ”¹äº†ï¼Œæƒ³ä¸€æƒ³ä¸ºä»€ä¹ˆï¼Ÿ</p></blockquote><p>è¿›å…¥<code>println</code>æºç ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> println</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">int</span><span style="color:#D8DEE9FF;"> x</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    synchronized</span><span style="color:#ECEFF4;"> (</span><span style="color:#81A1C1;">this</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#88C0D0;">        print</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">x</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#88C0D0;">        newLine</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯ä»¥çœ‹å‡ºåŠ äº†<code>synchronized</code>ï¼Œä¿è¯äº†æ¯æ¬¡<code>run</code>å˜é‡éƒ½ä¼šä»ä¸»å­˜ä¸­è·å–</p><h3 id="_2-3-å¯è§æ€§" tabindex="-1"><a class="header-anchor" href="#_2-3-å¯è§æ€§"><span>2-3 å¯è§æ€§</span></a></h3><p>å‰é¢ä¾‹å­ä½“ç°çš„å®é™…å°±æ˜¯å¯è§æ€§ï¼Œå®ƒä¿è¯çš„æ˜¯åœ¨å¤šä¸ªçº¿ç¨‹ä¹‹é—´ï¼Œä¸€ä¸ªçº¿ç¨‹å¯¹ volatile å˜é‡çš„ä¿®æ”¹å¯¹å¦ä¸€ ä¸ªçº¿ç¨‹å¯è§ï¼Œ ä¸èƒ½ä¿è¯åŸå­æ€§ï¼Œä»…ç”¨åœ¨ä¸€ä¸ªå†™çº¿ç¨‹ï¼Œå¤šä¸ªè¯»çº¿ç¨‹çš„æƒ…å†µï¼š ä¸Šä¾‹ä»å­—èŠ‚ç ç†è§£æ˜¯è¿™æ ·çš„ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;">getstatic run </span><span style="color:#616E88;">// çº¿ç¨‹ t è·å– run true</span></span>
<span class="line"><span style="color:#D8DEE9FF;">getstatic run </span><span style="color:#616E88;">// çº¿ç¨‹ t è·å– run true</span></span>
<span class="line"><span style="color:#D8DEE9FF;">getstatic run </span><span style="color:#616E88;">// çº¿ç¨‹ t è·å– run true</span></span>
<span class="line"><span style="color:#D8DEE9FF;">getstatic run </span><span style="color:#616E88;">// çº¿ç¨‹ t è·å– run true</span></span>
<span class="line"><span style="color:#D8DEE9FF;">putstatic run </span><span style="color:#616E88;">// çº¿ç¨‹ main ä¿®æ”¹ run ä¸º falseï¼Œ ä»…æ­¤ä¸€æ¬¡</span></span>
<span class="line"><span style="color:#D8DEE9FF;">getstatic run </span><span style="color:#616E88;">// çº¿ç¨‹ t è·å– run false</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¯”è¾ƒä¸€ä¸‹ä¹‹å‰æˆ‘ä»¬å°†çº¿ç¨‹å®‰å…¨æ—¶ä¸¾çš„ä¾‹å­ï¼šä¸¤ä¸ªçº¿ç¨‹ä¸€ä¸ª i++ ä¸€ä¸ª i-- ï¼Œåªèƒ½ä¿è¯çœ‹åˆ°æœ€æ–°å€¼ï¼Œä¸èƒ½è§£ å†³æŒ‡ä»¤äº¤é”™</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// å‡è®¾içš„åˆå§‹å€¼ä¸º0</span></span>
<span class="line"><span style="color:#D8DEE9FF;">getstatic i </span><span style="color:#616E88;">// çº¿ç¨‹1-è·å–é™æ€å˜é‡içš„å€¼ çº¿ç¨‹å†…i=0</span></span>
<span class="line"><span style="color:#D8DEE9FF;">getstatic i </span><span style="color:#616E88;">// çº¿ç¨‹2-è·å–é™æ€å˜é‡içš„å€¼ çº¿ç¨‹å†…i=0</span></span>
<span class="line"><span style="color:#D8DEE9FF;">iconst_1 </span><span style="color:#616E88;">// çº¿ç¨‹1-å‡†å¤‡å¸¸é‡1</span></span>
<span class="line"><span style="color:#D8DEE9FF;">iadd </span><span style="color:#616E88;">// çº¿ç¨‹1-è‡ªå¢ çº¿ç¨‹å†…i=1</span></span>
<span class="line"><span style="color:#D8DEE9FF;">putstatic i </span><span style="color:#616E88;">// çº¿ç¨‹1-å°†ä¿®æ”¹åçš„å€¼å­˜å…¥é™æ€å˜é‡i é™æ€å˜é‡i=1</span></span>
<span class="line"><span style="color:#D8DEE9FF;">iconst_1 </span><span style="color:#616E88;">// çº¿ç¨‹2-å‡†å¤‡å¸¸é‡1</span></span>
<span class="line"><span style="color:#D8DEE9FF;">isub </span><span style="color:#616E88;">// çº¿ç¨‹2-è‡ªå‡ çº¿ç¨‹å†…i=-1</span></span>
<span class="line"><span style="color:#D8DEE9FF;">putstatic i </span><span style="color:#616E88;">// çº¿ç¨‹2-å°†ä¿®æ”¹åçš„å€¼å­˜å…¥é™æ€å˜é‡i é™æ€å˜é‡i=-1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è™šæ‹Ÿæœºè°ƒä¼˜</p><h1 id="å‚è€ƒ" tabindex="-1"><a class="header-anchor" href="#å‚è€ƒ"><span>å‚è€ƒï¼š</span></a></h1><p>å‚è€ƒæ–‡ç« ï¼šhttps://blog.csdn.net/qq_45966440/article/details/120824295?spm=1001.2014.3001.5502</p><p>å‚è€ƒæ–‡ç« ï¼šhttps://blog.csdn.net/weixin_50280576/article/details/113742011</p><p>å‚è€ƒè§†é¢‘ï¼šhttps://www.bilibili.com/video/BV1yE411Z7AP?p=19&amp;spm_id_from=pageDriver&amp;vd_source=cd81f8812505504b960957155cd81114</p></div><!----><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><div class="contributors"><span class="vp-meta-label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="vp-meta-info" title="email: 2843768@qq.com">reniunai</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/note/java/juced.html" aria-label="Javaå¹¶å‘åŒ…"><div class="hint"><span class="arrow start"></span>ä¸Šä¸€é¡µ</div><div class="link"><span class="font-icon icon fa-fw fa-sm fas fa-file" style=""></span>Javaå¹¶å‘åŒ…</div></a><a class="route-link auto-link next" href="/note/java/SpringSecurity.html" aria-label="SpringSecurity"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow end"></span></div><div class="link">SpringSecurity<span class="font-icon icon fa-fw fa-sm fas fa-file" style=""></span></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper"><!----><!----></footer></div><!--]--><!--[--><!----><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-zamys2Ga.js" defer></script>
  </body>
</html>
