<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.14" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.51" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://reniunai.github.io/note/es/es%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95.html"><meta property="og:site_name" content="çƒ­ç‰›å¥¶"><meta property="og:title" content="æ•°æ®åŒæ­¥åˆ°Elasticsearch"><meta property="og:description" content="æ•°æ®åŒæ­¥åˆ°Elasticsearchï¼ŒåŒæ­¥å†™ï¼Œå¼‚æ­¥å†™ï¼Œä¸­é—´ä»¶å®ç°åŒæ­¥ã€‚"><meta property="og:type" content="article"><meta property="og:image" content="https://reniunai.github.io/assets/images/cover1.jpg"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2024-08-05T08:48:07.000Z"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image:src" content="https://reniunai.github.io/assets/images/cover1.jpg"><meta name="twitter:image:alt" content="æ•°æ®åŒæ­¥åˆ°Elasticsearch"><meta property="article:author" content="HotMilk"><meta property="article:tag" content="elasticsearch"><meta property="article:tag" content="æ•°æ®åŒæ­¥"><meta property="article:published_time" content="2024-07-15T00:00:00.000Z"><meta property="article:modified_time" content="2024-08-05T08:48:07.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"æ•°æ®åŒæ­¥åˆ°Elasticsearch","image":["https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407231954667.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407231954673.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407231954684.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407231954670.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407231954677.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407231954708.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407231954291.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407231954361.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407231954484.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407231954706.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407241747556.png","https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407241749128.png"],"datePublished":"2024-07-15T00:00:00.000Z","dateModified":"2024-08-05T08:48:07.000Z","author":[{"@type":"Person","name":"HotMilk"}]}</script><title>æ•°æ®åŒæ­¥åˆ°Elasticsearch | çƒ­ç‰›å¥¶</title><meta name="description" content="æ•°æ®åŒæ­¥åˆ°Elasticsearchï¼ŒåŒæ­¥å†™ï¼Œå¼‚æ­¥å†™ï¼Œä¸­é—´ä»¶å®ç°åŒæ­¥ã€‚">
    <link rel="preload" href="/assets/style-DqX65dVc.css" as="style"><link rel="stylesheet" href="/assets/style-DqX65dVc.css">
    <link rel="modulepreload" href="/assets/app-CfDCVS1X.js"><link rel="modulepreload" href="/assets/esåŸºç¡€è¯­æ³•.html-CxesGTNy.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper-DlAUqK2U.js">
    <link rel="prefetch" href="/assets/index.html-BIZri0Ys.js" as="script"><link rel="prefetch" href="/assets/intro.html-BkT-fjqa.js" as="script"><link rel="prefetch" href="/assets/index.html-nbPkiLf6.js" as="script"><link rel="prefetch" href="/assets/disable.html-D2NFuFuV.js" as="script"><link rel="prefetch" href="/assets/encrypt.html-DZD6cFPf.js" as="script"><link rel="prefetch" href="/assets/layout.html-Gnka5Q_6.js" as="script"><link rel="prefetch" href="/assets/markdown.html-CZglZfPu.js" as="script"><link rel="prefetch" href="/assets/page.html-BVxTPLFd.js" as="script"><link rel="prefetch" href="/assets/index.html-5BtFCm8w.js" as="script"><link rel="prefetch" href="/assets/cherry.html-DOe5xm8i.js" as="script"><link rel="prefetch" href="/assets/dragonfruit.html-Bi6RAIfO.js" as="script"><link rel="prefetch" href="/assets/strawberry.html-ChH3YJcf.js" as="script"><link rel="prefetch" href="/assets/tomato.html-DFH-JTwj.js" as="script"><link rel="prefetch" href="/assets/è®¡ç®—æœºç½‘ç»œ.html-Lq13r5sI.js" as="script"><link rel="prefetch" href="/assets/1.Elasticsearchå­¦ä¹ ï¼Œè¯·å…ˆçœ‹è¿™ä¸€ç¯‡ï¼.html-DQX8d_7X.js" as="script"><link rel="prefetch" href="/assets/2.Elasticsearchèšåˆæ·±å…¥è¯¦è§£â€”â€”å¯¹æ¯”Mysqlå®ç° - å‰¯æœ¬ (3).html-CdPpZHdP.js" as="script"><link rel="prefetch" href="/assets/2.Elasticsearchèšåˆæ·±å…¥è¯¦è§£â€”â€”å¯¹æ¯”Mysqlå®ç°.html-DjdrJKQX.js" as="script"><link rel="prefetch" href="/assets/3.ELK.html-v9bSruPL.js" as="script"><link rel="prefetch" href="/assets/5.æ•°æ®åŒæ­¥åˆ°Elasticsearched.html-D26ZMzAc.js" as="script"><link rel="prefetch" href="/assets/ginä½¿ç”¨elasticsearchå®ç°å¸–å­å…¨æ–‡æ£€ç´¢.html-Bz6lYaZr.js" as="script"><link rel="prefetch" href="/assets/ginä½¿ç”¨rabbitMQå®ç°å¼‚æ­¥åŒå†™.html-BOVJguT0.js" as="script"><link rel="prefetch" href="/assets/ginä½¿ç”¨rediså®ç°å…±åŒå…³æ³¨.html-D1w7QX7A.js" as="script"><link rel="prefetch" href="/assets/ginä½¿ç”¨rediså®ç°ç®€å•å…³æ³¨æ¨é€.html-DA1UKROE.js" as="script"><link rel="prefetch" href="/assets/go-ginä½¿ç”¨redis.html-DguoVChy.js" as="script"><link rel="prefetch" href="/assets/go-ç®€å•ä½¿ç”¨elasticsearch.html-CbFplrJ_.js" as="script"><link rel="prefetch" href="/assets/go-è¯­æ³•åŸºç¡€.html-D41DhE6o.js" as="script"><link rel="prefetch" href="/assets/index.html-CnllwsiR.js" as="script"><link rel="prefetch" href="/assets/SpringSecurity.html-BQuUda4y.js" as="script"><link rel="prefetch" href="/assets/disable.html-CEUuVfDH.js" as="script"><link rel="prefetch" href="/assets/juced.html-Cht8BGCl.js" as="script"><link rel="prefetch" href="/assets/jvmed.html-5eN0aPfc.js" as="script"><link rel="prefetch" href="/assets/kafkaæ¦‚å¿µ.html-pz7Szmj_.js" as="script"><link rel="prefetch" href="/assets/B_æ ‘ï¼Œç´¢å¼•ï¼Œå›è¡¨.html-DL6D2GAp.js" as="script"><link rel="prefetch" href="/assets/SQLæ³¨å…¥.html-CWA67FOD.js" as="script"><link rel="prefetch" href="/assets/ä¸»ä»åŒæ­¥åŸç†.html-C6exftCg.js" as="script"><link rel="prefetch" href="/assets/äº‹åŠ¡ã€éš”ç¦»çº§åˆ«ã€MVCC.html-mD3ZMvfI.js" as="script"><link rel="prefetch" href="/assets/åˆ†åº“åˆ†è¡¨.html-gIsOq2mk.js" as="script"><link rel="prefetch" href="/assets/æ…¢æŸ¥è¯¢ï¼ŒSQLä¼˜åŒ–.html-Bkcj71nU.js" as="script"><link rel="prefetch" href="/assets/1.redisç®€ä»‹.html-C5nWVm-p.js" as="script"><link rel="prefetch" href="/assets/10.åº”ç”¨åœºæ™¯.html-CmWoYLcY.js" as="script"><link rel="prefetch" href="/assets/11. Canalè§£å†³Mysqlå’ŒRedisæ•°æ®åŒæ­¥(TCP).html-DPfVvuBi.js" as="script"><link rel="prefetch" href="/assets/12. Canalè§£å†³Mysqlå’ŒRedisæ•°æ®åŒæ­¥(MQ).html-KUUreXSI.js" as="script"><link rel="prefetch" href="/assets/13. Canalè§£å†³Mysqlå’ŒESæ•°æ®åŒæ­¥.html-VVDnoXHr.js" as="script"><link rel="prefetch" href="/assets/2.Redisç¼“å­˜ï¼ˆç¼“å­˜ç©¿é€ã€ã€ç¼“å­˜å‡»ç©¿ã€ç¼“å­˜é›ªå´©ï¼‰.html-BQFK7__G.js" as="script"><link rel="prefetch" href="/assets/3.Redisç¼“å­˜ç©¿é€-å¸ƒéš†è¿‡æ»¤å™¨ed.html-D1Ua5aqP.js" as="script"><link rel="prefetch" href="/assets/4.Redisç¼“å­˜æ•°æ®å’Œæ•°æ®åº“æ•°æ®ä¸€è‡´æ€§.html-D6Ch4SfY.js" as="script"><link rel="prefetch" href="/assets/5.RedisæŒä¹…åŒ–ï¼ˆè½ç›˜ï¼‰.html-Ca8zqa0o.js" as="script"><link rel="prefetch" href="/assets/6.Redisé«˜å¯ç”¨-ä¸‰ç§æ–¹æ¡ˆ.html-DjrFP_Cl.js" as="script"><link rel="prefetch" href="/assets/7.Redisä¸»ä»å¤åˆ¶.html-CWBEugNn.js" as="script"><link rel="prefetch" href="/assets/8.åˆ†å¸ƒå¼é”ã€ç§’æ€ã€RedLock.html-DcBg523V.js" as="script"><link rel="prefetch" href="/assets/9.æ•°æ®è¿‡æœŸåˆ é™¤ç­–ç•¥ã€å†…å­˜æ·˜æ±°ç­–ç•¥.html-Cb075asG.js" as="script"><link rel="prefetch" href="/assets/index.html-CYeBzPto.js" as="script"><link rel="prefetch" href="/assets/page.html-Db43w48f.js" as="script"><link rel="prefetch" href="/assets/Spark.html-hhjgflCR.js" as="script"><link rel="prefetch" href="/assets/å¹¿å‘Šæ•°ä»“.html-DzrDRJqF.js" as="script"><link rel="prefetch" href="/assets/1.html-CGwriZjz.js" as="script"><link rel="prefetch" href="/assets/2.html-DrNvBQNz.js" as="script"><link rel="prefetch" href="/assets/3.html-GQCQSEre.js" as="script"><link rel="prefetch" href="/assets/4.html-ZKf1ClXT.js" as="script"><link rel="prefetch" href="/assets/1.html-iRC3KcrE.js" as="script"><link rel="prefetch" href="/assets/2.html-DpYggOCT.js" as="script"><link rel="prefetch" href="/assets/3.html-BqYiXnLS.js" as="script"><link rel="prefetch" href="/assets/4.html-D7OCYJ4v.js" as="script"><link rel="prefetch" href="/assets/dockerç®€å•è§£å†³æ— æ³•ä¸‹è½½é•œåƒ.html-DPFMbKgM.js" as="script"><link rel="prefetch" href="/assets/å®‰è£…Goï¼Œé…ç½®VScode.html-wyxhHfQ2.js" as="script"><link rel="prefetch" href="/assets/404.html-BcOdIj0K.js" as="script"><link rel="prefetch" href="/assets/index.html-D_rRy-wP.js" as="script"><link rel="prefetch" href="/assets/index.html-BF6eGJD5.js" as="script"><link rel="prefetch" href="/assets/index.html-B8JTFu1w.js" as="script"><link rel="prefetch" href="/assets/index.html-DNqeR8ah.js" as="script"><link rel="prefetch" href="/assets/index.html-DNnRZ_V1.js" as="script"><link rel="prefetch" href="/assets/index.html-jbkG1eH7.js" as="script"><link rel="prefetch" href="/assets/index.html-BSd63gFG.js" as="script"><link rel="prefetch" href="/assets/index.html-CJp1cDoQ.js" as="script"><link rel="prefetch" href="/assets/index.html-C1bPBnqL.js" as="script"><link rel="prefetch" href="/assets/index.html-DQYpIdPG.js" as="script"><link rel="prefetch" href="/assets/index.html-COU0oKxk.js" as="script"><link rel="prefetch" href="/assets/index.html-CFSTizTR.js" as="script"><link rel="prefetch" href="/assets/index.html-D3FQ_0oX.js" as="script"><link rel="prefetch" href="/assets/index.html-CkhCn-y2.js" as="script"><link rel="prefetch" href="/assets/index.html-DULfErzJ.js" as="script"><link rel="prefetch" href="/assets/index.html-S0JJ_wg0.js" as="script"><link rel="prefetch" href="/assets/index.html-uSzCqgrr.js" as="script"><link rel="prefetch" href="/assets/index.html-B9cKy90M.js" as="script"><link rel="prefetch" href="/assets/index.html-CG1Op1Z7.js" as="script"><link rel="prefetch" href="/assets/index.html-C_IOuaeE.js" as="script"><link rel="prefetch" href="/assets/index.html-BKphRqWp.js" as="script"><link rel="prefetch" href="/assets/index.html-Dt6uC7-T.js" as="script"><link rel="prefetch" href="/assets/index.html-BBwJEQ51.js" as="script"><link rel="prefetch" href="/assets/index.html-CCzi4KH9.js" as="script"><link rel="prefetch" href="/assets/index.html-BEkRiCpJ.js" as="script"><link rel="prefetch" href="/assets/index.html-CRJeQP4e.js" as="script"><link rel="prefetch" href="/assets/index.html-gtPG_M9S.js" as="script"><link rel="prefetch" href="/assets/index.html-BG34y28F.js" as="script"><link rel="prefetch" href="/assets/index.html-B4t1SIiA.js" as="script"><link rel="prefetch" href="/assets/index.html-7MAgYF9n.js" as="script"><link rel="prefetch" href="/assets/index.html-BjdJqRn0.js" as="script"><link rel="prefetch" href="/assets/index.html-C7f2_lrH.js" as="script"><link rel="prefetch" href="/assets/index.html-DA3pFITQ.js" as="script"><link rel="prefetch" href="/assets/index.html-DQxV7iIu.js" as="script"><link rel="prefetch" href="/assets/index.html-C5N7Hova.js" as="script"><link rel="prefetch" href="/assets/index.html-BumB1eZz.js" as="script"><link rel="prefetch" href="/assets/index.html-BEafWOh1.js" as="script"><link rel="prefetch" href="/assets/index.html-BWi4TGLP.js" as="script"><link rel="prefetch" href="/assets/index.html-9etHBs3E.js" as="script"><link rel="prefetch" href="/assets/index.html-CCxAV8GI.js" as="script"><link rel="prefetch" href="/assets/index.html-DJW2EOYC.js" as="script"><link rel="prefetch" href="/assets/index.html-B4MgOzFe.js" as="script"><link rel="prefetch" href="/assets/index.html-7JH8hlMI.js" as="script"><link rel="prefetch" href="/assets/index.html-CPrEVlTG.js" as="script"><link rel="prefetch" href="/assets/index.html-p9C-lMPn.js" as="script"><link rel="prefetch" href="/assets/index.html-DzsuqbnH.js" as="script"><link rel="prefetch" href="/assets/index.html-BbuWW_wi.js" as="script"><link rel="prefetch" href="/assets/index.html-B_u_3XGH.js" as="script"><link rel="prefetch" href="/assets/index.html-B13Y7u0q.js" as="script"><link rel="prefetch" href="/assets/index.html-BgVB8_9-.js" as="script"><link rel="prefetch" href="/assets/index.html-Ba67S78l.js" as="script"><link rel="prefetch" href="/assets/index.html-Vu1el6fC.js" as="script"><link rel="prefetch" href="/assets/index.html-gItZYLAd.js" as="script"><link rel="prefetch" href="/assets/index.html-ByBgTv3W.js" as="script"><link rel="prefetch" href="/assets/index.html-BAodZOCH.js" as="script"><link rel="prefetch" href="/assets/index.html-n0pzABDK.js" as="script"><link rel="prefetch" href="/assets/index.html-CWiwu2Ji.js" as="script"><link rel="prefetch" href="/assets/index.html-BgVB8_9-.js" as="script"><link rel="prefetch" href="/assets/index.html-mwReNVJM.js" as="script"><link rel="prefetch" href="/assets/index.html-BGTcVheJ.js" as="script"><link rel="prefetch" href="/assets/index.html-CJlwWi7D.js" as="script"><link rel="prefetch" href="/assets/index.html-ScqIbeXU.js" as="script"><link rel="prefetch" href="/assets/index.html-DWpRnaat.js" as="script"><link rel="prefetch" href="/assets/index.html-iwoFx71x.js" as="script"><link rel="prefetch" href="/assets/index.html-DBsOsjXV.js" as="script"><link rel="prefetch" href="/assets/index.html-CYNf2z1M.js" as="script"><link rel="prefetch" href="/assets/index.html-CBsMV2uR.js" as="script"><link rel="prefetch" href="/assets/index.html-DAq-itDW.js" as="script"><link rel="prefetch" href="/assets/index.html-BixFnwwp.js" as="script"><link rel="prefetch" href="/assets/index.html-BacW8CFh.js" as="script"><link rel="prefetch" href="/assets/index.html-Cav3ryJ3.js" as="script"><link rel="prefetch" href="/assets/index.html-BIenj8yK.js" as="script"><link rel="prefetch" href="/assets/index.html-ewGM0rma.js" as="script"><link rel="prefetch" href="/assets/index.html-W0B3FeHw.js" as="script"><link rel="prefetch" href="/assets/index.html-NyVk2fJB.js" as="script"><link rel="prefetch" href="/assets/index.html-CJndmsmz.js" as="script"><link rel="prefetch" href="/assets/index.html-DDuzW0lO.js" as="script"><link rel="prefetch" href="/assets/index.html-DdSTPBZL.js" as="script"><link rel="prefetch" href="/assets/index.html-lII-eOGe.js" as="script"><link rel="prefetch" href="/assets/index.html-CT77hj0p.js" as="script"><link rel="prefetch" href="/assets/index.html-C9WNIufr.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-GXRgw7eJ.js" as="script"><link rel="prefetch" href="/assets/SearchResult-B8j0219Z.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><div class="theme-container no-sidebar external-link-icon has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><!--[--><a class="route-link vp-brand" href="/"><img class="vp-nav-logo" src="https://theme-hope-assets.vuejs.press/logo.svg" alt><!----><span class="vp-site-name hide-in-pad">çƒ­ç‰›å¥¶</span></a><!--]--><!----></div><div class="vp-navbar-center"><!----><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/" aria-label="åšå®¢ä¸»é¡µ"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span><!--]-->åšå®¢ä¸»é¡µ<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="ç¬”è®°"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>ç¬”è®°<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/note/java/" aria-label="java"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->java<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/note/redis/" aria-label="redis"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->redis<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/note/Linux/" aria-label="redis"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->redis<!----></a></li></ul></button></div></div></nav><!--]--><!----></div><div class="vp-navbar-end"><!----><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/reniunai" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-outlook-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon" name="outlook"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="vp-outlook-dropdown"><!----></div></button></div><!--[--><button type="button" class="search-pro-button" aria-label="æœç´¢"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon" name="search"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="search-pro-placeholder">æœç´¢</div><div class="search-pro-key-hints"><kbd class="search-pro-key">Ctrl</kbd><kbd class="search-pro-key">K</kbd></div></button><!--]--><!--]--><!----><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!----><ul class="vp-sidebar-links"></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><div class="page-cover"><img src="/assets/images/cover1.jpg" alt no-view></div><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><span class="font-icon icon fa-fw fa-sm fas fa-file" style=""></span>æ•°æ®åŒæ­¥åˆ°Elasticsearch</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><span class="page-author-item">HotMilk</span></span><span property="author" content="HotMilk"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2024-07-15T00:00:00.000Z"></span><span class="page-category-info" aria-label="åˆ†ç±»ğŸŒˆ" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon" name="category"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item color3 clickable" role="navigation">Elasticsearch</span><!--]--><meta property="articleSection" content="Elasticsearch"></span><span class="page-tag-info" aria-label="æ ‡ç­¾ğŸ·" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon" name="tag"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item color0 clickable" role="navigation">elasticsearch</span><span class="page-tag-item color8 clickable" role="navigation">æ•°æ®åŒæ­¥</span><!--]--><meta property="keywords" content="elasticsearch,æ•°æ®åŒæ­¥"></span><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 18 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT18M"></span><span class="page-word-info" aria-label="å­—æ•°ğŸ” " data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon word-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="word icon" name="word"><path d="M518.217 432.64V73.143A73.143 73.143 0 01603.43 1.097a512 512 0 01419.474 419.474 73.143 73.143 0 01-72.046 85.212H591.36a73.143 73.143 0 01-73.143-73.143z"></path><path d="M493.714 566.857h340.297a73.143 73.143 0 0173.143 85.577A457.143 457.143 0 11371.566 117.76a73.143 73.143 0 0185.577 73.143v339.383a36.571 36.571 0 0036.571 36.571z"></path></svg><span>çº¦ 5548 å­—</span><meta property="wordCount" content="5548"></span></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!----><div class="vp-toc-header">æ­¤é¡µå†…å®¹<button type="button" class="print-button" title="æ‰“å°"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_4ã€åˆæ­¥æ£€ç´¢">4ã€åˆæ­¥æ£€ç´¢</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_5ã€è¿›é˜¶æ£€ç´¢">5ã€è¿›é˜¶æ£€ç´¢</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1ã€searchapi">1ã€SearchAPI</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2ã€query-dsl">2ã€Query DSL</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3ã€mappingå­—æ®µæ˜ å°„">3ã€Mappingå­—æ®µæ˜ å°„</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_4ã€åˆ†è¯">4ã€åˆ†è¯</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#å®šä¹‰å®ä½“">å®šä¹‰å®ä½“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#åˆ›å»ºç´¢å¼•-1">åˆ›å»ºç´¢å¼•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#å¢åŠ æ–‡æ¡£-1">å¢åŠ æ–‡æ¡£</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#åŠ¨æ€æœç´¢æ–‡æ¡£">åŠ¨æ€æœç´¢æ–‡æ¡£</a></li><!----><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!----></aside></div><!----><div class="theme-hope-content"><p>æ•°æ®åŒæ­¥åˆ°Elasticsearchï¼ŒåŒæ­¥å†™ï¼Œå¼‚æ­¥å†™ï¼Œä¸­é—´ä»¶å®ç°åŒæ­¥ã€‚</p><!-- more --><h2 id="_4ã€åˆæ­¥æ£€ç´¢" tabindex="-1"><a class="header-anchor" href="#_4ã€åˆæ­¥æ£€ç´¢"><span>4ã€åˆæ­¥æ£€ç´¢</span></a></h2><p><strong>1ã€_cat</strong></p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span>GET /_cat/nodesï¼šæŸ¥çœ‹æ‰€æœ‰èŠ‚ç‚¹</span></span>
<span class="line"><span>GET /_cat/healthï¼šæŸ¥çœ‹ es å¥åº·çŠ¶å†µ</span></span>
<span class="line"><span>GET /_cat/masterï¼šæŸ¥çœ‹ä¸»èŠ‚ç‚¹</span></span>
<span class="line"><span>GET /_cat/indicesï¼šæŸ¥çœ‹æ‰€æœ‰ç´¢å¼• show databases;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>2ã€ç´¢å¼•ä¸€ä¸ªæ–‡æ¡£ï¼ˆä¿å­˜ï¼‰</strong></p><p>ä¿å­˜ä¸€ä¸ªæ•°æ®ï¼Œä¿å­˜åœ¨å“ªä¸ªç´¢å¼•çš„å“ªä¸ªç±»å‹ä¸‹ï¼ŒæŒ‡å®šç”¨å“ªä¸ªå”¯ä¸€æ ‡è¯†PUT customer/external/1ï¼›åœ¨ customer ç´¢å¼•ä¸‹çš„ external ç±»å‹ä¸‹ä¿å­˜ 1 å·æ•°æ®ä¸º</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span># # åœ¨customerç´¢å¼•ä¸‹çš„externalç±»å‹ä¸‹ä¿å­˜1å·æ•°æ®</span></span>
<span class="line"><span>PUT customer/external/1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>httpclinet</p><div class="language-http line-numbers-mode" data-highlighter="shiki" data-ext="http" data-title="http" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">PUT</span><span style="color:#D8DEE9FF;"> http://59.110.106.16:9200/customer/external/1</span></span>
<span class="line"><span style="color:#81A1C1;">Content-Type:</span><span style="color:#A3BE8C;"> application/json</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">name</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">John Doe</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿”å›æ•°æ®</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;">è¿”å›æ•°æ®ï¼š</span></span>
<span class="line"><span style="color:#D8DEE9FF;">å¸¦æœ‰ä¸‹åˆ’çº¿å¼€å¤´çš„ï¼Œç§°ä¸ºå…ƒæ•°æ®ï¼Œåæ˜ äº†å½“å‰çš„åŸºæœ¬ä¿¡æ¯ã€‚</span></span>
<span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">_index</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">customer</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> è¡¨æ˜è¯¥æ•°æ®åœ¨å“ªä¸ªæ•°æ®åº“ä¸‹ï¼›</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">_type</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">external</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> è¡¨æ˜è¯¥æ•°æ®åœ¨å“ªä¸ªç±»å‹ä¸‹ï¼›</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">_id</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">1</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;">  è¡¨æ˜è¢«ä¿å­˜æ•°æ®çš„idï¼›</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">_version</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#B48EAD;"> 1</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;">  è¢«ä¿å­˜æ•°æ®çš„ç‰ˆæœ¬</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">result</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">created</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> è¿™é‡Œæ˜¯åˆ›å»ºäº†ä¸€æ¡æ•°æ®ï¼Œå¦‚æœé‡æ–°putä¸€æ¡æ•°æ®ï¼Œåˆ™è¯¥çŠ¶æ€ä¼šå˜ä¸ºupdatedï¼Œå¹¶ä¸”ç‰ˆæœ¬å·ä¹Ÿä¼šå‘ç”Ÿå˜åŒ–ã€‚</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">_shards</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">total</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#B48EAD;"> 2</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">successful</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#B48EAD;"> 1</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">failed</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#B48EAD;"> 0</span></span>
<span class="line"><span style="color:#ECEFF4;">  },</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">_seq_no</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#B48EAD;"> 1</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">_primary_term</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#B48EAD;"> 1</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>PUT å’Œ POST éƒ½å¯ä»¥ï¼Œ POST æ–°å¢ã€‚å¦‚æœä¸æŒ‡å®š idï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆ id, æ–°å¢è¿™ä¸ªæ•°æ®ã€‚æŒ‡å®š id å°±ä¼šä¿®æ”¹è¿™ä¸ªæ•°æ®ï¼Œå¹¶æ–°å¢ç‰ˆæœ¬å· PUT å¯ä»¥æ–°å¢å¯ä»¥ä¿®æ”¹ã€‚PUT å¿…é¡»æŒ‡å®š idï¼›ç”±äº PUT éœ€è¦æŒ‡å®š idï¼Œæˆ‘ä»¬ä¸€èˆ¬éƒ½ç”¨æ¥åšä¿®æ”¹æ“ä½œï¼Œä¸æŒ‡å®š id ä¼šæŠ¥é”™ã€‚</p></blockquote><p><strong>3ã€æŸ¥è¯¢æ–‡æ¡£</strong></p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span>GET customer/external/1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>httpclient</p><div class="language-http line-numbers-mode" data-highlighter="shiki" data-ext="http" data-title="http" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">### GET request with a header</span></span>
<span class="line"><span style="color:#81A1C1;">GET</span><span style="color:#D8DEE9FF;"> http://59.110.106.16:9200/customer/external/1</span></span>
<span class="line"><span style="color:#81A1C1;">Accept:</span><span style="color:#A3BE8C;"> application/json</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿”å›æ•°æ®ï¼š</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">_index</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">customer</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">_type</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">external</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">_id</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">1</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">_version</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#B48EAD;"> 2</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">_seq_no</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#B48EAD;"> 1</span><span style="color:#ECEFF4;">,</span><span style="color:#616E88;"> //å¹¶å‘æ§åˆ¶å­—æ®µï¼Œæ¯æ¬¡æ›´æ–°éƒ½ä¼š+1ï¼Œç”¨æ¥åšä¹è§‚é”</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">_primary_term</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#B48EAD;"> 1</span><span style="color:#ECEFF4;">,</span><span style="color:#616E88;">//åŒä¸Šï¼Œä¸»åˆ†ç‰‡é‡æ–°åˆ†é…ï¼Œå¦‚é‡å¯ï¼Œå°±ä¼šå˜åŒ–</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">found</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#81A1C1;"> true</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">_source</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span><span style="color:#616E88;"> //å­˜å‚¨çš„ä¿¡æ¯</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">name</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">John Doe</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>ä¹è§‚é”ç”¨æ³•ï¼šé€šè¿‡â€œ<code>if_seq_no=1&amp;if_primary_term=1</code>â€ï¼Œå½“åºåˆ—å·åŒ¹é…çš„æ—¶å€™ï¼Œæ‰è¿›è¡Œä¿®æ”¹ï¼Œå¦åˆ™ä¸ä¿®æ”¹ã€‚</p></blockquote><p>ç¤ºä¾‹ï¼š</p><p>å½“seq_no=1&amp;primary_term=1æ—¶ï¼Œå°±ä¿®æ”¹</p><div class="language-http line-numbers-mode" data-highlighter="shiki" data-ext="http" data-title="http" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">###</span></span>
<span class="line"><span style="color:#81A1C1;">PUT</span><span style="color:#D8DEE9FF;"> http://59.110.106.16:9200/customer/external/1?if_seq_no=1&amp;if_primary_term=1</span></span>
<span class="line"><span style="color:#81A1C1;">Content-Type:</span><span style="color:#A3BE8C;"> application/json</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">name</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">John Doe</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¿®æ”¹æˆåŠŸï¼Œä¿®æ”¹ä¹‹åseq_noå˜æˆ2</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407231954667.png" alt="image-20211011134234874" tabindex="0" loading="lazy"><figcaption>image-20211011134234874</figcaption></figure><p>å†æ¬¡å‘é€ä¸Šé¢çš„è¯·æ±‚ï¼Œä¿®æ”¹å¤±è´¥ï¼Œä¹è§‚é”æ˜¯ç”Ÿæ•ˆ</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407231954673.png" alt="image-20211011134451525" tabindex="0" loading="lazy"><figcaption>image-20211011134451525</figcaption></figure><p><strong>4ã€æ›´æ–°æ–‡æ¡£</strong></p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span>POST customer/external/1/_update</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>   &quot;doc&quot;:{</span></span>
<span class="line"><span>       &quot;name&quot;: &quot;John Doew&quot;</span></span>
<span class="line"><span>   }</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>æˆ–è€…</span></span>
<span class="line"><span>POST customer/external/1</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   &quot;name&quot;: &quot;John Doe2&quot;</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>æˆ–è€…</span></span>
<span class="line"><span>PUT customer/external/1</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>   &quot;name&quot;: &quot;John Doe&quot;</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><ul><li>æ³¨æ„å¸¦ä¸å¸¦_updateçš„è¯­æ³•ä¸åŒ</li><li>å¸¦_updateä¼šè·ŸåŸæ•°æ®å¯¹æ¯”ï¼Œè·ŸåŸæ¥ä¸€æ ·å°±ä»€ä¹ˆéƒ½ä¸åš,versionä¸å¢åŠ ã€‚ åº”ç”¨åœºæ™¯ï¼šå¯¹äºå¤§å¹¶å‘æŸ¥è¯¢ï¼Œå¶å°”æ›´æ–°ï¼Œå¸¦updateï¼›å¯¹æ¯”æ›´æ–°å‘¢ï¼Œé‡æ–°è®¡ç®—åˆ†é…è§„åˆ™</li><li>postä¸å¸¦_update,ä¸ä¼šæ£€æŸ¥åŸæ•°æ®,ç›´æ¥æ›´æ–°ã€‚ åº”ç”¨åœºæ™¯ï¼šå¯¹äºå¤§å¹¶å‘æ›´æ–°ï¼Œä¸å¸¦update</li></ul></blockquote><p>å‘é€ä¹‹åï¼Œä¸å…ƒç´ æ®å¯¹æ¯”ï¼Œå‘ç°ç›¸åŒï¼Œä¸åšä»»ä½•æ“ä½œ</p><div class="language-http line-numbers-mode" data-highlighter="shiki" data-ext="http" data-title="http" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">POST</span><span style="color:#D8DEE9FF;"> http://59.110.106.16:9200/customer/external/1/_update</span></span>
<span class="line"><span style="color:#81A1C1;">Content-Type:</span><span style="color:#A3BE8C;"> application/json</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">doc</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:{</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">name</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">John</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>5ã€åˆ é™¤æ–‡æ¡£&amp;ç´¢å¼•</strong></p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span>DELETE customer/external/1</span></span>
<span class="line"><span>DELETE customer</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>æ³¨ï¼šelasticsearchå¹¶æ²¡æœ‰æä¾›åˆ é™¤ç±»å‹çš„æ“ä½œï¼Œåªæä¾›äº†åˆ é™¤ç´¢å¼•å’Œæ–‡æ¡£çš„æ“ä½œã€‚</p></blockquote><p>åˆ é™¤id=1çš„æ•°æ®</p><div class="language-http line-numbers-mode" data-highlighter="shiki" data-ext="http" data-title="http" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">DELETE</span><span style="color:#D8DEE9FF;"> http://59.110.106.16:9200/customer/external/1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407231954684.png" alt="image-20211011140906175" tabindex="0" loading="lazy"><figcaption>image-20211011140906175</figcaption></figure><p>åˆ é™¤customerç´¢å¼•</p><div class="language-http line-numbers-mode" data-highlighter="shiki" data-ext="http" data-title="http" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">DELETE</span><span style="color:#D8DEE9FF;"> http://59.110.106.16:9200/customer</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;">å“åº”</span></span>
<span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">acknowledged</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#81A1C1;"> true</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>6ã€ESçš„æ‰¹é‡æ“ä½œâ€”â€”bulk</strong></p><p>ç”¨Kibanaä¹‹ä¸­çš„Dev Tools</p><p>ç¤ºä¾‹1:</p><div class="language-http line-numbers-mode" data-highlighter="shiki" data-ext="http" data-title="http" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">POST</span><span style="color:#D8DEE9FF;"> customer/external/_bulk</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ECEFF4;">{</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">index</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:{</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">_id</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">1</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">}}</span></span>
<span class="line"><span style="color:#ECEFF4;">{</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">name</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">John Doe</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ECEFF4;">{</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">index</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:{</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">_id</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">2</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">}}</span></span>
<span class="line"><span style="color:#ECEFF4;">{</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">name</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">Jane Doe</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> }</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¯­æ³•æ ¼å¼: ä¸¤è¡Œä¸€ç»„ï¼Œç¬¬ä¸€è¡Œä¸ºæ“ä½œï¼Œç¬¬äºŒè¡Œä¸ºæ•°æ®</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span>{ action: { metadata }}\n</span></span>
<span class="line"><span>{ request body}\n</span></span>
<span class="line"><span></span></span>
<span class="line"><span>{ action: { metadata }}\n</span></span>
<span class="line"><span>{ request body}\n</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œçš„æ‰¹é‡æ“ä½œï¼Œå½“å‘ç”ŸæŸä¸€æ¡æ‰§è¡Œå‘ç”Ÿå¤±è´¥æ—¶ï¼Œå…¶ä»–çš„æ•°æ®ä»ç„¶èƒ½å¤Ÿæ¥ç€æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´å½¼æ­¤ä¹‹é—´æ˜¯ç‹¬ç«‹çš„ã€‚</p><blockquote><p>bulk API ä»¥æ­¤æŒ‰é¡ºåºæ‰§è¡Œæ‰€æœ‰çš„ actionï¼ˆåŠ¨ä½œï¼‰ã€‚å¦‚æœä¸€ä¸ªå•ä¸ªçš„åŠ¨ä½œå› ä»»ä½•åŸå› è€Œå¤±è´¥ï¼Œå®ƒå°†ç»§ç»­å¤„ç†å®ƒåé¢å‰©ä½™çš„åŠ¨ä½œã€‚å½“ bulk API è¿”å›æ—¶ï¼Œå®ƒå°†æä¾›æ¯ä¸ªåŠ¨ä½œçš„çŠ¶æ€ï¼ˆä¸å‘é€çš„é¡ºåºç›¸åŒï¼‰ï¼Œæ‰€ä»¥æ‚¨å¯ä»¥æ£€æŸ¥æ˜¯å¦ä¸€ä¸ªæŒ‡å®šçš„åŠ¨ä½œæ˜¯ä¸æ˜¯å¤±è´¥äº†ã€‚</p></blockquote><p>è¿”å›æ•°æ®</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;">#! Deprecation: </span><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9;">types</span><span style="color:#D8DEE9;"> removal</span><span style="color:#ECEFF4;">]</span><span style="color:#D8DEE9FF;"> Specifying types in bulk requests is deprecated.</span></span>
<span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">took</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 318</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;">  èŠ±è´¹äº†å¤šå°‘ms</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">errors</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#81A1C1;"> false</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> æ²¡æœ‰å‘ç”Ÿä»»ä½•é”™è¯¯</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">items</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> [</span><span style="color:#D8DEE9;"> æ¯ä¸ªæ•°æ®çš„ç»“æœ</span></span>
<span class="line"><span style="color:#ECEFF4;">    {</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">index</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9;"> ä¿å­˜</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">_index</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">customer</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> ç´¢å¼•</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">_type</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">external</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> ç±»å‹</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">_id</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">1</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> æ–‡æ¡£</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">_version</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 1</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> ç‰ˆæœ¬</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">result</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">created</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> åˆ›å»º</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">_shards</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">          &quot;</span><span style="color:#8FBCBB;">total</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 2</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">          &quot;</span><span style="color:#8FBCBB;">successful</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 1</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">          &quot;</span><span style="color:#8FBCBB;">failed</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 0</span></span>
<span class="line"><span style="color:#ECEFF4;">        },</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">_seq_no</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">_primary_term</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 1</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">status</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 201</span><span style="color:#D8DEE9;"> æ–°å»ºå®Œæˆ</span></span>
<span class="line"><span style="color:#ECEFF4;">      }</span></span>
<span class="line"><span style="color:#ECEFF4;">    },</span></span>
<span class="line"><span style="color:#ECEFF4;">    {</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">index</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9;"> ç¬¬äºŒæ¡è®°å½•</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">_index</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">customer</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">_type</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">external</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">_id</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">2</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">_version</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 1</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">result</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">created</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">_shards</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">          &quot;</span><span style="color:#8FBCBB;">total</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 2</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">          &quot;</span><span style="color:#8FBCBB;">successful</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 1</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">          &quot;</span><span style="color:#8FBCBB;">failed</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 0</span></span>
<span class="line"><span style="color:#ECEFF4;">        },</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">_seq_no</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 1</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">_primary_term</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 1</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">status</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 201</span></span>
<span class="line"><span style="color:#ECEFF4;">      }</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  ]</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç¤ºä¾‹2ï¼š</p><div class="language-http line-numbers-mode" data-highlighter="shiki" data-ext="http" data-title="http" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">POST</span><span style="color:#D8DEE9FF;"> /_bulk</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ECEFF4;">{</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">delete</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:{</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">_index</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">website</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">_type</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">blog</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">_id</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">123</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">}}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ECEFF4;">{</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">create</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:{</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">_index</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">website</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">_type</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">blog</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">_id</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">123</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">}}</span></span>
<span class="line"><span style="color:#ECEFF4;">{</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">title</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">my first blog post</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ECEFF4;">{</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">index</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:{</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">_index</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">website</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">_type</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">blog</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">}}</span></span>
<span class="line"><span style="color:#ECEFF4;">{</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">title</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">my second blog post</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ECEFF4;">{</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">update</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:{</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">_index</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">website</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">_type</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">blog</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">_id</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">123</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">}}</span></span>
<span class="line"><span style="color:#ECEFF4;">{</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">doc</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:{</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">title</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">my updated blog post</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">}}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>7ã€æ ·æœ¬æµ‹è¯•æ•°æ®</strong></p><p>ä¸€ä»½é¡¾å®¢é“¶è¡Œè´¦æˆ·ä¿¡æ¯çš„è™šæ„çš„ JSON æ–‡æ¡£æ ·æœ¬ã€‚æ¯ä¸ªæ–‡æ¡£éƒ½æœ‰ä¸‹åˆ—çš„ schema(æ¨¡å¼):</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">account_number</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">balance</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#B48EAD;"> 16623</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">firstname</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">Bradshaw</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">lastname</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">Mckenzie</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">age</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#B48EAD;"> 29</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">gender</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">F</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">address</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">244 Columbus Place</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">employer</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">Euron</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">email</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">bradshawmckenzie@euron.com</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">city</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">Hobucken</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">state</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">CO</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æµ‹è¯•æ•°æ®åœ°å€https://gitee.com/xlh_blog/common_content/blob/master/es%E6%B5%8B%E8%AF%95%E6%95%B0%E6%8D%AE.json</p><div class="language-http line-numbers-mode" data-highlighter="shiki" data-ext="http" data-title="http" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">POST</span><span style="color:#D8DEE9FF;"> bank/account/_bulk</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">//ä¸Šé¢çš„æ•°æ®</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">//GET _cat/indices, æŸ¥çœ‹ç´¢å¼•</span></span>
<span class="line"><span style="color:#616E88;">//åˆšå¯¼å…¥äº†1000æ¡æ•°æ®</span></span>
<span class="line"><span style="color:#D8DEE9FF;">yellow open bank                     dno5JY9tTrGHdsjIMkvQyA 1 1 1000 0 414.2kb 414.2kb</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_5ã€è¿›é˜¶æ£€ç´¢" tabindex="-1"><a class="header-anchor" href="#_5ã€è¿›é˜¶æ£€ç´¢"><span>5ã€è¿›é˜¶æ£€ç´¢</span></a></h2><h3 id="_1ã€searchapi" tabindex="-1"><a class="header-anchor" href="#_1ã€searchapi"><span><strong>1ã€SearchAPI</strong></span></a></h3><p>ES æ”¯æŒä¸¤ç§åŸºæœ¬æ–¹å¼æ£€ç´¢ï¼š</p><ul><li>ä¸€ä¸ªæ˜¯é€šè¿‡ä½¿ç”¨ REST request URI å‘é€æœç´¢å‚æ•°ï¼ˆuri+æ£€ç´¢å‚æ•°ï¼‰</li><li>å¦ä¸€ä¸ªæ˜¯é€šè¿‡ä½¿ç”¨ REST request body æ¥å‘é€å®ƒä»¬ï¼ˆuri+è¯·æ±‚ä½“ï¼‰</li></ul><p>1ï¼‰ã€ä¿¡æ¯æ£€ç´¢</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span>GET bank/_search     													æ£€ç´¢ bank ä¸‹æ‰€æœ‰ä¿¡æ¯ï¼ŒåŒ…æ‹¬ type å’Œ docs</span></span>
<span class="line"><span></span></span>
<span class="line"><span>GET bank/_search?q=*&amp;sort=account_number:asc							è¯·æ±‚å‚æ•°æ–¹å¼æ£€ç´¢</span></span>
<span class="line"><span>è¯´æ˜ï¼š</span></span>
<span class="line"><span>q=* # æŸ¥è¯¢æ‰€æœ‰</span></span>
<span class="line"><span>sort # æ’åºå­—æ®µ</span></span>
<span class="line"><span>asc #å‡åº</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿”å›å†…å®¹ï¼š</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407231954670.png" alt="image-20211011143910397" tabindex="0" loading="lazy"><figcaption>image-20211011143910397</figcaption></figure><p><code>took</code> â€“ èŠ±è´¹å¤šå°‘msæœç´¢ <code>timed_out</code> â€“ æ˜¯å¦è¶…æ—¶ <code>_shards </code>â€“ å¤šå°‘åˆ†ç‰‡è¢«æœç´¢äº†ï¼Œä»¥åŠå¤šå°‘æˆåŠŸ/å¤±è´¥çš„æœç´¢åˆ†ç‰‡ <code>max_score</code> â€“æ–‡æ¡£ç›¸å…³æ€§æœ€é«˜å¾—åˆ† <code>hits.total.value</code> - å¤šå°‘åŒ¹é…æ–‡æ¡£è¢«æ‰¾åˆ° <code>hits.sort</code> - ç»“æœçš„æ’åºkeyï¼ˆåˆ—ï¼‰ï¼Œæ²¡æœ‰çš„è¯æŒ‰ç…§scoreæ’åº <code>hits._score</code> - ç›¸å…³å¾—åˆ† (not applicable when using match_all)</p><p>uri+è¯·æ±‚ä½“è¡Œæ£€ç´¢</p><div class="language-http line-numbers-mode" data-highlighter="shiki" data-ext="http" data-title="http" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">GET</span><span style="color:#D8DEE9FF;"> /bank/_search</span></span>
<span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">query</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#8FBCBB;">match_all</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {}</span><span style="color:#ECEFF4;"> },</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">sort</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> [</span></span>
<span class="line"><span style="color:#ECEFF4;">    {</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#8FBCBB;">account_number</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">asc</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> },</span></span>
<span class="line"><span style="color:#ECEFF4;">    {</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#8FBCBB;">balance</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">desc</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#ECEFF4;">  ]</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>HTTPå®¢æˆ·ç«¯å·¥å…·ï¼ˆPOSTMANï¼‰ï¼Œgetè¯·æ±‚ä¸èƒ½æºå¸¦è¯·æ±‚ä½“ï¼Œæˆ‘ä»¬å˜ä¸ºpostä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚æˆ‘ä»¬POSTä¸€ä¸ªJSONé£æ ¼çš„æŸ¥è¯¢è¯·æ±‚ä½“åˆ°_search APIã€‚</p><p>éœ€è¦äº†è§£ï¼Œä¸€æ—¦æœç´¢çš„ç»“æœè¢«è¿”å›Elasticsearchå°±å®Œæˆäº†è¿™æ¬¡è¯·æ±‚ï¼Œå¹¶ä¸”ä¸ä¼šç»´æŠ¤ä»»ä½•æœåŠ¡ç«¯çš„èµ„æºæˆ–è€…ç»“æœçš„cursorï¼ˆæ¸¸æ ‡ï¼‰</p><h3 id="_2ã€query-dsl" tabindex="-1"><a class="header-anchor" href="#_2ã€query-dsl"><span>2ã€Query DSL</span></a></h3><p>Elasticsearchæä¾›äº†ä¸€ä¸ªå¯ä»¥æ‰§è¡ŒæŸ¥è¯¢çš„Jsoné£æ ¼çš„DSL(domain-specific languageé¢†åŸŸç‰¹å®šè¯­è¨€)ã€‚è¿™ä¸ªè¢«ç§°ä¸ºQuery DSLï¼Œè¯¥æŸ¥è¯¢è¯­è¨€éå¸¸å…¨é¢ã€‚</p><p>1ã€åŸºæœ¬è¯­æ³•æ ¼å¼</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;">å¦‚æœé’ˆå¯¹äºæŸä¸ªå­—æ®µï¼Œé‚£ä¹ˆå®ƒçš„ç»“æ„å¦‚ä¸‹ï¼š</span></span>
<span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">  QUERY_NAME</span><span style="color:#ECEFF4;">:{</span><span style="color:#D8DEE9;">   #</span><span style="color:#D8DEE9;"> ä½¿ç”¨çš„åŠŸèƒ½</span></span>
<span class="line"><span style="color:#D8DEE9;">     FIELD_NAME</span><span style="color:#ECEFF4;">:{</span><span style="color:#D8DEE9;">  #</span><span style="color:#D8DEE9;">  åŠŸèƒ½å‚æ•°</span></span>
<span class="line"><span style="color:#D8DEE9;">       ARGUMENT</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9;">VALUE</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#D8DEE9;">       ARGUMENT</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9;">VALUE</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;">...</span></span>
<span class="line"><span style="color:#ECEFF4;">      }</span><span style="color:#D8DEE9FF;">   </span></span>
<span class="line"><span style="color:#ECEFF4;">   }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;">ç¤ºä¾‹  ä½¿ç”¨æ—¶ä¸è¦åŠ #æ³¨é‡Šå†…å®¹</span></span>
<span class="line"><span style="color:#8FBCBB;">GET</span><span style="color:#D8DEE9FF;"> bank</span><span style="color:#81A1C1;">/</span><span style="color:#8FBCBB;">_search</span></span>
<span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#A3BE8C;">query</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">:</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9FF;">  #  æŸ¥è¯¢çš„å­—æ®µ</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#A3BE8C;">match_all</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">:</span><span style="color:#ECEFF4;"> {}</span></span>
<span class="line"><span style="color:#ECEFF4;">  },</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#A3BE8C;">from</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">:</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;">  # ä»ç¬¬å‡ æ¡æ–‡æ¡£å¼€å§‹æŸ¥</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#A3BE8C;">size</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">:</span><span style="color:#B48EAD;"> 5</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;">  # æŸ¥å‡ æ¡æ–‡æ¡£</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#A3BE8C;">_source</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">:</span><span style="color:#ECEFF4;">[</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">balance</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">],</span><span style="color:#D8DEE9FF;"> # è¿”å›çš„æ•°æ®å­—æ®µï¼Œ è¿™é‡ŒåªæŸ¥balance</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#A3BE8C;">sort</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">:</span><span style="color:#ECEFF4;"> [</span></span>
<span class="line"><span style="color:#ECEFF4;">    {</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#A3BE8C;">account_number</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">:</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9FF;">  # è¿”å›ç»“æœæŒ‰å“ªä¸ªåˆ—æ’åº</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#A3BE8C;">order</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">desc</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">  # é™åº</span></span>
<span class="line"><span style="color:#ECEFF4;">      }</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  ]</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>queryå®šä¹‰å¦‚ä½•æŸ¥è¯¢ï¼›</p><ul><li>match_allæŸ¥è¯¢ç±»å‹ã€ä»£è¡¨æŸ¥è¯¢æ‰€æœ‰çš„ç´¢å¼•ã€‘ï¼Œesä¸­å¯ä»¥åœ¨queryä¸­ç»„åˆéå¸¸å¤šçš„æŸ¥è¯¢ç±»å‹å®Œæˆå¤æ‚æŸ¥è¯¢ï¼›</li><li>é™¤äº†queryå‚æ•°ä¹‹å¤–ï¼Œæˆ‘ä»¬å¯ä¹Ÿä¼ é€’å…¶ä»–çš„å‚æ•°ä»¥æ”¹å˜æŸ¥è¯¢ç»“æœï¼Œå¦‚sortï¼Œsizeï¼›</li><li>from+sizeé™å®šï¼Œå®Œæˆåˆ†é¡µåŠŸèƒ½ï¼›</li><li>sortæ’åºï¼Œå¤šå­—æ®µæ’åºï¼Œä¼šåœ¨å‰åºå­—æ®µç›¸ç­‰æ—¶åç»­å­—æ®µå†…éƒ¨æ’åºï¼Œå¦åˆ™ä»¥å‰åºä¸ºå‡†ï¼›</li></ul><p>2ã€<code>query/match</code>åŒ¹é…æŸ¥è¯¢</p><blockquote><p>å¦‚æœæ˜¯éå­—ç¬¦ä¸²ï¼Œä¼šè¿›è¡Œç²¾ç¡®åŒ¹é…ã€‚å¦‚æœæ˜¯å­—ç¬¦ä¸²ï¼Œä¼šè¿›è¡Œå…¨æ–‡æ£€ç´¢</p></blockquote><ul><li>åŸºæœ¬ç±»å‹ï¼ˆéå­—ç¬¦ä¸²ï¼‰ï¼Œç²¾ç¡®æ§åˆ¶: æŸ¥è¯¢account_number == 20çš„æ–‡æ¡£</li></ul><div class="language-http line-numbers-mode" data-highlighter="shiki" data-ext="http" data-title="http" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">GET</span><span style="color:#D8DEE9FF;"> bank/_search</span></span>
<span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">query</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">match</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">account_number</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">20</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>å­—ç¬¦ä¸²ï¼Œå…¨æ–‡æ£€ç´¢: æŸ¥è¯¢addressä¸­å«æœ‰kingsçš„æ–‡æ¡£</li></ul><div class="language-http line-numbers-mode" data-highlighter="shiki" data-ext="http" data-title="http" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">GET</span><span style="color:#D8DEE9FF;"> bank/_search</span></span>
<span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">query</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">match</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">address</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">kings</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>å­—ç¬¦ä¸²ï¼Œå…¨æ–‡æ£€ç´¢ï¼šæœ€ç»ˆæŸ¥è¯¢å‡º address ä¸­åŒ…å« mill æˆ–è€… road æˆ–è€… mill road çš„æ‰€æœ‰è®°å½•ï¼Œå¹¶ç»™å‡ºç›¸å…³æ€§å¾—åˆ†</li></ul><div class="language-http line-numbers-mode" data-highlighter="shiki" data-ext="http" data-title="http" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">GET</span><span style="color:#D8DEE9FF;"> bank/_search</span></span>
<span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">   &quot;</span><span style="color:#8FBCBB;">query</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">match</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">         &quot;</span><span style="color:#8FBCBB;">address</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">mill road</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">      }</span></span>
<span class="line"><span style="color:#ECEFF4;">   }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å…¨æ–‡æ£€ç´¢ï¼Œæœ€ç»ˆä¼šæŒ‰ç…§è¯„åˆ†è¿›è¡Œæ’åºï¼Œä¼šå¯¹æ£€ç´¢æ¡ä»¶è¿›è¡Œåˆ†è¯åŒ¹é…ã€‚</p><p>3ã€<code>query/match_phrase</code>ã€çŸ­è¯­åŒ¹é…ã€‘</p><p>å°†éœ€è¦åŒ¹é…çš„å€¼å½“æˆä¸€æ•´ä¸ªå•è¯ï¼ˆä¸åˆ†è¯ï¼‰è¿›è¡Œæ£€ç´¢</p><ul><li><code>match</code>ï¼šæ‹†åˆ†å­—ç¬¦ä¸²è¿›è¡Œæ£€ç´¢ã€‚ åŒ…å«mill æˆ– road æˆ– mill road</li><li><code>match_phrase</code>ï¼šä¸æ‹†åˆ†å­—ç¬¦ä¸²è¿›è¡Œæ£€ç´¢ã€‚ åŒ…å«mill road</li><li><code>å­—æ®µ.keyword</code>ï¼šå¿…é¡»å…¨åŒ¹é…ä¸Šæ‰æ£€ç´¢æˆåŠŸã€‚</li></ul><div class="language-http line-numbers-mode" data-highlighter="shiki" data-ext="http" data-title="http" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">GET</span><span style="color:#D8DEE9FF;"> bank/_search</span></span>
<span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">query</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">match_phrase</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">address</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">mill road</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9;">   #</span><span style="color:#D8DEE9;">  å°±æ˜¯è¯´ä¸è¦åŒ¹é…åªæœ‰millæˆ–åªæœ‰roadçš„ï¼Œè¦åŒ¹é…mill</span><span style="color:#D8DEE9;"> roadä¸€æ•´ä¸ªå­ä¸²</span></span>
<span class="line"><span style="color:#D8DEE9FF;">      </span></span>
<span class="line"><span style="color:#D8DEE9;">      #</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">address.keyword</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">990 Mill</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9;">  #</span><span style="color:#D8DEE9;"> å­—æ®µåé¢åŠ ä¸Š</span><span style="color:#D8DEE9;"> .keyword</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> å¿…é¡»å®Œå…¨åŒ¹é…</span></span>
<span class="line"><span style="color:#D8DEE9FF;">      </span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>4ã€<code>query/multi_math</code>ã€å¤šå­—æ®µåŒ¹é…ã€‘</p><p><code>stateæˆ–è€…addressä¸­åŒ…å«mill</code>ï¼Œå¹¶ä¸”åœ¨æŸ¥è¯¢è¿‡ç¨‹ä¸­ï¼Œä¼šå¯¹äºæŸ¥è¯¢æ¡ä»¶è¿›è¡Œåˆ†è¯ã€‚</p><div class="language-http line-numbers-mode" data-highlighter="shiki" data-ext="http" data-title="http" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">GET</span><span style="color:#D8DEE9FF;"> bank/_search</span></span>
<span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">query</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">multi_match</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9;">  #</span><span style="color:#D8DEE9;"> å‰é¢çš„matchä»…æŒ‡å®šäº†ä¸€ä¸ªå­—æ®µã€‚</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">query</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">mill</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">fields</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> [</span><span style="color:#D8DEE9;"> #</span><span style="color:#D8DEE9;"> stateå’Œaddressæœ‰millå­ä¸²</span><span style="color:#D8DEE9;">  ä¸è¦æ±‚éƒ½æœ‰</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#A3BE8C;">state</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#A3BE8C;">address</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">      ]</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>5ã€<code>query/bool/must</code>å¤åˆæŸ¥è¯¢</p><p>å¤åˆè¯­å¥å¯ä»¥åˆå¹¶ï¼Œä»»ä½•å…¶ä»–æŸ¥è¯¢è¯­å¥ï¼ŒåŒ…æ‹¬ç¬¦åˆè¯­å¥ã€‚è¿™ä¹Ÿå°±æ„å‘³ç€ï¼Œå¤åˆè¯­å¥ä¹‹é—´å¯ä»¥äº’ç›¸åµŒå¥—ï¼Œå¯ä»¥è¡¨è¾¾éå¸¸å¤æ‚çš„é€»è¾‘ã€‚</p><ul><li>mustï¼šå¿…é¡»è¾¾åˆ°mustæ‰€åˆ—ä¸¾çš„æ‰€æœ‰æ¡ä»¶</li><li>must_notï¼šå¿…é¡»ä¸åŒ¹é…must_notæ‰€åˆ—ä¸¾çš„æ‰€æœ‰æ¡ä»¶ã€‚</li><li>shouldï¼šåº”è¯¥æ»¡è¶³shouldæ‰€åˆ—ä¸¾çš„æ¡ä»¶ã€‚æ»¡è¶³æ¡ä»¶æœ€å¥½ï¼Œä¸æ»¡è¶³ä¹Ÿå¯ä»¥ï¼Œæ»¡è¶³å¾—åˆ†æ›´é«˜</li></ul><div class="language-http line-numbers-mode" data-highlighter="shiki" data-ext="http" data-title="http" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">GET</span><span style="color:#D8DEE9FF;"> bank/_search</span></span>
<span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">query</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">bool</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">must</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> [</span><span style="color:#D8DEE9;">   #</span><span style="color:#D8DEE9;"> genderå¿…é¡»æ˜¯Mï¼Œ</span><span style="color:#D8DEE9;"> addresså¿…é¡»åŒ…å«mill</span></span>
<span class="line"><span style="color:#ECEFF4;">        {</span></span>
<span class="line"><span style="color:#ECEFF4;">          &quot;</span><span style="color:#8FBCBB;">match</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">            &quot;</span><span style="color:#8FBCBB;">gender</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">M</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">          }</span></span>
<span class="line"><span style="color:#ECEFF4;">        },</span></span>
<span class="line"><span style="color:#ECEFF4;">        {</span></span>
<span class="line"><span style="color:#ECEFF4;">          &quot;</span><span style="color:#8FBCBB;">match</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">            &quot;</span><span style="color:#8FBCBB;">address</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">mill</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">          }</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#ECEFF4;">      ],</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">must_not</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> [</span><span style="color:#D8DEE9;">   #</span><span style="color:#D8DEE9;"> ageå¿…é¡»ä¸ç­‰äº</span><span style="color:#B48EAD;">18</span></span>
<span class="line"><span style="color:#ECEFF4;">        {</span></span>
<span class="line"><span style="color:#ECEFF4;">          &quot;</span><span style="color:#8FBCBB;">match</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">            &quot;</span><span style="color:#8FBCBB;">age</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">18</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">          }</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#ECEFF4;">      ],</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">should</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> [</span><span style="color:#D8DEE9;">    #</span><span style="color:#D8DEE9;"> lastnameæœ€å¥½åŒ…å«wallace</span></span>
<span class="line"><span style="color:#ECEFF4;">        {</span></span>
<span class="line"><span style="color:#ECEFF4;">          &quot;</span><span style="color:#8FBCBB;">match</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">            &quot;</span><span style="color:#8FBCBB;">lastname</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">Wallace</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">          }</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#ECEFF4;">      ]</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>6ã€<code>query/filter</code>ã€ç»“æœè¿‡æ»¤ã€‘</p><ul><li><p>ä¸Šé¢çš„mustå’Œshouldå½±å“ç›¸å…³æ€§å¾—åˆ†ï¼Œè€Œmust_notä»…ä»…æ˜¯ä¸€ä¸ªfilter ï¼Œä¸è´¡çŒ®å¾—åˆ†</p></li><li><p>mustæ”¹ä¸ºfilterå°±ä½¿mustä¸è´¡çŒ®å¾—åˆ†</p></li><li><p>å¦‚æœåªæœ‰filteræ¡ä»¶çš„è¯ï¼Œæˆ‘ä»¬ä¼šå‘ç°å¾—åˆ†éƒ½æ˜¯0</p></li></ul><p>å¹¶ä¸æ˜¯æ‰€æœ‰çš„æŸ¥è¯¢éƒ½éœ€è¦äº§ç”Ÿåˆ†æ•°ï¼Œç‰¹åˆ«æ˜¯å“ªäº›ä»…ç”¨äºfilteringè¿‡æ»¤çš„æ–‡æ¡£ã€‚ä¸å‚ä¸è¯„åˆ†æ›´å¿«, ä¸ºäº†ä¸è®¡ç®—åˆ†æ•°ï¼Œelasticsearchä¼šè‡ªåŠ¨æ£€æŸ¥åœºæ™¯å¹¶ä¸”ä¼˜åŒ–æŸ¥è¯¢çš„æ‰§è¡Œã€‚</p><div class="language-http line-numbers-mode" data-highlighter="shiki" data-ext="http" data-title="http" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">GET</span><span style="color:#D8DEE9FF;"> bank/_search</span></span>
<span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">query</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">bool</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">must</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> [</span></span>
<span class="line"><span style="color:#ECEFF4;">        {</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#8FBCBB;">match</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">address</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">mill</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> }</span><span style="color:#ECEFF4;"> }</span></span>
<span class="line"><span style="color:#ECEFF4;">      ],</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">filter</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9;">  #</span><span style="color:#D8DEE9;"> query.bool.filter</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">range</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">          &quot;</span><span style="color:#8FBCBB;">balance</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9;">  #</span><span style="color:#D8DEE9;"> å“ªä¸ªå­—æ®µ</span></span>
<span class="line"><span style="color:#ECEFF4;">            &quot;</span><span style="color:#8FBCBB;">gte</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">10000</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">            &quot;</span><span style="color:#8FBCBB;">lte</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">20000</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">          }</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#ECEFF4;">      }</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9FF;">è¿™é‡Œå…ˆæ˜¯æŸ¥è¯¢æ‰€æœ‰åŒ¹é…addressåŒ…å«millçš„æ–‡æ¡£ï¼Œç„¶åå†æ ¹æ®</span><span style="color:#B48EAD;">10000</span><span style="color:#D8DEE9FF;">&lt;=balance&lt;=</span><span style="color:#B48EAD;">20000</span><span style="color:#D8DEE9FF;">è¿›è¡Œè¿‡æ»¤æŸ¥è¯¢ç»“æœ</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>7ã€<code>query/term</code></p><p>å’Œ match ä¸€æ ·ã€‚åŒ¹é…æŸä¸ªå±æ€§çš„å€¼ã€‚å…¨æ–‡æ£€ç´¢å­—æ®µç”¨ matchï¼Œå…¶ä»–é text å­—æ®µåŒ¹é…ç”¨ termã€‚</p><p>æ¯”å¦‚ï¼šå¹´é¾„ä¸º23å²ï¼Œç”¨termï¼Œ addressä¸ºmill roadå°±ç”¨match</p><div class="language-http line-numbers-mode" data-highlighter="shiki" data-ext="http" data-title="http" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">GET</span><span style="color:#D8DEE9FF;"> bank/_search</span></span>
<span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">   &quot;</span><span style="color:#8FBCBB;">query</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">bool</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">         &quot;</span><span style="color:#8FBCBB;">must</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> [</span></span>
<span class="line"><span style="color:#ECEFF4;">            {</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">term</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">               &quot;</span><span style="color:#8FBCBB;">age</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">                  &quot;</span><span style="color:#8FBCBB;">value</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">28</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">               }</span></span>
<span class="line"><span style="color:#ECEFF4;">            }},</span></span>
<span class="line"><span style="color:#ECEFF4;">            {</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;">match</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">               &quot;</span><span style="color:#8FBCBB;">address</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">990 Mill Road</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">            }}</span></span>
<span class="line"><span style="color:#ECEFF4;">         ]</span></span>
<span class="line"><span style="color:#ECEFF4;">      }</span></span>
<span class="line"><span style="color:#ECEFF4;">   }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>8ã€<code>aggregations</code>ï¼ˆæ‰§è¡Œèšåˆï¼‰</p><p>â€‹ èšåˆæä¾›äº†ä»æ•°æ®ä¸­åˆ†ç»„å’Œæå–æ•°æ®çš„èƒ½åŠ›ã€‚æœ€ç®€å•çš„èšåˆæ–¹æ³•å¤§è‡´ç­‰äº SQL GROUP BY å’Œ SQL èšåˆå‡½æ•°ã€‚åœ¨ Elasticsearch ä¸­ï¼Œ<code>æœ‰æ‰§è¡Œæœç´¢è¿”å› hitsï¼ˆå‘½ä¸­ç»“æœï¼‰ï¼Œå¹¶ä¸”åŒæ—¶è¿”å›èšåˆç»“æœ</code>ï¼ŒæŠŠä¸€ä¸ªå“åº”ä¸­çš„æ‰€æœ‰ hitsï¼ˆå‘½ä¸­ç»“æœï¼‰åˆ†éš”å¼€çš„èƒ½åŠ›ã€‚è¿™æ˜¯éå¸¸å¼ºå¤§ä¸”æœ‰æ•ˆçš„ï¼Œæ‚¨å¯ä»¥æ‰§è¡ŒæŸ¥è¯¢å’Œå¤šä¸ªèšåˆï¼Œå¹¶ä¸”åœ¨ä¸€æ¬¡ä½¿ç”¨ä¸­å¾—åˆ°å„è‡ªçš„ï¼ˆä»»ä½•ä¸€ä¸ªçš„ï¼‰è¿”å›ç»“æœï¼Œä½¿ç”¨ä¸€æ¬¡ç®€æ´å’Œç®€åŒ–çš„ API æ¥é¿å…ç½‘ç»œå¾€è¿”ã€‚</p><p>ä¾‹ï¼šæœç´¢ address ä¸­åŒ…å« mill çš„æ‰€æœ‰äººçš„å¹´é¾„åˆ†å¸ƒä»¥åŠå¹³å‡å¹´é¾„ï¼Œä½†ä¸æ˜¾ç¤ºè¿™äº›äººçš„è¯¦æƒ…ã€‚</p><div class="language-http line-numbers-mode" data-highlighter="shiki" data-ext="http" data-title="http" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">GET</span><span style="color:#D8DEE9FF;"> bank/_search</span></span>
<span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">query</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9;"> #</span><span style="color:#D8DEE9;"> æŸ¥è¯¢å‡ºåŒ…å«millçš„</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">match</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">address</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">Mill</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  },</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">aggs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9;"> #åŸºäºæŸ¥è¯¢èšåˆ</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">ageAgg</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9;">  #</span><span style="color:#D8DEE9;"> èšåˆçš„åå­—ï¼Œéšä¾¿èµ·</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">terms</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9;"> #</span><span style="color:#D8DEE9;"> çœ‹å€¼çš„å¯èƒ½æ€§åˆ†å¸ƒ</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">field</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">age</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">size</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#B48EAD;"> 10</span></span>
<span class="line"><span style="color:#ECEFF4;">      }</span></span>
<span class="line"><span style="color:#ECEFF4;">    },</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">ageAvg</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">avg</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9;"> #</span><span style="color:#D8DEE9;"> çœ‹ageå€¼çš„å¹³å‡</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">field</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">age</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">      }</span></span>
<span class="line"><span style="color:#ECEFF4;">    },</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">balanceAvg</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">avg</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9;"> #</span><span style="color:#D8DEE9;"> çœ‹balanceçš„å¹³å‡</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">field</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">balance</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">      }</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  },</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">size</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#B48EAD;"> 0</span><span style="color:#D8DEE9;">  #</span><span style="color:#D8DEE9;"> ä¸çœ‹è¯¦æƒ…</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æŸ¥è¯¢ç»“æœï¼š</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">took</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 2</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">timed_out</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#81A1C1;"> false</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">_shards</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">total</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 1</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">successful</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 1</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">skipped</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">failed</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 0</span></span>
<span class="line"><span style="color:#ECEFF4;">  },</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">hits</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">total</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">value</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 4</span><span style="color:#ECEFF4;">,</span><span style="color:#616E88;"> // å‘½ä¸­4æ¡</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">relation</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">eq</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">    },</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">max_score</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#81A1C1;"> null</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">hits</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> [</span><span style="color:#ECEFF4;"> ]</span></span>
<span class="line"><span style="color:#ECEFF4;">  },</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">aggregations</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">ageAgg</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> {</span><span style="color:#616E88;"> // ç¬¬ä¸€ä¸ªèšåˆçš„ç»“æœ</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">doc_count_error_upper_bound</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">sum_other_doc_count</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">buckets</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> [</span></span>
<span class="line"><span style="color:#ECEFF4;">        {</span></span>
<span class="line"><span style="color:#ECEFF4;">          &quot;</span><span style="color:#8FBCBB;">key</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 38</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;">  #</span><span style="color:#D8DEE9;"> ageä¸º38çš„æœ‰2æ¡</span></span>
<span class="line"><span style="color:#ECEFF4;">          &quot;</span><span style="color:#8FBCBB;">doc_count</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 2</span></span>
<span class="line"><span style="color:#ECEFF4;">        },</span></span>
<span class="line"><span style="color:#ECEFF4;">        {</span></span>
<span class="line"><span style="color:#ECEFF4;">          &quot;</span><span style="color:#8FBCBB;">key</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 28</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">          &quot;</span><span style="color:#8FBCBB;">doc_count</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 1</span></span>
<span class="line"><span style="color:#ECEFF4;">        },</span></span>
<span class="line"><span style="color:#ECEFF4;">        {</span></span>
<span class="line"><span style="color:#ECEFF4;">          &quot;</span><span style="color:#8FBCBB;">key</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 32</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">          &quot;</span><span style="color:#8FBCBB;">doc_count</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 1</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#ECEFF4;">      ]</span></span>
<span class="line"><span style="color:#ECEFF4;">    },</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">ageAvg</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> {</span><span style="color:#616E88;"> // ç¬¬äºŒä¸ªèšåˆçš„ç»“æœ</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">value</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 34.0</span><span style="color:#D8DEE9;">  #</span><span style="color:#D8DEE9;"> balanceå­—æ®µçš„å¹³å‡å€¼æ˜¯</span><span style="color:#B48EAD;">34</span></span>
<span class="line"><span style="color:#ECEFF4;">    },</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">balanceAvg</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">value</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 25208.0</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¾‹ï¼šæŒ‰ç…§å¹´é¾„èšåˆï¼Œå¹¶ä¸”æ±‚è¿™äº›å¹´é¾„æ®µçš„è¿™äº›äººçš„å¹³å‡è–ªèµ„</p><p><code>aggs/aggName/aggs/aggName</code>å­èšåˆ</p><blockquote><p>å†™åˆ°ä¸€ä¸ªèšåˆé‡Œæ˜¯åŸºäºä¸Šä¸ªèšåˆè¿›è¡Œå­èšåˆã€‚</p><p>ä¸‹é¢æ±‚æ¯ä¸ªageåˆ†å¸ƒçš„å¹³å‡balance</p></blockquote><div class="language-http line-numbers-mode" data-highlighter="shiki" data-ext="http" data-title="http" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">GET</span><span style="color:#D8DEE9FF;"> bank/_search</span></span>
<span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">query</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">match_all</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {}</span></span>
<span class="line"><span style="color:#ECEFF4;">  },</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">aggs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">ageAgg</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">terms</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9;"> #</span><span style="color:#D8DEE9;"> çœ‹åˆ†å¸ƒ</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">field</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">age</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">size</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#B48EAD;"> 100</span></span>
<span class="line"><span style="color:#ECEFF4;">      },</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">aggs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9;"> #</span><span style="color:#D8DEE9;"> ä¸termså¹¶åˆ—</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">ageAvg</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9;"> #å¹³å‡</span></span>
<span class="line"><span style="color:#ECEFF4;">          &quot;</span><span style="color:#8FBCBB;">avg</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">            &quot;</span><span style="color:#8FBCBB;">field</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">balance</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">          }</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#ECEFF4;">      }</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  },</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">size</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#B48EAD;"> 0</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¾‹ï¼šå¤æ‚å­èšåˆï¼šæŸ¥å‡ºæ‰€æœ‰å¹´é¾„åˆ†å¸ƒï¼Œå¹¶ä¸”è¿™äº›<strong>å¹´é¾„æ®µ</strong>ä¸­Mçš„å¹³å‡è–ªèµ„å’ŒFçš„å¹³å‡è–ªèµ„ä»¥åŠè¿™ä¸ªå¹´é¾„æ®µçš„æ€»ä½“å¹³å‡è–ªèµ„</p><div class="language-http line-numbers-mode" data-highlighter="shiki" data-ext="http" data-title="http" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">GET</span><span style="color:#D8DEE9FF;"> bank/_search</span></span>
<span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">query</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">match_all</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {}</span></span>
<span class="line"><span style="color:#ECEFF4;">  },</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">aggs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">ageAgg</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">terms</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9;">  #</span><span style="color:#D8DEE9;">  çœ‹ageåˆ†å¸ƒ</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">field</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">age</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">size</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#B48EAD;"> 100</span></span>
<span class="line"><span style="color:#ECEFF4;">      },</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">aggs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9;"> #</span><span style="color:#D8DEE9;"> å­èšåˆ</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">genderAgg</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">          &quot;</span><span style="color:#8FBCBB;">terms</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9;"> #</span><span style="color:#D8DEE9;"> çœ‹genderåˆ†å¸ƒ</span></span>
<span class="line"><span style="color:#ECEFF4;">            &quot;</span><span style="color:#8FBCBB;">field</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">gender.keyword</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9;"> #</span><span style="color:#D8DEE9;"> æ³¨æ„è¿™é‡Œï¼Œæ–‡æœ¬å­—æ®µåº”è¯¥ç”¨.keyword</span></span>
<span class="line"><span style="color:#ECEFF4;">          },</span></span>
<span class="line"><span style="color:#ECEFF4;">          &quot;</span><span style="color:#8FBCBB;">aggs</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9;"> #</span><span style="color:#D8DEE9;"> å­èšåˆ</span></span>
<span class="line"><span style="color:#ECEFF4;">            &quot;</span><span style="color:#8FBCBB;">balanceAvg</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">              &quot;</span><span style="color:#8FBCBB;">avg</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9;"> #</span><span style="color:#D8DEE9;"> ç”·æ€§çš„å¹³å‡</span></span>
<span class="line"><span style="color:#ECEFF4;">                &quot;</span><span style="color:#8FBCBB;">field</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">balance</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">              }</span></span>
<span class="line"><span style="color:#ECEFF4;">            }</span></span>
<span class="line"><span style="color:#ECEFF4;">          }</span></span>
<span class="line"><span style="color:#ECEFF4;">        },</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">ageBalanceAvg</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">          &quot;</span><span style="color:#8FBCBB;">avg</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9;"> #ageåˆ†å¸ƒçš„å¹³å‡ï¼ˆç”·å¥³ï¼‰</span></span>
<span class="line"><span style="color:#ECEFF4;">            &quot;</span><span style="color:#8FBCBB;">field</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">balance</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">          }</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#ECEFF4;">      }</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  },</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">size</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#B48EAD;"> 0</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3ã€mappingå­—æ®µæ˜ å°„" tabindex="-1"><a class="header-anchor" href="#_3ã€mappingå­—æ®µæ˜ å°„"><span>3ã€Mappingå­—æ®µæ˜ å°„</span></a></h3><p>1ã€å­—æ®µç±»å‹</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407231954677.png" alt="image-20211012145448490" tabindex="0" loading="lazy"><figcaption>image-20211012145448490</figcaption></figure><blockquote><ul><li><code>text</code> â½¤äºå…¨â½‚ç´¢å¼•ï¼Œæœç´¢æ—¶ä¼šè‡ªåŠ¨ä½¿ç”¨åˆ†è¯å™¨è¿›â¾åˆ†è¯å†åŒ¹é…</li><li><code>keyword</code> ä¸åˆ†è¯ï¼Œæœç´¢æ—¶éœ€è¦åŒ¹é…å®Œæ•´çš„å€¼</li></ul></blockquote><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407231954708.png" alt="image-20211012145516034" tabindex="0" loading="lazy"><figcaption>image-20211012145516034</figcaption></figure><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407231954291.png" alt="image-20211012145531890" tabindex="0" loading="lazy"><figcaption>image-20211012145531890</figcaption></figure><p>2ã€Mappingï¼ˆæ˜ å°„ï¼‰ Mapping æ˜¯ç”¨æ¥å®šä¹‰ä¸€ä¸ªæ–‡æ¡£ï¼ˆdocumentï¼‰ï¼Œä»¥åŠå®ƒæ‰€åŒ…å«çš„å±æ€§ï¼ˆfieldï¼‰æ˜¯å¦‚ä½•å­˜å‚¨å’Œç´¢å¼•çš„ã€‚æ¯”å¦‚ï¼Œä½¿ç”¨ mapping æ¥å®šä¹‰ï¼š</p><ul><li>å“ªäº›å­—ç¬¦ä¸²å±æ€§åº”è¯¥è¢«çœ‹åšå…¨æ–‡æœ¬å±æ€§ï¼ˆfull text fieldsï¼‰ï¼›</li><li>å“ªäº›å±æ€§åŒ…å«æ•°å­—ï¼Œæ—¥æœŸæˆ–åœ°ç†ä½ç½®ï¼›</li><li>æ–‡æ¡£ä¸­çš„æ‰€æœ‰å±æ€§æ˜¯å¦éƒ½èƒ½è¢«ç´¢å¼•ï¼ˆall é…ç½®ï¼‰ï¼›</li><li>æ—¥æœŸçš„æ ¼å¼ï¼›</li><li>è‡ªå®šä¹‰æ˜ å°„è§„åˆ™æ¥æ‰§è¡ŒåŠ¨æ€æ·»åŠ å±æ€§ï¼›</li><li>æŸ¥çœ‹mappingä¿¡æ¯ï¼š<code>GET bank/_mapping</code></li></ul><p>3ã€æ–°ç‰ˆæœ¬æ”¹å˜</p><p>ElasticSearch7-å»æ‰typeæ¦‚å¿µ</p><ul><li>å…³ç³»å‹æ•°æ®åº“ä¸­ä¸¤ä¸ªæ•°æ®è¡¨ç¤ºæ˜¯ç‹¬ç«‹çš„ï¼Œå³ä½¿ä»–ä»¬é‡Œé¢æœ‰ç›¸åŒåç§°çš„åˆ—ä¹Ÿä¸å½±å“ä½¿ç”¨ï¼Œä½†ESä¸­ä¸æ˜¯è¿™æ ·çš„ã€‚elasticsearchæ˜¯åŸºäºLuceneå¼€å‘çš„æœç´¢å¼•æ“ï¼Œè€ŒESä¸­ä¸åŒtypeä¸‹åç§°ç›¸åŒçš„filedæœ€ç»ˆåœ¨Luceneä¸­çš„å¤„ç†æ–¹å¼æ˜¯ä¸€æ ·çš„ã€‚ <ul><li>ä¸¤ä¸ªä¸åŒtypeä¸‹çš„ä¸¤ä¸ªuser_nameï¼Œåœ¨ESåŒä¸€ä¸ªç´¢å¼•ä¸‹å…¶å®è¢«è®¤ä¸ºæ˜¯åŒä¸€ä¸ªfiledï¼Œä½ å¿…é¡»åœ¨ä¸¤ä¸ªä¸åŒçš„typeä¸­å®šä¹‰ç›¸åŒçš„filedæ˜ å°„ã€‚å¦åˆ™ï¼Œä¸åŒtypeä¸­çš„ç›¸åŒå­—æ®µåç§°å°±ä¼šåœ¨å¤„ç†ä¸­å‡ºç°å†²çªçš„æƒ…å†µï¼Œå¯¼è‡´Luceneå¤„ç†æ•ˆç‡ä¸‹é™ã€‚</li><li>å»æ‰typeå°±æ˜¯ä¸ºäº†æé«˜ESå¤„ç†æ•°æ®çš„æ•ˆç‡ã€‚</li></ul></li></ul><p>Elasticsearch 7.x URLä¸­çš„typeå‚æ•°ä¸ºå¯é€‰ã€‚æ¯”å¦‚ï¼Œç´¢å¼•ä¸€ä¸ªæ–‡æ¡£ä¸å†è¦æ±‚æä¾›æ–‡æ¡£ç±»å‹ã€‚</p><p>Elasticsearch 8.x ä¸å†æ”¯æŒURLä¸­çš„typeå‚æ•°ã€‚</p><p>è§£å†³ï¼š 1ï¼‰å°†ç´¢å¼•ä»å¤šç±»å‹è¿ç§»åˆ°å•ç±»å‹ï¼Œæ¯ç§ç±»å‹æ–‡æ¡£ä¸€ä¸ªç‹¬ç«‹ç´¢å¼•</p><p>2ï¼‰å°†å·²å­˜åœ¨çš„ç´¢å¼•ä¸‹çš„ç±»å‹æ•°æ®ï¼Œå…¨éƒ¨è¿ç§»åˆ°æŒ‡å®šä½ç½®å³å¯ã€‚è¯¦è§æ•°æ®è¿ç§»</p><p>4ã€å¯¹æ˜ å°„çš„æ“ä½œ</p><p>1ï¼‰åˆ›å»ºç´¢å¼•å¹¶æŒ‡å®šæ˜ å°„</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;">PUT /my_index</span></span>
<span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">mappings</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">properties</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">age</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">type</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">integer</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">      },</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">email</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">type</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">keyword</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9;"> #</span><span style="color:#D8DEE9;"> æŒ‡å®šä¸ºkeyword</span></span>
<span class="line"><span style="color:#ECEFF4;">      },</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">name</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">type</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">text</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9;"> #</span><span style="color:#D8DEE9;"> å…¨æ–‡æ£€ç´¢ã€‚ä¿å­˜æ—¶å€™åˆ†è¯ï¼Œæ£€ç´¢æ—¶å€™è¿›è¡Œåˆ†è¯åŒ¹é…</span></span>
<span class="line"><span style="color:#ECEFF4;">      }</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2ï¼‰æ·»åŠ æ–°çš„å­—æ®µæ˜ å°„</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;">PUT /my_index/_mapping</span></span>
<span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">properties</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">employee-id</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">type</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">keyword</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">index</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#81A1C1;"> false</span><span style="color:#D8DEE9;"> #</span><span style="color:#D8DEE9;"> å­—æ®µä¸èƒ½è¢«æ£€ç´¢ã€‚æ£€ç´¢</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>3)æ›´æ–°æ˜ å°„</p><p>å¯¹äºå·²ç»å­˜åœ¨çš„æ˜ å°„å­—æ®µï¼Œæˆ‘ä»¬ä¸èƒ½æ›´æ–°ã€‚æ›´æ–°å¿…é¡»åˆ›å»ºæ–°çš„ç´¢å¼•è¿›è¡Œæ•°æ®è¿ç§»</p><p>4ï¼‰æ•°æ®è¿ç§»</p><p>å…ˆåˆ›å»ºnew_twitterçš„æ­£ç¡®æ˜ å°„ï¼Œç„¶åä½¿ç”¨å¦‚ä¸‹æ–¹å¼è¿›è¡Œæ•°æ®è¿ç§»ã€‚</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#B48EAD;">6.0</span><span style="color:#D8DEE9FF;">ä»¥åå†™æ³•</span></span>
<span class="line"><span style="color:#D8DEE9FF;">POST reindex</span></span>
<span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">source</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:{</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">index</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">twitter</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">   },</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">dest</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:{</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">index</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">new_twitters</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">   }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9FF;">è€ç‰ˆæœ¬å†™æ³•</span></span>
<span class="line"><span style="color:#D8DEE9FF;">POST reindex</span></span>
<span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">source</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:{</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">index</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">twitter</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">twitter</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">twitter</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">   },</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">dest</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:{</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">index</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">new_twitters</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">   }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç¤ºä¾‹ï¼šæŠŠbank/accountä¸‹çš„æ–‡æ¡£è¿ç§»åˆ°newbankä¸‹</p><ul><li><p>åˆ›å»ºnewbankç´¢å¼•</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;">PUT /newbank</span></span>
<span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">mappings</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">properties</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">account_number</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">type</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">long</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">      },</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">address</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">type</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">text</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">      },</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">age</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">type</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">integer</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">      },</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">balance</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">type</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">long</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">      },</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">city</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">type</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">keyword</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">      },</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">email</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">type</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">keyword</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">      },</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">employer</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">type</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">keyword</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">      },</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">firstname</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">type</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">text</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">      },</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">gender</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">type</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">keyword</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">      },</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">lastname</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">type</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">text</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">fields</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">          &quot;</span><span style="color:#8FBCBB;">keyword</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">            &quot;</span><span style="color:#8FBCBB;">type</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">keyword</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">            &quot;</span><span style="color:#8FBCBB;">ignore_above</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#B48EAD;"> 256</span></span>
<span class="line"><span style="color:#ECEFF4;">          }</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#ECEFF4;">      },</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">state</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">type</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">keyword</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">      }</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>æ•°æ®è¿ç§»</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;">POST _reindex</span></span>
<span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">source</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">index</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">bank</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">type</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">account</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">  },</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">dest</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">index</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">newbank</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">  }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>æŸ¥çœ‹newbankä¸­çš„æ•°æ®</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;">GET /newbank/_search</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9FF;">è¾“å‡º</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#A3BE8C;">hits</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;"> : </span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">total</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">value</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 1000</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">relation</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">eq</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">    },</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">max_score</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 1.0</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#8FBCBB;">hits</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> [</span></span>
<span class="line"><span style="color:#ECEFF4;">      {</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">_index</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">newbank</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">        &quot;</span><span style="color:#8FBCBB;">_type</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">_doc</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> #</span><span style="color:#D8DEE9;"> æ²¡æœ‰äº†ç±»å‹</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h3 id="_4ã€åˆ†è¯" tabindex="-1"><a class="header-anchor" href="#_4ã€åˆ†è¯"><span>4ã€åˆ†è¯</span></a></h3><ul><li><p>ä¸€ä¸ªtokenizerï¼ˆåˆ†è¯å™¨ï¼‰æ¥æ”¶ä¸€ä¸ªå­—ç¬¦æµï¼Œå°†ä¹‹åˆ†å‰²ä¸ºç‹¬ç«‹çš„tokensï¼ˆè¯å…ƒï¼Œé€šå¸¸æ˜¯ç‹¬ç«‹çš„å•è¯ï¼‰ï¼Œç„¶åè¾“å‡ºtokensæµã€‚</p></li><li><p>ä¾‹å¦‚ï¼šwhitespace tokenizeré‡åˆ°ç©ºç™½å­—ç¬¦æ—¶åˆ†å‰²æ–‡æœ¬ã€‚å®ƒä¼šå°†æ–‡æœ¬&quot;Quick brown fox!&quot;åˆ†å‰²ä¸º[Quick,brown,fox!]</p></li><li><p>è¯¥tokenizerï¼ˆåˆ†è¯å™¨ï¼‰è¿˜è´Ÿè´£è®°å½•å„ä¸ªterms(è¯æ¡)çš„é¡ºåºæˆ–positionä½ç½®ï¼ˆç”¨äºphraseçŸ­è¯­å’Œword proximityè¯è¿‘é‚»æŸ¥è¯¢ï¼‰ï¼Œä»¥åŠtermï¼ˆè¯æ¡ï¼‰æ‰€ä»£è¡¨çš„åŸå§‹wordï¼ˆå•è¯ï¼‰çš„startï¼ˆèµ·å§‹ï¼‰å’Œendï¼ˆç»“æŸï¼‰çš„character offsetsï¼ˆå­—ç¬¦ä¸²åç§»é‡ï¼‰ï¼ˆç”¨äºé«˜äº®æ˜¾ç¤ºæœç´¢çš„å†…å®¹ï¼‰ã€‚</p></li><li><p>elasticsearchæä¾›äº†å¾ˆå¤šå†…ç½®çš„åˆ†è¯å™¨ï¼ˆæ ‡å‡†åˆ†è¯å™¨ï¼‰ï¼Œå¯ä»¥ç”¨æ¥æ„å»ºcustom analyzersï¼ˆè‡ªå®šä¹‰åˆ†è¯å™¨ï¼‰</p></li></ul><p>ç¤ºä¾‹ï¼š</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;">POST _analyze</span></span>
<span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">analyzer</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">standard</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">text</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">Quick brown fox!</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åˆ†è¯ç»“æœï¼š</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407231954361.png" alt="image-20211012154808341" tabindex="0" loading="lazy"><figcaption>image-20211012154808341</figcaption></figure><p><strong>1ã€å®‰è£…ikåˆ†è¯å™¨</strong></p><p>æ‰€æœ‰çš„è¯­è¨€åˆ†è¯ï¼Œé»˜è®¤ä½¿ç”¨çš„éƒ½æ˜¯â€œStandard Analyzerâ€ï¼Œä½†æ˜¯è¿™äº›åˆ†è¯å™¨é’ˆå¯¹äºä¸­æ–‡çš„åˆ†è¯ï¼Œå¹¶ä¸å‹å¥½ã€‚ä¸ºæ­¤éœ€è¦å®‰è£…ä¸­æ–‡çš„åˆ†è¯å™¨ã€‚</p><p>ä¸‹è½½åœ°å€ï¼šhttps://github.com/medcl/elasticsearch-analysis-ik/releases</p><p>åœ¨å‰é¢å®‰è£…çš„elasticsearchæ—¶ï¼Œæˆ‘ä»¬å·²ç»å°†elasticsearchå®¹å™¨çš„â€œ/usr/share/elasticsearch/pluginsâ€ç›®å½•ï¼Œæ˜ å°„åˆ°å®¿ä¸»æœºçš„â€œ /mydata/elasticsearch/pluginsâ€ç›®å½•ä¸‹ï¼Œæ‰€ä»¥æ¯”è¾ƒæ–¹ä¾¿çš„åšæ³•å°±æ˜¯ä¸‹è½½â€œ/elasticsearch-analysis-ik-7.4.2.zipâ€æ–‡ä»¶ï¼Œç„¶åè§£å‹åˆ°è¯¥æ–‡ä»¶å¤¹ä¸‹å³å¯ã€‚å®‰è£…å®Œæ¯•åï¼Œéœ€è¦é‡å¯elasticsearchå®¹å™¨ã€‚</p><p><strong>2ã€æµ‹è¯•åˆ†è¯å™¨</strong></p><p>1ã€ik_smart</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;">POST _analyze</span></span>
<span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">analyzer</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">ik_smart</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">text</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">æˆ‘æ˜¯ä¸­å›½äºº</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿”å›ç»“æœ</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">tokens</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> [</span></span>
<span class="line"><span style="color:#ECEFF4;">    {</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">token</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">æˆ‘</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">start_offset</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">end_offset</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 1</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">type</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">CN_CHAR</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">position</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 0</span></span>
<span class="line"><span style="color:#ECEFF4;">    },</span></span>
<span class="line"><span style="color:#ECEFF4;">    {</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">token</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">æ˜¯</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">start_offset</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 1</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">end_offset</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 2</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">type</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">CN_CHAR</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">position</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 1</span></span>
<span class="line"><span style="color:#ECEFF4;">    },</span></span>
<span class="line"><span style="color:#ECEFF4;">    {</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">token</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">ä¸­å›½äºº</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">start_offset</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 2</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">end_offset</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 5</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">type</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">CN_WORD</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">position</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 2</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  ]</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2ã€ik_max_word</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;">POST _analyze</span></span>
<span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">analyzer</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">ik_max_word</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">text</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">æˆ‘æ˜¯ä¸­å›½äºº</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿”å›ç»“æœ</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">tokens</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> [</span></span>
<span class="line"><span style="color:#ECEFF4;">    {</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">token</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">æˆ‘</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">start_offset</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">end_offset</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 1</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">type</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">CN_CHAR</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">position</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 0</span></span>
<span class="line"><span style="color:#ECEFF4;">    },</span></span>
<span class="line"><span style="color:#ECEFF4;">    {</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">token</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">æ˜¯</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">start_offset</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 1</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">end_offset</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 2</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">type</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">CN_CHAR</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">position</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 1</span></span>
<span class="line"><span style="color:#ECEFF4;">    },</span></span>
<span class="line"><span style="color:#ECEFF4;">    {</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">token</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">ä¸­å›½äºº</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">start_offset</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 2</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">end_offset</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 5</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">type</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">CN_WORD</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">position</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 2</span></span>
<span class="line"><span style="color:#ECEFF4;">    },</span></span>
<span class="line"><span style="color:#ECEFF4;">    {</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">token</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">ä¸­å›½</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">start_offset</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 2</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">end_offset</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 4</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">type</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">CN_WORD</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">position</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 3</span></span>
<span class="line"><span style="color:#ECEFF4;">    },</span></span>
<span class="line"><span style="color:#ECEFF4;">    {</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">token</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">å›½äºº</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">start_offset</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 3</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">end_offset</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 5</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">type</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">CN_WORD</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">position</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 4</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  ]</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>3ã€è‡ªå®šä¹‰è¯åº“</strong></p><p>å…ˆå®‰è£…nginx</p><p>1ï¼‰éšä¾¿å¯åŠ¨ä¸€ä¸ª nginx å®ä¾‹ï¼Œåªæ˜¯ä¸ºäº†å¤åˆ¶å‡ºé…ç½®</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">docker</span><span style="color:#A3BE8C;"> run</span><span style="color:#A3BE8C;"> -p</span><span style="color:#A3BE8C;"> 80:80</span><span style="color:#A3BE8C;"> --name</span><span style="color:#A3BE8C;"> nginx</span><span style="color:#A3BE8C;"> -d</span><span style="color:#A3BE8C;"> nginx:1.10</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>2)å°†å®¹å™¨å†…çš„é…ç½®æ–‡ä»¶æ‹·è´åˆ°å½“å‰ç›®å½•</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">docker</span><span style="color:#A3BE8C;"> container</span><span style="color:#A3BE8C;"> cp</span><span style="color:#A3BE8C;"> nginx:/etc/nginx</span><span style="color:#A3BE8C;"> .</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>3ï¼‰ä¿®æ”¹æ–‡ä»¶åç§°ï¼šmv nginx conf æŠŠè¿™ä¸ª conf ç§»åŠ¨åˆ°/mydata/nginx ä¸‹</p><p>4ï¼‰ç»ˆæ­¢åŸå®¹å™¨ï¼šdocker stop nginx</p><p>5ï¼‰æ‰§è¡Œå‘½ä»¤åˆ é™¤åŸå®¹å™¨ï¼šdocker rm $ContainerId</p><p>6ï¼‰åˆ›å»ºæ–°çš„ nginxï¼›æ‰§è¡Œä»¥ä¸‹å‘½ä»¤</p><div class="language-she line-numbers-mode" data-highlighter="shiki" data-ext="she" data-title="she" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span>docker run -p 80:80 --name nginx \</span></span>
<span class="line"><span>-v /mydata/nginx/html:/usr/share/nginx/html \</span></span>
<span class="line"><span>-v /mydata/nginx/logs:/var/log/nginx \</span></span>
<span class="line"><span>-v /mydata/nginx/conf:/etc/nginx \</span></span>
<span class="line"><span>-d nginx:1.10</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>7)ç»™ nginx çš„ html ä¸‹é¢æ”¾çš„æ‰€æœ‰èµ„æºå¯ä»¥ç›´æ¥è®¿é—®ï¼›</p><p>8)åœ¨nginx/html/ä¸­åˆ›å»ºä¸€ä¸ªesæ–‡ä»¶å¤¹ï¼Œåœ¨é‡Œé¢æ–°å»ºæ–‡ä»¶fenci.txtï¼Œç”¨ä½œåˆ†è¯è¡¨ï¼Œå†™å…¥ï¼šå°šç¡…è°·</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407231954484.png" alt="image-20211012192408901" tabindex="0" loading="lazy"><figcaption>image-20211012192408901</figcaption></figure><p>9ï¼‰è®¿é—®ï¼Œç”±äºè®¿é—®nginxä¸­èµ„æºï¼Œéƒ½åœ¨htmlæ–‡ä»¶å¤¹ä¸‹æŸ¥æ‰¾ï¼Œæ‰€ä»¥ç›´æ¥è®¿é—®/es/fenci.txtå³å¯ï¼ˆä¹±ç å…ˆä¸ç”¨ç®¡ï¼Œè®¿é—®åˆ°äº†å³å¯ï¼‰</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407231954706.png" alt="image-20211012192537189" tabindex="0" loading="lazy"><figcaption>image-20211012192537189</figcaption></figure><p>10ï¼‰ä¿®æ”¹/usr/share/elasticsearch/plugins/ik/configä¸­çš„IKAnalyzer.cfg.xml</p><div class="language-xml line-numbers-mode" data-highlighter="shiki" data-ext="xml" data-title="xml" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">&lt;?</span><span style="color:#5E81AC;">xml</span><span style="color:#8FBCBB;"> version</span><span style="color:#D8DEE9FF;">=</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">1.0</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#8FBCBB;"> encoding</span><span style="color:#D8DEE9FF;">=</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">UTF-8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">?&gt;</span></span>
<span class="line"><span style="color:#81A1C1;">&lt;!</span><span style="color:#5E81AC;">DOCTYPE</span><span style="color:#81A1C1;"> properties</span><span style="color:#D8DEE9FF;"> SYSTEM &quot;http://java.sun.com/dtd/properties.dtd&quot;</span><span style="color:#81A1C1;">&gt;</span></span>
<span class="line"><span style="color:#81A1C1;">&lt;properties&gt;</span></span>
<span class="line"><span style="color:#81A1C1;">	&lt;comment&gt;</span><span style="color:#D8DEE9FF;">IK Analyzer æ‰©å±•é…ç½®</span><span style="color:#81A1C1;">&lt;/comment&gt;</span></span>
<span class="line"><span style="color:#616E88;">	&lt;!--ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œé…ç½®è‡ªå·±çš„æ‰©å±•å­—å…¸ --&gt;</span></span>
<span class="line"><span style="color:#81A1C1;">	&lt;entry</span><span style="color:#8FBCBB;"> key</span><span style="color:#D8DEE9FF;">=</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ext_dict</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">&gt;&lt;/entry&gt;</span></span>
<span class="line"><span style="color:#616E88;">	 &lt;!--ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œé…ç½®è‡ªå·±çš„æ‰©å±•åœæ­¢è¯å­—å…¸--&gt;</span></span>
<span class="line"><span style="color:#81A1C1;">	&lt;entry</span><span style="color:#8FBCBB;"> key</span><span style="color:#D8DEE9FF;">=</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ext_stopwords</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">&gt;&lt;/entry&gt;</span></span>
<span class="line"><span style="color:#616E88;">	&lt;!--ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œé…ç½®è¿œç¨‹æ‰©å±•å­—å…¸ --&gt;</span></span>
<span class="line"><span style="color:#81A1C1;">	&lt;entry</span><span style="color:#8FBCBB;"> key</span><span style="color:#D8DEE9FF;">=</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">remote_ext_dict</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">&gt;</span><span style="color:#D8DEE9FF;">http://192.168.56.10/es/fenci.txt</span><span style="color:#81A1C1;">&lt;/entry&gt;</span><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#616E88;">	&lt;!--ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œé…ç½®è¿œç¨‹æ‰©å±•åœæ­¢è¯å­—å…¸--&gt;</span></span>
<span class="line"><span style="color:#616E88;">	&lt;!-- &lt;entry key=&quot;remote_ext_stopwords&quot;&gt;words_location&lt;/entry&gt; --&gt;</span></span>
<span class="line"><span style="color:#81A1C1;">&lt;/properties&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>11ï¼‰é‡å¯es,éªŒè¯åˆ†è¯æ•ˆæœ</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;">POST _analyze</span></span>
<span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">analyzer</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">ik_max_word</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">text</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">å°šç¡…è°·ä¸é”™</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åˆ†è¯æ•ˆæœ</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">  &quot;</span><span style="color:#8FBCBB;">tokens</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> [</span></span>
<span class="line"><span style="color:#ECEFF4;">    {</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">token</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">å°šç¡…è°·</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">start_offset</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 0</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">end_offset</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 3</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">type</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">CN_WORD</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">position</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 0</span></span>
<span class="line"><span style="color:#ECEFF4;">    },</span></span>
<span class="line"><span style="color:#ECEFF4;">    {</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">token</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">ç¡…è°·</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">start_offset</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 1</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">end_offset</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 3</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">type</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">CN_WORD</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">position</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 1</span></span>
<span class="line"><span style="color:#ECEFF4;">    },</span></span>
<span class="line"><span style="color:#ECEFF4;">    {</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">token</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">ä¸é”™</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">start_offset</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 3</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">end_offset</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 5</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">type</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">CN_WORD</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">      &quot;</span><span style="color:#8FBCBB;">position</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;"> :</span><span style="color:#B48EAD;"> 2</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">  ]</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="go-elasticsearch" tabindex="-1"><a class="header-anchor" href="#go-elasticsearch"><span>go-elasticsearch</span></a></h1><p><a href="https://www.elastic.co/guide/en/elasticsearch/client/go-api/current/getting-started-go.html" target="_blank" rel="noopener noreferrer">å¼€å§‹ä½¿ç”¨ |Elasticsearch Go å®¢æˆ·ç«¯ </a></p><p>ä½¿ç”¨ç¬¬ä¸‰æ–¹ç»„ä»¶æ­¥éª¤</p><p>åˆ›å»ºå®¢æˆ·ç«¯ï¼Œ</p><p>ä½¿ç”¨å®¢æˆ·ç«¯æ“ä½œç›¸åº”API</p><h1 id="åˆ›å»ºå®¢æˆ·ç«¯" tabindex="-1"><a class="header-anchor" href="#åˆ›å»ºå®¢æˆ·ç«¯"><span>åˆ›å»ºå®¢æˆ·ç«¯</span></a></h1><p>goæä¾›äº†2ç§ä¸¤ç§å®¢æˆ·ç«¯ï¼Œä¸€ç§æ˜¯ä½çº§apiï¼Œä¸€ç§æ˜¯å…¨ç±»å‹APIï¼Œä¸‹é¢æä¾›äº†ç¤ºä¾‹å…¨æ˜¯åŸºäºå…¨ç±»å‹çš„ã€‚å…·ä½“çš„å¯ä»¥æŸ¥çœ‹ä¸Šæ–¹ç»™å‡ºçš„å®˜ç½‘ã€‚</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407241747556.png" alt="image-20240724174725467" tabindex="0" loading="lazy"><figcaption>image-20240724174725467</figcaption></figure><div class="language-go line-numbers-mode" data-highlighter="shiki" data-ext="go" data-title="go" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// ES é…ç½®</span></span>
<span class="line"><span style="color:#D8DEE9;">cfg</span><span style="color:#81A1C1;"> :=</span><span style="color:#D8DEE9FF;"> elasticsearch</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9FF;">Config</span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">	Addresses</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> []</span><span style="color:#81A1C1;">string</span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">		&quot;</span><span style="color:#A3BE8C;">http://localhost:9200</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">	},</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// åˆ›å»ºå®¢æˆ·ç«¯è¿æ¥</span></span>
<span class="line"><span style="color:#D8DEE9;">client</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;"> :=</span><span style="color:#D8DEE9;"> elasticsearch</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">NewTypedClient</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">cfg</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"><span style="color:#81A1C1;">if</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;"> !=</span><span style="color:#81A1C1;"> nil</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">	fmt</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">Printf</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">elasticsearch.NewTypedClient failed, err:</span><span style="color:#EBCB8B;">%v\n</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"><span style="color:#81A1C1;">	return</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>çœ‹åˆ°è¯¥å®¢æˆ·ç«¯æœ‰API</p><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407241749128.png" alt="image-20240724174902053" tabindex="0" loading="lazy"><figcaption>image-20240724174902053</figcaption></figure><h1 id="åˆ›å»ºç´¢å¼•" tabindex="-1"><a class="header-anchor" href="#åˆ›å»ºç´¢å¼•"><span>åˆ›å»ºç´¢å¼•</span></a></h1><div class="language-go line-numbers-mode" data-highlighter="shiki" data-ext="go" data-title="go" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9;">typedClient</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">Indices</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">Create</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">my_index</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">).</span><span style="color:#88C0D0;">Do</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">context</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">TODO</span><span style="color:#ECEFF4;">())</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h1 id="å¢åŠ æ–‡æ¡£" tabindex="-1"><a class="header-anchor" href="#å¢åŠ æ–‡æ¡£"><span>å¢åŠ æ–‡æ¡£</span></a></h1><div class="language-go line-numbers-mode" data-highlighter="shiki" data-ext="go" data-title="go" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9;">document</span><span style="color:#81A1C1;"> :=</span><span style="color:#81A1C1;"> struct</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">    Name</span><span style="color:#81A1C1;"> string</span><span style="color:#ECEFF4;"> `</span><span style="color:#A3BE8C;">json:&quot;name&quot;</span><span style="color:#ECEFF4;">`</span></span>
<span class="line"><span style="color:#ECEFF4;">}{</span></span>
<span class="line"><span style="color:#ECEFF4;">    &quot;</span><span style="color:#A3BE8C;">go-elasticsearch</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"><span style="color:#D8DEE9;">typedClient</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">Index</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">my_index</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">).</span></span>
<span class="line"><span style="color:#88C0D0;">		Id</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">1</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">).</span></span>
<span class="line"><span style="color:#88C0D0;">		Request</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">document</span><span style="color:#ECEFF4;">).</span></span>
<span class="line"><span style="color:#88C0D0;">		Do</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">context</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">TODO</span><span style="color:#ECEFF4;">())</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="æŸ¥è¯¢æ–‡æ¡£" tabindex="-1"><a class="header-anchor" href="#æŸ¥è¯¢æ–‡æ¡£"><span>æŸ¥è¯¢æ–‡æ¡£</span></a></h1><div class="language-go line-numbers-mode" data-highlighter="shiki" data-ext="go" data-title="go" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9;">typedClient</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">Get</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">my_index</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">id</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">).</span><span style="color:#88C0D0;">Do</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">context</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">TODO</span><span style="color:#ECEFF4;">())</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h1 id="æ›´æ–°æ–‡æ¡£" tabindex="-1"><a class="header-anchor" href="#æ›´æ–°æ–‡æ¡£"><span>æ›´æ–°æ–‡æ¡£</span></a></h1><div class="language-go line-numbers-mode" data-highlighter="shiki" data-ext="go" data-title="go" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9;">typedClient</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">Update</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">my_index</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">id</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">).</span></span>
<span class="line"><span style="color:#88C0D0;">	Request</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">&amp;</span><span style="color:#D8DEE9FF;">update</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9FF;">Request</span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">        Doc</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9;"> json</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">RawMessage</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">{ language: &quot;Go&quot; }</span><span style="color:#ECEFF4;">`</span><span style="color:#ECEFF4;">),</span></span>
<span class="line"><span style="color:#ECEFF4;">    }).</span><span style="color:#88C0D0;">Do</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">context</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">TODO</span><span style="color:#ECEFF4;">())</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="åˆ é™¤æ–‡æ¡£" tabindex="-1"><a class="header-anchor" href="#åˆ é™¤æ–‡æ¡£"><span>åˆ é™¤æ–‡æ¡£</span></a></h1><div class="language-go line-numbers-mode" data-highlighter="shiki" data-ext="go" data-title="go" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9;">typedClient</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">Delete</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">my_index</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">id</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">).</span><span style="color:#88C0D0;">Do</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">context</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">TODO</span><span style="color:#ECEFF4;">())</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h1 id="åˆ é™¤ç´¢å¼•" tabindex="-1"><a class="header-anchor" href="#åˆ é™¤ç´¢å¼•"><span>åˆ é™¤ç´¢å¼•</span></a></h1><div class="language-go line-numbers-mode" data-highlighter="shiki" data-ext="go" data-title="go" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9;">typedClient</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">Indices</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">Delete</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">my_index</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">).</span><span style="color:#88C0D0;">Do</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">context</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">TODO</span><span style="color:#ECEFF4;">())</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h1 id="ç®€å•å®ç°å¸–å­å…¨æ–‡æ£€ç´¢" tabindex="-1"><a class="header-anchor" href="#ç®€å•å®ç°å¸–å­å…¨æ–‡æ£€ç´¢"><span>ç®€å•å®ç°å¸–å­å…¨æ–‡æ£€ç´¢</span></a></h1><h2 id="å®šä¹‰å®ä½“" tabindex="-1"><a class="header-anchor" href="#å®šä¹‰å®ä½“"><span>å®šä¹‰å®ä½“</span></a></h2><div class="language-go line-numbers-mode" data-highlighter="shiki" data-ext="go" data-title="go" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">type</span><span style="color:#D8DEE9FF;"> Post </span><span style="color:#81A1C1;">struct</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">	ID</span><span style="color:#81A1C1;">          int64</span><span style="color:#ECEFF4;">     `</span><span style="color:#A3BE8C;">json:&quot;id,string&quot; db:&quot;post_id&quot;</span><span style="color:#ECEFF4;">`</span><span style="color:#616E88;">                            // å¸–å­id</span></span>
<span class="line"><span style="color:#D8DEE9;">	AuthorID</span><span style="color:#81A1C1;">    int64</span><span style="color:#ECEFF4;">     `</span><span style="color:#A3BE8C;">json:&quot;author_id&quot; db:&quot;author_id&quot;</span><span style="color:#ECEFF4;">`</span><span style="color:#616E88;">                          // ä½œè€…id</span></span>
<span class="line"><span style="color:#D8DEE9;">	CommunityID</span><span style="color:#81A1C1;"> int64</span><span style="color:#ECEFF4;">     `</span><span style="color:#A3BE8C;">json:&quot;community_id&quot; db:&quot;community_id&quot; binding:&quot;required&quot;</span><span style="color:#ECEFF4;">`</span><span style="color:#616E88;"> // ç¤¾åŒºid</span></span>
<span class="line"><span style="color:#D8DEE9;">	Status</span><span style="color:#81A1C1;">      int32</span><span style="color:#ECEFF4;">     `</span><span style="color:#A3BE8C;">json:&quot;status&quot; db:&quot;status&quot;</span><span style="color:#ECEFF4;">`</span><span style="color:#616E88;">                                // å¸–å­çŠ¶æ€</span></span>
<span class="line"><span style="color:#D8DEE9;">	Title</span><span style="color:#81A1C1;">       string</span><span style="color:#ECEFF4;">    `</span><span style="color:#A3BE8C;">json:&quot;title&quot; db:&quot;title&quot; binding:&quot;required&quot;</span><span style="color:#ECEFF4;">`</span><span style="color:#616E88;">               // å¸–å­æ ‡é¢˜</span></span>
<span class="line"><span style="color:#D8DEE9;">	Content</span><span style="color:#81A1C1;">     string</span><span style="color:#ECEFF4;">    `</span><span style="color:#A3BE8C;">json:&quot;content&quot; db:&quot;content&quot; binding:&quot;required&quot;</span><span style="color:#ECEFF4;">`</span><span style="color:#616E88;">           // å¸–å­å†…å®¹</span></span>
<span class="line"><span style="color:#D8DEE9;">	CreateTime</span><span style="color:#D8DEE9FF;">  time</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9FF;">Time </span><span style="color:#ECEFF4;">`</span><span style="color:#A3BE8C;">json:&quot;create_time&quot; db:&quot;create_time&quot;</span><span style="color:#ECEFF4;">`</span><span style="color:#616E88;">                      // å¸–å­åˆ›å»ºæ—¶é—´</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="åˆ›å»ºç´¢å¼•-1" tabindex="-1"><a class="header-anchor" href="#åˆ›å»ºç´¢å¼•-1"><span>åˆ›å»ºç´¢å¼•</span></a></h2><div class="language-go line-numbers-mode" data-highlighter="shiki" data-ext="go" data-title="go" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// createIndex åˆ›å»ºç´¢å¼•</span></span>
<span class="line"><span style="color:#81A1C1;">func</span><span style="color:#88C0D0;"> createIndex</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">client</span><span style="color:#81A1C1;"> *</span><span style="color:#D8DEE9FF;">elasticsearch</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9FF;">TypedClient</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">	resp</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;"> :=</span><span style="color:#D8DEE9;"> client</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">Indices</span><span style="color:#ECEFF4;">.</span></span>
<span class="line"><span style="color:#88C0D0;">		Create</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">post</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">).</span></span>
<span class="line"><span style="color:#88C0D0;">		Do</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">context</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">Background</span><span style="color:#ECEFF4;">())</span></span>
<span class="line"><span style="color:#81A1C1;">	if</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;"> !=</span><span style="color:#81A1C1;"> nil</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">		fmt</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">Printf</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">create index failed, err:</span><span style="color:#EBCB8B;">%v\n</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"><span style="color:#81A1C1;">		return</span></span>
<span class="line"><span style="color:#ECEFF4;">	}</span></span>
<span class="line"><span style="color:#D8DEE9;">	fmt</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">Printf</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">index:</span><span style="color:#EBCB8B;">%#v\n</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> resp</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">Index</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="å¢åŠ æ–‡æ¡£-1" tabindex="-1"><a class="header-anchor" href="#å¢åŠ æ–‡æ¡£-1"><span>å¢åŠ æ–‡æ¡£</span></a></h2><div class="language-go line-numbers-mode" data-highlighter="shiki" data-ext="go" data-title="go" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">// indexDocument ç´¢å¼•æ–‡æ¡£</span></span>
<span class="line"><span style="color:#81A1C1;">func</span><span style="color:#88C0D0;"> indexDocument</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">client</span><span style="color:#81A1C1;"> *</span><span style="color:#D8DEE9FF;">elasticsearch</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9FF;">TypedClient</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;">post</span><span style="color:#D8DEE9FF;"> Post</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">	// å®šä¹‰ document ç»“æ„ä½“å¯¹è±¡</span></span>
<span class="line"><span style="color:#616E88;">	//Post{</span></span>
<span class="line"><span style="color:#616E88;">    //  ID: 1,             // å¸–å­id</span></span>
<span class="line"><span style="color:#616E88;">    //    AuthorID:          // ä½œè€…id</span></span>
<span class="line"><span style="color:#616E88;">    //    CommunityID:       // ç¤¾åŒºid</span></span>
<span class="line"><span style="color:#616E88;">    //    Status:            // å¸–å­çŠ¶æ€</span></span>
<span class="line"><span style="color:#616E88;">    //    Title:             // å¸–å­æ ‡é¢˜</span></span>
<span class="line"><span style="color:#616E88;">    //    Content:           // å¸–å­å†…å®¹</span></span>
<span class="line"><span style="color:#616E88;">    //    CreateTime:        //å¸–å­åˆ›å»ºæ—¶é—´</span></span>
<span class="line"><span style="color:#616E88;">	//		}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">	// æ·»åŠ æ–‡æ¡£</span></span>
<span class="line"><span style="color:#D8DEE9;">	resp</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;"> :=</span><span style="color:#D8DEE9;"> client</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">Index</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">post</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">).</span></span>
<span class="line"><span style="color:#88C0D0;">		Id</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">strconv</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">FormatInt</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">post</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">ID</span><span style="color:#ECEFF4;">,</span><span style="color:#B48EAD;"> 10</span><span style="color:#ECEFF4;">)).</span></span>
<span class="line"><span style="color:#88C0D0;">		Document</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">post</span><span style="color:#ECEFF4;">).</span></span>
<span class="line"><span style="color:#88C0D0;">		Do</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">context</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">Background</span><span style="color:#ECEFF4;">())</span></span>
<span class="line"><span style="color:#81A1C1;">	if</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;"> !=</span><span style="color:#81A1C1;"> nil</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">		fmt</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">Printf</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">indexing document failed, err:</span><span style="color:#EBCB8B;">%v\n</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"><span style="color:#81A1C1;">		return</span></span>
<span class="line"><span style="color:#ECEFF4;">	}</span></span>
<span class="line"><span style="color:#D8DEE9;">	fmt</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">Printf</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">result:</span><span style="color:#EBCB8B;">%#v\n</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> resp</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">Result</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="åŠ¨æ€æœç´¢æ–‡æ¡£" tabindex="-1"><a class="header-anchor" href="#åŠ¨æ€æœç´¢æ–‡æ¡£"><span>åŠ¨æ€æœç´¢æ–‡æ¡£</span></a></h2><div class="language-go line-numbers-mode" data-highlighter="shiki" data-ext="go" data-title="go" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">import</span><span style="color:#ECEFF4;"> (</span></span>
<span class="line"><span style="color:#ECEFF4;">	&quot;</span><span style="color:#A3BE8C;">context</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">	&quot;</span><span style="color:#A3BE8C;">fmt</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">	&quot;</span><span style="color:#A3BE8C;">github.com/elastic/go-elasticsearch/v8</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">	&quot;</span><span style="color:#A3BE8C;">github.com/elastic/go-elasticsearch/v8/typedapi/types</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">// searchDocument æŒ‡å®šæ¡ä»¶æœç´¢æ–‡æ¡£</span></span>
<span class="line"><span style="color:#81A1C1;">func</span><span style="color:#88C0D0;"> searchDocument</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">client</span><span style="color:#81A1C1;"> *</span><span style="color:#D8DEE9FF;">elasticsearch</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9FF;">TypedClient</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;">str</span><span style="color:#81A1C1;"> string</span><span style="color:#ECEFF4;">)</span><span style="color:#D8DEE9;"> data</span><span style="color:#ECEFF4;"> []</span><span style="color:#81A1C1;">string</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">	// æœç´¢contentä¸­åŒ…å«çš„æ–‡æ¡£</span></span>
<span class="line"><span style="color:#D8DEE9;">	resp</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;"> :=</span><span style="color:#D8DEE9;"> client</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">Search</span><span style="color:#ECEFF4;">().</span></span>
<span class="line"><span style="color:#88C0D0;">		Index</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">post</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">).</span></span>
<span class="line"><span style="color:#88C0D0;">		Query</span><span style="color:#ECEFF4;">(</span><span style="color:#81A1C1;">&amp;</span><span style="color:#D8DEE9FF;">types</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9FF;">Query</span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#D8DEE9;">			MatchPhrase</span><span style="color:#ECEFF4;">:</span><span style="color:#81A1C1;"> map</span><span style="color:#ECEFF4;">[</span><span style="color:#81A1C1;">string</span><span style="color:#ECEFF4;">]</span><span style="color:#D8DEE9FF;">types</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9FF;">MatchPhraseQuery</span><span style="color:#ECEFF4;">{</span></span>
<span class="line"><span style="color:#ECEFF4;">				&quot;</span><span style="color:#A3BE8C;">content</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> {</span><span style="color:#D8DEE9;">Query</span><span style="color:#ECEFF4;">:</span><span style="color:#D8DEE9;"> str</span><span style="color:#ECEFF4;">},</span></span>
<span class="line"><span style="color:#ECEFF4;">			},</span></span>
<span class="line"><span style="color:#ECEFF4;">		}).</span></span>
<span class="line"><span style="color:#88C0D0;">		Do</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">context</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">Background</span><span style="color:#ECEFF4;">())</span></span>
<span class="line"><span style="color:#81A1C1;">	if</span><span style="color:#D8DEE9;"> err</span><span style="color:#81A1C1;"> !=</span><span style="color:#81A1C1;"> nil</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">		fmt</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">Printf</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">search document failed, err:</span><span style="color:#EBCB8B;">%v\n</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> err</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"><span style="color:#81A1C1;">		return</span></span>
<span class="line"><span style="color:#ECEFF4;">	}</span></span>
<span class="line"><span style="color:#616E88;">	//fmt.Printf(&quot;total: %d\n&quot;, resp.Hits.Total.Value)</span></span>
<span class="line"><span style="color:#616E88;">	//// éå†æ‰€æœ‰ç»“æœ</span></span>
<span class="line"><span style="color:#81A1C1;">	for</span><span style="color:#D8DEE9;"> _</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> hit</span><span style="color:#81A1C1;"> :=</span><span style="color:#81A1C1;"> range</span><span style="color:#D8DEE9;"> resp</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">Hits</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">Hits</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">		fmt</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">Printf</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#EBCB8B;">%s\n</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> hit</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">Source_</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"><span style="color:#616E88;">        // è¿™é‡Œå‡è®¾hit.Source_æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œå¦‚æœå®é™…ç±»å‹ä¸åŒï¼Œéœ€è¦åšç›¸åº”çš„è½¬æ¢</span></span>
<span class="line"><span style="color:#D8DEE9;">		data</span><span style="color:#81A1C1;"> =</span><span style="color:#88C0D0;"> append</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">data</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> fmt</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">Sprintf</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#EBCB8B;">%v</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> hit</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">Source_</span><span style="color:#ECEFF4;">))</span></span>
<span class="line"><span style="color:#ECEFF4;">	}</span></span>
<span class="line"><span style="color:#81A1C1;">    return</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><!----><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><div class="contributors"><span class="vp-meta-label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="vp-meta-info" title="email: 2843768@qq.com">reniunai</span><!--]--><!--]--></div></div></footer><!----><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper"><!----><!----></footer></div><!--]--><!--[--><!----><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-CfDCVS1X.js" defer></script>
  </body>
</html>
