import{_ as t}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as a,d as i,a as e,f as n,e as o,o as p}from"./app-zamys2Ga.js";const s={},r=e("p",null,[e("code",null,"more"),n(" 注释之前的内容被视为文章摘要。")],-1),c=o('<h1 id="缓存穿透" tabindex="-1"><a class="header-anchor" href="#缓存穿透"><span>缓存穿透</span></a></h1><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407162329593.png" alt="image-20240716232915559" tabindex="0" loading="lazy"><figcaption>image-20240716232915559</figcaption></figure><p>缓存穿透：</p><p>指查询一个不存在的数据，由于缓存不命中，将去查询数据库，但是数据库也无此记录，我们没有将这次查询的null写入</p><p>缓存，这将导致这个不存在的数据每次请求都要到存储层去查询，失去了缓存的意义。</p><p>风险：</p><p>利用不存在的数据进行攻击，数据库压力瞬间增大，最终导致崩溃</p><p>解决：</p><ul><li>null结果缓存，并加入短暂过期时间</li><li>布隆过滤器判断是否存在</li></ul><h1 id="缓存击穿" tabindex="-1"><a class="header-anchor" href="#缓存击穿"><span>缓存击穿</span></a></h1><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407162329508.png" alt="image-20240716232939467" tabindex="0" loading="lazy"><figcaption>image-20240716232939467</figcaption></figure><p>缓存击穿：</p><p>对于一些设置了过期时间的key，如果这些key可能在某些时间内被超高并发的访问，是一种非常热点的数据</p><p>，如果这个key在大量请求同时进来前刚好失效，那么所有对这个key的数据查询都落到db，我们称为缓存击穿。</p><p>解决：</p><ul><li><p>分布式锁</p><p>大量并发只让一人去查，其他人等待，查询到以后释放锁，其他人获取到锁，先查询缓存，就会有数据，不用去DB查询</p></li><li><p>逻辑过期</p><p>第二种方案可以设置当前key逻辑过期，大概是思路如下：</p><p>①：在设置key的时候，设置一个过期时间字段一块存入缓存中，不给当前key设置过期时间</p><p>②：当查询的时候，从redis取出数据后判断时间是否过期</p><p>③：如果过期则开通另外一个线程进行数据同步，当前线程正常返回数据，这个数据不是最新</p></li></ul><p>当然两种方案各有利弊：</p><p>如果选择数据的强一致性，建议使用分布式锁的方案，性能上可能没那么高，锁需要等，也有可能产生死锁的问题</p><p>如果选择key的逻辑删除，则优先考虑的高可用性，性能比较高，但是数据同步这块做不到强一致。</p><h1 id="缓存雪崩" tabindex="-1"><a class="header-anchor" href="#缓存雪崩"><span>缓存雪崩</span></a></h1><figure><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407162330907.png" alt="image-20240716233013863" tabindex="0" loading="lazy"><figcaption>image-20240716233013863</figcaption></figure><p>缓存雪崩：</p><p>缓存雪崩是指我们在设置缓存key时采用了相同的过期时间，导致缓存在某一时刻同时失效，请求全部转发到DB，DB压力瞬时压力过重雪崩</p><p>解决：</p><p>在原有的失效时间基础上行增加一个随机值，比如1-5分钟随机，这样每一个缓存的过期时间的重复率就会降低，</p><p>就很难引发集体失效的事件</p>',26);function m(l,d){return p(),a("div",null,[r,i(" more "),c])}const u=t(s,[["render",m],["__file","2.Redis缓存（缓存穿透、、缓存击穿、缓存雪崩）.html.vue"]]),_=JSON.parse('{"path":"/note/redis/2.Redis%E7%BC%93%E5%AD%98%EF%BC%88%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F%E3%80%81%E3%80%81%E7%BC%93%E5%AD%98%E5%87%BB%E7%A9%BF%E3%80%81%E7%BC%93%E5%AD%98%E9%9B%AA%E5%B4%A9%EF%BC%89.html","title":"Redis缓存三兄弟","lang":"zh-CN","frontmatter":{"title":"Redis缓存三兄弟","cover":"/assets/images/cover1.jpg","icon":"file","order":3,"author":"HotMilk","category":["Redis"],"tag":["缓存穿透","缓存击穿","缓存雪崩"],"description":"more 注释之前的内容被视为文章摘要。","head":[["meta",{"property":"og:url","content":"https://reniunai.github.io/note/redis/2.Redis%E7%BC%93%E5%AD%98%EF%BC%88%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F%E3%80%81%E3%80%81%E7%BC%93%E5%AD%98%E5%87%BB%E7%A9%BF%E3%80%81%E7%BC%93%E5%AD%98%E9%9B%AA%E5%B4%A9%EF%BC%89.html"}],["meta",{"property":"og:site_name","content":"热牛奶"}],["meta",{"property":"og:title","content":"Redis缓存三兄弟"}],["meta",{"property":"og:description","content":"more 注释之前的内容被视为文章摘要。"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://reniunai.github.io/assets/images/cover1.jpg"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-08-05T08:48:07.000Z"}],["meta",{"name":"twitter:card","content":"summary_large_image"}],["meta",{"name":"twitter:image:src","content":"https://reniunai.github.io/assets/images/cover1.jpg"}],["meta",{"name":"twitter:image:alt","content":"Redis缓存三兄弟"}],["meta",{"property":"article:author","content":"HotMilk"}],["meta",{"property":"article:tag","content":"缓存穿透"}],["meta",{"property":"article:tag","content":"缓存击穿"}],["meta",{"property":"article:tag","content":"缓存雪崩"}],["meta",{"property":"article:modified_time","content":"2024-08-05T08:48:07.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Redis缓存三兄弟\\",\\"image\\":[\\"https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407162329593.png\\",\\"https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407162329508.png\\",\\"https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407162330907.png\\"],\\"dateModified\\":\\"2024-08-05T08:48:07.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"HotMilk\\"}]}"]]},"headers":[],"git":{"createdTime":1722847687000,"updatedTime":1722847687000,"contributors":[{"name":"reniunai","email":"2843768@qq.com","commits":1}]},"readingTime":{"minutes":2.77,"words":830},"filePathRelative":"note/redis/2.Redis缓存（缓存穿透、、缓存击穿、缓存雪崩）.md","localizedDate":"2024年8月5日","excerpt":"<p><code>more</code> 注释之前的内容被视为文章摘要。</p>\\n","autoDesc":true}');export{u as comp,_ as data};
