import{_ as n}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as a,d as l,a as s,e,o as p}from"./app-CfDCVS1X.js";const o={},c=s("h1",{id:"canal解决mysql和redis数据同步-mq",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#canal解决mysql和redis数据同步-mq"},[s("span",null,"Canal解决Mysql和Redis数据同步(MQ)")])],-1),t=e(`<h3 id="mysql和redis数据同步方案" tabindex="-1"><a class="header-anchor" href="#mysql和redis数据同步方案"><span>Mysql和Redis数据同步方案</span></a></h3><p>根据上面所说，我们就可以通过Canal去自动同步数据库的binlog数据日志文件，然后再把数据同步到Redis，从而达到Mysql和Redis自动同步的功能。很遗憾的是Canal没办法直接把数据库同步到Redis，它支持的是组件有 ： mysql、Kafka、ElasticSearch、Hbase、RocketMQ等</p><p><img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407171258005.png" alt="在这里插入图片描述" loading="lazy"> 当然 canal 特别设计了 client-server 模式，交互协议使用 protobuf 3.0 , client 端可采用不同语言实现不同的消费逻辑</p><ul><li>canal java 客户端: https://github.com/alibaba/canal/wiki/ClientExample</li><li>canal c# 客户端: https://github.com/dotnetcore/CanalSharp</li><li>canal go客户端: https://github.com/CanalClient/canal-go</li><li>canal Python客户端: https://github.com/haozi3156666/canal-python</li></ul><p>canal 作为 MySQL binlog 增量获取和解析工具，可将变更记录投递到 MQ 系统中，比如 Kafka/RocketMQ，可以借助于 MQ 的多语言能力,因此我们可以使用下面这种方案来同步数据 <img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407171258928.png" alt="在这里插入图片描述" loading="lazy"> 这里对流程做一个解释</p><ol><li>首选我们需要开启Mysql的bin-log日志文件</li><li>接着安装好Canal去同步bin-log日志，同时配置RocketMQ地址，Canal会把消息推送给MQ</li><li>需要编写Java客户端去监听MQ中的消息，然后往Redis中进行同步</li></ol><h3 id="开启mysql-bin-log日志" tabindex="-1"><a class="header-anchor" href="#开启mysql-bin-log日志"><span>开启Mysql bin-log日志</span></a></h3><p>找到Mysql安装目录中的my.ini 配置文件，我以mysql 5.5为例,在 mysqld 下做如下配置</p><div class="language-ini line-numbers-mode" data-highlighter="shiki" data-ext="ini" data-title="ini" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">mysqld</span><span style="color:#ECEFF4;">]</span></span>
<span class="line"><span style="color:#616E88;">#开启bInlog</span></span>
<span class="line"><span style="color:#81A1C1;">log-bin</span><span style="color:#ECEFF4;">=</span><span style="color:#D8DEE9FF;">mysql-bin</span></span>
<span class="line"><span style="color:#616E88;">#给mysql服务指定一个唯一的ID</span></span>
<span class="line"><span style="color:#81A1C1;">server-id</span><span style="color:#ECEFF4;">=</span><span style="color:#D8DEE9FF;">1</span></span>
<span class="line"><span style="color:#616E88;">#以数据的方式写binlog日志 ：statement 是记录SQL，row是记录数据</span></span>
<span class="line"><span style="color:#81A1C1;">binlog-format</span><span style="color:#ECEFF4;">=</span><span style="color:#D8DEE9FF;">ROW</span></span>
<span class="line"><span style="color:#616E88;">#同步的数据库名</span></span>
<span class="line"><span style="color:#81A1C1;">binlog-do-db</span><span style="color:#ECEFF4;">=</span><span style="color:#D8DEE9FF;">canaldb</span></span>
<span class="line"><span style="color:#616E88;">#忽略的表</span></span>
<span class="line"><span style="color:#81A1C1;">binlog-ignore-db</span><span style="color:#ECEFF4;">=</span><span style="color:#D8DEE9FF;">mysql</span></span>
<span class="line"><span style="color:#616E88;"># 启动mysql时不启动grant-tables授权表</span></span>
<span class="line"><span style="color:#D8DEE9FF;">skip-grant-tables</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>修改好之后，重启Mysql服务。注意：我这里指定了需要同步的数据库为canaldb，所以需要创建一个数据库，同时创建了一个employee表作为演示 <img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407171258752.png" alt="在这里插入图片描述" loading="lazy"> 然后创建一个用户提供给canal来链接Mysql做数据同步</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;">flush privileges;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">#创建用户cannal</span></span>
<span class="line"><span style="color:#81A1C1;">CREATE</span><span style="color:#81A1C1;"> USER</span><span style="color:#88C0D0;"> canal</span><span style="color:#D8DEE9FF;"> IDENTIFIED </span><span style="color:#81A1C1;">BY</span><span style="color:#ECEFF4;"> &#39;</span><span style="color:#A3BE8C;">canal</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">#把所有权限赋予canal，密码也是canal</span></span>
<span class="line"><span style="color:#81A1C1;">GRANT</span><span style="color:#D8DEE9FF;"> ALL PRIVILEGES </span><span style="color:#81A1C1;">ON</span><span style="color:#D8DEE9FF;"> canaldb.user </span><span style="color:#81A1C1;">TO</span><span style="color:#ECEFF4;"> &#39;</span><span style="color:#A3BE8C;">canal</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">@</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">%</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;"> identified </span><span style="color:#81A1C1;">by</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">canal</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">;</span></span>
<span class="line"><span style="color:#81A1C1;">//GRANT</span><span style="color:#81A1C1;"> SELECT</span><span style="color:#D8DEE9FF;">, REPLICATION SLAVE, REPLICATION CLIENT </span><span style="color:#81A1C1;">ON</span><span style="color:#81A1C1;"> *</span><span style="color:#D8DEE9FF;">.</span><span style="color:#81A1C1;">*</span><span style="color:#81A1C1;"> TO</span><span style="color:#ECEFF4;"> &#39;</span><span style="color:#A3BE8C;">canal</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">@</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">%</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;"> identified </span><span style="color:#81A1C1;">by</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">canal</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">#刷新权限</span></span>
<span class="line"><span style="color:#D8DEE9FF;">flush privileges;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>到这，Mysql部分就搞定了</p><h3 id="安装canal" tabindex="-1"><a class="header-anchor" href="#安装canal"><span>安装Canal</span></a></h3><p>去官网下载 Canal : https://github.com/alibaba/canal/releases ，我使用的是canal.deployer-1.1.5.tar.gz版本<img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407171258755.png" alt="在这里插入图片描述" loading="lazy"></p><p>下载好之后解压，目录结构如下 <img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407171258731.png" alt="在这里插入图片描述" loading="lazy"> 接下来修改instance 配置文件 ： conf/example/instance.properties</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;">#  按需修改成自己的数据库信息</span></span>
<span class="line"><span style="color:#D8DEE9FF;">#################################################</span></span>
<span class="line"><span style="color:#D8DEE9FF;">...</span></span>
<span class="line"><span style="color:#D8DEE9FF;">#我的端口是3307</span></span>
<span class="line"><span style="color:#D8DEE9FF;">canal.instance.master.address</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">192</span><span style="color:#D8DEE9FF;">.</span><span style="color:#B48EAD;">168</span><span style="color:#D8DEE9FF;">.</span><span style="color:#B48EAD;">1</span><span style="color:#D8DEE9FF;">.</span><span style="color:#B48EAD;">20</span><span style="color:#D8DEE9FF;">:</span><span style="color:#B48EAD;">3307</span></span>
<span class="line"><span style="color:#D8DEE9FF;"># username</span><span style="color:#81A1C1;">/password</span><span style="color:#D8DEE9FF;">,数据库的用户名和密码</span></span>
<span class="line"><span style="color:#D8DEE9FF;">...</span></span>
<span class="line"><span style="color:#D8DEE9FF;">#刚才开通的mysql的账户密码</span></span>
<span class="line"><span style="color:#D8DEE9FF;">canal.instance.dbUsername </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> canal</span></span>
<span class="line"><span style="color:#D8DEE9FF;">canal.instance.dbPassword </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> canal</span></span>
<span class="line"><span style="color:#D8DEE9FF;">...</span></span>
<span class="line"><span style="color:#D8DEE9FF;">#################################################</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9FF;"># mq config 数据同步到MQ中的topic名字</span></span>
<span class="line"><span style="color:#D8DEE9FF;">canal.mq.topic</span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;">example</span></span>
<span class="line"><span style="color:#D8DEE9FF;"># 针对库名或者表名发送动态topic</span></span>
<span class="line"><span style="color:#D8DEE9FF;">#canal.mq.dynamicTopic</span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;">mytest,.</span><span style="color:#81A1C1;">*</span><span style="color:#D8DEE9FF;">,mytest.user,mytest\\\\..</span><span style="color:#81A1C1;">*</span><span style="color:#D8DEE9FF;">,.</span><span style="color:#81A1C1;">*</span><span style="color:#D8DEE9FF;">\\\\..</span><span style="color:#81A1C1;">*</span></span>
<span class="line"><span style="color:#D8DEE9FF;">canal.mq.</span><span style="color:#81A1C1;">partition=</span><span style="color:#B48EAD;">0</span></span>
<span class="line"><span style="color:#D8DEE9FF;"># </span><span style="color:#81A1C1;">hash</span><span style="color:#81A1C1;"> partition</span><span style="color:#D8DEE9FF;"> config</span></span>
<span class="line"><span style="color:#D8DEE9FF;">#canal.mq.partitionsNum</span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;">3</span></span>
<span class="line"><span style="color:#D8DEE9FF;">#库名.表名: 唯一主键，多个表之间用逗号分隔</span></span>
<span class="line"><span style="color:#D8DEE9FF;">#canal.mq.partitionHash</span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;">mytest.person:id,mytest.role:id</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这里注意如下几个东西，其他的不用管</p><ul><li>master.address ：Mysql的地址，我的端口是3307，默认是3306</li><li>dbUsername ：上面开通的Mysql用户</li><li>dbPassword ： 密码</li><li>canal.mq.topic=example ： 数据同步到MQ中的topic名字</li></ul><p>接着修改canal 配置文件 conf/canal.properties</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;"># ...</span></span>
<span class="line"><span style="color:#D8DEE9FF;"># 可选项: </span><span style="color:#81A1C1;">tcp</span><span style="color:#D8DEE9FF;">(默认), kafka, RocketMQ</span></span>
<span class="line"><span style="color:#D8DEE9FF;"># 这里使用RocketMQ</span></span>
<span class="line"><span style="color:#D8DEE9FF;">canal.serverMode </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> rocketMQ</span></span>
<span class="line"><span style="color:#D8DEE9FF;"># ...</span></span>
<span class="line"><span style="color:#D8DEE9FF;">##################################################</span></span>
<span class="line"><span style="color:#D8DEE9FF;">######### 		    RocketMQ	     #############</span></span>
<span class="line"><span style="color:#D8DEE9FF;">##################################################</span></span>
<span class="line"><span style="color:#D8DEE9FF;">rocketmq.producer.group </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> test</span></span>
<span class="line"><span style="color:#D8DEE9FF;">rocketmq.enable.message.trace </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> false</span></span>
<span class="line"><span style="color:#D8DEE9FF;">rocketmq.customized.trace.topic </span><span style="color:#81A1C1;">=</span></span>
<span class="line"><span style="color:#D8DEE9FF;">rocketmq.namespace </span><span style="color:#81A1C1;">=</span></span>
<span class="line"><span style="color:#D8DEE9FF;"># RocketMQ的地址</span></span>
<span class="line"><span style="color:#D8DEE9FF;">rocketmq.namesrv.addr </span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;"> 127</span><span style="color:#D8DEE9FF;">.</span><span style="color:#B48EAD;">0</span><span style="color:#D8DEE9FF;">.</span><span style="color:#B48EAD;">0</span><span style="color:#D8DEE9FF;">.</span><span style="color:#B48EAD;">1</span><span style="color:#D8DEE9FF;">:</span><span style="color:#B48EAD;">9876</span></span>
<span class="line"><span style="color:#D8DEE9FF;">rocketmq.retry.</span><span style="color:#81A1C1;">times</span><span style="color:#D8DEE9FF;">.when.send.failed </span><span style="color:#81A1C1;">=</span><span style="color:#B48EAD;"> 0</span></span>
<span class="line"><span style="color:#D8DEE9FF;">rocketmq.vip.channel.enabled </span><span style="color:#81A1C1;">=</span><span style="color:#D8DEE9FF;"> false</span></span>
<span class="line"><span style="color:#D8DEE9FF;">rocketmq.tag </span><span style="color:#81A1C1;">=</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这里需要注意2个东西</p><ul><li>canal.serverMode = rocketMQ ： 我这里以RocketMQ为例</li><li>rocketmq.namesrv.addr = 127.0.0.1:9876 ： 指向RocketMQ的地址</li></ul><p>配置好之后，找到 canal 安装目录下 bin目录下的 startup.bat 双击启动，linux上启动：startup.sh <img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407171258767.png" alt="在这里插入图片描述" loading="lazy"></p><p>对于RocketMQ没使用过的童鞋可以看我《<a href="https://blog.csdn.net/u014494148/category_11320162.html?spm=1001.2014.3001.5482" target="_blank" rel="noopener noreferrer">RocketMQ极简入门专题</a>》，启动Canal和RocketMQ之后，尝试往employee表中增加数据，观察MQ控制台是否有数据同步，访问http://localhost:8080/#/message 如下 <img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407171258670.png" alt="在这里插入图片描述" loading="lazy"> 点击 MESSAGE DETAIL 如下 <img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407171258677.png" alt="在这里插入图片描述" loading="lazy"> 数据是JSON格式存储到MQ中的 ， 这里可以看到数据同步于哪个数据库，哪个表，以及数据内容以及old老数据。注意这里的内容格式，后面我们需要封装对象</p><h3 id="java程序把数据同步到redis" tabindex="-1"><a class="header-anchor" href="#java程序把数据同步到redis"><span>Java程序把数据同步到Redis</span></a></h3><p>接下来需要编写一个Java程序来消费MQ中的消息同步到Redis ，创建项目，导入依赖</p><div class="language-xml line-numbers-mode" data-highlighter="shiki" data-ext="xml" data-title="xml" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#81A1C1;">&lt;parent&gt;</span></span>
<span class="line"><span style="color:#81A1C1;">    &lt;groupId&gt;</span><span style="color:#D8DEE9FF;"> org.springframework.boot</span><span style="color:#81A1C1;">&lt;/groupId&gt;</span></span>
<span class="line"><span style="color:#81A1C1;">    &lt;artifactId&gt;</span><span style="color:#D8DEE9FF;">spring-boot-starter-parent</span><span style="color:#81A1C1;">&lt;/artifactId&gt;</span></span>
<span class="line"><span style="color:#81A1C1;">    &lt;version&gt;</span><span style="color:#D8DEE9FF;">2.2.5.RELEASE</span><span style="color:#81A1C1;">&lt;/version&gt;</span></span>
<span class="line"><span style="color:#81A1C1;">&lt;/parent&gt;</span></span>
<span class="line"><span style="color:#D8DEE9FF;"> </span></span>
<span class="line"><span style="color:#81A1C1;">&lt;dependencies&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">&lt;dependency&gt;</span></span>
<span class="line"><span style="color:#81A1C1;">   &lt;groupId&gt;</span><span style="color:#D8DEE9FF;">org.springframework.boot</span><span style="color:#81A1C1;">&lt;/groupId&gt;</span></span>
<span class="line"><span style="color:#81A1C1;">     &lt;artifactId&gt;</span><span style="color:#D8DEE9FF;">spring-boot-starter-web</span><span style="color:#81A1C1;">&lt;/artifactId&gt;</span></span>
<span class="line"><span style="color:#81A1C1;"> &lt;/dependency&gt;</span></span>
<span class="line"><span style="color:#81A1C1;">&lt;dependency&gt;</span></span>
<span class="line"><span style="color:#81A1C1;">	&lt;groupId&gt;</span><span style="color:#D8DEE9FF;">org.apache.rocketmq</span><span style="color:#81A1C1;">&lt;/groupId&gt;</span></span>
<span class="line"><span style="color:#81A1C1;">	 &lt;artifactId&gt;</span><span style="color:#D8DEE9FF;">rocketmq-spring-boot-starter</span><span style="color:#81A1C1;">&lt;/artifactId&gt;</span></span>
<span class="line"><span style="color:#81A1C1;">	 &lt;version&gt;</span><span style="color:#D8DEE9FF;">2.0.4</span><span style="color:#81A1C1;">&lt;/version&gt;</span></span>
<span class="line"><span style="color:#81A1C1;">&lt;/dependency&gt;</span></span>
<span class="line"><span style="color:#616E88;">&lt;!--整合Redis , 底层可以用jedis--&gt;</span></span>
<span class="line"><span style="color:#81A1C1;">&lt;dependency&gt;</span></span>
<span class="line"><span style="color:#81A1C1;">  &lt;groupId&gt;</span><span style="color:#D8DEE9FF;">org.springframework.boot</span><span style="color:#81A1C1;">&lt;/groupId&gt;</span></span>
<span class="line"><span style="color:#81A1C1;">  &lt;artifactId&gt;</span><span style="color:#D8DEE9FF;">spring-boot-starter-data-redis</span><span style="color:#81A1C1;">&lt;/artifactId&gt;</span></span>
<span class="line"><span style="color:#81A1C1;">  &lt;exclusions&gt;</span></span>
<span class="line"><span style="color:#81A1C1;">      &lt;exclusion&gt;</span></span>
<span class="line"><span style="color:#81A1C1;">          &lt;groupId&gt;</span><span style="color:#D8DEE9FF;">io.lettuce</span><span style="color:#81A1C1;">&lt;/groupId&gt;</span></span>
<span class="line"><span style="color:#81A1C1;">          &lt;artifactId&gt;</span><span style="color:#D8DEE9FF;">lettuce-core</span><span style="color:#81A1C1;">&lt;/artifactId&gt;</span></span>
<span class="line"><span style="color:#81A1C1;">      &lt;/exclusion&gt;</span></span>
<span class="line"><span style="color:#81A1C1;">  &lt;/exclusions&gt;</span></span>
<span class="line"><span style="color:#81A1C1;">&lt;/dependency&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">&lt;dependency&gt;</span></span>
<span class="line"><span style="color:#81A1C1;">  &lt;groupId&gt;</span><span style="color:#D8DEE9FF;">redis.clients</span><span style="color:#81A1C1;">&lt;/groupId&gt;</span></span>
<span class="line"><span style="color:#81A1C1;">  &lt;artifactId&gt;</span><span style="color:#D8DEE9FF;">jedis</span><span style="color:#81A1C1;">&lt;/artifactId&gt;</span></span>
<span class="line"><span style="color:#81A1C1;">&lt;/dependency&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#81A1C1;">&lt;/dependencies&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>编写yml配置MQ和Redis</p><div class="language-yml line-numbers-mode" data-highlighter="shiki" data-ext="yml" data-title="yml" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#616E88;">#..其他省略..</span></span>
<span class="line"><span style="color:#8FBCBB;">spring</span><span style="color:#ECEFF4;">:</span></span>
<span class="line"><span style="color:#8FBCBB;">  redis</span><span style="color:#ECEFF4;">:</span></span>
<span class="line"><span style="color:#8FBCBB;">    database</span><span style="color:#ECEFF4;">:</span><span style="color:#B48EAD;"> 0</span></span>
<span class="line"><span style="color:#8FBCBB;">    host</span><span style="color:#ECEFF4;">:</span><span style="color:#B48EAD;"> 127.0.0.1</span></span>
<span class="line"><span style="color:#8FBCBB;">    port</span><span style="color:#ECEFF4;">:</span><span style="color:#B48EAD;"> 6379</span></span>
<span class="line"><span style="color:#8FBCBB;">    password</span><span style="color:#ECEFF4;">:</span><span style="color:#B48EAD;"> 123456</span></span>
<span class="line"><span style="color:#8FBCBB;">    jedis</span><span style="color:#ECEFF4;">:</span></span>
<span class="line"><span style="color:#8FBCBB;">      pool</span><span style="color:#ECEFF4;">:</span></span>
<span class="line"><span style="color:#8FBCBB;">        max-wait</span><span style="color:#ECEFF4;">:</span><span style="color:#A3BE8C;"> 2000ms</span></span>
<span class="line"><span style="color:#8FBCBB;">        min-idle</span><span style="color:#ECEFF4;">:</span><span style="color:#B48EAD;"> 2</span></span>
<span class="line"><span style="color:#8FBCBB;">        max-idle</span><span style="color:#ECEFF4;">:</span><span style="color:#B48EAD;"> 8</span></span>
<span class="line"><span style="color:#8FBCBB;">rocketmq</span><span style="color:#ECEFF4;">:</span></span>
<span class="line"><span style="color:#8FBCBB;">  name-server</span><span style="color:#ECEFF4;">:</span><span style="color:#A3BE8C;"> 127.0.0.1:9876</span></span>
<span class="line"><span style="color:#616E88;">  # 是否开启自动配置</span></span>
<span class="line"><span style="color:#8FBCBB;">  producer</span><span style="color:#ECEFF4;">:</span></span>
<span class="line"><span style="color:#8FBCBB;">    enable-msg-trace</span><span style="color:#ECEFF4;">:</span><span style="color:#81A1C1;"> true</span></span>
<span class="line"><span style="color:#8FBCBB;">    group</span><span style="color:#ECEFF4;">:</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">service-producer</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#616E88;">    # 消息最大长度 默认 1024 * 4 (4M)</span></span>
<span class="line"><span style="color:#8FBCBB;">    max-message-size</span><span style="color:#ECEFF4;">:</span><span style="color:#B48EAD;"> 4096</span></span>
<span class="line"><span style="color:#616E88;">    # 发送消息超时时间，默认 3000</span></span>
<span class="line"><span style="color:#8FBCBB;">    send-message-timeout</span><span style="color:#ECEFF4;">:</span><span style="color:#B48EAD;"> 3000</span></span>
<span class="line"><span style="color:#616E88;">    # 发送消息失败重试次数，默认2</span></span>
<span class="line"><span style="color:#8FBCBB;">    retry-times-when-send-failed</span><span style="color:#ECEFF4;">:</span><span style="color:#B48EAD;"> 2</span></span>
<span class="line"><span style="color:#8FBCBB;">    retry-times-when-send-async-failed</span><span style="color:#ECEFF4;">:</span><span style="color:#B48EAD;"> 2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>编写实体类来封装MQ中的消息 , 注意： 下面的 CanalSynDto对象是根据<code>MQ中的消息内容</code>进行封装的，你可以把数据复制到在线JSON转换工具中进行分析。</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">@</span><span style="color:#D08770;">Data</span></span>
<span class="line"><span style="color:#ECEFF4;">@</span><span style="color:#D08770;">NoArgsConstructor</span></span>
<span class="line"><span style="color:#ECEFF4;">@</span><span style="color:#D08770;">AllArgsConstructor</span></span>
<span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> Employee</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    private</span><span style="color:#8FBCBB;"> Long</span><span style="color:#D8DEE9;"> id</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    private</span><span style="color:#8FBCBB;"> String</span><span style="color:#D8DEE9;"> username</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#ECEFF4;">@</span><span style="color:#D08770;">AllArgsConstructor</span></span>
<span class="line"><span style="color:#ECEFF4;">@</span><span style="color:#D08770;">NoArgsConstructor</span></span>
<span class="line"><span style="color:#ECEFF4;">@</span><span style="color:#D08770;">Data</span></span>
<span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> CanalSynDto</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">    private</span><span style="color:#8FBCBB;"> List</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">Employee</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9;"> data</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    private</span><span style="color:#8FBCBB;"> String</span><span style="color:#D8DEE9;"> database</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    private</span><span style="color:#8FBCBB;"> String</span><span style="color:#D8DEE9;"> table</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#81A1C1;">    private</span><span style="color:#8FBCBB;"> String</span><span style="color:#D8DEE9;"> type</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">    //省略了一些不重要的内容</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>编写MQ消费者代码，把MQ消息封装成 CanalSynDto 对象，然后取到data数据，再根据SQL的类型(insert,delete,update)对Redis进行数据同步</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#ECEFF4;">@</span><span style="color:#D08770;">Slf4j</span></span>
<span class="line"><span style="color:#ECEFF4;">@</span><span style="color:#D08770;">Component</span></span>
<span class="line"><span style="color:#616E88;">//对应了canal的instance.properties 中的canal.mq.topic=example</span></span>
<span class="line"><span style="color:#ECEFF4;">@</span><span style="color:#D08770;">RocketMQMessageListener</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">topic</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">example</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#616E88;"> //TOPIC主题，</span></span>
<span class="line"><span style="color:#D8DEE9;">        selectorExpression</span><span style="color:#81A1C1;">=</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">*</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#616E88;"> //tag标签</span></span>
<span class="line"><span style="color:#ECEFF4;">        ,</span><span style="color:#D8DEE9;">consumerGroup</span><span style="color:#81A1C1;"> =</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">canal-syn-consumer</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">        ,</span><span style="color:#D8DEE9;">messageModel</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> MessageModel</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">CLUSTERING</span></span>
<span class="line"><span style="color:#ECEFF4;">)</span></span>
<span class="line"><span style="color:#81A1C1;">public</span><span style="color:#81A1C1;"> class</span><span style="color:#8FBCBB;"> CanalSynListenner</span><span style="color:#81A1C1;">  implements</span><span style="color:#8FBCBB;font-weight:bold;"> RocketMQListener</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">MessageExt</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#616E88;">	//注入Redis API</span></span>
<span class="line"><span style="color:#ECEFF4;">    @</span><span style="color:#D08770;">Autowired</span></span>
<span class="line"><span style="color:#81A1C1;">    private</span><span style="color:#8FBCBB;"> RedisTemplate</span><span style="color:#ECEFF4;">&lt;</span><span style="color:#8FBCBB;">Object</span><span style="color:#ECEFF4;">,</span><span style="color:#8FBCBB;">Object</span><span style="color:#ECEFF4;">&gt;</span><span style="color:#D8DEE9;"> redisTemplate</span><span style="color:#81A1C1;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ECEFF4;">    @</span><span style="color:#D08770;">Override</span></span>
<span class="line"><span style="color:#81A1C1;">    public</span><span style="color:#81A1C1;"> void</span><span style="color:#88C0D0;"> onMessage</span><span style="color:#ECEFF4;">(</span><span style="color:#8FBCBB;">MessageExt</span><span style="color:#D8DEE9;"> message</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#81A1C1;">        try</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">        	//拿到MQ中的消息内容</span></span>
<span class="line"><span style="color:#8FBCBB;">            String</span><span style="color:#D8DEE9;"> json</span><span style="color:#81A1C1;"> =</span><span style="color:#81A1C1;"> new</span><span style="color:#88C0D0;"> String</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">message</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getBody</span><span style="color:#ECEFF4;">(),</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">utf-8</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">            //把数据转为实体类</span></span>
<span class="line"><span style="color:#8FBCBB;">            CanalSynDto</span><span style="color:#D8DEE9;"> canalSynDto</span><span style="color:#81A1C1;"> =</span><span style="color:#D8DEE9;"> JSON</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">parseObject</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">json</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9;"> CanalSynDto</span><span style="color:#ECEFF4;">.</span><span style="color:#D8DEE9;">class</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#D8DEE9;">            log</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">info</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">canal同步 {}</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">,</span><span style="color:#D8DEE9FF;"> canalSynDto</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">			//如果是INSERT或者UPDATE,直接往Redis添加</span></span>
<span class="line"><span style="color:#81A1C1;">            if</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9;">canalSynDto</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getType</span><span style="color:#ECEFF4;">().</span><span style="color:#88C0D0;">equals</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">INSERT</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;"> ||</span><span style="color:#D8DEE9;"> canalSynDto</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getType</span><span style="color:#ECEFF4;">().</span><span style="color:#88C0D0;">equals</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">UPDATE</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)){</span></span>
<span class="line"><span style="color:#616E88;">                //insert就添加，update就覆盖</span></span>
<span class="line"><span style="color:#D8DEE9;">                canalSynDto</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getData</span><span style="color:#ECEFF4;">().</span><span style="color:#88C0D0;">forEach</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">employee </span><span style="color:#8FBCBB;">-&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">                    //以  ID为key,把对象存储到Redis中</span></span>
<span class="line"><span style="color:#D8DEE9;">                    redisTemplate</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">opsForValue</span><span style="color:#ECEFF4;">().</span><span style="color:#88C0D0;">set</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ID:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">+</span><span style="color:#D8DEE9;">employee</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getId</span><span style="color:#ECEFF4;">(),</span><span style="color:#D8DEE9FF;">employee</span><span style="color:#ECEFF4;">)</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">                })</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#616E88;">             //删除命令</span></span>
<span class="line"><span style="color:#ECEFF4;">            }</span><span style="color:#81A1C1;">else</span><span style="color:#81A1C1;"> if</span><span style="color:#ECEFF4;"> (</span><span style="color:#D8DEE9;">canalSynDto</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getType</span><span style="color:#ECEFF4;">().</span><span style="color:#88C0D0;">equals</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">DELETE</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)){</span></span>
<span class="line"><span style="color:#D8DEE9;">                canalSynDto</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getData</span><span style="color:#ECEFF4;">().</span><span style="color:#88C0D0;">forEach</span><span style="color:#ECEFF4;">(</span><span style="color:#D8DEE9FF;">employee </span><span style="color:#8FBCBB;">-&gt;</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#616E88;">                    //以  ID为key,把对象从Redis中删除</span></span>
<span class="line"><span style="color:#D8DEE9;">                    redisTemplate</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">delete</span><span style="color:#ECEFF4;">(</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">ID:</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#81A1C1;">+</span><span style="color:#D8DEE9;">employee</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">getId</span><span style="color:#ECEFF4;">())</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">                })</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">            }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ECEFF4;">        }</span><span style="color:#81A1C1;"> catch</span><span style="color:#ECEFF4;"> (</span><span style="color:#8FBCBB;">UnsupportedEncodingException</span><span style="color:#D8DEE9;"> e</span><span style="color:#ECEFF4;">)</span><span style="color:#ECEFF4;"> {</span></span>
<span class="line"><span style="color:#D8DEE9;">            e</span><span style="color:#ECEFF4;">.</span><span style="color:#88C0D0;">printStackTrace</span><span style="color:#ECEFF4;">()</span><span style="color:#81A1C1;">;</span></span>
<span class="line"><span style="color:#ECEFF4;">        }</span></span>
<span class="line"><span style="color:#ECEFF4;">    }</span></span>
<span class="line"><span style="color:#ECEFF4;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>到这里代码就写完了，启动SpringBoot程序，对employee表中数据进行修改或者删除，观察Redis中的数据变化 ：Redis始终会随着Mysql变化而变化 <img src="https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407171258821.png" alt="在这里插入图片描述" loading="lazy"></p><p>我们的效果达到了，弱弱的问一句：Mysql实现ElasticSearch的数据同步你有方案吗？可以在评论区说出你的见解</p>`,35);function i(r,y){return p(),a("div",null,[c,l(" more "),t])}const F=n(o,[["render",i],["__file","12. Canal解决Mysql和Redis数据同步(MQ).html.vue"]]),v=JSON.parse('{"path":"/note/redis/12.%20Canal%E8%A7%A3%E5%86%B3Mysql%E5%92%8CRedis%E6%95%B0%E6%8D%AE%E5%90%8C%E6%AD%A5(MQ).html","title":"Canal解决Mysql和Redis数据同步(MQ)","lang":"zh-CN","frontmatter":{"title":"Canal解决Mysql和Redis数据同步(MQ)","cover":"/assets/images/cover1.jpg","icon":"file","order":12,"author":"HotMilk","category":["Redis"],"tag":["Redis","Canal","数据同步","MQ"],"head":[["meta",{"property":"og:url","content":"https://reniunai.github.io/note/redis/12.%20Canal%E8%A7%A3%E5%86%B3Mysql%E5%92%8CRedis%E6%95%B0%E6%8D%AE%E5%90%8C%E6%AD%A5(MQ).html"}],["meta",{"property":"og:site_name","content":"热牛奶"}],["meta",{"property":"og:title","content":"Canal解决Mysql和Redis数据同步(MQ)"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://reniunai.github.io/assets/images/cover1.jpg"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-08-05T09:42:18.000Z"}],["meta",{"name":"twitter:card","content":"summary_large_image"}],["meta",{"name":"twitter:image:src","content":"https://reniunai.github.io/assets/images/cover1.jpg"}],["meta",{"name":"twitter:image:alt","content":"Canal解决Mysql和Redis数据同步(MQ)"}],["meta",{"property":"article:author","content":"HotMilk"}],["meta",{"property":"article:tag","content":"Redis"}],["meta",{"property":"article:tag","content":"Canal"}],["meta",{"property":"article:tag","content":"数据同步"}],["meta",{"property":"article:tag","content":"MQ"}],["meta",{"property":"article:modified_time","content":"2024-08-05T09:42:18.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Canal解决Mysql和Redis数据同步(MQ)\\",\\"image\\":[\\"https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407171258005.png\\",\\"https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407171258928.png\\",\\"https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407171258752.png\\",\\"https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407171258755.png\\",\\"https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407171258731.png\\",\\"https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407171258767.png\\",\\"https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407171258670.png\\",\\"https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407171258677.png\\",\\"https://hotmilk-pic.oss-cn-shenzhen.aliyuncs.com/assets/202407171258821.png\\"],\\"dateModified\\":\\"2024-08-05T09:42:18.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"HotMilk\\"}]}"]]},"headers":[{"level":3,"title":"Mysql和Redis数据同步方案","slug":"mysql和redis数据同步方案","link":"#mysql和redis数据同步方案","children":[]},{"level":3,"title":"开启Mysql bin-log日志","slug":"开启mysql-bin-log日志","link":"#开启mysql-bin-log日志","children":[]},{"level":3,"title":"安装Canal","slug":"安装canal","link":"#安装canal","children":[]},{"level":3,"title":"Java程序把数据同步到Redis","slug":"java程序把数据同步到redis","link":"#java程序把数据同步到redis","children":[]}],"git":{"createdTime":1722847687000,"updatedTime":1722850938000,"contributors":[{"name":"reniunai","email":"2843768@qq.com","commits":2}]},"readingTime":{"minutes":6.52,"words":1956},"filePathRelative":"note/redis/12. Canal解决Mysql和Redis数据同步(MQ).md","localizedDate":"2024年8月5日","excerpt":"\\n"}');export{F as comp,v as data};
